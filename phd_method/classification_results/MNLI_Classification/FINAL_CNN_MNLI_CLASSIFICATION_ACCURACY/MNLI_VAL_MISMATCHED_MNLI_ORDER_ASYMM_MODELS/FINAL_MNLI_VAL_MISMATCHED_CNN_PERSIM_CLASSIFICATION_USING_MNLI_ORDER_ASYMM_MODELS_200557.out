Job ID: 200557
Node: gpuvm16
Time: Wed  3 Sep 08:56:59 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Wed Sep  3 08:57:05 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   37C    P8             10W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting Model training...

Using device: cuda
Loading MNLI training chunks...
  Chunk 1: 78540 samples
  Chunk 2: 78540 samples
  Chunk 3: 78541 samples
  Chunk 4: 78540 samples
  Chunk 5: 78538 samples
Total training samples: 392699
Loading MNLI validation data...
Validation samples: 9815
Loading test data from: /vol/bitbucket/ahb24/tda_entailment_new/MNLI_ORDER_ASYMM_MODELS_precomputed_mnli_val_mismatched_persistence_images.pkl
Test samples: 9832
Training CNN...
Epoch  0: Train Acc 0.627, Val Acc 0.610
Epoch 10: Train Acc 0.642, Val Acc 0.615
Early stopping at epoch 13
Training completed. Best validation accuracy: 0.620
Making predictions on test set...

Predictions completed!
Test set size: 9832
Prediction distribution:
  entailment: 4083 (41.5%)
  neutral: 3155 (32.1%)
  contradiction: 2594 (26.4%)

Test Set Evaluation:
Accuracy: 0.629

Classification Report:
               precision    recall  f1-score   support

   entailment      0.648     0.764     0.701      3463
      neutral      0.509     0.514     0.511      3129
contradiction      0.744     0.596     0.662      3240

     accuracy                          0.629      9832
    macro avg      0.634     0.624     0.625      9832
 weighted avg      0.636     0.629     0.628      9832


Results saved to: snli_cnn_predictions.pkl
Done!

Analysis completed with exit code: 0
Time: Wed  3 Sep 09:10:18 BST 2025

=== ANALYSIS SUCCESSFUL ===
Clustering successful!


Job finished.
