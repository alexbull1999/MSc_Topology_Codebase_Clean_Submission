Job ID: 200564
Node: gpuvm16
Time: Wed  3 Sep 09:21:04 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Wed Sep  3 09:21:05 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   39C    P8             14W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting Model training...

Using device: cuda
Loading MNLI training chunks...
  Chunk 1: 78540 samples
  Chunk 2: 78540 samples
  Chunk 3: 78541 samples
  Chunk 4: 78540 samples
  Chunk 5: 78538 samples
Total training samples: 392699
Loading MNLI validation data...
Validation samples: 9832
Loading test data from: /vol/bitbucket/ahb24/tda_entailment_new/MNLI_ORDER_ASYMM_MODELS_precomputed_mnli_val_matched_persistence_images.pkl
Test samples: 9815
Training CNN...
Epoch  0: Train Acc 0.626, Val Acc 0.609
Epoch 10: Train Acc 0.640, Val Acc 0.622
Epoch 20: Train Acc 0.642, Val Acc 0.631
Epoch 30: Train Acc 0.646, Val Acc 0.628
Early stopping at epoch 30
Training completed. Best validation accuracy: 0.631
Making predictions on test set...

Predictions completed!
Test set size: 9815
Prediction distribution:
  entailment: 3788 (38.6%)
  neutral: 3450 (35.2%)
  contradiction: 2577 (26.3%)

Test Set Evaluation:
Accuracy: 0.623

Classification Report:
               precision    recall  f1-score   support

   entailment      0.662     0.721     0.690      3479
      neutral      0.492     0.543     0.516      3123
contradiction      0.743     0.596     0.661      3213

     accuracy                          0.623      9815
    macro avg      0.632     0.620     0.623      9815
 weighted avg      0.634     0.623     0.625      9815


Results saved to: snli_cnn_predictions.pkl
Done!

Analysis completed with exit code: 0
Time: Wed  3 Sep 09:43:29 BST 2025

=== ANALYSIS SUCCESSFUL ===
Clustering successful!


Job finished.
