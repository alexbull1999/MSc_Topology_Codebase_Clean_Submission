Job ID: 195118
Node: parrot
Time: Sat 16 Aug 19:49:58 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Aug 16 19:50:03 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A16                     Off |   00000000:90:00.0 Off |                    0 |
|  0%   36C    P8             15W /   62W |       0MiB /  15356MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: NVIDIA A16
GPU memory: 15.7 GB
PyTorch setup verified!

Starting Model training...

================================================================================
TRAIN ON SNLI, EVALUATE ON CHAOSNLI
================================================================================
Loading SNLI + MNLI persistence images...
Combined SNLI+MNLI persistence images:
  Train: (198000, 900) (SNLI: (150000, 900), MNLI: (48000, 900))
  Val: (19657, 900) (SNLI: (9842, 900), MNLI: (9815, 900))
Computing SBERT baseline features from SNLI + MNLI...
Combined data: SNLI 150000 + MNLI 150000 = 300000 total samples
Processing entailment: 100167 samples
  Processed 1000/100167 entailment samples
  Processed 2000/100167 entailment samples
  Processed 3000/100167 entailment samples
  Processed 4000/100167 entailment samples
  Processed 5000/100167 entailment samples
  Processed 6000/100167 entailment samples
  Processed 7000/100167 entailment samples
  Processed 8000/100167 entailment samples
  Processed 9000/100167 entailment samples
  Processed 10000/100167 entailment samples
  Processed 11000/100167 entailment samples
  Processed 12000/100167 entailment samples
  Processed 13000/100167 entailment samples
  Processed 14000/100167 entailment samples
  Processed 15000/100167 entailment samples
  Processed 16000/100167 entailment samples
  Processed 17000/100167 entailment samples
  Processed 18000/100167 entailment samples
  Processed 19000/100167 entailment samples
  Processed 20000/100167 entailment samples
  Processed 21000/100167 entailment samples
  Processed 22000/100167 entailment samples
  Processed 23000/100167 entailment samples
  Processed 24000/100167 entailment samples
  Processed 25000/100167 entailment samples
  Processed 26000/100167 entailment samples
  Processed 27000/100167 entailment samples
  Processed 28000/100167 entailment samples
  Processed 29000/100167 entailment samples
  Processed 30000/100167 entailment samples
  Processed 31000/100167 entailment samples
  Processed 32000/100167 entailment samples
  Processed 33000/100167 entailment samples
  Processed 34000/100167 entailment samples
  Processed 35000/100167 entailment samples
  Processed 36000/100167 entailment samples
  Processed 37000/100167 entailment samples
  Processed 38000/100167 entailment samples
  Processed 39000/100167 entailment samples
  Processed 40000/100167 entailment samples
  Processed 41000/100167 entailment samples
  Processed 42000/100167 entailment samples
  Processed 43000/100167 entailment samples
  Processed 44000/100167 entailment samples
  Processed 45000/100167 entailment samples
  Processed 46000/100167 entailment samples
  Processed 47000/100167 entailment samples
  Processed 48000/100167 entailment samples
  Processed 49000/100167 entailment samples
  Processed 50000/100167 entailment samples
  Processed 51000/100167 entailment samples
  Processed 52000/100167 entailment samples
  Processed 53000/100167 entailment samples
  Processed 54000/100167 entailment samples
  Processed 55000/100167 entailment samples
  Processed 56000/100167 entailment samples
  Processed 57000/100167 entailment samples
  Processed 58000/100167 entailment samples
  Processed 59000/100167 entailment samples
  Processed 60000/100167 entailment samples
  Processed 61000/100167 entailment samples
  Processed 62000/100167 entailment samples
  Processed 63000/100167 entailment samples
  Processed 64000/100167 entailment samples
  Processed 65000/100167 entailment samples
  Processed 66000/100167 entailment samples
  Processed 67000/100167 entailment samples
  Processed 68000/100167 entailment samples
  Processed 69000/100167 entailment samples
  Processed 70000/100167 entailment samples
  Processed 71000/100167 entailment samples
  Processed 72000/100167 entailment samples
  Processed 73000/100167 entailment samples
  Processed 74000/100167 entailment samples
  Processed 75000/100167 entailment samples
  Processed 76000/100167 entailment samples
  Processed 77000/100167 entailment samples
  Processed 78000/100167 entailment samples
  Processed 79000/100167 entailment samples
  Processed 80000/100167 entailment samples
  Processed 81000/100167 entailment samples
  Processed 82000/100167 entailment samples
  Processed 83000/100167 entailment samples
  Processed 84000/100167 entailment samples
  Processed 85000/100167 entailment samples
  Processed 86000/100167 entailment samples
  Processed 87000/100167 entailment samples
  Processed 88000/100167 entailment samples
  Processed 89000/100167 entailment samples
  Processed 90000/100167 entailment samples
  Processed 91000/100167 entailment samples
  Processed 92000/100167 entailment samples
  Processed 93000/100167 entailment samples
  Processed 94000/100167 entailment samples
  Processed 95000/100167 entailment samples
  Processed 96000/100167 entailment samples
  Processed 97000/100167 entailment samples
  Processed 98000/100167 entailment samples
  Processed 99000/100167 entailment samples
  Processed 100000/100167 entailment samples
Processing neutral: 100359 samples
  Processed 1000/100359 neutral samples
  Processed 2000/100359 neutral samples
  Processed 3000/100359 neutral samples
  Processed 4000/100359 neutral samples
  Processed 5000/100359 neutral samples
  Processed 6000/100359 neutral samples
  Processed 7000/100359 neutral samples
  Processed 8000/100359 neutral samples
  Processed 9000/100359 neutral samples
  Processed 10000/100359 neutral samples
  Processed 11000/100359 neutral samples
  Processed 12000/100359 neutral samples
  Processed 13000/100359 neutral samples
  Processed 14000/100359 neutral samples
  Processed 15000/100359 neutral samples
  Processed 16000/100359 neutral samples
  Processed 17000/100359 neutral samples
  Processed 18000/100359 neutral samples
  Processed 19000/100359 neutral samples
  Processed 20000/100359 neutral samples
  Processed 21000/100359 neutral samples
  Processed 22000/100359 neutral samples
  Processed 23000/100359 neutral samples
  Processed 24000/100359 neutral samples
  Processed 25000/100359 neutral samples
  Processed 26000/100359 neutral samples
  Processed 27000/100359 neutral samples
  Processed 28000/100359 neutral samples
  Processed 29000/100359 neutral samples
  Processed 30000/100359 neutral samples
  Processed 31000/100359 neutral samples
  Processed 32000/100359 neutral samples
  Processed 33000/100359 neutral samples
  Processed 34000/100359 neutral samples
  Processed 35000/100359 neutral samples
  Processed 36000/100359 neutral samples
  Processed 37000/100359 neutral samples
  Processed 38000/100359 neutral samples
  Processed 39000/100359 neutral samples
  Processed 40000/100359 neutral samples
  Processed 41000/100359 neutral samples
  Processed 42000/100359 neutral samples
  Processed 43000/100359 neutral samples
  Processed 44000/100359 neutral samples
  Processed 45000/100359 neutral samples
  Processed 46000/100359 neutral samples
  Processed 47000/100359 neutral samples
  Processed 48000/100359 neutral samples
  Processed 49000/100359 neutral samples
  Processed 50000/100359 neutral samples
  Processed 51000/100359 neutral samples
  Processed 52000/100359 neutral samples
  Processed 53000/100359 neutral samples
  Processed 54000/100359 neutral samples
  Processed 55000/100359 neutral samples
  Processed 56000/100359 neutral samples
  Processed 57000/100359 neutral samples
  Processed 58000/100359 neutral samples
  Processed 59000/100359 neutral samples
  Processed 60000/100359 neutral samples
  Processed 61000/100359 neutral samples
  Processed 62000/100359 neutral samples
  Processed 63000/100359 neutral samples
  Processed 64000/100359 neutral samples
  Processed 65000/100359 neutral samples
  Processed 66000/100359 neutral samples
  Processed 67000/100359 neutral samples
  Processed 68000/100359 neutral samples
  Processed 69000/100359 neutral samples
  Processed 70000/100359 neutral samples
  Processed 71000/100359 neutral samples
  Processed 72000/100359 neutral samples
  Processed 73000/100359 neutral samples
  Processed 74000/100359 neutral samples
  Processed 75000/100359 neutral samples
  Processed 76000/100359 neutral samples
  Processed 77000/100359 neutral samples
  Processed 78000/100359 neutral samples
  Processed 79000/100359 neutral samples
  Processed 80000/100359 neutral samples
  Processed 81000/100359 neutral samples
  Processed 82000/100359 neutral samples
  Processed 83000/100359 neutral samples
  Processed 84000/100359 neutral samples
  Processed 85000/100359 neutral samples
  Processed 86000/100359 neutral samples
  Processed 87000/100359 neutral samples
  Processed 88000/100359 neutral samples
  Processed 89000/100359 neutral samples
  Processed 90000/100359 neutral samples
  Processed 91000/100359 neutral samples
  Processed 92000/100359 neutral samples
  Processed 93000/100359 neutral samples
  Processed 94000/100359 neutral samples
  Processed 95000/100359 neutral samples
  Processed 96000/100359 neutral samples
  Processed 97000/100359 neutral samples
  Processed 98000/100359 neutral samples
  Processed 99000/100359 neutral samples
  Processed 100000/100359 neutral samples
Processing contradiction: 99474 samples
  Processed 1000/99474 contradiction samples
  Processed 2000/99474 contradiction samples
  Processed 3000/99474 contradiction samples
  Processed 4000/99474 contradiction samples
  Processed 5000/99474 contradiction samples
  Processed 6000/99474 contradiction samples
  Processed 7000/99474 contradiction samples
  Processed 8000/99474 contradiction samples
  Processed 9000/99474 contradiction samples
  Processed 10000/99474 contradiction samples
  Processed 11000/99474 contradiction samples
  Processed 12000/99474 contradiction samples
  Processed 13000/99474 contradiction samples
  Processed 14000/99474 contradiction samples
  Processed 15000/99474 contradiction samples
  Processed 16000/99474 contradiction samples
  Processed 17000/99474 contradiction samples
  Processed 18000/99474 contradiction samples
  Processed 19000/99474 contradiction samples
  Processed 20000/99474 contradiction samples
  Processed 21000/99474 contradiction samples
  Processed 22000/99474 contradiction samples
  Processed 23000/99474 contradiction samples
  Processed 24000/99474 contradiction samples
  Processed 25000/99474 contradiction samples
  Processed 26000/99474 contradiction samples
  Processed 27000/99474 contradiction samples
  Processed 28000/99474 contradiction samples
  Processed 29000/99474 contradiction samples
  Processed 30000/99474 contradiction samples
  Processed 31000/99474 contradiction samples
  Processed 32000/99474 contradiction samples
  Processed 33000/99474 contradiction samples
  Processed 34000/99474 contradiction samples
  Processed 35000/99474 contradiction samples
  Processed 36000/99474 contradiction samples
  Processed 37000/99474 contradiction samples
  Processed 38000/99474 contradiction samples
  Processed 39000/99474 contradiction samples
  Processed 40000/99474 contradiction samples
  Processed 41000/99474 contradiction samples
  Processed 42000/99474 contradiction samples
  Processed 43000/99474 contradiction samples
  Processed 44000/99474 contradiction samples
  Processed 45000/99474 contradiction samples
  Processed 46000/99474 contradiction samples
  Processed 47000/99474 contradiction samples
  Processed 48000/99474 contradiction samples
  Processed 49000/99474 contradiction samples
  Processed 50000/99474 contradiction samples
  Processed 51000/99474 contradiction samples
  Processed 52000/99474 contradiction samples
  Processed 53000/99474 contradiction samples
  Processed 54000/99474 contradiction samples
  Processed 55000/99474 contradiction samples
  Processed 56000/99474 contradiction samples
  Processed 57000/99474 contradiction samples
  Processed 58000/99474 contradiction samples
  Processed 59000/99474 contradiction samples
  Processed 60000/99474 contradiction samples
  Processed 61000/99474 contradiction samples
  Processed 62000/99474 contradiction samples
  Processed 63000/99474 contradiction samples
  Processed 64000/99474 contradiction samples
  Processed 65000/99474 contradiction samples
  Processed 66000/99474 contradiction samples
  Processed 67000/99474 contradiction samples
  Processed 68000/99474 contradiction samples
  Processed 69000/99474 contradiction samples
  Processed 70000/99474 contradiction samples
  Processed 71000/99474 contradiction samples
  Processed 72000/99474 contradiction samples
  Processed 73000/99474 contradiction samples
  Processed 74000/99474 contradiction samples
  Processed 75000/99474 contradiction samples
  Processed 76000/99474 contradiction samples
  Processed 77000/99474 contradiction samples
  Processed 78000/99474 contradiction samples
  Processed 79000/99474 contradiction samples
  Processed 80000/99474 contradiction samples
  Processed 81000/99474 contradiction samples
  Processed 82000/99474 contradiction samples
  Processed 83000/99474 contradiction samples
  Processed 84000/99474 contradiction samples
  Processed 85000/99474 contradiction samples
  Processed 86000/99474 contradiction samples
  Processed 87000/99474 contradiction samples
  Processed 88000/99474 contradiction samples
  Processed 89000/99474 contradiction samples
  Processed 90000/99474 contradiction samples
  Processed 91000/99474 contradiction samples
  Processed 92000/99474 contradiction samples
  Processed 93000/99474 contradiction samples
  Processed 94000/99474 contradiction samples
  Processed 95000/99474 contradiction samples
  Processed 96000/99474 contradiction samples
  Processed 97000/99474 contradiction samples
  Processed 98000/99474 contradiction samples
  Processed 99000/99474 contradiction samples
Combined SBERT features: (300000, 3072), class distribution: {0: 100167, 1: 100359, 2: 99474}
Computing SBERT baseline features from SNLI + MNLI...
Combined data: SNLI 9842 + MNLI 9815 = 19657 total samples
Processing entailment: 6808 samples
  Processed 1000/6808 entailment samples
  Processed 2000/6808 entailment samples
  Processed 3000/6808 entailment samples
  Processed 4000/6808 entailment samples
  Processed 5000/6808 entailment samples
  Processed 6000/6808 entailment samples
Processing neutral: 6358 samples
  Processed 1000/6358 neutral samples
  Processed 2000/6358 neutral samples
  Processed 3000/6358 neutral samples
  Processed 4000/6358 neutral samples
  Processed 5000/6358 neutral samples
  Processed 6000/6358 neutral samples
Processing contradiction: 6491 samples
  Processed 1000/6491 contradiction samples
  Processed 2000/6491 contradiction samples
  Processed 3000/6491 contradiction samples
  Processed 4000/6491 contradiction samples
  Processed 5000/6491 contradiction samples
  Processed 6000/6491 contradiction samples
Combined SBERT features: (19657, 3072), class distribution: {0: 6808, 1: 6358, 2: 6491}
Aligning persistence and SBERT datasets...
Class 0: persistence=98214, sbert=100167, using=98214
Class 1: persistence=50069, sbert=100359, using=50069
Class 2: persistence=49717, sbert=99474, using=49717
Aligned datasets: (198000, 900) persistence, (198000, 3072) SBERT
Loading ChaosNLI persistence images...
ChaosNLI persistence images: (1514, 900)
Human label distributions: (1514, 3)
Entropy range: 0.000 - 1.583
Loading ChaosNLI persistence images...
ChaosNLI persistence images: (1599, 900)
Human label distributions: (1599, 3)
Entropy range: 0.081 - 1.584
Computing ChaosNLI SBERT baseline features from /vol/bitbucket/ahb24/tda_entailment_new/chaosnli_snli_sbert_tokens.pkl
Processing 1514 ChaosNLI samples...
  Processed 1000/1514 samples
ChaosNLI SBERT features: (1514, 3072)
Computing ChaosNLI SBERT baseline features from /vol/bitbucket/ahb24/tda_entailment_new/chaosnli_mnli_matched_sbert_tokens.pkl
Processing 1599 ChaosNLI samples...
  Processed 1000/1599 samples
ChaosNLI SBERT features: (1599, 3072)

============================================================
TRAINING PERSISTENCE IMAGE CNN ON SNLI
============================================================
Training model on cuda...
Training samples: 198000
Validation samples: 19657
Epoch   0: Train Loss 0.5353 (Acc 0.817), Val Loss 1.3179 (Acc 0.584), Best Val 0.000
Epoch   1: Train Loss 0.4935 (Acc 0.834), Val Loss 1.2522 (Acc 0.596), Best Val 0.584
Epoch   2: Train Loss 0.4784 (Acc 0.836), Val Loss 1.3630 (Acc 0.591), Best Val 0.596
Epoch   3: Train Loss 0.4683 (Acc 0.838), Val Loss 1.2785 (Acc 0.593), Best Val 0.596
Epoch   4: Train Loss 0.4620 (Acc 0.838), Val Loss 1.2586 (Acc 0.593), Best Val 0.596
Epoch   5: Train Loss 0.4573 (Acc 0.839), Val Loss 1.2999 (Acc 0.596), Best Val 0.596
Epoch   6: Train Loss 0.4540 (Acc 0.840), Val Loss 1.2988 (Acc 0.596), Best Val 0.596
Epoch   7: Train Loss 0.4504 (Acc 0.841), Val Loss 1.2836 (Acc 0.592), Best Val 0.596
Epoch   8: Train Loss 0.4463 (Acc 0.841), Val Loss 1.2734 (Acc 0.601), Best Val 0.596
Epoch   9: Train Loss 0.4424 (Acc 0.842), Val Loss 1.3164 (Acc 0.590), Best Val 0.601
Epoch  20: Train Loss 0.4201 (Acc 0.847), Val Loss 1.2765 (Acc 0.607), Best Val 0.605
Epoch  40: Train Loss 0.3947 (Acc 0.854), Val Loss 1.3163 (Acc 0.605), Best Val 0.609
Epoch  60: Train Loss 0.3875 (Acc 0.857), Val Loss 1.3380 (Acc 0.608), Best Val 0.611
Early stopping at epoch 72 (patience=25)
Training completed. Best validation accuracy: 0.611
Persistence CNN SNLI validation accuracy: 0.611

============================================================
TRAINING SBERT CLASSIFIER ON SNLI
============================================================
Standardizing (198000, 3072) in-place...
Training model on cuda...
Training samples: 198000
Validation samples: 19657
Epoch   0: Train Loss 0.6755 (Acc 0.720), Val Loss 1.6522 (Acc 0.391), Best Val 0.000
Epoch   1: Train Loss 0.6124 (Acc 0.751), Val Loss 1.7264 (Acc 0.389), Best Val 0.391
Epoch   2: Train Loss 0.5806 (Acc 0.765), Val Loss 1.8040 (Acc 0.385), Best Val 0.391
Epoch   3: Train Loss 0.5534 (Acc 0.776), Val Loss 1.7443 (Acc 0.379), Best Val 0.391
Epoch   4: Train Loss 0.5278 (Acc 0.788), Val Loss 2.0483 (Acc 0.375), Best Val 0.391
Epoch   5: Train Loss 0.5051 (Acc 0.796), Val Loss 2.2687 (Acc 0.382), Best Val 0.391
Epoch   6: Train Loss 0.4841 (Acc 0.805), Val Loss 2.1505 (Acc 0.378), Best Val 0.391
Epoch   7: Train Loss 0.4629 (Acc 0.814), Val Loss 2.2575 (Acc 0.383), Best Val 0.391
Epoch   8: Train Loss 0.4429 (Acc 0.823), Val Loss 2.5163 (Acc 0.373), Best Val 0.391
Epoch   9: Train Loss 0.4251 (Acc 0.830), Val Loss 2.5830 (Acc 0.371), Best Val 0.391
Epoch  20: Train Loss 0.2461 (Acc 0.904), Val Loss 4.1447 (Acc 0.372), Best Val 0.391
Early stopping at epoch 25 (patience=25)
Training completed. Best validation accuracy: 0.391
SBERT SNLI validation accuracy: 0.391

================================================================================
EVALUATING ON CHAOSNLI SNLI DATASET UNCERTAINTY QUANTIFICATION
================================================================================

Analysis completed with exit code: 1
Time: Sat 16 Aug 20:17:33 BST 2025

=== ANALYSIS FAILED ===
Please check the error output above for debugging information.


Job finished.
