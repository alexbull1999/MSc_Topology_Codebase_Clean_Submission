Job ID: 199653
Node: gpuvm16
Time: Sat 30 Aug 14:00:28 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Aug 30 14:00:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   38C    P8             13W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting Model training...

Using device: cuda
Loading SNLI training chunks...
  Chunk 1: 78541 samples
  Chunk 2: 78540 samples
  Chunk 3: 78539 samples
  Chunk 4: 78541 samples
  Chunk 5: 78537 samples
Total training samples: 392698
Loading SNLI validation data...
Validation samples: 9815
Loading test data from: /vol/bitbucket/ahb24/tda_entailment_new/precomputed_mnli_val_mismatched_persistence_images.pkl
Test samples: 9832
Training CNN...
Epoch  0: Train Acc 0.524, Val Acc 0.542
Epoch 10: Train Acc 0.574, Val Acc 0.578
Epoch 20: Train Acc 0.584, Val Acc 0.590
Epoch 30: Train Acc 0.588, Val Acc 0.563
Early stopping at epoch 36
Training completed. Best validation accuracy: 0.596
Making predictions on test set...

Predictions completed!
Test set size: 9832
Prediction distribution:
  entailment: 4215 (42.9%)
  neutral: 3432 (34.9%)
  contradiction: 2185 (22.2%)

Test Set Evaluation:
Accuracy: 0.591

Classification Report:
               precision    recall  f1-score   support

   entailment      0.643     0.783     0.706      3463
      neutral      0.450     0.493     0.470      3129
contradiction      0.712     0.480     0.574      3240

     accuracy                          0.591      9832
    macro avg      0.602     0.585     0.583      9832
 weighted avg      0.604     0.591     0.587      9832


Results saved to: snli_cnn_predictions.pkl
Done!

Analysis completed with exit code: 0
Time: Sat 30 Aug 14:34:12 BST 2025

=== ANALYSIS SUCCESSFUL ===
Clustering successful!


Job finished.
