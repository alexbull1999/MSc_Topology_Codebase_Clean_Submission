Job ID: 189171
Node: gpuvm17
Time: Fri  1 Aug 14:14:39 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Fri Aug  1 14:14:41 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   30C    P8              9W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting Model training...

================================================================================
STEP 1: TRAINING ORDER EMBEDDING MODEL
================================================================================
Loading processed dataset: /vol/bitbucket/ahb24/tda_entailment_new/snli_train_sbert_tokens_all_distilroberta_v1.pkl
Loaded 150000 samples
Label distribution: {'contradiction': 49717, 'entailment': 50214, 'neutral': 50069}
OrderEmbeddingTrainer initialized on cuda
Training OrderEmbeddingModel - Pure Vendrov et al. max-margin loss

Epoch 1/20
Train Loss: 0.8351, Val Loss: 0.2942
Energy Rankings:
  entailment: 0.3795 ± 0.2495
  neutral: 0.7743 ± 0.3853
  contradiction: 0.9827 ± 0.4977
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 2/20
Train Loss: 0.2603, Val Loss: 0.2688
Energy Rankings:
  entailment: 0.3503 ± 0.2691
  neutral: 0.8591 ± 0.4828
  contradiction: 1.0898 ± 0.5822
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 3/20
Train Loss: 0.2394, Val Loss: 0.2537
Energy Rankings:
  entailment: 0.3288 ± 0.2810
  neutral: 0.9144 ± 0.5513
  contradiction: 1.1934 ± 0.6727
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 4/20
Train Loss: 0.2241, Val Loss: 0.2412
Energy Rankings:
  entailment: 0.3220 ± 0.2937
  neutral: 0.9756 ± 0.6141
  contradiction: 1.2997 ± 0.7454
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 5/20
Train Loss: 0.2127, Val Loss: 0.2336
Energy Rankings:
  entailment: 0.3155 ± 0.3043
  neutral: 1.0169 ± 0.6583
  contradiction: 1.3805 ± 0.8065
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 6/20
Train Loss: 0.2034, Val Loss: 0.2288
Energy Rankings:
  entailment: 0.3067 ± 0.3052
  neutral: 1.0395 ± 0.6833
  contradiction: 1.3962 ± 0.8160
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 7/20
Train Loss: 0.1953, Val Loss: 0.2219
Energy Rankings:
  entailment: 0.3121 ± 0.3185
  neutral: 1.0976 ± 0.7333
  contradiction: 1.5149 ± 0.9000
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 8/20
Train Loss: 0.1886, Val Loss: 0.2201
Energy Rankings:
  entailment: 0.3021 ± 0.3142
  neutral: 1.0897 ± 0.7284
  contradiction: 1.4980 ± 0.8939
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 9/20
Train Loss: 0.1825, Val Loss: 0.2175
Energy Rankings:
  entailment: 0.2955 ± 0.3178
  neutral: 1.1067 ± 0.7578
  contradiction: 1.5425 ± 0.9363
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 10/20
Train Loss: 0.1770, Val Loss: 0.2127
Energy Rankings:
  entailment: 0.3067 ± 0.3289
  neutral: 1.1581 ± 0.7858
  contradiction: 1.6232 ± 0.9757
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 11/20
Train Loss: 0.1721, Val Loss: 0.2126
Energy Rankings:
  entailment: 0.2954 ± 0.3254
  neutral: 1.1438 ± 0.7885
  contradiction: 1.6216 ± 0.9966
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 12/20
Train Loss: 0.1674, Val Loss: 0.2100
Energy Rankings:
  entailment: 0.3013 ± 0.3318
  neutral: 1.1745 ± 0.8055
  contradiction: 1.6739 ± 1.0287
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 13/20
Train Loss: 0.1634, Val Loss: 0.2075
Energy Rankings:
  entailment: 0.3030 ± 0.3388
  neutral: 1.2087 ± 0.8341
  contradiction: 1.7082 ± 1.0511
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 14/20
Train Loss: 0.1596, Val Loss: 0.2075
Energy Rankings:
  entailment: 0.2911 ± 0.3318
  neutral: 1.1838 ± 0.8255
  contradiction: 1.6852 ± 1.0460
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 15/20
Train Loss: 0.1558, Val Loss: 0.2062
Energy Rankings:
  entailment: 0.2942 ± 0.3337
  neutral: 1.2054 ± 0.8393
  contradiction: 1.7224 ± 1.0763
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 16/20
Train Loss: 0.1525, Val Loss: 0.2057
Energy Rankings:
  entailment: 0.2900 ± 0.3344
  neutral: 1.2013 ± 0.8452
  contradiction: 1.7402 ± 1.0940
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 17/20
Train Loss: 0.1494, Val Loss: 0.2055
Energy Rankings:
  entailment: 0.2897 ± 0.3350
  neutral: 1.2029 ± 0.8443
  contradiction: 1.7319 ± 1.0911
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 18/20
Train Loss: 0.1461, Val Loss: 0.2034
Energy Rankings:
  entailment: 0.2959 ± 0.3454
  neutral: 1.2466 ± 0.8782
  contradiction: 1.7721 ± 1.1080
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt

Epoch 19/20
Train Loss: 0.1434, Val Loss: 0.2035
Energy Rankings:
  entailment: 0.2901 ± 0.3395
  neutral: 1.2341 ± 0.8730
  contradiction: 1.7681 ± 1.1199

Epoch 20/20
Train Loss: 0.1407, Val Loss: 0.2032
Energy Rankings:
  entailment: 0.2891 ± 0.3441
  neutral: 1.2451 ± 0.8867
  contradiction: 1.7835 ± 1.1388
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/order_embedding_model_all_distilroberta_v1.pt
================================================================================
STEP 2: TRAINING ASYMMETRY TRANSFORM MODEL
================================================================================
Loading processed dataset: /vol/bitbucket/ahb24/tda_entailment_new/snli_train_sbert_tokens_all_distilroberta_v1.pkl
Loaded 150000 samples
Label distribution: {'contradiction': 49717, 'entailment': 50214, 'neutral': 50069}
AsymmetryTrainer initialized on cuda
Order model is frozen - only training asymmetry model
Training AsymmetryTransformModel - Asymmetric directional loss
OrderEmbeddingModel is frozen

Epoch 1/15
Train Loss: 0.9265, Val Loss: 1.0333
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=1.048
  neutral: fwd=1.245, bwd=1.225, asym=1.126
  contradiction: fwd=1.784, bwd=1.749, asym=1.362
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 2/15
Train Loss: 0.9266, Val Loss: 1.0313
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=1.467
  neutral: fwd=1.245, bwd=1.225, asym=1.354
  contradiction: fwd=1.784, bwd=1.749, asym=1.540
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 3/15
Train Loss: 0.9266, Val Loss: 1.0295
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=2.028
  neutral: fwd=1.245, bwd=1.225, asym=1.732
  contradiction: fwd=1.784, bwd=1.749, asym=1.867
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 4/15
Train Loss: 0.9266, Val Loss: 1.0283
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=2.685
  neutral: fwd=1.245, bwd=1.225, asym=2.217
  contradiction: fwd=1.784, bwd=1.749, asym=2.320
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 5/15
Train Loss: 0.9266, Val Loss: 1.0279
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=3.201
  neutral: fwd=1.245, bwd=1.225, asym=2.601
  contradiction: fwd=1.784, bwd=1.749, asym=2.678
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 6/15
Train Loss: 0.9266, Val Loss: 1.0275
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=3.714
  neutral: fwd=1.245, bwd=1.225, asym=3.005
  contradiction: fwd=1.784, bwd=1.749, asym=3.085
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 7/15
Train Loss: 0.9266, Val Loss: 1.0274
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=3.976
  neutral: fwd=1.245, bwd=1.225, asym=3.205
  contradiction: fwd=1.784, bwd=1.749, asym=3.278
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 8/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.269
  neutral: fwd=1.245, bwd=1.225, asym=3.431
  contradiction: fwd=1.784, bwd=1.749, asym=3.499
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 9/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.470
  neutral: fwd=1.245, bwd=1.225, asym=3.586
  contradiction: fwd=1.784, bwd=1.749, asym=3.654
✅ Asymmetry model saved: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_transform_model_all_distilroberta_v1.pt

Epoch 10/15
Train Loss: 0.9266, Val Loss: 1.0274
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.250
  neutral: fwd=1.245, bwd=1.225, asym=3.408
  contradiction: fwd=1.784, bwd=1.749, asym=3.474

Epoch 11/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.427
  neutral: fwd=1.245, bwd=1.225, asym=3.545
  contradiction: fwd=1.784, bwd=1.749, asym=3.609

Epoch 12/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.509
  neutral: fwd=1.245, bwd=1.225, asym=3.612
  contradiction: fwd=1.784, bwd=1.749, asym=3.683

Epoch 13/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.602
  neutral: fwd=1.245, bwd=1.225, asym=3.684
  contradiction: fwd=1.784, bwd=1.749, asym=3.757

Epoch 14/15
Train Loss: 0.9266, Val Loss: 1.0273
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.560
  neutral: fwd=1.245, bwd=1.225, asym=3.653
  contradiction: fwd=1.784, bwd=1.749, asym=3.732

Epoch 15/15
Train Loss: 0.9266, Val Loss: 1.0274
Asymmetry Stats:
  entailment: fwd=0.289, bwd=1.640, asym=4.438
  neutral: fwd=1.245, bwd=1.225, asym=3.555
  contradiction: fwd=1.784, bwd=1.749, asym=3.635
Comprehensive training plots saved to: MSc_Topology_Codebase/phd_method/models/separate_models/comprehensive_training_progress__all_distilroberta_v1_20250801_170413.png
Detailed order model plots saved to: MSc_Topology_Codebase/phd_method/models/separate_models/order_model_detailed__all_distilroberta_v1_20250801_170413.png
Detailed asymmetry model plots saved to: MSc_Topology_Codebase/phd_method/models/separate_models/asymmetry_model_detailed__all_distilroberta_v1_20250801_170413.png
Token-level analysis summary saved to: MSc_Topology_Codebase/phd_method/models/separate_models/token_level_analysis__all_distilroberta_v1_20250801_170413.txt

================================================================================
SEPARATE MODEL TRAINING COMPLETE!
✅ OrderEmbeddingModel: Pure hierarchy (Vendrov et al.)
✅ AsymmetryTransformModel: Directional patterns

Point cloud structure per sample:
  - SBERT tokens: ~30-50 points
  - Order embeddings: ~30-50 points
  - Asymmetric features: ~30-50 points
  - Total: ~90-150 points per text
Next: Update point_cloud_clustering_test.py to use both models
================================================================================

Analysis completed with exit code: 0
Time: Fri  1 Aug 17:05:02 BST 2025

=== ANALYSIS SUCCESSFUL ===
Training successful!


Job finished.
