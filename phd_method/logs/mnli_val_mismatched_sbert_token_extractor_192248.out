Starting Surface Distance Metric Analysis job...
Job ID: 192248
Node: parrot
Time: Sat  9 Aug 09:02:10 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Aug  9 09:02:16 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A16                     Off |   00000000:98:00.0 Off |                    0 |
|  0%   36C    P8             15W /   62W |       0MiB /  15356MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: NVIDIA A16
GPU memory: 15.7 GB
PyTorch setup verified!

Starting SBERT Token Extraction...

Loading SBERT model: sentence-transformers/all-mpnet-base-v2
Device: cuda
Hidden size: 768
SBERT token extractor ready

Processing SNLI validation data...
Processing dataset: MSc_Topology_Codebase/data/raw/mnli/validation_mismatched/mnli_full_validation_mismatched.json
Total samples to process: 9832
Processed 100/9832 samples
Processed 200/9832 samples
Processed 300/9832 samples
Processed 400/9832 samples
Processed 500/9832 samples
Processed 600/9832 samples
Processed 700/9832 samples
Processed 800/9832 samples
Processed 900/9832 samples
Processed 1000/9832 samples
Processed 1100/9832 samples
Processed 1200/9832 samples
Processed 1300/9832 samples
Processed 1400/9832 samples
Processed 1500/9832 samples
Processed 1600/9832 samples
Processed 1700/9832 samples
Processed 1800/9832 samples
Processed 1900/9832 samples
Processed 2000/9832 samples
Processed 2100/9832 samples
Processed 2200/9832 samples
Processed 2300/9832 samples
Processed 2400/9832 samples
Processed 2500/9832 samples
Processed 2600/9832 samples
Processed 2700/9832 samples
Processed 2800/9832 samples
Processed 2900/9832 samples
Processed 3000/9832 samples
Processed 3100/9832 samples
Processed 3200/9832 samples
Processed 3300/9832 samples
Processed 3400/9832 samples
Processed 3500/9832 samples
Processed 3600/9832 samples
Processed 3700/9832 samples
Processed 3800/9832 samples
Processed 3900/9832 samples
Processed 4000/9832 samples
Processed 4100/9832 samples
Processed 4200/9832 samples
Processed 4300/9832 samples
Processed 4400/9832 samples
Processed 4500/9832 samples
Processed 4600/9832 samples
Processed 4700/9832 samples
Processed 4800/9832 samples
Processed 4900/9832 samples
Processed 5000/9832 samples
Processed 5100/9832 samples
Processed 5200/9832 samples
Processed 5300/9832 samples
Processed 5400/9832 samples
Processed 5500/9832 samples
Processed 5600/9832 samples
Processed 5700/9832 samples
Processed 5800/9832 samples
Processed 5900/9832 samples
Processed 6000/9832 samples
Processed 6100/9832 samples
Processed 6200/9832 samples
Processed 6300/9832 samples
Processed 6400/9832 samples
Processed 6500/9832 samples
Processed 6600/9832 samples
Processed 6700/9832 samples
Processed 6800/9832 samples
Processed 6900/9832 samples
Processed 7000/9832 samples
Processed 7100/9832 samples
Processed 7200/9832 samples
Processed 7300/9832 samples
Processed 7400/9832 samples
Processed 7500/9832 samples
Processed 7600/9832 samples
Processed 7700/9832 samples
Processed 7800/9832 samples
Processed 7900/9832 samples
Processed 8000/9832 samples
Processed 8100/9832 samples
Processed 8200/9832 samples
Processed 8300/9832 samples
Processed 8400/9832 samples
Processed 8500/9832 samples
Processed 8600/9832 samples
Processed 8700/9832 samples
Processed 8800/9832 samples
Processed 8900/9832 samples
Processed 9000/9832 samples
Processed 9100/9832 samples
Processed 9200/9832 samples
Processed 9300/9832 samples
Processed 9400/9832 samples
Processed 9500/9832 samples
Processed 9600/9832 samples
Processed 9700/9832 samples
Processed 9800/9832 samples
Saving processed data to: /vol/bitbucket/ahb24/tda_entailment_new/mnli_val_mismatched_sbert_tokens.pkl

Processing Statistics:
Successfully processed: 9832 samples
Premise token counts - Mean: 26.8, Min: 5, Max: 196
Hypothesis token counts - Mean: 15.1, Min: 4, Max: 76
Label distribution: {'neutral': 3129, 'entailment': 3463, 'contradiction': 3240}

SBERT token extraction completed!

Analysis completed with exit code: 0
Time: Sat  9 Aug 09:08:33 BST 2025

=== ANALYSIS SUCCESSFUL ===
Extraction successful!


Job finished.
