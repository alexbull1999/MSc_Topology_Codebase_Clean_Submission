Job ID: 191362
Node: parrot
Time: Thu  7 Aug 17:35:21 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Thu Aug  7 17:35:26 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A16                     Off |   00000000:8E:00.0 Off |                    0 |
|  0%   22C    P8             15W /   62W |       0MiB /  15356MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: NVIDIA A16
GPU memory: 15.7 GB
PyTorch setup verified!

Starting Model training...

================================================================================
TRAINING ORDER EMBEDDING MODEL WITH SEPARATE MARGINS
================================================================================
Loading processed dataset: /vol/bitbucket/ahb24/tda_entailment_new/mnli_train_sbert_tokens.pkl
Loaded 150000 samples
Label distribution: {'contradiction': 49757, 'entailment': 49953, 'neutral': 50290}
OrderEmbeddingTrainerSeparateMargins initialized on cuda
Training OrderEmbeddingModel - Separate Margin Loss
Neutral margin: 1.0, Upper bound: 1.5, Contradiction margin: 2.0

Epoch 1/100
Train Loss: 0.5047, Val Loss: 0.4900
Energy Rankings:
  entailment: 0.6818 ± 0.2730
  neutral: 0.9317 ± 0.3721
  contradiction: 1.5448 ± 0.6967
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 2/100
Train Loss: 0.4689, Val Loss: 0.4669
Energy Rankings:
  entailment: 0.6856 ± 0.3032
  neutral: 0.9864 ± 0.4317
  contradiction: 1.7287 ± 0.8142
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 3/100
Train Loss: 0.4533, Val Loss: 0.4606
Energy Rankings:
  entailment: 0.6572 ± 0.3036
  neutral: 0.9705 ± 0.4346
  contradiction: 1.7269 ± 0.8153
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 4/100
Train Loss: 0.4417, Val Loss: 0.4579
Energy Rankings:
  entailment: 0.6257 ± 0.3028
  neutral: 0.9429 ± 0.4344
  contradiction: 1.7207 ± 0.8286
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 5/100
Train Loss: 0.4320, Val Loss: 0.4501
Energy Rankings:
  entailment: 0.6401 ± 0.3153
  neutral: 0.9828 ± 0.4567
  contradiction: 1.7853 ± 0.8516
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 6/100
Train Loss: 0.4234, Val Loss: 0.4469
Energy Rankings:
  entailment: 0.6310 ± 0.3215
  neutral: 0.9820 ± 0.4672
  contradiction: 1.7995 ± 0.8551
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 7/100
Train Loss: 0.4155, Val Loss: 0.4456
Energy Rankings:
  entailment: 0.6158 ± 0.3215
  neutral: 0.9702 ± 0.4677
  contradiction: 1.7963 ± 0.8625
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 8/100
Train Loss: 0.4084, Val Loss: 0.4428
Energy Rankings:
  entailment: 0.6202 ± 0.3289
  neutral: 0.9842 ± 0.4812
  contradiction: 1.8410 ± 0.8896
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 9/100
Train Loss: 0.4019, Val Loss: 0.4410
Energy Rankings:
  entailment: 0.6216 ± 0.3286
  neutral: 0.9922 ± 0.4791
  contradiction: 1.8278 ± 0.8684
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 10/100
Train Loss: 0.3952, Val Loss: 0.4423
Energy Rankings:
  entailment: 0.6001 ± 0.3232
  neutral: 0.9647 ± 0.4731
  contradiction: 1.7941 ± 0.8590
  ✅ Correct ordering maintained

Epoch 11/100
Train Loss: 0.3894, Val Loss: 0.4393
Energy Rankings:
  entailment: 0.6115 ± 0.3301
  neutral: 0.9907 ± 0.4853
  contradiction: 1.8186 ± 0.8584
  ✅ Correct ordering maintained
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 12/100
Train Loss: 0.3837, Val Loss: 0.4380
Energy Rankings:
  entailment: 0.6232 ± 0.3419
  neutral: 1.0109 ± 0.5003
  contradiction: 1.8731 ± 0.8920
  ✅ Perfect target zones achieved!
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 13/100
Train Loss: 0.3780, Val Loss: 0.4392
Energy Rankings:
  entailment: 0.6046 ± 0.3350
  neutral: 0.9818 ± 0.4888
  contradiction: 1.8291 ± 0.8756
  ✅ Correct ordering maintained

Epoch 14/100
Train Loss: 0.3722, Val Loss: 0.4374
Energy Rankings:
  entailment: 0.6089 ± 0.3407
  neutral: 1.0000 ± 0.5017
  contradiction: 1.8458 ± 0.8746
  ✅ Perfect target zones achieved!
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 15/100
Train Loss: 0.3674, Val Loss: 0.4373
Energy Rankings:
  entailment: 0.6103 ± 0.3450
  neutral: 1.0055 ± 0.5099
  contradiction: 1.8706 ± 0.8939
  ✅ Perfect target zones achieved!
✅ Order model saved: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_model_separate_margins.pt

Epoch 16/100
Train Loss: 0.3623, Val Loss: 0.4375
Energy Rankings:
  entailment: 0.6013 ± 0.3421
  neutral: 0.9930 ± 0.5048
  contradiction: 1.8516 ± 0.8890
  ✅ Correct ordering maintained

Epoch 17/100
Train Loss: 0.3570, Val Loss: 0.4378
Energy Rankings:
  entailment: 0.5988 ± 0.3460
  neutral: 0.9906 ± 0.5118
  contradiction: 1.8673 ± 0.9040
  ✅ Correct ordering maintained

Epoch 18/100
Train Loss: 0.3520, Val Loss: 0.4377
Energy Rankings:
  entailment: 0.6052 ± 0.3480
  neutral: 1.0025 ± 0.5149
  contradiction: 1.8672 ± 0.8952
  ✅ Perfect target zones achieved!

Epoch 19/100
Train Loss: 0.3472, Val Loss: 0.4381
Energy Rankings:
  entailment: 0.6042 ± 0.3557
  neutral: 1.0084 ± 0.5285
  contradiction: 1.8856 ± 0.9090
  ✅ Perfect target zones achieved!

Epoch 20/100
Train Loss: 0.3426, Val Loss: 0.4378
Energy Rankings:
  entailment: 0.6071 ± 0.3554
  neutral: 1.0194 ± 0.5286
  contradiction: 1.8723 ± 0.8941
  ✅ Perfect target zones achieved!

Epoch 21/100
Train Loss: 0.3378, Val Loss: 0.4398
Energy Rankings:
  entailment: 0.6013 ± 0.3539
  neutral: 1.0066 ± 0.5264
  contradiction: 1.8554 ± 0.8937
  ✅ Perfect target zones achieved!

Epoch 22/100
Train Loss: 0.3333, Val Loss: 0.4400
Energy Rankings:
  entailment: 0.5974 ± 0.3568
  neutral: 1.0019 ± 0.5306
  contradiction: 1.8583 ± 0.8951
  ✅ Perfect target zones achieved!

Epoch 23/100
Train Loss: 0.3281, Val Loss: 0.4403
Energy Rankings:
  entailment: 0.6080 ± 0.3668
  neutral: 1.0260 ± 0.5514
  contradiction: 1.9093 ± 0.9266
  ✅ Perfect target zones achieved!
Early stopping at epoch 23
Training progress plots saved to: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_separate_margins_training_20250807_191447.png
Analysis summary saved to: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_separate_margins_analysis_20250807_191447.txt

================================================================================
ORDER EMBEDDING MODEL WITH SEPARATE MARGINS TRAINING COMPLETE!
✅ Separate margin loss: Enhanced neutral class separation
✅ Target energy zones: E<1.0, 1.0≤N≤1.5, C>1.8
✅ Comprehensive analysis and plots generated
Next: Use this model for improved point cloud clustering
================================================================================
Training progress plots saved to: MSc_Topology_Codebase/phd_method/models/separate_models/mnli_order_embedding_separate_margins_training_20250807_191457.png

================================================================================
SEPARATE MARGINS ORDER EMBEDDING TRAINING COMPLETE!
Next: Update point_cloud_clustering_test.py to use new model
================================================================================

Analysis completed with exit code: 0
Time: Thu  7 Aug 19:15:13 BST 2025

=== ANALYSIS SUCCESSFUL ===
Training successful!


Job finished.
