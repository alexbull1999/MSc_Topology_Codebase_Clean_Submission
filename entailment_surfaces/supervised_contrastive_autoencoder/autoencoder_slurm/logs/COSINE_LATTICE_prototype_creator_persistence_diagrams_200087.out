Starting Surface Distance Metric Analysis job...
Job ID: 200087
Node: gpuvm18
Time: Mon  1 Sep 12:22:29 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Mon Sep  1 12:22:32 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   33C    P8             13W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting Persistence Diagram Prototype Creation...

Persim library available for bottleneck distance computation
Creating persistence diagram prototypes...
Initialized prototype creator

Creating prototypes using bottleneck method...
==================================================

--- Creating prototypes for ENTAILMENT ---
  Processing H0...
    Computing bottleneck distance Fréchet mean with 100 diagrams...
      Subsampling to 10 diagrams for efficiency...
      Computing pairwise bottleneck distances...
        Diagram 0: total bottleneck distance = 0.429310
        Diagram 1: total bottleneck distance = 0.694989
        Diagram 2: total bottleneck distance = 0.657307
        Diagram 3: total bottleneck distance = 0.498430
        Diagram 4: total bottleneck distance = 0.402863
        Diagram 5: total bottleneck distance = 0.523169
        Diagram 6: total bottleneck distance = 0.414202
        Diagram 7: total bottleneck distance = 0.481224
        Diagram 8: total bottleneck distance = 0.547319
        Diagram 9: total bottleneck distance = 0.514932
      Selected diagram 4 as Bottleneck Median
      Total bottleneck distance: 0.402863
      Mean bottleneck distance: 0.044763
      Features: 949
      Total persistence: 434.5062
      Max persistence: 0.726750
    H0 prototype: 949 features
    Total persistence: 434.5062
    Max persistence: 0.7267
  Processing H1...
    Computing bottleneck distance Fréchet mean with 100 diagrams...
      Subsampling to 10 diagrams for efficiency...
      Computing pairwise bottleneck distances...
        Diagram 0: total bottleneck distance = 0.319554
        Diagram 1: total bottleneck distance = 0.333349
        Diagram 2: total bottleneck distance = 0.297764
        Diagram 3: total bottleneck distance = 0.352570
        Diagram 4: total bottleneck distance = 0.287797
        Diagram 5: total bottleneck distance = 0.356189
        Diagram 6: total bottleneck distance = 0.359004
        Diagram 7: total bottleneck distance = 0.282994
        Diagram 8: total bottleneck distance = 0.317171
        Diagram 9: total bottleneck distance = 0.283364
      Selected diagram 7 as Bottleneck Median
      Total bottleneck distance: 0.282994
      Mean bottleneck distance: 0.031444
      Features: 1529
      Total persistence: 65.1319
      Max persistence: 0.229627
    H1 prototype: 1529 features
    Total persistence: 65.1319
    Max persistence: 0.2296

--- Creating prototypes for NEUTRAL ---
  Processing H0...
    Computing bottleneck distance Fréchet mean with 100 diagrams...
      Subsampling to 10 diagrams for efficiency...
      Computing pairwise bottleneck distances...
        Diagram 0: total bottleneck distance = 0.682632
        Diagram 1: total bottleneck distance = 0.746421
        Diagram 2: total bottleneck distance = 0.750439
        Diagram 3: total bottleneck distance = 0.655759
        Diagram 4: total bottleneck distance = 0.642177
        Diagram 5: total bottleneck distance = 0.847297
        Diagram 6: total bottleneck distance = 0.876503
        Diagram 7: total bottleneck distance = 0.632310
        Diagram 8: total bottleneck distance = 0.672510
        Diagram 9: total bottleneck distance = 0.887349
      Selected diagram 7 as Bottleneck Median
      Total bottleneck distance: 0.632310
      Mean bottleneck distance: 0.070257
      Features: 949
      Total persistence: 511.9681
      Max persistence: 0.735710
    H0 prototype: 949 features
    Total persistence: 511.9681
    Max persistence: 0.7357
  Processing H1...
    Computing bottleneck distance Fréchet mean with 100 diagrams...
      Subsampling to 10 diagrams for efficiency...
      Computing pairwise bottleneck distances...
        Diagram 0: total bottleneck distance = 0.269052
        Diagram 1: total bottleneck distance = 0.274935
        Diagram 2: total bottleneck distance = 0.306678
        Diagram 3: total bottleneck distance = 0.261310
