Starting Surface Distance Metric Analysis job...
Job ID: 181868
Node: gpuvm15
Time: Sat 12 Jul 12:58:35 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jul 12 12:58:37 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   34C    P8             10W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting AutoEncoder Pipeline...

GLOBAL DATASET CONTRASTIVE AUTOENCODER PIPELINE
============================================================
Start time: 2025-07-12 12:58:54.940970
Using device: cuda

Configuration:
  Embedding type: lattice
  Batch size: 1020
  Global update frequency: 3 epochs
  Training epochs: 20
Experiment setup completed:
  Experiment directory: experiments/global_lattice_test_20250712_125855
  Config saved to: experiments/global_lattice_test_20250712_125855/config.json
Loading data...
========================================
FlexibleEmbedder initialized with type: 'lattice'
Output dimension will be: 768
GlobalDataLoader initialized:
  Embedding type: lattice
  Output dimension: 768
  Sample size: All
Starting data loading pipeline...
============================================================
Loading training data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 training samples
Loading validation data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 validation samples
Loading test data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 test samples
Generating embeddings for training...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
Generating embeddings for validation...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
Generating embeddings for test...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}

Data loading pipeline completed!
Output embedding dimension: 768
Updated model input_dim to: 768
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
DataLoaders created:
  Batch size: 1020
  Balanced sampling: True
  Train batches: 537
  Val batches: 537
  Test batches: 539
Data loading completed!
  Train: 549367 samples, 537 batches
  Val: 549367 samples, 537 batches
  Test: 549367 samples, 539 batches
Creating model and trainer...
========================================
ContrastiveAutoencoder initialized:
  Input dim: 768
  Latent dim: 75
  Hidden dims: [512, 256]
  Dropout rate: 0.2
  Total parameters: 1,089,355
Model created with 1,089,355 parameters
FullDatasetContrastiveLoss initialized:
  Margin: 2.0
  Update frequency: 3 epochs
  Max global samples: 5000
FullDatasetCombinedLoss initialized:
  Contrastive weight: 1.0
  Base reconstruction weight: 0.0
  Scheduled reconstruction: warmup=30 epochs, max_weight=0.3
Optimizer created (lr=0.0001)
GlobalDatasetTrainer initialized on device: cuda
Model parameters: 1,089,355
Starting training...
========================================
Starting Global Dataset Training...
============================================================

🌍 Updating global dataset at epoch 1
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.039 ± 0.004
    Neg distances: 0.039 ± 0.005
    Separation ratio: 1.01x
    Gap: -0.056
    ❌ Poor global separation

Epoch 1 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.062, Neg=0.063, Ratio=1.01x, Gap=-0.125
Batch   0/537: Loss=1.9996 (C:1.9996, R:0.0030)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.062, Neg=0.062, Ratio=1.01x, Gap=-0.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.062, Neg=0.063, Ratio=1.01x, Gap=-0.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.062, Neg=0.063, Ratio=1.01x, Gap=-0.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.063, Neg=0.064, Ratio=1.01x, Gap=-0.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.063, Neg=0.064, Ratio=1.02x, Gap=-0.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.064, Neg=0.065, Ratio=1.01x, Gap=-0.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.065, Neg=0.066, Ratio=1.02x, Gap=-0.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.066, Neg=0.067, Ratio=1.02x, Gap=-0.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.067, Neg=0.068, Ratio=1.02x, Gap=-0.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.068, Neg=0.070, Ratio=1.03x, Gap=-0.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.070, Neg=0.071, Ratio=1.02x, Gap=-0.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.071, Neg=0.073, Ratio=1.03x, Gap=-0.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.072, Neg=0.075, Ratio=1.03x, Gap=-0.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.074, Neg=0.076, Ratio=1.03x, Gap=-0.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.077, Neg=0.079, Ratio=1.03x, Gap=-0.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.078, Neg=0.081, Ratio=1.04x, Gap=-0.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.080, Neg=0.084, Ratio=1.04x, Gap=-0.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.083, Neg=0.086, Ratio=1.04x, Gap=-0.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.085, Neg=0.089, Ratio=1.05x, Gap=-0.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.088, Neg=0.092, Ratio=1.04x, Gap=-0.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.092, Neg=0.097, Ratio=1.05x, Gap=-0.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.094, Neg=0.100, Ratio=1.06x, Gap=-0.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.099, Neg=0.105, Ratio=1.06x, Gap=-0.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.103, Neg=0.109, Ratio=1.06x, Gap=-0.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.107, Neg=0.114, Ratio=1.06x, Gap=-0.433
Batch  25/537: Loss=1.9934 (C:1.9934, R:0.0028)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.113, Neg=0.119, Ratio=1.05x, Gap=-0.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.115, Neg=0.122, Ratio=1.06x, Gap=-0.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.121, Neg=0.128, Ratio=1.06x, Gap=-0.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.135, Ratio=1.07x, Gap=-0.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.132, Neg=0.142, Ratio=1.07x, Gap=-0.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.139, Neg=0.148, Ratio=1.07x, Gap=-0.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.144, Neg=0.153, Ratio=1.07x, Gap=-0.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.150, Neg=0.160, Ratio=1.07x, Gap=-0.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.161, Neg=0.172, Ratio=1.07x, Gap=-0.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.164, Neg=0.175, Ratio=1.07x, Gap=-0.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.176, Neg=0.190, Ratio=1.08x, Gap=-0.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.185, Neg=0.198, Ratio=1.07x, Gap=-0.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.191, Neg=0.207, Ratio=1.08x, Gap=-0.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.201, Neg=0.217, Ratio=1.08x, Gap=-1.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.218, Neg=0.233, Ratio=1.07x, Gap=-1.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.227, Neg=0.244, Ratio=1.07x, Gap=-1.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.233, Neg=0.251, Ratio=1.08x, Gap=-1.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.251, Neg=0.265, Ratio=1.05x, Gap=-1.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.257, Neg=0.279, Ratio=1.08x, Gap=-1.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.266, Neg=0.286, Ratio=1.07x, Gap=-1.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.286, Neg=0.305, Ratio=1.07x, Gap=-1.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.300, Neg=0.323, Ratio=1.08x, Gap=-1.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.314, Neg=0.335, Ratio=1.07x, Gap=-1.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.323, Neg=0.346, Ratio=1.07x, Gap=-1.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.341, Neg=0.366, Ratio=1.07x, Gap=-1.854
Batch  50/537: Loss=1.9751 (C:1.9751, R:0.0026)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.356, Neg=0.387, Ratio=1.09x, Gap=-1.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.378, Neg=0.408, Ratio=1.08x, Gap=-1.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=0.432, Ratio=1.08x, Gap=-2.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=0.466, Ratio=1.08x, Gap=-2.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=0.475, Ratio=1.09x, Gap=-2.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=0.502, Ratio=1.10x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.520, Ratio=1.07x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.545, Ratio=1.08x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.581, Ratio=1.09x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.616, Ratio=1.07x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.620, Ratio=1.06x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.631, Ratio=1.09x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.638, Ratio=1.09x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.653, Ratio=1.09x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.647, Ratio=1.08x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.628, Ratio=1.09x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.615, Ratio=1.09x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.612, Ratio=1.12x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.592, Ratio=1.10x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.573, Ratio=1.11x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.557, Ratio=1.10x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.558, Ratio=1.11x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.540, Ratio=1.10x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.552, Ratio=1.10x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.537, Ratio=1.11x, Gap=-3.148
Batch  75/537: Loss=1.9474 (C:1.9474, R:0.0025)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=0.529, Ratio=1.09x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.545, Ratio=1.11x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.534, Ratio=1.10x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=0.533, Ratio=1.10x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.552, Ratio=1.11x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.556, Ratio=1.12x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.550, Ratio=1.10x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.577, Ratio=1.11x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.582, Ratio=1.12x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.576, Ratio=1.11x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.561, Ratio=1.12x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.571, Ratio=1.14x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.561, Ratio=1.12x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.583, Ratio=1.14x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.572, Ratio=1.10x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.585, Ratio=1.14x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.587, Ratio=1.14x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.592, Ratio=1.12x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.606, Ratio=1.14x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.596, Ratio=1.13x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.589, Ratio=1.13x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.594, Ratio=1.13x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.588, Ratio=1.14x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.599, Ratio=1.13x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.598, Ratio=1.12x, Gap=-3.683
Batch 100/537: Loss=1.9451 (C:1.9451, R:0.0023)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.617, Ratio=1.14x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.611, Ratio=1.15x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.604, Ratio=1.14x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.615, Ratio=1.15x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.604, Ratio=1.13x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.605, Ratio=1.13x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.573, Ratio=1.13x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.590, Ratio=1.12x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.583, Ratio=1.14x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.596, Ratio=1.16x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.583, Ratio=1.15x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.588, Ratio=1.15x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.568, Ratio=1.13x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.580, Ratio=1.16x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.592, Ratio=1.15x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.579, Ratio=1.16x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.578, Ratio=1.15x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.567, Ratio=1.14x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.589, Ratio=1.15x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.589, Ratio=1.16x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.582, Ratio=1.15x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.578, Ratio=1.14x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.578, Ratio=1.14x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.577, Ratio=1.15x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.600, Ratio=1.18x, Gap=-3.328
Batch 125/537: Loss=1.9219 (C:1.9219, R:0.0022)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.578, Ratio=1.15x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.584, Ratio=1.13x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.587, Ratio=1.14x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.604, Ratio=1.16x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.572, Ratio=1.14x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.584, Ratio=1.15x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.599, Ratio=1.15x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.590, Ratio=1.16x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.585, Ratio=1.16x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.600, Ratio=1.16x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.594, Ratio=1.15x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.603, Ratio=1.16x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.574, Ratio=1.14x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.599, Ratio=1.14x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.583, Ratio=1.16x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.592, Ratio=1.14x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.600, Ratio=1.16x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.603, Ratio=1.16x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.581, Ratio=1.15x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.587, Ratio=1.14x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.592, Ratio=1.15x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.584, Ratio=1.15x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.578, Ratio=1.15x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.590, Ratio=1.16x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.585, Ratio=1.16x, Gap=-3.362
Batch 150/537: Loss=1.9315 (C:1.9315, R:0.0021)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.583, Ratio=1.15x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.592, Ratio=1.16x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.572, Ratio=1.12x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.598, Ratio=1.15x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.590, Ratio=1.15x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.596, Ratio=1.15x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.596, Ratio=1.15x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.590, Ratio=1.15x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.607, Ratio=1.15x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.596, Ratio=1.15x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.608, Ratio=1.14x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.602, Ratio=1.16x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.605, Ratio=1.14x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.603, Ratio=1.16x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.604, Ratio=1.16x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.599, Ratio=1.15x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.583, Ratio=1.13x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.595, Ratio=1.15x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.584, Ratio=1.15x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.592, Ratio=1.15x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.594, Ratio=1.16x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.569, Ratio=1.14x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.581, Ratio=1.15x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-3.227
Batch 175/537: Loss=1.9337 (C:1.9337, R:0.0020)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.589, Ratio=1.15x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.589, Ratio=1.16x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.597, Ratio=1.16x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.584, Ratio=1.16x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.597, Ratio=1.16x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.599, Ratio=1.17x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.596, Ratio=1.15x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.601, Ratio=1.14x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.603, Ratio=1.17x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.611, Ratio=1.16x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.614, Ratio=1.18x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.610, Ratio=1.15x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.609, Ratio=1.15x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.592, Ratio=1.15x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.601, Ratio=1.16x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.594, Ratio=1.15x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.570, Ratio=1.13x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.612, Ratio=1.17x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.591, Ratio=1.15x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.592, Ratio=1.14x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.595, Ratio=1.14x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.588, Ratio=1.17x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.589, Ratio=1.16x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.588, Ratio=1.13x, Gap=-3.414
Batch 200/537: Loss=1.9421 (C:1.9421, R:0.0020)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.619, Ratio=1.16x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.587, Ratio=1.17x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.624, Ratio=1.18x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.614, Ratio=1.16x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.609, Ratio=1.17x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.597, Ratio=1.16x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.588, Ratio=1.16x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.598, Ratio=1.16x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.602, Ratio=1.14x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.583, Ratio=1.15x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.615, Ratio=1.16x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.592, Ratio=1.15x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.609, Ratio=1.16x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.610, Ratio=1.16x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.590, Ratio=1.15x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.592, Ratio=1.15x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.603, Ratio=1.15x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.623, Ratio=1.17x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.612, Ratio=1.17x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.591, Ratio=1.14x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.609, Ratio=1.16x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.609, Ratio=1.17x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.593, Ratio=1.14x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.582, Ratio=1.17x, Gap=-3.386
Batch 225/537: Loss=1.9276 (C:1.9276, R:0.0019)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.610, Ratio=1.17x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.601, Ratio=1.15x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.606, Ratio=1.17x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.600, Ratio=1.15x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.607, Ratio=1.13x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.594, Ratio=1.15x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.589, Ratio=1.18x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.593, Ratio=1.15x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.613, Ratio=1.18x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.598, Ratio=1.16x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.18x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.599, Ratio=1.15x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.597, Ratio=1.16x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.604, Ratio=1.17x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.608, Ratio=1.17x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.584, Ratio=1.18x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.599, Ratio=1.14x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.603, Ratio=1.18x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.618, Ratio=1.16x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.613, Ratio=1.16x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.597, Ratio=1.14x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.608, Ratio=1.18x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.603, Ratio=1.14x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-3.242
Batch 250/537: Loss=1.9342 (C:1.9342, R:0.0019)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.581, Ratio=1.15x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.596, Ratio=1.16x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.609, Ratio=1.17x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.585, Ratio=1.16x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.612, Ratio=1.16x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.606, Ratio=1.16x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.598, Ratio=1.15x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.599, Ratio=1.15x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.602, Ratio=1.16x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.613, Ratio=1.17x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.622, Ratio=1.19x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.603, Ratio=1.17x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.590, Ratio=1.15x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.609, Ratio=1.15x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.608, Ratio=1.19x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.601, Ratio=1.15x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.616, Ratio=1.16x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.621, Ratio=1.15x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.609, Ratio=1.16x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.618, Ratio=1.16x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.619, Ratio=1.17x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.614, Ratio=1.16x, Gap=-3.001
Batch 275/537: Loss=1.9275 (C:1.9275, R:0.0019)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.598, Ratio=1.16x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.606, Ratio=1.17x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.595, Ratio=1.15x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.623, Ratio=1.17x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.579, Ratio=1.17x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.595, Ratio=1.14x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.600, Ratio=1.17x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.594, Ratio=1.15x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.602, Ratio=1.15x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.594, Ratio=1.15x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.600, Ratio=1.14x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.599, Ratio=1.18x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.588, Ratio=1.15x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.611, Ratio=1.19x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.593, Ratio=1.16x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.604, Ratio=1.16x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.596, Ratio=1.15x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.612, Ratio=1.16x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.618, Ratio=1.16x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.607, Ratio=1.16x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.618, Ratio=1.17x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.17x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.605, Ratio=1.16x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.627, Ratio=1.20x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.617, Ratio=1.18x, Gap=-2.928
Batch 300/537: Loss=1.9162 (C:1.9162, R:0.0019)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.610, Ratio=1.18x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.628, Ratio=1.18x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.613, Ratio=1.16x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.618, Ratio=1.14x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.618, Ratio=1.15x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.616, Ratio=1.19x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.616, Ratio=1.15x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.604, Ratio=1.18x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.610, Ratio=1.18x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.612, Ratio=1.16x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.610, Ratio=1.18x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.607, Ratio=1.16x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.601, Ratio=1.14x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.603, Ratio=1.18x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.620, Ratio=1.17x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.617, Ratio=1.17x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.618, Ratio=1.17x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.604, Ratio=1.16x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.609, Ratio=1.18x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.607, Ratio=1.14x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.618, Ratio=1.18x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.596, Ratio=1.14x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.616, Ratio=1.16x, Gap=-2.963
Batch 325/537: Loss=1.9246 (C:1.9246, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.609, Ratio=1.19x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.608, Ratio=1.15x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.617, Ratio=1.16x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.601, Ratio=1.16x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.597, Ratio=1.17x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.604, Ratio=1.15x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.615, Ratio=1.19x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.608, Ratio=1.18x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.600, Ratio=1.17x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.615, Ratio=1.17x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.623, Ratio=1.17x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.603, Ratio=1.15x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.592, Ratio=1.15x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.630, Ratio=1.19x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.612, Ratio=1.15x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.612, Ratio=1.17x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.636, Ratio=1.16x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.624, Ratio=1.16x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.618, Ratio=1.16x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.614, Ratio=1.17x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.618, Ratio=1.19x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.613, Ratio=1.19x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.618, Ratio=1.15x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.633, Ratio=1.15x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.606, Ratio=1.17x, Gap=-2.984
Batch 350/537: Loss=1.9233 (C:1.9233, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.620, Ratio=1.15x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.605, Ratio=1.18x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.602, Ratio=1.18x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.610, Ratio=1.17x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.594, Ratio=1.14x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.583, Ratio=1.15x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.618, Ratio=1.17x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.602, Ratio=1.15x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.600, Ratio=1.18x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.602, Ratio=1.17x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.618, Ratio=1.17x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.616, Ratio=1.15x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.612, Ratio=1.16x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.615, Ratio=1.17x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.620, Ratio=1.19x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.613, Ratio=1.16x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.608, Ratio=1.17x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.638, Ratio=1.17x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.610, Ratio=1.13x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.606, Ratio=1.17x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.602, Ratio=1.19x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.620, Ratio=1.18x, Gap=-2.883
Batch 375/537: Loss=1.9127 (C:1.9127, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.603, Ratio=1.19x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.610, Ratio=1.18x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.617, Ratio=1.18x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.601, Ratio=1.16x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.611, Ratio=1.18x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.613, Ratio=1.19x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.615, Ratio=1.16x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.625, Ratio=1.16x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.629, Ratio=1.19x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.619, Ratio=1.21x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.624, Ratio=1.18x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.604, Ratio=1.16x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.600, Ratio=1.17x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.598, Ratio=1.19x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.597, Ratio=1.17x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.615, Ratio=1.15x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.604, Ratio=1.18x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.598, Ratio=1.17x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.626, Ratio=1.16x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.598, Ratio=1.16x, Gap=-2.937
Batch 400/537: Loss=1.9244 (C:1.9244, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.598, Ratio=1.16x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.613, Ratio=1.15x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.626, Ratio=1.16x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.605, Ratio=1.16x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.18x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.606, Ratio=1.19x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.611, Ratio=1.15x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.626, Ratio=1.16x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.614, Ratio=1.15x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.611, Ratio=1.15x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.621, Ratio=1.16x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.612, Ratio=1.18x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.619, Ratio=1.17x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.597, Ratio=1.15x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.608, Ratio=1.15x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.605, Ratio=1.17x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.602, Ratio=1.17x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.611, Ratio=1.19x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.593, Ratio=1.19x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.606, Ratio=1.15x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.605, Ratio=1.19x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.598, Ratio=1.19x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.602, Ratio=1.18x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.619, Ratio=1.18x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.613, Ratio=1.17x, Gap=-2.787
Batch 425/537: Loss=1.9196 (C:1.9196, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.617, Ratio=1.17x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.618, Ratio=1.18x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.602, Ratio=1.15x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.633, Ratio=1.19x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.620, Ratio=1.15x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.626, Ratio=1.15x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.624, Ratio=1.16x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.598, Ratio=1.12x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.615, Ratio=1.17x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.612, Ratio=1.16x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.599, Ratio=1.16x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.600, Ratio=1.15x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.596, Ratio=1.17x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.620, Ratio=1.19x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.612, Ratio=1.17x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.609, Ratio=1.15x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.597, Ratio=1.16x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.611, Ratio=1.18x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.615, Ratio=1.17x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.634, Ratio=1.18x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.613, Ratio=1.18x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.616, Ratio=1.17x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.617, Ratio=1.15x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.604, Ratio=1.16x, Gap=-2.816
Batch 450/537: Loss=1.9255 (C:1.9255, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.603, Ratio=1.17x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.612, Ratio=1.17x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.607, Ratio=1.16x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.614, Ratio=1.17x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.595, Ratio=1.14x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.600, Ratio=1.15x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.602, Ratio=1.19x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.610, Ratio=1.18x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.18x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.612, Ratio=1.15x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.612, Ratio=1.15x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.625, Ratio=1.18x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.17x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.607, Ratio=1.16x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.631, Ratio=1.20x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.614, Ratio=1.14x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.17x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.612, Ratio=1.14x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.616, Ratio=1.15x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.604, Ratio=1.17x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.600, Ratio=1.19x, Gap=-2.828
Batch 475/537: Loss=1.9105 (C:1.9105, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.599, Ratio=1.17x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.601, Ratio=1.17x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.607, Ratio=1.17x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.605, Ratio=1.19x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.597, Ratio=1.19x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.616, Ratio=1.17x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.619, Ratio=1.19x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.622, Ratio=1.17x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.619, Ratio=1.16x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.623, Ratio=1.19x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.17x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.614, Ratio=1.17x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.613, Ratio=1.19x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.618, Ratio=1.17x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.603, Ratio=1.17x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.607, Ratio=1.18x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.598, Ratio=1.15x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.619, Ratio=1.17x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.18x, Gap=-2.723
Batch 500/537: Loss=1.9118 (C:1.9118, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.607, Ratio=1.17x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.603, Ratio=1.16x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.618, Ratio=1.18x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.616, Ratio=1.18x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.605, Ratio=1.20x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.592, Ratio=1.18x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.597, Ratio=1.19x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.604, Ratio=1.17x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.615, Ratio=1.18x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.622, Ratio=1.19x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.634, Ratio=1.19x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.612, Ratio=1.19x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.624, Ratio=1.17x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.632, Ratio=1.18x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.607, Ratio=1.16x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.628, Ratio=1.19x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.612, Ratio=1.20x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.612, Ratio=1.17x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.639, Ratio=1.19x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.626, Ratio=1.19x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.597, Ratio=1.17x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.615, Ratio=1.16x, Gap=-2.560
Batch 525/537: Loss=1.9216 (C:1.9216, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.624, Ratio=1.20x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.615, Ratio=1.19x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.624, Ratio=1.20x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.605, Ratio=1.18x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.621, Ratio=1.17x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.610, Ratio=1.13x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.622, Ratio=1.17x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.624, Ratio=1.17x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.603, Ratio=1.15x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.599, Ratio=1.14x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.604, Ratio=1.20x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.611, Ratio=1.23x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.620, Ratio=1.23x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.600, Ratio=1.19x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.594, Ratio=1.16x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.611, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=0.596, Ratio=1.24x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.609, Ratio=1.18x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.626, Ratio=1.20x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.607, Ratio=1.22x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.609, Ratio=1.19x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.613, Ratio=1.17x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.605, Ratio=1.22x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.611, Ratio=1.20x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.599, Ratio=1.18x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.603, Ratio=1.20x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.604, Ratio=1.20x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.633, Ratio=1.19x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.591, Ratio=1.18x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.601, Ratio=1.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.607, Ratio=1.20x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.606, Ratio=1.19x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.593, Ratio=1.21x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.613, Ratio=1.16x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.598, Ratio=1.17x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.597, Ratio=1.20x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.595, Ratio=1.19x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.608, Ratio=1.17x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.602, Ratio=1.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.598, Ratio=1.18x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.600, Ratio=1.20x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.603, Ratio=1.18x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.597, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.596, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.604, Ratio=1.18x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.598, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.610, Ratio=1.20x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.577, Ratio=1.17x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.604, Ratio=1.19x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.605, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.604, Ratio=1.17x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.600, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.598, Ratio=1.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.606, Ratio=1.24x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.610, Ratio=1.21x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.598, Ratio=1.19x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.609, Ratio=1.18x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.627, Ratio=1.20x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.605, Ratio=1.20x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.611, Ratio=1.21x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.599, Ratio=1.16x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.602, Ratio=1.20x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.581, Ratio=1.15x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.591, Ratio=1.19x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.600, Ratio=1.18x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.621, Ratio=1.22x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.608, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.593, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.616, Ratio=1.20x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.591, Ratio=1.16x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.599, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.609, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.607, Ratio=1.22x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.606, Ratio=1.20x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.599, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.602, Ratio=1.17x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.624, Ratio=1.20x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.601, Ratio=1.20x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.610, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.586, Ratio=1.16x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.590, Ratio=1.17x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.604, Ratio=1.20x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.604, Ratio=1.17x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.587, Ratio=1.17x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.597, Ratio=1.18x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.596, Ratio=1.16x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.601, Ratio=1.20x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.600, Ratio=1.18x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.609, Ratio=1.17x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.603, Ratio=1.18x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.606, Ratio=1.18x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.621, Ratio=1.19x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.616, Ratio=1.18x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.608, Ratio=1.19x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.608, Ratio=1.23x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.598, Ratio=1.19x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.606, Ratio=1.19x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.586, Ratio=1.16x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.596, Ratio=1.18x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.617, Ratio=1.20x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.601, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.590, Ratio=1.16x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.596, Ratio=1.15x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.621, Ratio=1.19x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.591, Ratio=1.17x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.610, Ratio=1.19x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.601, Ratio=1.18x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.594, Ratio=1.20x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.604, Ratio=1.19x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.606, Ratio=1.16x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.605, Ratio=1.20x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.600, Ratio=1.17x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.595, Ratio=1.17x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.592, Ratio=1.16x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.611, Ratio=1.20x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.595, Ratio=1.19x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.619, Ratio=1.21x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.596, Ratio=1.18x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.598, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.604, Ratio=1.19x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.594, Ratio=1.17x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.578, Ratio=1.15x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.623, Ratio=1.22x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.597, Ratio=1.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.615, Ratio=1.19x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.595, Ratio=1.20x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.611, Ratio=1.20x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.605, Ratio=1.19x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.621, Ratio=1.21x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.594, Ratio=1.17x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.607, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.603, Ratio=1.20x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.612, Ratio=1.21x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.607, Ratio=1.21x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.591, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.613, Ratio=1.20x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.605, Ratio=1.20x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.603, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.592, Ratio=1.13x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.605, Ratio=1.22x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.611, Ratio=1.18x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.595, Ratio=1.17x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.610, Ratio=1.18x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.604, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.600, Ratio=1.21x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.597, Ratio=1.20x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.598, Ratio=1.18x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.594, Ratio=1.17x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.619, Ratio=1.22x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.599, Ratio=1.19x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.601, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.600, Ratio=1.17x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.598, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.609, Ratio=1.21x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.607, Ratio=1.21x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.610, Ratio=1.19x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.608, Ratio=1.23x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.598, Ratio=1.18x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.619, Ratio=1.18x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.603, Ratio=1.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.616, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.593, Ratio=1.18x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.584, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.610, Ratio=1.21x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.612, Ratio=1.21x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.613, Ratio=1.21x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.600, Ratio=1.18x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.614, Ratio=1.20x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.595, Ratio=1.19x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.602, Ratio=1.21x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.604, Ratio=1.21x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.608, Ratio=1.21x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.599, Ratio=1.21x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.608, Ratio=1.19x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.601, Ratio=1.16x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.590, Ratio=1.18x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.603, Ratio=1.19x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.618, Ratio=1.20x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.611, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.606, Ratio=1.20x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.601, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.617, Ratio=1.22x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.609, Ratio=1.20x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.613, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.606, Ratio=1.19x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.584, Ratio=1.20x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.605, Ratio=1.20x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.606, Ratio=1.19x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.607, Ratio=1.19x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.606, Ratio=1.18x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.612, Ratio=1.21x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.598, Ratio=1.17x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.591, Ratio=1.16x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.585, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.614, Ratio=1.22x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.606, Ratio=1.17x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.612, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.623, Ratio=1.19x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.587, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.593, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.627, Ratio=1.23x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.609, Ratio=1.18x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.603, Ratio=1.20x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.585, Ratio=1.20x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.594, Ratio=1.18x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.601, Ratio=1.18x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.593, Ratio=1.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.612, Ratio=1.20x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.590, Ratio=1.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.598, Ratio=1.18x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.600, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.613, Ratio=1.18x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.594, Ratio=1.21x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.609, Ratio=1.18x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.609, Ratio=1.20x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.605, Ratio=1.20x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.591, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.592, Ratio=1.16x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.599, Ratio=1.16x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.588, Ratio=1.18x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.609, Ratio=1.21x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.590, Ratio=1.18x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.608, Ratio=1.18x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.601, Ratio=1.20x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.612, Ratio=1.18x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.619, Ratio=1.20x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.596, Ratio=1.20x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.604, Ratio=1.17x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.602, Ratio=1.17x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.604, Ratio=1.21x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.611, Ratio=1.19x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.602, Ratio=1.21x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.618, Ratio=1.20x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.590, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.610, Ratio=1.20x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.605, Ratio=1.20x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.601, Ratio=1.17x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.613, Ratio=1.20x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.601, Ratio=1.18x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.607, Ratio=1.18x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.598, Ratio=1.17x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.618, Ratio=1.22x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.611, Ratio=1.22x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.609, Ratio=1.20x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.620, Ratio=1.21x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.609, Ratio=1.14x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.608, Ratio=1.20x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.603, Ratio=1.19x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.611, Ratio=1.19x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.610, Ratio=1.23x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.586, Ratio=1.15x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.613, Ratio=1.20x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.612, Ratio=1.17x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.602, Ratio=1.18x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.604, Ratio=1.22x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.601, Ratio=1.20x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.595, Ratio=1.19x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.598, Ratio=1.18x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.598, Ratio=1.17x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.607, Ratio=1.17x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.594, Ratio=1.20x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.601, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.599, Ratio=1.16x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.603, Ratio=1.15x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.601, Ratio=1.19x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.614, Ratio=1.20x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.612, Ratio=1.19x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.594, Ratio=1.17x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.589, Ratio=1.18x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.608, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.606, Ratio=1.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.607, Ratio=1.20x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.605, Ratio=1.21x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.606, Ratio=1.19x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.602, Ratio=1.19x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.606, Ratio=1.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.592, Ratio=1.19x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.600, Ratio=1.19x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.600, Ratio=1.20x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.607, Ratio=1.20x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.609, Ratio=1.19x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.588, Ratio=1.19x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.600, Ratio=1.19x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.599, Ratio=1.21x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.592, Ratio=1.19x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.604, Ratio=1.24x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.604, Ratio=1.20x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.594, Ratio=1.17x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.576, Ratio=1.17x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.604, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.599, Ratio=1.18x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.608, Ratio=1.19x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.596, Ratio=1.19x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.607, Ratio=1.19x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.592, Ratio=1.20x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.610, Ratio=1.20x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.604, Ratio=1.20x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.593, Ratio=1.21x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.611, Ratio=1.20x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.589, Ratio=1.17x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.594, Ratio=1.16x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.605, Ratio=1.22x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.598, Ratio=1.20x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.597, Ratio=1.17x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.600, Ratio=1.21x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.609, Ratio=1.19x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.601, Ratio=1.18x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.598, Ratio=1.21x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.596, Ratio=1.20x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.615, Ratio=1.20x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.601, Ratio=1.18x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.580, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.602, Ratio=1.19x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.611, Ratio=1.21x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.600, Ratio=1.19x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.594, Ratio=1.19x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.594, Ratio=1.20x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.602, Ratio=1.17x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.604, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.621, Ratio=1.19x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.600, Ratio=1.15x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.602, Ratio=1.19x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.598, Ratio=1.17x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.617, Ratio=1.22x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.612, Ratio=1.20x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.607, Ratio=1.18x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.605, Ratio=1.18x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.600, Ratio=1.19x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.595, Ratio=1.19x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.617, Ratio=1.24x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.610, Ratio=1.19x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.591, Ratio=1.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.608, Ratio=1.20x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.606, Ratio=1.18x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.612, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.596, Ratio=1.18x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.615, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.603, Ratio=1.18x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.616, Ratio=1.17x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.625, Ratio=1.21x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.590, Ratio=1.19x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.604, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.611, Ratio=1.20x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.600, Ratio=1.19x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.600, Ratio=1.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.619, Ratio=1.20x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.608, Ratio=1.21x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.600, Ratio=1.17x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.613, Ratio=1.20x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.594, Ratio=1.20x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.617, Ratio=1.21x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.585, Ratio=1.15x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.602, Ratio=1.20x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.604, Ratio=1.20x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.605, Ratio=1.18x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.596, Ratio=1.20x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.608, Ratio=1.21x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.605, Ratio=1.19x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.605, Ratio=1.23x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.598, Ratio=1.17x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.618, Ratio=1.18x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.595, Ratio=1.18x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.601, Ratio=1.18x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.608, Ratio=1.23x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.603, Ratio=1.20x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.615, Ratio=1.19x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.610, Ratio=1.20x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.609, Ratio=1.17x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.594, Ratio=1.19x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.597, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.611, Ratio=1.22x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.602, Ratio=1.20x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.604, Ratio=1.20x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.595, Ratio=1.19x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.594, Ratio=1.20x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.615, Ratio=1.22x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.600, Ratio=1.19x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.612, Ratio=1.25x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.603, Ratio=1.17x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.615, Ratio=1.21x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.618, Ratio=1.22x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.598, Ratio=1.16x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.598, Ratio=1.21x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.596, Ratio=1.19x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.617, Ratio=1.23x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.595, Ratio=1.20x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.589, Ratio=1.20x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.610, Ratio=1.21x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.605, Ratio=1.19x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.599, Ratio=1.17x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.588, Ratio=1.19x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.597, Ratio=1.17x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.586, Ratio=1.21x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.587, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.590, Ratio=1.19x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.602, Ratio=1.20x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.610, Ratio=1.19x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.607, Ratio=1.16x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.608, Ratio=1.21x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.573, Ratio=1.16x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.591, Ratio=1.19x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.582, Ratio=1.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.594, Ratio=1.18x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.601, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.596, Ratio=1.17x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.599, Ratio=1.20x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.623, Ratio=1.20x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.604, Ratio=1.21x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.612, Ratio=1.21x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.599, Ratio=1.18x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.609, Ratio=1.20x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.604, Ratio=1.20x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.594, Ratio=1.20x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.599, Ratio=1.20x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.613, Ratio=1.17x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.606, Ratio=1.16x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.610, Ratio=1.21x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.598, Ratio=1.17x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.595, Ratio=1.18x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.599, Ratio=1.19x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.607, Ratio=1.19x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.601, Ratio=1.18x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.596, Ratio=1.19x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.600, Ratio=1.16x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.590, Ratio=1.20x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.614, Ratio=1.22x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.612, Ratio=1.19x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.610, Ratio=1.24x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.587, Ratio=1.18x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.614, Ratio=1.17x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.600, Ratio=1.16x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.602, Ratio=1.21x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.604, Ratio=1.20x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.606, Ratio=1.20x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.597, Ratio=1.20x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.596, Ratio=1.18x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.597, Ratio=1.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.591, Ratio=1.16x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.600, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.599, Ratio=1.16x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.601, Ratio=1.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.605, Ratio=1.20x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.598, Ratio=1.19x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.592, Ratio=1.17x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.596, Ratio=1.19x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.617, Ratio=1.23x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.597, Ratio=1.17x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.620, Ratio=1.21x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.605, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.603, Ratio=1.19x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.599, Ratio=1.18x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.609, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.598, Ratio=1.16x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.598, Ratio=1.18x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.593, Ratio=1.21x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.606, Ratio=1.19x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.608, Ratio=1.24x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.584, Ratio=1.16x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.599, Ratio=1.18x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.611, Ratio=1.22x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.598, Ratio=1.17x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.612, Ratio=1.20x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.614, Ratio=1.22x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.613, Ratio=1.23x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.598, Ratio=1.20x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.594, Ratio=1.16x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.593, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.619, Ratio=1.20x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.608, Ratio=1.21x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.603, Ratio=1.21x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.598, Ratio=1.17x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.622, Ratio=1.23x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.612, Ratio=1.19x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.607, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.596, Ratio=1.17x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.604, Ratio=1.20x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.616, Ratio=1.20x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.613, Ratio=1.22x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.603, Ratio=1.19x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.608, Ratio=1.19x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.603, Ratio=1.19x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.588, Ratio=1.18x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.614, Ratio=1.16x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.607, Ratio=1.20x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.597, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.598, Ratio=1.21x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.605, Ratio=1.19x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.604, Ratio=1.20x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.616, Ratio=1.19x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.607, Ratio=1.21x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.604, Ratio=1.17x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.602, Ratio=1.17x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.579, Ratio=1.18x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.615, Ratio=1.19x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.612, Ratio=1.22x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.608, Ratio=1.18x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.588, Ratio=1.19x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.610, Ratio=1.18x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.607, Ratio=1.20x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.600, Ratio=1.19x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.602, Ratio=1.16x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.594, Ratio=1.19x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.610, Ratio=1.22x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.609, Ratio=1.19x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.610, Ratio=1.17x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.595, Ratio=1.18x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.600, Ratio=1.22x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.616, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.596, Ratio=1.19x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.596, Ratio=1.19x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.595, Ratio=1.18x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.608, Ratio=1.24x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.599, Ratio=1.20x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.599, Ratio=1.19x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.594, Ratio=1.19x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.18x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.594, Ratio=1.15x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.595, Ratio=1.18x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.593, Ratio=1.19x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.632, Ratio=1.21x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.610, Ratio=1.20x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.603, Ratio=1.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.610, Ratio=1.19x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.600, Ratio=1.19x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.608, Ratio=1.20x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.602, Ratio=1.19x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.599, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.622, Ratio=1.21x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.597, Ratio=1.17x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.599, Ratio=1.19x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.610, Ratio=1.20x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.617, Ratio=1.23x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.612, Ratio=1.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.597, Ratio=1.19x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.601, Ratio=1.20x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.623, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.604, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.601, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.599, Ratio=1.21x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.614, Ratio=1.20x, Gap=-2.377

============================================================
Epoch 1/20 completed in 36.5s
Train: Loss=1.9332 (C:1.9332, R:0.0020) Ratio=1.61x
Val:   Loss=1.9088 (C:1.9088, R:0.0018) Ratio=1.89x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.9088)
============================================================

Epoch 2 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.598, Ratio=1.16x, Gap=-2.603
Batch   0/537: Loss=1.9225 (C:1.9225, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.599, Ratio=1.19x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.606, Ratio=1.17x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=0.587, Ratio=1.23x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.590, Ratio=1.16x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.616, Ratio=1.19x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.625, Ratio=1.18x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.634, Ratio=1.17x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.615, Ratio=1.17x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.637, Ratio=1.21x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.623, Ratio=1.16x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.639, Ratio=1.17x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.633, Ratio=1.19x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.629, Ratio=1.18x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.623, Ratio=1.19x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.602, Ratio=1.17x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.604, Ratio=1.17x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.601, Ratio=1.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.608, Ratio=1.18x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.615, Ratio=1.15x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.608, Ratio=1.17x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.613, Ratio=1.20x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.616, Ratio=1.17x, Gap=-2.766
Batch  25/537: Loss=1.9201 (C:1.9201, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.627, Ratio=1.18x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.619, Ratio=1.15x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.602, Ratio=1.14x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.607, Ratio=1.19x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.626, Ratio=1.22x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.602, Ratio=1.18x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.607, Ratio=1.17x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.634, Ratio=1.19x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.615, Ratio=1.13x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.622, Ratio=1.18x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.645, Ratio=1.21x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.633, Ratio=1.15x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.618, Ratio=1.16x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.632, Ratio=1.18x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.624, Ratio=1.21x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.583, Ratio=1.16x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.613, Ratio=1.18x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.622, Ratio=1.19x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.600, Ratio=1.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.17x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.625, Ratio=1.17x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.614, Ratio=1.16x, Gap=-2.701
Batch  50/537: Loss=1.9239 (C:1.9239, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.622, Ratio=1.20x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.614, Ratio=1.19x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.613, Ratio=1.15x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.624, Ratio=1.18x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.625, Ratio=1.19x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.643, Ratio=1.18x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.616, Ratio=1.14x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.596, Ratio=1.17x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.611, Ratio=1.13x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.597, Ratio=1.16x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.610, Ratio=1.17x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.606, Ratio=1.15x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.598, Ratio=1.20x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.600, Ratio=1.15x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.597, Ratio=1.20x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.610, Ratio=1.21x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.623, Ratio=1.19x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.606, Ratio=1.17x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.631, Ratio=1.22x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.614, Ratio=1.20x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.616, Ratio=1.19x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.617, Ratio=1.18x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.632, Ratio=1.22x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.621, Ratio=1.18x, Gap=-2.625
Batch  75/537: Loss=1.9098 (C:1.9098, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.636, Ratio=1.17x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.617, Ratio=1.18x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.635, Ratio=1.19x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.627, Ratio=1.15x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.610, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.18x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.598, Ratio=1.16x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.597, Ratio=1.15x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.620, Ratio=1.18x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.617, Ratio=1.21x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.608, Ratio=1.17x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.609, Ratio=1.18x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.629, Ratio=1.20x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.610, Ratio=1.18x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.617, Ratio=1.17x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.615, Ratio=1.15x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.625, Ratio=1.18x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.628, Ratio=1.19x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.604, Ratio=1.19x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.18x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.638, Ratio=1.19x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.623, Ratio=1.21x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.613, Ratio=1.19x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.593, Ratio=1.19x, Gap=-2.698
Batch 100/537: Loss=1.9093 (C:1.9093, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.625, Ratio=1.17x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.18x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.635, Ratio=1.19x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.625, Ratio=1.19x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.619, Ratio=1.15x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.609, Ratio=1.16x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.610, Ratio=1.18x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.598, Ratio=1.16x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.616, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.597, Ratio=1.15x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.593, Ratio=1.15x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.605, Ratio=1.17x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.606, Ratio=1.17x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.635, Ratio=1.19x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.603, Ratio=1.17x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.616, Ratio=1.19x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.619, Ratio=1.17x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.597, Ratio=1.15x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.611, Ratio=1.18x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.626, Ratio=1.15x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.645, Ratio=1.17x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.634, Ratio=1.18x, Gap=-2.600
Batch 125/537: Loss=1.9091 (C:1.9091, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.619, Ratio=1.19x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.612, Ratio=1.18x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.619, Ratio=1.19x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.586, Ratio=1.16x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.601, Ratio=1.18x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.608, Ratio=1.16x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.601, Ratio=1.19x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.605, Ratio=1.19x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.599, Ratio=1.17x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.629, Ratio=1.18x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.606, Ratio=1.20x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.621, Ratio=1.17x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.622, Ratio=1.20x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.612, Ratio=1.14x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.605, Ratio=1.16x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.600, Ratio=1.16x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.592, Ratio=1.14x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.614, Ratio=1.21x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.611, Ratio=1.17x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.619, Ratio=1.17x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.603, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.613, Ratio=1.19x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.621, Ratio=1.21x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.614, Ratio=1.19x, Gap=-2.619
Batch 150/537: Loss=1.9058 (C:1.9058, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.615, Ratio=1.19x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.630, Ratio=1.17x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.641, Ratio=1.19x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.627, Ratio=1.16x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.621, Ratio=1.21x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.633, Ratio=1.21x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.606, Ratio=1.15x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.620, Ratio=1.16x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.601, Ratio=1.17x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.603, Ratio=1.19x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.595, Ratio=1.21x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.620, Ratio=1.19x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.597, Ratio=1.19x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.603, Ratio=1.16x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.588, Ratio=1.14x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.613, Ratio=1.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.613, Ratio=1.17x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.610, Ratio=1.17x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.598, Ratio=1.18x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.634, Ratio=1.18x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.641, Ratio=1.16x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.635, Ratio=1.16x, Gap=-2.736
Batch 175/537: Loss=1.9205 (C:1.9205, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.616, Ratio=1.16x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.633, Ratio=1.17x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.628, Ratio=1.17x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.635, Ratio=1.17x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.639, Ratio=1.20x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.627, Ratio=1.20x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.17x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.608, Ratio=1.17x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.621, Ratio=1.17x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.624, Ratio=1.16x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.615, Ratio=1.17x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.633, Ratio=1.17x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.615, Ratio=1.18x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.619, Ratio=1.20x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.637, Ratio=1.20x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.638, Ratio=1.19x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.626, Ratio=1.19x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.633, Ratio=1.22x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.628, Ratio=1.22x, Gap=-2.660
Batch 200/537: Loss=1.8917 (C:1.8917, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.636, Ratio=1.19x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.628, Ratio=1.14x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.612, Ratio=1.19x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.608, Ratio=1.17x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.629, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.610, Ratio=1.17x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.606, Ratio=1.19x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.618, Ratio=1.18x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.589, Ratio=1.14x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.623, Ratio=1.19x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.613, Ratio=1.18x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.621, Ratio=1.16x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.615, Ratio=1.20x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.634, Ratio=1.19x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.615, Ratio=1.18x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.641, Ratio=1.18x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.625, Ratio=1.18x, Gap=-2.761
Batch 225/537: Loss=1.9130 (C:1.9130, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.642, Ratio=1.16x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.635, Ratio=1.14x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.627, Ratio=1.17x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.624, Ratio=1.18x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.624, Ratio=1.15x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.605, Ratio=1.15x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.610, Ratio=1.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.18x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.613, Ratio=1.17x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.622, Ratio=1.18x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.617, Ratio=1.18x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.638, Ratio=1.20x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.636, Ratio=1.16x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.622, Ratio=1.19x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.17x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.618, Ratio=1.19x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.627, Ratio=1.20x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.606, Ratio=1.16x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.620, Ratio=1.19x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.634, Ratio=1.18x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.620, Ratio=1.17x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.632, Ratio=1.18x, Gap=-2.556
Batch 250/537: Loss=1.9085 (C:1.9085, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.620, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.621, Ratio=1.20x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.626, Ratio=1.21x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.613, Ratio=1.18x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.635, Ratio=1.20x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.621, Ratio=1.17x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.619, Ratio=1.17x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.616, Ratio=1.18x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.603, Ratio=1.18x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.594, Ratio=1.19x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.617, Ratio=1.21x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.614, Ratio=1.22x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.618, Ratio=1.18x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.629, Ratio=1.20x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.627, Ratio=1.20x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.641, Ratio=1.23x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.625, Ratio=1.21x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.640, Ratio=1.20x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.657, Ratio=1.21x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.623, Ratio=1.16x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.625, Ratio=1.19x, Gap=-2.507
Batch 275/537: Loss=1.9072 (C:1.9072, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.615, Ratio=1.17x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.604, Ratio=1.15x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.605, Ratio=1.17x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.604, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.607, Ratio=1.17x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.611, Ratio=1.20x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.609, Ratio=1.16x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.635, Ratio=1.19x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.619, Ratio=1.20x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.617, Ratio=1.17x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.632, Ratio=1.21x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.625, Ratio=1.20x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.615, Ratio=1.19x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.628, Ratio=1.17x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.614, Ratio=1.19x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.612, Ratio=1.18x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.608, Ratio=1.19x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.19x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.602, Ratio=1.20x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.622, Ratio=1.20x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.624, Ratio=1.20x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.517
Batch 300/537: Loss=1.9089 (C:1.9089, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.629, Ratio=1.20x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.633, Ratio=1.15x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.638, Ratio=1.15x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.626, Ratio=1.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.630, Ratio=1.20x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.610, Ratio=1.16x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.613, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.597, Ratio=1.15x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.610, Ratio=1.21x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.616, Ratio=1.18x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.619, Ratio=1.21x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.627, Ratio=1.19x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.617, Ratio=1.19x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.619, Ratio=1.17x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.630, Ratio=1.19x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.632, Ratio=1.16x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.627, Ratio=1.21x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.615, Ratio=1.18x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.603, Ratio=1.16x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.617, Ratio=1.21x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.643, Ratio=1.19x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.620, Ratio=1.19x, Gap=-2.518
Batch 325/537: Loss=1.9062 (C:1.9062, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.611, Ratio=1.17x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.16x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.624, Ratio=1.15x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.630, Ratio=1.18x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.603, Ratio=1.19x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.625, Ratio=1.18x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.623, Ratio=1.19x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.607, Ratio=1.19x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.618, Ratio=1.19x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.624, Ratio=1.19x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.627, Ratio=1.16x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.616, Ratio=1.22x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.604, Ratio=1.21x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.622, Ratio=1.20x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.637, Ratio=1.20x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.598, Ratio=1.20x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.599, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.624, Ratio=1.17x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.619, Ratio=1.22x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.622, Ratio=1.16x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.609, Ratio=1.15x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.604, Ratio=1.16x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.695
Batch 350/537: Loss=1.9064 (C:1.9064, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.613, Ratio=1.21x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.608, Ratio=1.18x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.617, Ratio=1.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.609, Ratio=1.17x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.18x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.609, Ratio=1.20x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.617, Ratio=1.18x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.605, Ratio=1.18x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.608, Ratio=1.18x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.614, Ratio=1.18x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.616, Ratio=1.19x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.612, Ratio=1.19x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.610, Ratio=1.21x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.615, Ratio=1.14x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.620, Ratio=1.20x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.623, Ratio=1.16x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.627, Ratio=1.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.624, Ratio=1.16x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.620, Ratio=1.16x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.618, Ratio=1.15x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.604, Ratio=1.15x, Gap=-2.590
Batch 375/537: Loss=1.9276 (C:1.9276, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.614, Ratio=1.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.620, Ratio=1.22x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.612, Ratio=1.17x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.629, Ratio=1.20x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.624, Ratio=1.19x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.625, Ratio=1.18x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.645, Ratio=1.18x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.631, Ratio=1.19x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.632, Ratio=1.21x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.625, Ratio=1.23x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.607, Ratio=1.16x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.604, Ratio=1.17x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.621, Ratio=1.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.23x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.609, Ratio=1.16x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.611, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.600, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.605, Ratio=1.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.623, Ratio=1.20x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.623, Ratio=1.14x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.614, Ratio=1.19x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.600, Ratio=1.18x, Gap=-2.536
Batch 400/537: Loss=1.9147 (C:1.9147, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.617, Ratio=1.17x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.632, Ratio=1.17x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.642, Ratio=1.19x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.622, Ratio=1.18x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.619, Ratio=1.18x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.615, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.628, Ratio=1.22x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.642, Ratio=1.21x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.635, Ratio=1.19x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.611, Ratio=1.18x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.621, Ratio=1.17x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.625, Ratio=1.21x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.609, Ratio=1.17x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.617, Ratio=1.21x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.630, Ratio=1.20x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.630, Ratio=1.17x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.622, Ratio=1.19x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.617, Ratio=1.19x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.622, Ratio=1.19x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.611, Ratio=1.16x, Gap=-2.534
Batch 425/537: Loss=1.9219 (C:1.9219, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.629, Ratio=1.19x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.608, Ratio=1.19x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.637, Ratio=1.20x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.617, Ratio=1.21x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.622, Ratio=1.17x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.18x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.612, Ratio=1.21x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.621, Ratio=1.16x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.615, Ratio=1.17x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.619, Ratio=1.22x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.617, Ratio=1.19x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.606, Ratio=1.14x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.607, Ratio=1.15x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.616, Ratio=1.17x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.612, Ratio=1.16x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.597, Ratio=1.20x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.630, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.616, Ratio=1.22x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.624, Ratio=1.19x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.618, Ratio=1.19x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.623, Ratio=1.20x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.613, Ratio=1.18x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.614, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.617, Ratio=1.20x, Gap=-2.562
Batch 450/537: Loss=1.9049 (C:1.9049, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.641, Ratio=1.24x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.639, Ratio=1.22x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.624, Ratio=1.19x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.632, Ratio=1.21x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.621, Ratio=1.20x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.613, Ratio=1.20x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.618, Ratio=1.21x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.618, Ratio=1.18x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.623, Ratio=1.24x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.625, Ratio=1.22x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.615, Ratio=1.14x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.604, Ratio=1.19x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.581, Ratio=1.18x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.594, Ratio=1.18x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.598, Ratio=1.14x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.621, Ratio=1.21x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.620, Ratio=1.18x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.643, Ratio=1.23x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.616, Ratio=1.17x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.608, Ratio=1.21x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.19x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.648, Ratio=1.20x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.623, Ratio=1.20x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.501
Batch 475/537: Loss=1.9045 (C:1.9045, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.634, Ratio=1.16x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.642, Ratio=1.20x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.622, Ratio=1.16x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.624, Ratio=1.21x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.623, Ratio=1.20x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.631, Ratio=1.19x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.583, Ratio=1.15x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.628, Ratio=1.21x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.610, Ratio=1.15x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.612, Ratio=1.17x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.628, Ratio=1.20x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.602, Ratio=1.17x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.606, Ratio=1.17x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.602, Ratio=1.18x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.604, Ratio=1.18x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.603, Ratio=1.18x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.623, Ratio=1.19x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.598, Ratio=1.16x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.617, Ratio=1.19x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.623, Ratio=1.15x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.623, Ratio=1.16x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.624, Ratio=1.20x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.631, Ratio=1.21x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.616, Ratio=1.14x, Gap=-2.594
Batch 500/537: Loss=1.9301 (C:1.9301, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.640, Ratio=1.18x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.634, Ratio=1.17x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.631, Ratio=1.17x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.605, Ratio=1.19x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.607, Ratio=1.16x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.624, Ratio=1.20x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.614, Ratio=1.20x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.629, Ratio=1.19x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.600, Ratio=1.18x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.636, Ratio=1.19x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.595, Ratio=1.18x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.624, Ratio=1.22x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.618, Ratio=1.16x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.625, Ratio=1.18x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.604, Ratio=1.19x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.615, Ratio=1.18x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.616, Ratio=1.22x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.600, Ratio=1.23x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.609, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.610, Ratio=1.17x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.608, Ratio=1.18x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.622, Ratio=1.21x, Gap=-2.495
Batch 525/537: Loss=1.8972 (C:1.8972, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.619, Ratio=1.17x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.621, Ratio=1.19x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.606, Ratio=1.21x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.616, Ratio=1.21x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.22x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.630, Ratio=1.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.634, Ratio=1.18x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.625, Ratio=1.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.17x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.620, Ratio=1.18x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.622, Ratio=1.20x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.624, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.612, Ratio=1.18x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.630, Ratio=1.22x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.643, Ratio=1.19x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.631, Ratio=1.19x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.17x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.641, Ratio=1.18x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.613, Ratio=1.17x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.614, Ratio=1.18x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.620, Ratio=1.17x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.636, Ratio=1.24x, Gap=-2.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.18x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.633, Ratio=1.22x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.640, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.618, Ratio=1.15x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.638, Ratio=1.24x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.620, Ratio=1.19x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.631, Ratio=1.20x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.628, Ratio=1.20x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.633, Ratio=1.17x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.626, Ratio=1.18x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.612, Ratio=1.20x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.620, Ratio=1.16x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.633, Ratio=1.21x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.619, Ratio=1.19x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.618, Ratio=1.22x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.623, Ratio=1.19x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.627, Ratio=1.20x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.624, Ratio=1.20x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.626, Ratio=1.19x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.614, Ratio=1.17x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.621, Ratio=1.20x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.616, Ratio=1.20x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.604, Ratio=1.22x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.624, Ratio=1.22x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.18x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.638, Ratio=1.21x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.617, Ratio=1.19x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.628, Ratio=1.21x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.625, Ratio=1.21x, Gap=-2.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.627, Ratio=1.22x, Gap=-2.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.633, Ratio=1.23x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.629, Ratio=1.16x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.619, Ratio=1.18x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.620, Ratio=1.22x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.634, Ratio=1.23x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.636, Ratio=1.21x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.619, Ratio=1.18x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.622, Ratio=1.19x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.619, Ratio=1.20x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.619, Ratio=1.18x, Gap=-2.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.637, Ratio=1.20x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.625, Ratio=1.21x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.633, Ratio=1.21x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.630, Ratio=1.19x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.625, Ratio=1.18x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.626, Ratio=1.22x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.639, Ratio=1.22x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.620, Ratio=1.16x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.627, Ratio=1.19x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.624, Ratio=1.19x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.629, Ratio=1.21x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.620, Ratio=1.19x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.629, Ratio=1.22x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.612, Ratio=1.20x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.610, Ratio=1.17x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.624, Ratio=1.20x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.629, Ratio=1.19x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.630, Ratio=1.22x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.637, Ratio=1.18x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.622, Ratio=1.18x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.619, Ratio=1.19x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.624, Ratio=1.20x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.641, Ratio=1.22x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.627, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.604, Ratio=1.18x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.620, Ratio=1.18x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.629, Ratio=1.19x, Gap=-2.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.629, Ratio=1.20x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.628, Ratio=1.18x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.617, Ratio=1.18x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.637, Ratio=1.19x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.633, Ratio=1.20x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.638, Ratio=1.20x, Gap=-2.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.613, Ratio=1.18x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.615, Ratio=1.16x, Gap=-2.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.621, Ratio=1.18x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.644, Ratio=1.21x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.623, Ratio=1.14x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.644, Ratio=1.20x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.621, Ratio=1.19x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.639, Ratio=1.19x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.631, Ratio=1.19x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.613, Ratio=1.18x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.633, Ratio=1.20x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.622, Ratio=1.20x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.630, Ratio=1.20x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.643, Ratio=1.21x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.640, Ratio=1.23x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.617, Ratio=1.19x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.608, Ratio=1.16x, Gap=-2.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.615, Ratio=1.17x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.630, Ratio=1.19x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.628, Ratio=1.21x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.627, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.19x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.624, Ratio=1.16x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.617, Ratio=1.20x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.616, Ratio=1.17x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.618, Ratio=1.15x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.636, Ratio=1.17x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.644, Ratio=1.19x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.636, Ratio=1.19x, Gap=-2.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.622, Ratio=1.17x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.635, Ratio=1.20x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.607, Ratio=1.18x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.608, Ratio=1.16x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.637, Ratio=1.23x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.607, Ratio=1.18x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.641, Ratio=1.25x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.632, Ratio=1.22x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.611, Ratio=1.15x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.612, Ratio=1.21x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.625, Ratio=1.18x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.634, Ratio=1.20x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.634, Ratio=1.17x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.620, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.614, Ratio=1.19x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.624, Ratio=1.17x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.626, Ratio=1.22x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.625, Ratio=1.18x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.613, Ratio=1.18x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.620, Ratio=1.18x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.630, Ratio=1.24x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.613, Ratio=1.21x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.622, Ratio=1.20x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.649, Ratio=1.24x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.641, Ratio=1.19x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.615, Ratio=1.18x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.632, Ratio=1.19x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.636, Ratio=1.24x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.602, Ratio=1.20x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.593, Ratio=1.16x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.626, Ratio=1.17x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.607, Ratio=1.16x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.635, Ratio=1.21x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.619, Ratio=1.18x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.633, Ratio=1.16x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.623, Ratio=1.18x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.618, Ratio=1.15x, Gap=-2.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.625, Ratio=1.16x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.604, Ratio=1.15x, Gap=-2.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.625, Ratio=1.17x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.622, Ratio=1.22x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.626, Ratio=1.21x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.620, Ratio=1.15x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.614, Ratio=1.18x, Gap=-2.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.624, Ratio=1.18x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.616, Ratio=1.18x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.633, Ratio=1.23x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.625, Ratio=1.19x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.600, Ratio=1.17x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.632, Ratio=1.21x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.628, Ratio=1.21x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.634, Ratio=1.20x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.645, Ratio=1.19x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.605, Ratio=1.18x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.619, Ratio=1.20x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.640, Ratio=1.21x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.634, Ratio=1.21x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.628, Ratio=1.19x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.647, Ratio=1.21x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.631, Ratio=1.19x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.604, Ratio=1.18x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.634, Ratio=1.26x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.623, Ratio=1.16x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.613, Ratio=1.20x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.616, Ratio=1.16x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.616, Ratio=1.18x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.644, Ratio=1.18x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.623, Ratio=1.18x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.644, Ratio=1.22x, Gap=-2.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.630, Ratio=1.21x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.621, Ratio=1.18x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.640, Ratio=1.18x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.623, Ratio=1.18x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.643, Ratio=1.20x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.630, Ratio=1.19x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.626, Ratio=1.21x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.632, Ratio=1.17x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.609, Ratio=1.19x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.653, Ratio=1.23x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.618, Ratio=1.18x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.628, Ratio=1.21x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.630, Ratio=1.20x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.616, Ratio=1.19x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.619, Ratio=1.15x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.620, Ratio=1.20x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.635, Ratio=1.18x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.639, Ratio=1.20x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.628, Ratio=1.17x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.626, Ratio=1.17x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.621, Ratio=1.14x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.623, Ratio=1.20x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.630, Ratio=1.23x, Gap=-2.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.620, Ratio=1.20x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.619, Ratio=1.19x, Gap=-2.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.606, Ratio=1.19x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.617, Ratio=1.21x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.609, Ratio=1.14x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.626, Ratio=1.17x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.625, Ratio=1.19x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.612, Ratio=1.19x, Gap=-2.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.610, Ratio=1.18x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.644, Ratio=1.20x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.630, Ratio=1.22x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.645, Ratio=1.23x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.633, Ratio=1.23x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.644, Ratio=1.20x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.628, Ratio=1.21x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.619, Ratio=1.17x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.621, Ratio=1.16x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.618, Ratio=1.18x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.622, Ratio=1.18x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.627, Ratio=1.22x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.615, Ratio=1.18x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.622, Ratio=1.22x, Gap=-2.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.621, Ratio=1.18x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.611, Ratio=1.18x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.629, Ratio=1.17x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.616, Ratio=1.16x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.605, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.642, Ratio=1.22x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.620, Ratio=1.17x, Gap=-2.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.635, Ratio=1.20x, Gap=-2.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.636, Ratio=1.22x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.610, Ratio=1.18x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.615, Ratio=1.16x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.642, Ratio=1.21x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.617, Ratio=1.18x, Gap=-2.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.606, Ratio=1.19x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.623, Ratio=1.20x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.627, Ratio=1.21x, Gap=-2.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.622, Ratio=1.22x, Gap=-2.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.619, Ratio=1.18x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.609, Ratio=1.18x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.646, Ratio=1.22x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.618, Ratio=1.21x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.629, Ratio=1.22x, Gap=-2.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.623, Ratio=1.20x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.634, Ratio=1.19x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.622, Ratio=1.21x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.627, Ratio=1.17x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.619, Ratio=1.19x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.617, Ratio=1.18x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.618, Ratio=1.20x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.624, Ratio=1.22x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.619, Ratio=1.15x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.621, Ratio=1.19x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.617, Ratio=1.17x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.637, Ratio=1.19x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.619, Ratio=1.19x, Gap=-2.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.641, Ratio=1.21x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.618, Ratio=1.16x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.610, Ratio=1.18x, Gap=-2.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.641, Ratio=1.18x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.607, Ratio=1.23x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.625, Ratio=1.19x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.640, Ratio=1.24x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.628, Ratio=1.19x, Gap=-2.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.629, Ratio=1.22x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.605, Ratio=1.14x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.634, Ratio=1.22x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.654, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.627, Ratio=1.15x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.607, Ratio=1.16x, Gap=-2.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.627, Ratio=1.17x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.619, Ratio=1.17x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.616, Ratio=1.19x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.620, Ratio=1.19x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.623, Ratio=1.19x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.622, Ratio=1.23x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.642, Ratio=1.22x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.624, Ratio=1.19x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.627, Ratio=1.19x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.625, Ratio=1.17x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.629, Ratio=1.20x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.645, Ratio=1.17x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.643, Ratio=1.20x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.622, Ratio=1.19x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.626, Ratio=1.19x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.627, Ratio=1.19x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.637, Ratio=1.21x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.624, Ratio=1.16x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.593, Ratio=1.17x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.631, Ratio=1.19x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.645, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.624, Ratio=1.18x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.616, Ratio=1.20x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.613, Ratio=1.18x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.629, Ratio=1.19x, Gap=-2.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.624, Ratio=1.19x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.631, Ratio=1.21x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.623, Ratio=1.18x, Gap=-2.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.625, Ratio=1.21x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.625, Ratio=1.19x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.626, Ratio=1.21x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.601, Ratio=1.17x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.631, Ratio=1.21x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.636, Ratio=1.21x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.632, Ratio=1.18x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.626, Ratio=1.17x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.633, Ratio=1.20x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.630, Ratio=1.19x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.622, Ratio=1.16x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.631, Ratio=1.20x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.619, Ratio=1.21x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.632, Ratio=1.22x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.642, Ratio=1.22x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.614, Ratio=1.16x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.18x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.622, Ratio=1.21x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.629, Ratio=1.18x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.627, Ratio=1.19x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.635, Ratio=1.21x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.622, Ratio=1.18x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.651, Ratio=1.22x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.629, Ratio=1.20x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.615, Ratio=1.20x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.621, Ratio=1.20x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.622, Ratio=1.17x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.618, Ratio=1.17x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.628, Ratio=1.18x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.611, Ratio=1.15x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.19x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.619, Ratio=1.15x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.602, Ratio=1.20x, Gap=-2.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.620, Ratio=1.22x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.640, Ratio=1.25x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.609, Ratio=1.19x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.647, Ratio=1.20x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.618, Ratio=1.22x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.613, Ratio=1.16x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.635, Ratio=1.21x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.641, Ratio=1.20x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.610, Ratio=1.18x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.624, Ratio=1.20x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.623, Ratio=1.20x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.629, Ratio=1.20x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.626, Ratio=1.19x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.636, Ratio=1.20x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.635, Ratio=1.22x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.625, Ratio=1.20x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.628, Ratio=1.18x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.627, Ratio=1.19x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.621, Ratio=1.17x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.635, Ratio=1.20x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.612, Ratio=1.19x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.618, Ratio=1.18x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.632, Ratio=1.20x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.612, Ratio=1.18x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.620, Ratio=1.16x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.634, Ratio=1.18x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.613, Ratio=1.21x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.645, Ratio=1.19x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.620, Ratio=1.17x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.653, Ratio=1.19x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.621, Ratio=1.21x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.632, Ratio=1.21x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.629, Ratio=1.23x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.635, Ratio=1.24x, Gap=-2.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.645, Ratio=1.20x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.638, Ratio=1.17x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.626, Ratio=1.15x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.608, Ratio=1.19x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.637, Ratio=1.19x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.634, Ratio=1.23x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.628, Ratio=1.20x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.628, Ratio=1.20x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.624, Ratio=1.18x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.612, Ratio=1.19x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.608, Ratio=1.19x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.613, Ratio=1.20x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.613, Ratio=1.19x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.621, Ratio=1.18x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.619, Ratio=1.19x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.621, Ratio=1.22x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.621, Ratio=1.17x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.612, Ratio=1.16x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.630, Ratio=1.15x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.18x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.631, Ratio=1.21x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.619, Ratio=1.21x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.614, Ratio=1.16x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.633, Ratio=1.17x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.637, Ratio=1.17x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.623, Ratio=1.18x, Gap=-2.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.612, Ratio=1.19x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.629, Ratio=1.20x, Gap=-2.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.624, Ratio=1.18x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.623, Ratio=1.21x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.636, Ratio=1.22x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.649, Ratio=1.22x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.633, Ratio=1.21x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.639, Ratio=1.22x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.628, Ratio=1.21x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.621, Ratio=1.14x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.614, Ratio=1.18x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.638, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.631, Ratio=1.20x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.615, Ratio=1.20x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.636, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.624, Ratio=1.23x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.613, Ratio=1.18x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.631, Ratio=1.21x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.620, Ratio=1.18x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.631, Ratio=1.18x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.622, Ratio=1.21x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.617, Ratio=1.18x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.615, Ratio=1.17x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.630, Ratio=1.21x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.622, Ratio=1.19x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.634, Ratio=1.20x, Gap=-2.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.629, Ratio=1.20x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.626, Ratio=1.20x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.612, Ratio=1.18x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.612, Ratio=1.18x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.625, Ratio=1.20x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.621, Ratio=1.21x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.639, Ratio=1.27x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.630, Ratio=1.22x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.620, Ratio=1.20x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.613, Ratio=1.21x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.642, Ratio=1.18x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.624, Ratio=1.16x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.606, Ratio=1.18x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.625, Ratio=1.19x, Gap=-2.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.632, Ratio=1.15x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.613, Ratio=1.17x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.613, Ratio=1.16x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.634, Ratio=1.18x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.636, Ratio=1.21x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.628, Ratio=1.19x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.632, Ratio=1.18x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.619, Ratio=1.18x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.639, Ratio=1.18x, Gap=-2.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.632, Ratio=1.19x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.628, Ratio=1.21x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.625, Ratio=1.20x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.620, Ratio=1.19x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.628, Ratio=1.22x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.627, Ratio=1.22x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.620, Ratio=1.15x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.645, Ratio=1.20x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.618, Ratio=1.20x, Gap=-2.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.625, Ratio=1.16x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.614, Ratio=1.15x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.606, Ratio=1.17x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.617, Ratio=1.18x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.619, Ratio=1.20x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.281

============================================================
Epoch 2/20 completed in 30.8s
Train: Loss=1.9112 (C:1.9112, R:0.0018) Ratio=1.82x
Val:   Loss=1.9036 (C:1.9036, R:0.0018) Ratio=1.94x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.9036)
============================================================

Epoch 3 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.615, Ratio=1.16x, Gap=-2.519
Batch   0/537: Loss=1.9190 (C:1.9190, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.622, Ratio=1.20x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.621, Ratio=1.24x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.616, Ratio=1.19x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.640, Ratio=1.20x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.617, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.623, Ratio=1.16x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.621, Ratio=1.19x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.630, Ratio=1.21x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.625, Ratio=1.20x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.614, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.610, Ratio=1.15x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.613, Ratio=1.24x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.625, Ratio=1.21x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.585, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.608, Ratio=1.18x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.614, Ratio=1.19x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.622, Ratio=1.17x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.613, Ratio=1.15x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.616, Ratio=1.18x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.605, Ratio=1.18x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.622, Ratio=1.18x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.604, Ratio=1.15x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.621, Ratio=1.20x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.636, Ratio=1.20x, Gap=-2.476
Batch  25/537: Loss=1.8989 (C:1.8989, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.620, Ratio=1.21x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.630, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.623, Ratio=1.21x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.616, Ratio=1.20x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.629, Ratio=1.20x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.639, Ratio=1.15x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.625, Ratio=1.19x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.628, Ratio=1.18x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.623, Ratio=1.17x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.634, Ratio=1.19x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.639, Ratio=1.17x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.639, Ratio=1.19x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.645, Ratio=1.20x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.621, Ratio=1.16x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.628, Ratio=1.18x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.630, Ratio=1.15x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.650, Ratio=1.13x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.636, Ratio=1.17x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.635, Ratio=1.19x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.621, Ratio=1.16x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.625, Ratio=1.17x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.607, Ratio=1.15x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.619, Ratio=1.18x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.629, Ratio=1.20x, Gap=-2.605
Batch  50/537: Loss=1.9022 (C:1.9022, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.599, Ratio=1.17x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.609, Ratio=1.22x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.623, Ratio=1.20x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.605, Ratio=1.20x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.620, Ratio=1.17x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.629, Ratio=1.19x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.611, Ratio=1.21x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.622, Ratio=1.20x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.623, Ratio=1.17x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.649, Ratio=1.18x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.648, Ratio=1.18x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.644, Ratio=1.22x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.643, Ratio=1.20x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.613, Ratio=1.16x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.634, Ratio=1.20x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.649, Ratio=1.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.614, Ratio=1.17x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.612, Ratio=1.18x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.615, Ratio=1.23x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.593, Ratio=1.15x, Gap=-2.465
Batch  75/537: Loss=1.9272 (C:1.9272, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.640, Ratio=1.20x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.618, Ratio=1.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.613, Ratio=1.21x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.611, Ratio=1.18x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.633, Ratio=1.20x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.631, Ratio=1.23x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.614, Ratio=1.17x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.621, Ratio=1.16x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.625, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.622, Ratio=1.17x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.617, Ratio=1.21x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.607, Ratio=1.22x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.625, Ratio=1.17x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.617, Ratio=1.18x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.617, Ratio=1.16x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.625, Ratio=1.19x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.630, Ratio=1.22x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.622, Ratio=1.18x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.627, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.622, Ratio=1.20x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.631, Ratio=1.17x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.639, Ratio=1.23x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.620, Ratio=1.23x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-2.428
Batch 100/537: Loss=1.9107 (C:1.9107, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.630, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.624, Ratio=1.15x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.616, Ratio=1.19x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.604, Ratio=1.21x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.643, Ratio=1.20x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.630, Ratio=1.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.623, Ratio=1.15x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.625, Ratio=1.19x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.609, Ratio=1.20x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.614, Ratio=1.20x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.639, Ratio=1.19x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.603, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.619, Ratio=1.18x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.620, Ratio=1.19x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.631, Ratio=1.19x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.608, Ratio=1.18x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.630, Ratio=1.20x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.615, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.642, Ratio=1.21x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.606, Ratio=1.17x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.610, Ratio=1.18x, Gap=-2.549
Batch 125/537: Loss=1.9102 (C:1.9102, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.604, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.609, Ratio=1.16x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.605, Ratio=1.17x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.610, Ratio=1.16x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.599, Ratio=1.19x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.613, Ratio=1.18x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.620, Ratio=1.19x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.639, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.628, Ratio=1.17x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.622, Ratio=1.15x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.629, Ratio=1.19x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.625, Ratio=1.22x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.631, Ratio=1.16x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.640, Ratio=1.20x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.629, Ratio=1.16x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.632, Ratio=1.18x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.622, Ratio=1.18x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.634, Ratio=1.19x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.620, Ratio=1.19x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.605, Ratio=1.19x, Gap=-2.538
Batch 150/537: Loss=1.9104 (C:1.9104, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.621, Ratio=1.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.20x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.616, Ratio=1.22x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.620, Ratio=1.21x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.629, Ratio=1.20x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.639, Ratio=1.20x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.625, Ratio=1.19x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.17x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.632, Ratio=1.23x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.648, Ratio=1.20x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.613, Ratio=1.17x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.632, Ratio=1.18x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.634, Ratio=1.16x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.633, Ratio=1.21x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.618, Ratio=1.17x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.608, Ratio=1.19x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.612, Ratio=1.17x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.606, Ratio=1.17x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.632, Ratio=1.20x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.620, Ratio=1.15x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.624, Ratio=1.16x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.623, Ratio=1.21x, Gap=-2.428
Batch 175/537: Loss=1.8978 (C:1.8978, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.643, Ratio=1.22x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.18x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.629, Ratio=1.21x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.643, Ratio=1.19x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.642, Ratio=1.20x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.626, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.639, Ratio=1.19x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.609, Ratio=1.15x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.628, Ratio=1.21x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.623, Ratio=1.16x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.615, Ratio=1.22x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.616, Ratio=1.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.595, Ratio=1.16x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.607, Ratio=1.18x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.627, Ratio=1.22x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.618, Ratio=1.19x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.635, Ratio=1.20x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.620, Ratio=1.19x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.629, Ratio=1.17x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.621, Ratio=1.21x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.603, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.623, Ratio=1.19x, Gap=-2.570
Batch 200/537: Loss=1.9079 (C:1.9079, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.621, Ratio=1.19x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.637, Ratio=1.21x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.636, Ratio=1.21x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.625, Ratio=1.20x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.632, Ratio=1.20x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.619, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.622, Ratio=1.21x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.633, Ratio=1.19x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.630, Ratio=1.18x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.616, Ratio=1.17x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.628, Ratio=1.17x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.641, Ratio=1.24x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.632, Ratio=1.20x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.622, Ratio=1.20x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.630, Ratio=1.15x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.622, Ratio=1.19x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.630, Ratio=1.15x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.614, Ratio=1.21x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.621, Ratio=1.18x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.625, Ratio=1.21x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.632, Ratio=1.19x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.630, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.638, Ratio=1.19x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.626, Ratio=1.20x, Gap=-2.485
Batch 225/537: Loss=1.9017 (C:1.9017, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.626, Ratio=1.21x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.625, Ratio=1.16x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.629, Ratio=1.23x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.636, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.624, Ratio=1.21x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.617, Ratio=1.16x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.614, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.629, Ratio=1.20x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.639, Ratio=1.18x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.624, Ratio=1.21x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.618, Ratio=1.21x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.625, Ratio=1.21x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.614, Ratio=1.18x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.608, Ratio=1.17x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.606, Ratio=1.16x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.630, Ratio=1.20x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.642, Ratio=1.21x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.636, Ratio=1.19x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.615, Ratio=1.17x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.650, Ratio=1.24x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.613, Ratio=1.16x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.646, Ratio=1.21x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.644, Ratio=1.19x, Gap=-2.495
Batch 250/537: Loss=1.9022 (C:1.9022, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.608, Ratio=1.19x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.621, Ratio=1.16x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.627, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.638, Ratio=1.22x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.607, Ratio=1.16x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.625, Ratio=1.17x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.615, Ratio=1.18x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.611, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.623, Ratio=1.20x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.618, Ratio=1.21x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.626, Ratio=1.22x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.626, Ratio=1.18x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.614, Ratio=1.19x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.645, Ratio=1.22x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.616, Ratio=1.20x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.616, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.628, Ratio=1.21x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.633, Ratio=1.22x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.609, Ratio=1.18x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.618, Ratio=1.20x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.625, Ratio=1.17x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.634, Ratio=1.19x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.604, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.630, Ratio=1.20x, Gap=-2.405
Batch 275/537: Loss=1.8969 (C:1.8969, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.633, Ratio=1.19x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.602, Ratio=1.23x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.638, Ratio=1.21x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.640, Ratio=1.21x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.626, Ratio=1.21x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.621, Ratio=1.20x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.642, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.628, Ratio=1.22x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.628, Ratio=1.18x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.608, Ratio=1.20x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.613, Ratio=1.20x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.610, Ratio=1.18x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.614, Ratio=1.18x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.639, Ratio=1.20x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.629, Ratio=1.19x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.626, Ratio=1.16x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.617, Ratio=1.20x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.463
Batch 300/537: Loss=1.9134 (C:1.9134, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.17x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.625, Ratio=1.16x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.638, Ratio=1.20x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.605, Ratio=1.15x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.617, Ratio=1.24x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.613, Ratio=1.21x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.591, Ratio=1.19x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.613, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.623, Ratio=1.20x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.610, Ratio=1.20x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.618, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.601, Ratio=1.13x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.618, Ratio=1.16x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.615, Ratio=1.21x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.621, Ratio=1.24x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.607, Ratio=1.19x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.599, Ratio=1.18x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.634, Ratio=1.19x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.633, Ratio=1.20x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.626, Ratio=1.20x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.643, Ratio=1.20x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.635, Ratio=1.20x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.646, Ratio=1.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.638, Ratio=1.20x, Gap=-2.517
Batch 325/537: Loss=1.8984 (C:1.8984, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.626, Ratio=1.20x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.632, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.618, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.636, Ratio=1.20x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.636, Ratio=1.23x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.633, Ratio=1.23x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.615, Ratio=1.17x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.608, Ratio=1.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.627, Ratio=1.21x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.621, Ratio=1.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.620, Ratio=1.19x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.622, Ratio=1.16x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.621, Ratio=1.20x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.615, Ratio=1.22x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.631, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.605, Ratio=1.20x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.630, Ratio=1.21x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.620, Ratio=1.22x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.623, Ratio=1.20x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.619, Ratio=1.15x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.623, Ratio=1.20x, Gap=-2.580
Batch 350/537: Loss=1.9028 (C:1.9028, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.614, Ratio=1.21x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.608, Ratio=1.16x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.639, Ratio=1.21x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.634, Ratio=1.18x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.624, Ratio=1.20x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.626, Ratio=1.22x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.646, Ratio=1.19x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.637, Ratio=1.22x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.631, Ratio=1.18x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.631, Ratio=1.24x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.637, Ratio=1.16x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.617, Ratio=1.19x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.620, Ratio=1.18x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.620, Ratio=1.17x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.622, Ratio=1.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.632, Ratio=1.22x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.609, Ratio=1.22x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.628, Ratio=1.21x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.623, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.620, Ratio=1.20x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.632, Ratio=1.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.620, Ratio=1.17x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.623, Ratio=1.19x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.634, Ratio=1.21x, Gap=-2.465
Batch 375/537: Loss=1.8950 (C:1.8950, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.645, Ratio=1.20x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.613, Ratio=1.21x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.643, Ratio=1.22x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.619, Ratio=1.20x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.631, Ratio=1.21x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.608, Ratio=1.16x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.629, Ratio=1.20x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.617, Ratio=1.23x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.612, Ratio=1.19x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.598, Ratio=1.18x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.619, Ratio=1.18x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.612, Ratio=1.20x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.623, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.627, Ratio=1.18x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.605, Ratio=1.21x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.605, Ratio=1.20x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.629, Ratio=1.18x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.616, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.611, Ratio=1.20x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.19x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.623, Ratio=1.20x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.635, Ratio=1.22x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.622, Ratio=1.23x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.632, Ratio=1.22x, Gap=-2.415
Batch 400/537: Loss=1.8928 (C:1.8928, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.614, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.611, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.621, Ratio=1.22x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.611, Ratio=1.18x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.620, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.615, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.627, Ratio=1.16x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.617, Ratio=1.18x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.615, Ratio=1.16x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.634, Ratio=1.21x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.618, Ratio=1.21x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.638, Ratio=1.22x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.633, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.633, Ratio=1.20x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.646, Ratio=1.21x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.651, Ratio=1.20x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.633, Ratio=1.19x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.646, Ratio=1.19x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.631, Ratio=1.17x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.631, Ratio=1.22x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.619, Ratio=1.21x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.620, Ratio=1.20x, Gap=-2.402
Batch 425/537: Loss=1.9026 (C:1.9026, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.617, Ratio=1.24x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.617, Ratio=1.20x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.593, Ratio=1.19x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.602, Ratio=1.19x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.585, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.613, Ratio=1.18x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.622, Ratio=1.20x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.604, Ratio=1.17x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.598, Ratio=1.19x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.617, Ratio=1.22x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.623, Ratio=1.23x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.627, Ratio=1.21x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.611, Ratio=1.15x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.616, Ratio=1.15x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.624, Ratio=1.15x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.636, Ratio=1.19x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.645, Ratio=1.25x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.623, Ratio=1.22x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.637, Ratio=1.22x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.613, Ratio=1.22x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.637, Ratio=1.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.630, Ratio=1.20x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.644, Ratio=1.23x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.643, Ratio=1.17x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.624, Ratio=1.14x, Gap=-2.492
Batch 450/537: Loss=1.9270 (C:1.9270, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.640, Ratio=1.20x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.628, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.646, Ratio=1.22x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.621, Ratio=1.20x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.635, Ratio=1.18x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.635, Ratio=1.20x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.638, Ratio=1.20x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.19x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.628, Ratio=1.21x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.611, Ratio=1.18x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.627, Ratio=1.20x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.618, Ratio=1.19x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.616, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.624, Ratio=1.21x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.611, Ratio=1.19x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.619, Ratio=1.21x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.631, Ratio=1.20x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.651, Ratio=1.19x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.600, Ratio=1.17x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.622, Ratio=1.18x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.609, Ratio=1.17x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.638, Ratio=1.15x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.636, Ratio=1.21x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.379
Batch 475/537: Loss=1.9106 (C:1.9106, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.634, Ratio=1.20x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.637, Ratio=1.20x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.627, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.639, Ratio=1.19x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.624, Ratio=1.20x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.637, Ratio=1.19x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.632, Ratio=1.25x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.632, Ratio=1.21x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.619, Ratio=1.19x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.616, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.625, Ratio=1.20x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.629, Ratio=1.20x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.637, Ratio=1.21x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.625, Ratio=1.20x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.624, Ratio=1.20x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.622, Ratio=1.20x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.624, Ratio=1.20x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.614, Ratio=1.19x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.619, Ratio=1.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.628, Ratio=1.19x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.611, Ratio=1.17x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-2.389
Batch 500/537: Loss=1.9144 (C:1.9144, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.617, Ratio=1.19x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.621, Ratio=1.20x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.620, Ratio=1.17x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.619, Ratio=1.19x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.629, Ratio=1.20x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.604, Ratio=1.18x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.614, Ratio=1.19x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.621, Ratio=1.20x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.603, Ratio=1.19x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.607, Ratio=1.20x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.620, Ratio=1.15x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.615, Ratio=1.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.631, Ratio=1.21x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.619, Ratio=1.20x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.627, Ratio=1.24x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.620, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.633, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.626, Ratio=1.19x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.610, Ratio=1.20x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.616, Ratio=1.20x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.628, Ratio=1.23x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.601, Ratio=1.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.640, Ratio=1.21x, Gap=-2.346
Batch 525/537: Loss=1.8927 (C:1.8927, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.23x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.608, Ratio=1.21x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.16x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.625, Ratio=1.18x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.17x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.621, Ratio=1.18x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.636, Ratio=1.19x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.641, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.626, Ratio=1.20x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.616, Ratio=1.19x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.637, Ratio=1.18x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.639, Ratio=1.18x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.623, Ratio=1.17x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.650, Ratio=1.20x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.628, Ratio=1.18x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.646, Ratio=1.19x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.620, Ratio=1.15x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.650, Ratio=1.21x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.621, Ratio=1.18x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.638, Ratio=1.19x, Gap=-2.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.605, Ratio=1.13x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.637, Ratio=1.22x, Gap=-2.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.623, Ratio=1.18x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.23x, Gap=-2.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.632, Ratio=1.20x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.633, Ratio=1.21x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.628, Ratio=1.15x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.629, Ratio=1.18x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.649, Ratio=1.19x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.654, Ratio=1.21x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.646, Ratio=1.22x, Gap=-2.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.650, Ratio=1.25x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.642, Ratio=1.17x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.631, Ratio=1.22x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.626, Ratio=1.14x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.662, Ratio=1.26x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.648, Ratio=1.17x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.648, Ratio=1.18x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.643, Ratio=1.18x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.647, Ratio=1.21x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.639, Ratio=1.18x, Gap=-2.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.618, Ratio=1.18x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.645, Ratio=1.21x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.625, Ratio=1.17x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.641, Ratio=1.19x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.628, Ratio=1.20x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.640, Ratio=1.17x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.639, Ratio=1.20x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.653, Ratio=1.21x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.657, Ratio=1.23x, Gap=-2.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.633, Ratio=1.20x, Gap=-2.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.642, Ratio=1.19x, Gap=-2.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.657, Ratio=1.20x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.646, Ratio=1.21x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.625, Ratio=1.17x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.638, Ratio=1.21x, Gap=-2.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.633, Ratio=1.19x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.640, Ratio=1.17x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.654, Ratio=1.21x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.617, Ratio=1.18x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.627, Ratio=1.18x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.19x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.632, Ratio=1.20x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.623, Ratio=1.17x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.642, Ratio=1.20x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.633, Ratio=1.19x, Gap=-2.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.645, Ratio=1.23x, Gap=-2.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.644, Ratio=1.20x, Gap=-2.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.651, Ratio=1.21x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.647, Ratio=1.20x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.616, Ratio=1.20x, Gap=-2.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.623, Ratio=1.19x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.651, Ratio=1.18x, Gap=-2.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.637, Ratio=1.16x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.647, Ratio=1.21x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.635, Ratio=1.15x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.643, Ratio=1.19x, Gap=-2.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.636, Ratio=1.21x, Gap=-2.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.667, Ratio=1.20x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.629, Ratio=1.20x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.640, Ratio=1.17x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.624, Ratio=1.16x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.634, Ratio=1.17x, Gap=-2.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.641, Ratio=1.19x, Gap=-2.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.637, Ratio=1.20x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.620, Ratio=1.15x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.634, Ratio=1.20x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.646, Ratio=1.19x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.620, Ratio=1.18x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.650, Ratio=1.19x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.633, Ratio=1.21x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.639, Ratio=1.16x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.655, Ratio=1.21x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.645, Ratio=1.21x, Gap=-2.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.626, Ratio=1.16x, Gap=-2.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.631, Ratio=1.21x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.637, Ratio=1.24x, Gap=-2.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.635, Ratio=1.18x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.619, Ratio=1.20x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.650, Ratio=1.19x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.633, Ratio=1.16x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.640, Ratio=1.22x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.17x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.636, Ratio=1.18x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.619, Ratio=1.18x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.621, Ratio=1.19x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.634, Ratio=1.18x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.635, Ratio=1.21x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.624, Ratio=1.19x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.637, Ratio=1.22x, Gap=-2.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.632, Ratio=1.15x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.645, Ratio=1.18x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.636, Ratio=1.15x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.648, Ratio=1.20x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.621, Ratio=1.18x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.638, Ratio=1.20x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.632, Ratio=1.16x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.633, Ratio=1.17x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.651, Ratio=1.19x, Gap=-2.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.658, Ratio=1.24x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.640, Ratio=1.20x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.631, Ratio=1.18x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.633, Ratio=1.22x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.621, Ratio=1.21x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.635, Ratio=1.20x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.640, Ratio=1.16x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.631, Ratio=1.23x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.643, Ratio=1.20x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.636, Ratio=1.22x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.648, Ratio=1.21x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.645, Ratio=1.19x, Gap=-2.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.626, Ratio=1.16x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.629, Ratio=1.22x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.626, Ratio=1.21x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.632, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.647, Ratio=1.20x, Gap=-2.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.619, Ratio=1.16x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.612, Ratio=1.20x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.637, Ratio=1.20x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.638, Ratio=1.19x, Gap=-2.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.647, Ratio=1.20x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.654, Ratio=1.24x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.622, Ratio=1.22x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.621, Ratio=1.14x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.641, Ratio=1.19x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.626, Ratio=1.14x, Gap=-2.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.657, Ratio=1.22x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.641, Ratio=1.21x, Gap=-2.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.639, Ratio=1.18x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.636, Ratio=1.19x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.634, Ratio=1.18x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.646, Ratio=1.21x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.622, Ratio=1.19x, Gap=-2.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.642, Ratio=1.19x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.645, Ratio=1.20x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.649, Ratio=1.20x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.628, Ratio=1.19x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.629, Ratio=1.22x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.635, Ratio=1.20x, Gap=-2.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.638, Ratio=1.18x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.633, Ratio=1.21x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.629, Ratio=1.18x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.641, Ratio=1.19x, Gap=-2.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.640, Ratio=1.21x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.633, Ratio=1.18x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.644, Ratio=1.22x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.628, Ratio=1.19x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.648, Ratio=1.19x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.644, Ratio=1.22x, Gap=-2.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.621, Ratio=1.16x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.652, Ratio=1.20x, Gap=-2.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.647, Ratio=1.20x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.636, Ratio=1.22x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.640, Ratio=1.22x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.635, Ratio=1.19x, Gap=-2.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.635, Ratio=1.21x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.652, Ratio=1.20x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.636, Ratio=1.21x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.646, Ratio=1.26x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.639, Ratio=1.20x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.17x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.631, Ratio=1.18x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.620, Ratio=1.21x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.626, Ratio=1.19x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.634, Ratio=1.22x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.657, Ratio=1.19x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.640, Ratio=1.20x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.647, Ratio=1.23x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.637, Ratio=1.16x, Gap=-2.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.647, Ratio=1.18x, Gap=-2.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.633, Ratio=1.21x, Gap=-2.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.630, Ratio=1.20x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.639, Ratio=1.21x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.613, Ratio=1.17x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.632, Ratio=1.24x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.642, Ratio=1.22x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.661, Ratio=1.22x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.639, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.637, Ratio=1.16x, Gap=-2.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.622, Ratio=1.18x, Gap=-2.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.645, Ratio=1.18x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.662, Ratio=1.22x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.658, Ratio=1.21x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.647, Ratio=1.21x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.631, Ratio=1.17x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.632, Ratio=1.19x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.632, Ratio=1.19x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.623, Ratio=1.17x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.640, Ratio=1.19x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.631, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.623, Ratio=1.15x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.631, Ratio=1.22x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.647, Ratio=1.19x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.20x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.636, Ratio=1.23x, Gap=-2.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.647, Ratio=1.23x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.630, Ratio=1.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.637, Ratio=1.22x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.632, Ratio=1.21x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.634, Ratio=1.23x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.642, Ratio=1.20x, Gap=-2.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.635, Ratio=1.19x, Gap=-2.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.637, Ratio=1.19x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.642, Ratio=1.20x, Gap=-2.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.18x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.646, Ratio=1.22x, Gap=-2.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.624, Ratio=1.15x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.638, Ratio=1.18x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.637, Ratio=1.24x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.634, Ratio=1.20x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.630, Ratio=1.19x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.642, Ratio=1.20x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.645, Ratio=1.23x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.646, Ratio=1.20x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.615, Ratio=1.15x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.649, Ratio=1.20x, Gap=-2.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.638, Ratio=1.21x, Gap=-2.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.635, Ratio=1.20x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.639, Ratio=1.18x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.648, Ratio=1.20x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.635, Ratio=1.21x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.631, Ratio=1.19x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.645, Ratio=1.22x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.639, Ratio=1.19x, Gap=-2.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.647, Ratio=1.21x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.641, Ratio=1.22x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.633, Ratio=1.20x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.638, Ratio=1.20x, Gap=-2.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.642, Ratio=1.19x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.621, Ratio=1.17x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.631, Ratio=1.17x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.651, Ratio=1.22x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.624, Ratio=1.17x, Gap=-2.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.620, Ratio=1.16x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.637, Ratio=1.20x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.661, Ratio=1.24x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.634, Ratio=1.21x, Gap=-2.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.645, Ratio=1.14x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.632, Ratio=1.19x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.627, Ratio=1.17x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.636, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.626, Ratio=1.19x, Gap=-2.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.645, Ratio=1.18x, Gap=-2.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.631, Ratio=1.18x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.630, Ratio=1.20x, Gap=-2.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.625, Ratio=1.19x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.631, Ratio=1.21x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.641, Ratio=1.23x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.650, Ratio=1.21x, Gap=-2.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.640, Ratio=1.22x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.635, Ratio=1.25x, Gap=-2.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.636, Ratio=1.21x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.631, Ratio=1.15x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.648, Ratio=1.19x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.649, Ratio=1.20x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.640, Ratio=1.20x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.636, Ratio=1.22x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.17x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.639, Ratio=1.18x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.626, Ratio=1.21x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.642, Ratio=1.17x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.632, Ratio=1.20x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.644, Ratio=1.18x, Gap=-2.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.629, Ratio=1.21x, Gap=-2.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.635, Ratio=1.22x, Gap=-2.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.653, Ratio=1.23x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.647, Ratio=1.22x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.651, Ratio=1.19x, Gap=-2.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.650, Ratio=1.19x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.620, Ratio=1.18x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.633, Ratio=1.21x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.23x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.629, Ratio=1.19x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.629, Ratio=1.18x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.655, Ratio=1.20x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.625, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.645, Ratio=1.18x, Gap=-2.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.629, Ratio=1.22x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.638, Ratio=1.20x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.632, Ratio=1.22x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.625, Ratio=1.18x, Gap=-2.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.639, Ratio=1.20x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.638, Ratio=1.19x, Gap=-2.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.636, Ratio=1.19x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.649, Ratio=1.26x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.655, Ratio=1.23x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.637, Ratio=1.17x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.637, Ratio=1.21x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.635, Ratio=1.19x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.629, Ratio=1.21x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.648, Ratio=1.20x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.629, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.637, Ratio=1.17x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.644, Ratio=1.23x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.626, Ratio=1.18x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.647, Ratio=1.21x, Gap=-2.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.626, Ratio=1.19x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.640, Ratio=1.23x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.623, Ratio=1.19x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.629, Ratio=1.20x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.622, Ratio=1.21x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.640, Ratio=1.21x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.633, Ratio=1.19x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.645, Ratio=1.19x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.633, Ratio=1.19x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.637, Ratio=1.17x, Gap=-2.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.649, Ratio=1.23x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.637, Ratio=1.24x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.633, Ratio=1.17x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.632, Ratio=1.19x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.19x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.638, Ratio=1.21x, Gap=-2.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.637, Ratio=1.18x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.636, Ratio=1.20x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.644, Ratio=1.18x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.644, Ratio=1.20x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.646, Ratio=1.21x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.640, Ratio=1.21x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.642, Ratio=1.17x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.638, Ratio=1.18x, Gap=-2.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.621, Ratio=1.15x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.637, Ratio=1.21x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.634, Ratio=1.16x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.649, Ratio=1.20x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.633, Ratio=1.19x, Gap=-2.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.651, Ratio=1.23x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.656, Ratio=1.22x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.640, Ratio=1.20x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.621, Ratio=1.18x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.646, Ratio=1.18x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.639, Ratio=1.23x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.652, Ratio=1.19x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.634, Ratio=1.18x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.619, Ratio=1.18x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.640, Ratio=1.24x, Gap=-2.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.630, Ratio=1.20x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.643, Ratio=1.20x, Gap=-2.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.650, Ratio=1.22x, Gap=-2.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.627, Ratio=1.16x, Gap=-2.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.632, Ratio=1.21x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.652, Ratio=1.24x, Gap=-2.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.627, Ratio=1.20x, Gap=-2.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.649, Ratio=1.20x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.641, Ratio=1.20x, Gap=-2.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.629, Ratio=1.20x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.627, Ratio=1.17x, Gap=-2.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.637, Ratio=1.22x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.637, Ratio=1.23x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.638, Ratio=1.19x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.620, Ratio=1.20x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.623, Ratio=1.18x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-2.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.645, Ratio=1.20x, Gap=-2.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.649, Ratio=1.20x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.620, Ratio=1.20x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.634, Ratio=1.20x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.647, Ratio=1.21x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.647, Ratio=1.22x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.632, Ratio=1.16x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.650, Ratio=1.24x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.619, Ratio=1.16x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.642, Ratio=1.17x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.629, Ratio=1.15x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.661, Ratio=1.22x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.637, Ratio=1.19x, Gap=-2.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.622, Ratio=1.18x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.633, Ratio=1.17x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.624, Ratio=1.21x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.635, Ratio=1.19x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.641, Ratio=1.24x, Gap=-2.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.650, Ratio=1.21x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.659, Ratio=1.20x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.639, Ratio=1.18x, Gap=-2.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.637, Ratio=1.21x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.651, Ratio=1.20x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.643, Ratio=1.16x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.641, Ratio=1.21x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.650, Ratio=1.18x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.630, Ratio=1.22x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.635, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-2.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.642, Ratio=1.21x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.635, Ratio=1.21x, Gap=-2.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.628, Ratio=1.20x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.636, Ratio=1.16x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.645, Ratio=1.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.640, Ratio=1.19x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.603, Ratio=1.19x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.646, Ratio=1.21x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.633, Ratio=1.20x, Gap=-2.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.663, Ratio=1.20x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.642, Ratio=1.26x, Gap=-2.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.638, Ratio=1.17x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.643, Ratio=1.19x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.645, Ratio=1.17x, Gap=-2.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.639, Ratio=1.19x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.635, Ratio=1.21x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.644, Ratio=1.18x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.633, Ratio=1.18x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.639, Ratio=1.20x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.651, Ratio=1.20x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.619, Ratio=1.20x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.628, Ratio=1.19x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.644, Ratio=1.20x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.641, Ratio=1.21x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.639, Ratio=1.19x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.643, Ratio=1.16x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.628, Ratio=1.20x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.637, Ratio=1.19x, Gap=-2.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.645, Ratio=1.18x, Gap=-2.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.614, Ratio=1.17x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.635, Ratio=1.18x, Gap=-2.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.637, Ratio=1.15x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.639, Ratio=1.22x, Gap=-2.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.624, Ratio=1.21x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.635, Ratio=1.18x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.643, Ratio=1.18x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.647, Ratio=1.26x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.627, Ratio=1.20x, Gap=-2.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.632, Ratio=1.19x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.648, Ratio=1.20x, Gap=-2.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.628, Ratio=1.19x, Gap=-2.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.628, Ratio=1.20x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.636, Ratio=1.20x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.641, Ratio=1.22x, Gap=-2.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.643, Ratio=1.17x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.616, Ratio=1.20x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.637, Ratio=1.21x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.655, Ratio=1.19x, Gap=-2.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.626, Ratio=1.21x, Gap=-2.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.621, Ratio=1.19x, Gap=-2.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.618, Ratio=1.17x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.639, Ratio=1.20x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.664, Ratio=1.21x, Gap=-2.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.628, Ratio=1.18x, Gap=-2.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.659, Ratio=1.26x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.646, Ratio=1.18x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.639, Ratio=1.19x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.625, Ratio=1.18x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.620, Ratio=1.18x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.640, Ratio=1.19x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.639, Ratio=1.19x, Gap=-2.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.634, Ratio=1.21x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.648, Ratio=1.23x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.640, Ratio=1.22x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.628, Ratio=1.19x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.641, Ratio=1.20x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.614, Ratio=1.17x, Gap=-2.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.20x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.641, Ratio=1.25x, Gap=-2.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.641, Ratio=1.20x, Gap=-2.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.633, Ratio=1.17x, Gap=-2.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.636, Ratio=1.19x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.661, Ratio=1.24x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.649, Ratio=1.24x, Gap=-2.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.635, Ratio=1.19x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.629, Ratio=1.20x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.640, Ratio=1.19x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.630, Ratio=1.18x, Gap=-2.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.628, Ratio=1.18x, Gap=-2.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.634, Ratio=1.22x, Gap=-2.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.634, Ratio=1.23x, Gap=-2.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.636, Ratio=1.21x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.650, Ratio=1.21x, Gap=-2.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.634, Ratio=1.22x, Gap=-2.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.637, Ratio=1.19x, Gap=-2.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.638, Ratio=1.17x, Gap=-2.302

============================================================
Epoch 3/20 completed in 30.9s
Train: Loss=1.9059 (C:1.9059, R:0.0018) Ratio=1.92x
Val:   Loss=1.8995 (C:1.8995, R:0.0018) Ratio=1.98x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.8995)
============================================================

🌍 Updating global dataset at epoch 4
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.600 ± 0.698
    Neg distances: 1.188 ± 0.808
    Separation ratio: 1.98x
    Gap: -2.397
    ⚠️  Moderate global separation

Epoch 4 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.189, Ratio=1.99x, Gap=-2.535
Batch   0/537: Loss=1.4293 (C:1.4293, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.189, Ratio=1.89x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.204, Ratio=2.00x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.210, Ratio=2.01x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.212, Ratio=2.00x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.191, Ratio=1.90x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.204, Ratio=2.01x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.190, Ratio=1.96x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.183, Ratio=1.97x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.185, Ratio=1.95x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.166, Ratio=1.90x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.185, Ratio=1.95x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.204, Ratio=1.97x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.203, Ratio=2.05x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.198, Ratio=1.94x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.200, Ratio=1.93x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.194, Ratio=1.93x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.199, Ratio=1.98x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.186, Ratio=1.89x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.182, Ratio=1.92x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.186, Ratio=1.95x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.195, Ratio=1.93x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.211, Ratio=2.01x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.203, Ratio=1.96x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.213, Ratio=2.00x, Gap=-2.407
Batch  25/537: Loss=1.4200 (C:1.4200, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.187, Ratio=1.88x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.199, Ratio=1.93x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.191, Ratio=1.95x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.177, Ratio=1.83x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.195, Ratio=1.96x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.196, Ratio=1.98x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.203, Ratio=2.02x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.190, Ratio=1.96x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.206, Ratio=1.98x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.199, Ratio=1.92x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.183, Ratio=1.89x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.199, Ratio=2.00x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.193, Ratio=1.97x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.187, Ratio=1.91x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.186, Ratio=1.93x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.192, Ratio=1.97x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.190, Ratio=1.97x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.181, Ratio=1.90x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.213, Ratio=2.08x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.193, Ratio=1.87x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.195, Ratio=2.02x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.203, Ratio=2.04x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.195, Ratio=2.00x, Gap=-2.488
Batch  50/537: Loss=1.4274 (C:1.4274, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.205, Ratio=2.04x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.191, Ratio=1.96x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.198, Ratio=1.98x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.195, Ratio=1.92x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.193, Ratio=1.95x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.188, Ratio=1.97x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.206, Ratio=2.00x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.194, Ratio=1.98x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.184, Ratio=1.85x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.202, Ratio=1.96x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.191, Ratio=1.96x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.182, Ratio=1.93x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.179, Ratio=1.96x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.210, Ratio=2.03x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.179, Ratio=1.85x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.198, Ratio=1.90x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.185, Ratio=1.93x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.198, Ratio=1.96x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.177, Ratio=1.89x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.187, Ratio=1.96x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.185, Ratio=1.90x, Gap=-2.463
Batch  75/537: Loss=1.4633 (C:1.4633, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.202, Ratio=1.94x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.201, Ratio=1.94x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.204, Ratio=2.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.194, Ratio=1.97x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.190, Ratio=1.93x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=1.99x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.213, Ratio=2.05x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.186, Ratio=1.90x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.203, Ratio=1.97x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.205, Ratio=1.95x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.205, Ratio=2.02x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.201, Ratio=1.97x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.178, Ratio=1.85x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.194, Ratio=1.93x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.200, Ratio=1.98x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.02x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.191, Ratio=1.97x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.166, Ratio=1.87x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.204, Ratio=1.99x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.202, Ratio=2.01x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.200, Ratio=1.94x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.188, Ratio=1.90x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.203, Ratio=1.98x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.194, Ratio=1.90x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.197, Ratio=2.00x, Gap=-2.510
Batch 100/537: Loss=1.4265 (C:1.4265, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.205, Ratio=1.98x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.196, Ratio=1.95x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.197, Ratio=1.95x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.187, Ratio=1.91x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.180, Ratio=1.89x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.193, Ratio=2.00x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.197, Ratio=1.96x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.195, Ratio=1.90x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.186, Ratio=1.95x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.191, Ratio=1.94x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.187, Ratio=1.94x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.184, Ratio=1.90x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.189, Ratio=1.94x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.195, Ratio=2.03x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.192, Ratio=1.93x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.185, Ratio=1.90x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.194, Ratio=1.98x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.193, Ratio=1.97x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.198, Ratio=1.95x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.202, Ratio=1.97x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.196, Ratio=1.97x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.194, Ratio=1.95x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.207, Ratio=2.01x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.181, Ratio=1.87x, Gap=-2.505
Batch 125/537: Loss=1.4717 (C:1.4717, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.188, Ratio=1.95x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.198, Ratio=2.04x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.189, Ratio=1.93x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.179, Ratio=1.91x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.190, Ratio=1.93x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.200, Ratio=1.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.190, Ratio=1.94x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.178, Ratio=1.90x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.183, Ratio=1.87x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.188, Ratio=1.93x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.197, Ratio=2.00x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.209, Ratio=2.01x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.192, Ratio=1.93x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.206, Ratio=2.02x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.209, Ratio=2.05x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.172, Ratio=1.84x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.193, Ratio=1.91x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.199, Ratio=2.05x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.187, Ratio=1.90x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.214, Ratio=2.04x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.185, Ratio=1.99x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.202, Ratio=2.02x, Gap=-2.538
Batch 150/537: Loss=1.4166 (C:1.4166, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.192, Ratio=1.93x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.187, Ratio=1.94x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.202, Ratio=1.97x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.199, Ratio=2.03x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.192, Ratio=1.94x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.196, Ratio=1.97x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.172, Ratio=1.88x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.177, Ratio=1.91x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.210, Ratio=1.99x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.197, Ratio=1.97x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.188, Ratio=1.90x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.203, Ratio=2.04x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.168, Ratio=1.86x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.199, Ratio=2.00x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.216, Ratio=2.04x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.181, Ratio=1.87x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.186, Ratio=1.87x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.190, Ratio=1.93x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.184, Ratio=1.91x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.204, Ratio=2.07x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.193, Ratio=1.96x, Gap=-2.720
Batch 175/537: Loss=1.4411 (C:1.4411, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.188, Ratio=1.98x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.193, Ratio=1.95x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.198, Ratio=1.95x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.210, Ratio=1.98x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.204, Ratio=1.97x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.198, Ratio=1.98x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.187, Ratio=1.96x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.197, Ratio=2.02x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.207, Ratio=1.98x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.197, Ratio=1.95x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.209, Ratio=2.05x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.213, Ratio=2.00x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.192, Ratio=1.94x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.194, Ratio=1.93x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.206, Ratio=1.95x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.203, Ratio=1.97x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.182, Ratio=1.90x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.188, Ratio=1.94x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.173, Ratio=1.92x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.174, Ratio=1.91x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.209, Ratio=2.03x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.202, Ratio=1.98x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.184, Ratio=1.94x, Gap=-2.421
Batch 200/537: Loss=1.4503 (C:1.4503, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.196, Ratio=1.93x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.195, Ratio=1.95x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.208, Ratio=2.02x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.201, Ratio=1.94x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.174, Ratio=1.91x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.185, Ratio=1.96x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.189, Ratio=2.03x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.197, Ratio=2.04x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.193, Ratio=1.96x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.217, Ratio=2.02x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.176, Ratio=1.87x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.220, Ratio=2.05x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.193, Ratio=1.94x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.193, Ratio=2.01x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.196, Ratio=1.99x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.187, Ratio=1.93x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.186, Ratio=1.93x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.199, Ratio=1.95x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.220, Ratio=2.04x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.196, Ratio=1.95x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.186, Ratio=1.93x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.00x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.215, Ratio=2.10x, Gap=-2.535
Batch 225/537: Loss=1.3873 (C:1.3873, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.184, Ratio=1.94x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.212, Ratio=2.06x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.202, Ratio=1.96x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.00x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.182, Ratio=1.91x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.186, Ratio=1.95x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.186, Ratio=1.94x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.198, Ratio=1.97x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.196, Ratio=1.94x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.181, Ratio=1.93x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.195, Ratio=1.98x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.199, Ratio=1.97x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.186, Ratio=1.89x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.195, Ratio=1.96x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.194, Ratio=1.95x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.189, Ratio=1.89x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.186, Ratio=1.96x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.179, Ratio=1.91x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.208, Ratio=2.06x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.190, Ratio=1.96x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.183, Ratio=1.90x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.193, Ratio=1.95x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.195, Ratio=2.01x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.204, Ratio=2.02x, Gap=-2.704
Batch 250/537: Loss=1.4169 (C:1.4169, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.196, Ratio=1.92x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.224, Ratio=2.13x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.207, Ratio=2.01x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.211, Ratio=2.05x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.186, Ratio=1.88x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.207, Ratio=1.99x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.189, Ratio=1.92x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.191, Ratio=1.92x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.191, Ratio=1.97x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.184, Ratio=1.90x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.212, Ratio=2.08x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.189, Ratio=1.88x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.215, Ratio=2.05x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.198, Ratio=1.94x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.204, Ratio=2.05x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.205, Ratio=1.99x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.201, Ratio=1.96x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.211, Ratio=1.99x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.190, Ratio=1.92x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.184, Ratio=1.87x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.211, Ratio=2.03x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.198, Ratio=1.95x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.190, Ratio=1.95x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.443
Batch 275/537: Loss=1.4103 (C:1.4103, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.170, Ratio=1.87x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.201, Ratio=2.03x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.181, Ratio=1.91x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.196, Ratio=2.03x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.189, Ratio=1.96x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.193, Ratio=1.96x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.196, Ratio=1.98x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.203, Ratio=1.98x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.179, Ratio=1.93x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.206, Ratio=2.06x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.191, Ratio=1.93x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.190, Ratio=1.92x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.207, Ratio=1.99x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.211, Ratio=2.07x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.218, Ratio=2.13x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.204, Ratio=1.99x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.205, Ratio=1.99x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.190, Ratio=1.95x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.185, Ratio=1.96x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.203, Ratio=2.01x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.193, Ratio=1.93x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.177, Ratio=1.91x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.186, Ratio=1.91x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.196, Ratio=2.02x, Gap=-2.518
Batch 300/537: Loss=1.4182 (C:1.4182, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.176, Ratio=1.89x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.181, Ratio=1.93x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.185, Ratio=1.87x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.182, Ratio=1.93x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.212, Ratio=2.01x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.202, Ratio=2.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.199, Ratio=2.01x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.192, Ratio=1.92x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.211, Ratio=2.02x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.206, Ratio=2.02x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.200, Ratio=2.04x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.209, Ratio=2.07x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.180, Ratio=1.93x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.188, Ratio=1.94x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.201, Ratio=1.98x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.213, Ratio=2.09x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.210, Ratio=2.00x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.186, Ratio=1.93x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.200, Ratio=1.98x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.210, Ratio=2.02x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.199, Ratio=1.96x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.203, Ratio=2.04x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.192, Ratio=1.96x, Gap=-2.626
Batch 325/537: Loss=1.4381 (C:1.4381, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.200, Ratio=1.98x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=1.99x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.183, Ratio=1.89x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.206, Ratio=2.00x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.210, Ratio=2.02x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.184, Ratio=1.90x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.188, Ratio=1.93x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.191, Ratio=1.97x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.199, Ratio=1.95x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.192, Ratio=1.99x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.196, Ratio=1.97x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.204, Ratio=1.99x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.178, Ratio=1.90x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.191, Ratio=1.96x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.209, Ratio=2.05x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.199, Ratio=1.95x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.208, Ratio=1.98x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.187, Ratio=1.94x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.181, Ratio=1.91x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.199, Ratio=2.03x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.198, Ratio=1.96x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.199, Ratio=1.96x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.200, Ratio=1.95x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.195, Ratio=1.91x, Gap=-2.573
Batch 350/537: Loss=1.4554 (C:1.4554, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.190, Ratio=1.90x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.194, Ratio=1.92x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.211, Ratio=2.04x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.192, Ratio=1.93x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.189, Ratio=1.90x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.188, Ratio=1.87x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.191, Ratio=1.95x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.193, Ratio=1.97x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.189, Ratio=1.92x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.195, Ratio=1.98x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.189, Ratio=1.97x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.191, Ratio=1.95x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.196, Ratio=1.95x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.186, Ratio=1.91x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.199, Ratio=1.92x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.188, Ratio=2.02x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.192, Ratio=1.99x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.192, Ratio=1.94x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.195, Ratio=1.99x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.185, Ratio=1.90x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.170, Ratio=1.85x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.196, Ratio=1.96x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.193, Ratio=1.90x, Gap=-2.596
Batch 375/537: Loss=1.4567 (C:1.4567, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.206, Ratio=1.98x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.205, Ratio=1.99x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.202, Ratio=1.98x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.202, Ratio=1.99x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.183, Ratio=1.91x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.212, Ratio=2.09x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.205, Ratio=2.00x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.200, Ratio=2.03x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.194, Ratio=1.97x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.197, Ratio=1.98x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.200, Ratio=1.94x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.207, Ratio=1.98x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.198, Ratio=1.98x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.193, Ratio=1.92x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.186, Ratio=1.90x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.205, Ratio=2.01x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.191, Ratio=1.93x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.195, Ratio=2.03x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.201, Ratio=2.01x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.188, Ratio=1.93x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.186, Ratio=1.95x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.194, Ratio=2.02x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.183, Ratio=1.91x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.10x, Gap=-2.641
Batch 400/537: Loss=1.3874 (C:1.3874, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.213, Ratio=2.08x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.208, Ratio=1.95x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.194, Ratio=1.97x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.210, Ratio=1.98x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.221, Ratio=2.07x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.204, Ratio=2.00x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.181, Ratio=1.95x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.186, Ratio=1.94x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.167, Ratio=1.85x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.188, Ratio=1.95x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.194, Ratio=1.99x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.187, Ratio=1.96x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.202, Ratio=1.97x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.178, Ratio=1.87x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.215, Ratio=2.02x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.198, Ratio=2.03x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.206, Ratio=1.96x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.217, Ratio=2.11x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.182, Ratio=1.92x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.202, Ratio=2.03x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.177, Ratio=1.87x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.192, Ratio=1.96x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.177, Ratio=1.91x, Gap=-2.482
Batch 425/537: Loss=1.4606 (C:1.4606, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.176, Ratio=1.93x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.204, Ratio=2.05x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.208, Ratio=2.02x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.215, Ratio=2.04x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.211, Ratio=2.09x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.203, Ratio=1.95x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.190, Ratio=1.97x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.190, Ratio=1.94x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.207, Ratio=2.10x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.199, Ratio=2.00x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.193, Ratio=1.91x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.229, Ratio=2.18x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.180, Ratio=1.87x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.190, Ratio=1.94x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.190, Ratio=1.93x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.214, Ratio=2.04x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.216, Ratio=2.06x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.05x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.198, Ratio=1.95x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.211, Ratio=2.05x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.203, Ratio=2.01x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.205, Ratio=1.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.198, Ratio=1.95x, Gap=-2.461
Batch 450/537: Loss=1.4387 (C:1.4387, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.194, Ratio=1.96x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.184, Ratio=1.96x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.197, Ratio=1.94x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.202, Ratio=1.99x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.203, Ratio=1.99x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.193, Ratio=1.90x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.186, Ratio=1.93x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.205, Ratio=2.03x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.208, Ratio=2.01x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.176, Ratio=1.88x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.199, Ratio=1.94x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.211, Ratio=2.06x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.183, Ratio=1.90x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.199, Ratio=1.97x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.185, Ratio=1.93x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.196, Ratio=1.95x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.201, Ratio=2.03x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.188, Ratio=2.00x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.202, Ratio=2.03x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.196, Ratio=2.04x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.201, Ratio=1.99x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.434
Batch 475/537: Loss=1.4180 (C:1.4180, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.207, Ratio=2.03x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.185, Ratio=1.93x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.194, Ratio=1.95x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.203, Ratio=2.01x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.191, Ratio=1.96x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.195, Ratio=1.99x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.176, Ratio=1.87x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.198, Ratio=1.97x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.206, Ratio=1.99x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.201, Ratio=1.97x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.197, Ratio=1.94x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.198, Ratio=2.03x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.223, Ratio=2.16x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.208, Ratio=2.04x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.205, Ratio=2.04x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.183, Ratio=1.85x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.191, Ratio=1.94x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.187, Ratio=1.87x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.194, Ratio=1.97x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.202, Ratio=1.95x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.202, Ratio=2.02x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.223, Ratio=2.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.199, Ratio=2.02x, Gap=-2.429
Batch 500/537: Loss=1.4180 (C:1.4180, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.193, Ratio=1.95x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.183, Ratio=1.93x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.200, Ratio=2.03x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.203, Ratio=2.02x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.194, Ratio=1.95x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.191, Ratio=1.98x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.198, Ratio=1.96x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.200, Ratio=1.98x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.191, Ratio=1.96x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.196, Ratio=1.98x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.210, Ratio=2.05x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.193, Ratio=1.95x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.195, Ratio=1.96x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.219, Ratio=2.06x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.178, Ratio=1.87x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.197, Ratio=1.97x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.199, Ratio=2.02x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.203, Ratio=2.00x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.181, Ratio=1.88x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.191, Ratio=1.93x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.176, Ratio=1.92x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.202, Ratio=2.02x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.207, Ratio=2.03x, Gap=-2.915
Batch 525/537: Loss=1.4134 (C:1.4134, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.208, Ratio=1.98x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.196, Ratio=1.97x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.191, Ratio=1.95x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.193, Ratio=1.91x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.189, Ratio=1.90x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.220, Ratio=2.08x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.187, Ratio=1.99x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.195, Ratio=1.99x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.201, Ratio=1.97x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.194, Ratio=1.95x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.216, Ratio=2.14x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.197, Ratio=1.96x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.211, Ratio=2.12x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.203, Ratio=2.05x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.208, Ratio=2.10x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.202, Ratio=2.04x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.208, Ratio=2.04x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.194, Ratio=2.02x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.213, Ratio=2.06x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.207, Ratio=2.09x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.193, Ratio=2.06x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.207, Ratio=2.08x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.183, Ratio=1.92x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.217, Ratio=2.15x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.195, Ratio=2.06x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.215, Ratio=2.17x, Gap=-2.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.209, Ratio=2.10x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.09x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.201, Ratio=2.08x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.205, Ratio=2.02x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.187, Ratio=1.98x, Gap=-2.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.203, Ratio=2.10x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.198, Ratio=2.03x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.191, Ratio=1.91x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.202, Ratio=2.05x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.191, Ratio=1.98x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.194, Ratio=1.95x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.192, Ratio=1.95x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.201, Ratio=2.07x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.188, Ratio=1.96x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.192, Ratio=1.96x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.189, Ratio=1.93x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.196, Ratio=1.97x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.194, Ratio=1.94x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.191, Ratio=1.97x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.196, Ratio=1.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.192, Ratio=1.95x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.218, Ratio=2.14x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.202, Ratio=2.01x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.194, Ratio=1.97x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.198, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.202, Ratio=2.08x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.183, Ratio=1.97x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.183, Ratio=1.91x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.206, Ratio=2.07x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.207, Ratio=2.06x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.193, Ratio=1.98x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.192, Ratio=2.01x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.193, Ratio=1.97x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.200, Ratio=2.03x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.193, Ratio=1.97x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.199, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.199, Ratio=1.99x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.206, Ratio=2.03x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.200, Ratio=2.02x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.234, Ratio=2.21x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.200, Ratio=2.01x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.178, Ratio=1.96x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.189, Ratio=1.96x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.200, Ratio=2.03x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.211, Ratio=2.09x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.187, Ratio=1.92x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.202, Ratio=2.06x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.204, Ratio=2.10x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.211, Ratio=2.05x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.193, Ratio=1.96x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.201, Ratio=2.06x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.191, Ratio=2.00x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.210, Ratio=2.06x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.172, Ratio=1.92x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.212, Ratio=2.11x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.199, Ratio=2.00x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.209, Ratio=2.09x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.207, Ratio=2.04x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.208, Ratio=2.05x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.200, Ratio=2.01x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.217, Ratio=2.21x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.198, Ratio=1.99x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.204, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.190, Ratio=1.94x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.192, Ratio=2.01x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.190, Ratio=1.98x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.185, Ratio=1.97x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.194, Ratio=1.93x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.206, Ratio=2.04x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.192, Ratio=1.98x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.197, Ratio=1.98x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.208, Ratio=2.09x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.188, Ratio=2.03x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.200, Ratio=1.98x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.211, Ratio=2.07x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.192, Ratio=1.95x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.200, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.213, Ratio=2.07x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.191, Ratio=1.99x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.197, Ratio=2.05x, Gap=-2.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.207, Ratio=2.06x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.192, Ratio=1.98x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.186, Ratio=1.91x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.188, Ratio=1.98x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.195, Ratio=1.96x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.188, Ratio=2.00x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.196, Ratio=2.03x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.198, Ratio=2.04x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.203, Ratio=2.04x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.182, Ratio=1.95x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.190, Ratio=1.95x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.187, Ratio=2.00x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.196, Ratio=1.99x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.193, Ratio=1.99x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.197, Ratio=2.03x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.198, Ratio=2.08x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.198, Ratio=2.02x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.218, Ratio=2.14x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.217, Ratio=2.14x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.191, Ratio=1.99x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.194, Ratio=2.01x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.204, Ratio=2.07x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.216, Ratio=2.13x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.215, Ratio=2.12x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.205, Ratio=2.06x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.203, Ratio=2.03x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.203, Ratio=1.97x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.213, Ratio=2.14x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.192, Ratio=1.98x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.193, Ratio=2.01x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.203, Ratio=2.05x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.192, Ratio=1.96x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.187, Ratio=1.98x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.206, Ratio=2.09x, Gap=-2.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.220, Ratio=2.14x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.212, Ratio=2.14x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.191, Ratio=1.93x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.217, Ratio=2.13x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.198, Ratio=1.95x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.193, Ratio=1.95x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.192, Ratio=2.00x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.195, Ratio=1.99x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.215, Ratio=2.12x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.205, Ratio=2.05x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.186, Ratio=1.91x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.195, Ratio=2.03x, Gap=-2.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.203, Ratio=1.99x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.201, Ratio=2.07x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.208, Ratio=2.09x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.197, Ratio=2.00x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.203, Ratio=1.99x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.205, Ratio=2.08x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.195, Ratio=2.02x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.214, Ratio=2.07x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.194, Ratio=2.00x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.212, Ratio=2.04x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.213, Ratio=2.10x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.190, Ratio=1.92x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.197, Ratio=1.96x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.190, Ratio=1.99x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.185, Ratio=1.99x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.185, Ratio=1.90x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.194, Ratio=2.00x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.210, Ratio=2.18x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.203, Ratio=2.03x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.206, Ratio=2.06x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.213, Ratio=2.06x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.220, Ratio=2.10x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.204, Ratio=2.03x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.214, Ratio=2.04x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.203, Ratio=2.01x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.212, Ratio=2.10x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.202, Ratio=2.07x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.198, Ratio=2.02x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.194, Ratio=1.98x, Gap=-2.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.200, Ratio=2.02x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.191, Ratio=2.02x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.199, Ratio=2.05x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.196, Ratio=1.97x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.188, Ratio=1.97x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.221, Ratio=2.15x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.189, Ratio=2.00x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.215, Ratio=2.05x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.191, Ratio=1.99x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.199, Ratio=2.06x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.201, Ratio=1.99x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.204, Ratio=2.08x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.198, Ratio=2.04x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.191, Ratio=1.93x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.197, Ratio=1.98x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.195, Ratio=2.02x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.187, Ratio=2.00x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.200, Ratio=2.04x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.204, Ratio=2.06x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.195, Ratio=2.02x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.183, Ratio=1.95x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.210, Ratio=2.09x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.199, Ratio=2.05x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.201, Ratio=2.01x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.186, Ratio=1.96x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.200, Ratio=2.04x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.205, Ratio=2.10x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.203, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.189, Ratio=1.92x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.189, Ratio=1.97x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.190, Ratio=2.00x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.184, Ratio=1.96x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.197, Ratio=1.97x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.205, Ratio=2.05x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.202, Ratio=2.05x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.205, Ratio=2.03x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.190, Ratio=1.93x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.203, Ratio=2.06x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.176, Ratio=1.94x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.200, Ratio=2.00x, Gap=-2.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.190, Ratio=1.93x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.218, Ratio=2.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.196, Ratio=1.99x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.199, Ratio=2.05x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.203, Ratio=2.08x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.205, Ratio=2.06x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=2.00x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.198, Ratio=1.99x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.198, Ratio=2.06x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.185, Ratio=1.97x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.209, Ratio=2.06x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.204, Ratio=2.07x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.189, Ratio=1.98x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.202, Ratio=2.09x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.206, Ratio=2.06x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.192, Ratio=1.97x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.199, Ratio=2.04x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.205, Ratio=2.08x, Gap=-2.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.213, Ratio=2.08x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.182, Ratio=1.87x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.216, Ratio=2.13x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.193, Ratio=1.98x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.173, Ratio=1.90x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.194, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.208, Ratio=2.09x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.198, Ratio=2.09x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.207, Ratio=2.08x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.195, Ratio=2.03x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.205, Ratio=2.01x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.195, Ratio=2.00x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.192, Ratio=1.97x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.189, Ratio=1.94x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.214, Ratio=2.05x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.180, Ratio=1.93x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.192, Ratio=1.96x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.09x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.205, Ratio=2.04x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.196, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.191, Ratio=2.01x, Gap=-2.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.189, Ratio=1.97x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.210, Ratio=2.10x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.191, Ratio=1.96x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.180, Ratio=1.96x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.205, Ratio=2.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.200, Ratio=2.03x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.199, Ratio=2.03x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.191, Ratio=1.98x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.199, Ratio=2.00x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.190, Ratio=1.97x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.208, Ratio=2.09x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.204, Ratio=2.09x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.211, Ratio=2.10x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.203, Ratio=1.97x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.195, Ratio=1.98x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.188, Ratio=1.99x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.192, Ratio=1.93x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.196, Ratio=1.99x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.194, Ratio=1.96x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.204, Ratio=2.03x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.189, Ratio=1.94x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.189, Ratio=1.94x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.204, Ratio=2.12x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.205, Ratio=2.03x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.202, Ratio=2.05x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.187, Ratio=1.92x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.209, Ratio=2.13x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.193, Ratio=1.97x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.195, Ratio=2.01x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.207, Ratio=2.09x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.212, Ratio=2.10x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.192, Ratio=1.99x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.202, Ratio=2.08x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.212, Ratio=2.10x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.210, Ratio=2.06x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.215, Ratio=2.09x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.192, Ratio=1.98x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.194, Ratio=2.01x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.204, Ratio=2.07x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.212, Ratio=2.10x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.202, Ratio=2.06x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.198, Ratio=1.99x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.201, Ratio=2.01x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.193, Ratio=1.98x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.192, Ratio=2.02x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.200, Ratio=2.05x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.207, Ratio=2.06x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.194, Ratio=2.02x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.198, Ratio=1.96x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.208, Ratio=2.08x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.206, Ratio=2.05x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.190, Ratio=2.00x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.174, Ratio=1.87x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.186, Ratio=1.97x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.204, Ratio=2.05x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.211, Ratio=2.14x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.182, Ratio=1.93x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.179, Ratio=1.90x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.198, Ratio=2.00x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.197, Ratio=2.04x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.204, Ratio=2.05x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.199, Ratio=2.05x, Gap=-2.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.191, Ratio=1.95x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.214, Ratio=2.10x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.196, Ratio=1.98x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.216, Ratio=2.16x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.205, Ratio=2.02x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.208, Ratio=2.06x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.203, Ratio=2.04x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.198, Ratio=2.04x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.03x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.196, Ratio=1.97x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.186, Ratio=1.92x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.189, Ratio=1.94x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.192, Ratio=1.95x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.194, Ratio=1.97x, Gap=-2.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.189, Ratio=2.03x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.196, Ratio=2.03x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.208, Ratio=2.08x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.199, Ratio=2.02x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.207, Ratio=2.04x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.182, Ratio=1.92x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.206, Ratio=2.03x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.197, Ratio=2.02x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.195, Ratio=1.96x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.196, Ratio=2.04x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.216, Ratio=2.09x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.182, Ratio=1.94x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.185, Ratio=1.90x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.210, Ratio=2.03x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.213, Ratio=2.09x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.05x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.192, Ratio=1.97x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.177, Ratio=1.90x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.199, Ratio=1.98x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.198, Ratio=2.06x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.202, Ratio=2.02x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.193, Ratio=1.96x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.197, Ratio=2.02x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.186, Ratio=1.99x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.223, Ratio=2.16x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.191, Ratio=1.99x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.186, Ratio=1.98x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.209, Ratio=2.08x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.193, Ratio=1.99x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.206, Ratio=2.06x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.194, Ratio=1.96x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.197, Ratio=2.01x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.188, Ratio=1.95x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.206, Ratio=2.02x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.197, Ratio=1.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.192, Ratio=1.96x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.187, Ratio=1.95x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.185, Ratio=1.93x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.196, Ratio=2.00x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.205, Ratio=2.09x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.183, Ratio=1.94x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.199, Ratio=2.06x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.200, Ratio=2.02x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.190, Ratio=1.99x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.198, Ratio=2.01x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.193, Ratio=1.96x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.193, Ratio=2.03x, Gap=-2.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.194, Ratio=1.98x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.206, Ratio=2.09x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.03x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.184, Ratio=1.91x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.192, Ratio=1.99x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.202, Ratio=2.09x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.189, Ratio=2.00x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.192, Ratio=1.96x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.198, Ratio=1.98x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.193, Ratio=2.00x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.217, Ratio=2.16x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.200, Ratio=2.03x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.194, Ratio=2.00x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.201, Ratio=2.07x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.209, Ratio=2.10x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.197, Ratio=2.01x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.201, Ratio=2.03x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.210, Ratio=2.10x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.212, Ratio=2.04x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.206, Ratio=2.11x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.194, Ratio=2.01x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.202, Ratio=2.08x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.193, Ratio=1.99x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.203, Ratio=2.03x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.180, Ratio=1.99x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.186, Ratio=1.96x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.183, Ratio=1.96x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.180, Ratio=1.92x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.188, Ratio=1.97x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.206, Ratio=2.07x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.213, Ratio=2.16x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.191, Ratio=1.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.187, Ratio=2.00x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.193, Ratio=1.99x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.193, Ratio=2.06x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.185, Ratio=1.96x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.185, Ratio=1.93x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.188, Ratio=1.98x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.204, Ratio=2.07x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.210, Ratio=2.05x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.202, Ratio=2.05x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.209, Ratio=2.11x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.190, Ratio=2.00x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.202, Ratio=2.04x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.189, Ratio=1.95x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.185, Ratio=1.99x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.206, Ratio=2.07x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.190, Ratio=1.97x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.196, Ratio=1.98x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.200, Ratio=2.09x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.204, Ratio=2.08x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.206, Ratio=2.02x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.194, Ratio=2.00x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.210, Ratio=2.12x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.199, Ratio=2.02x, Gap=-2.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.186, Ratio=1.96x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.204, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.199, Ratio=2.02x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.207, Ratio=2.07x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.206, Ratio=2.08x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.196, Ratio=2.00x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.191, Ratio=2.00x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.214, Ratio=2.13x, Gap=-2.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.198, Ratio=1.98x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.185, Ratio=2.00x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.209, Ratio=2.09x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.206, Ratio=2.04x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.208, Ratio=2.09x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.190, Ratio=1.97x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.195, Ratio=2.01x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.196, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.193, Ratio=1.98x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.195, Ratio=2.02x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.204, Ratio=2.05x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.205, Ratio=2.07x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.192, Ratio=1.97x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.215, Ratio=2.13x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.195, Ratio=1.99x, Gap=-2.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.187, Ratio=1.99x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.195, Ratio=2.01x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.185, Ratio=1.95x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.194, Ratio=2.04x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.201, Ratio=2.06x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.190, Ratio=1.97x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.199, Ratio=2.03x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.197, Ratio=1.97x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.189, Ratio=1.92x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.197, Ratio=2.08x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.199, Ratio=2.09x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.192, Ratio=1.98x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.215, Ratio=2.07x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.03x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.192, Ratio=1.95x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.188, Ratio=1.99x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.185, Ratio=1.98x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.214, Ratio=2.05x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.217, Ratio=2.12x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.191, Ratio=2.01x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.202, Ratio=2.02x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.191, Ratio=2.02x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.196, Ratio=2.05x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.210, Ratio=2.08x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.200, Ratio=2.02x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.194, Ratio=2.04x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.193, Ratio=1.97x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.197, Ratio=2.00x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.203, Ratio=2.01x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.193, Ratio=2.02x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.207, Ratio=2.08x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.208, Ratio=2.05x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.182, Ratio=1.98x, Gap=-2.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.178, Ratio=1.89x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.204, Ratio=2.03x, Gap=-2.328

============================================================
Epoch 4/20 completed in 36.0s
Train: Loss=1.4351 (C:1.4351, R:0.0018) Ratio=1.96x
Val:   Loss=1.4164 (C:1.4164, R:0.0018) Ratio=2.08x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.4164)
============================================================

Epoch 5 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.194, Ratio=1.94x, Gap=-2.425
Batch   0/537: Loss=1.4438 (C:1.4438, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.218, Ratio=2.14x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.190, Ratio=1.95x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.195, Ratio=1.94x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.200, Ratio=1.99x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.204, Ratio=2.06x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.211, Ratio=2.03x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.206, Ratio=1.98x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.183, Ratio=1.92x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.207, Ratio=2.03x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.202, Ratio=2.01x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.204, Ratio=2.07x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.197, Ratio=1.97x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.205, Ratio=1.98x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.208, Ratio=2.00x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.227, Ratio=2.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.203, Ratio=1.99x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.192, Ratio=1.93x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.203, Ratio=1.98x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.198, Ratio=2.00x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.196, Ratio=2.03x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.189, Ratio=1.99x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.185, Ratio=1.95x, Gap=-2.501
Batch  25/537: Loss=1.4446 (C:1.4446, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.198, Ratio=2.04x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.199, Ratio=1.97x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.210, Ratio=2.05x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.213, Ratio=2.01x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.210, Ratio=1.99x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.206, Ratio=2.00x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.221, Ratio=2.10x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.206, Ratio=2.01x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.209, Ratio=2.02x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.207, Ratio=2.13x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.217, Ratio=2.15x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.214, Ratio=2.02x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.216, Ratio=2.04x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.201, Ratio=1.97x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.210, Ratio=2.07x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.188, Ratio=1.92x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.195, Ratio=1.95x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.196, Ratio=1.99x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.224, Ratio=2.19x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.188, Ratio=1.94x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.200, Ratio=1.97x, Gap=-2.591
Batch  50/537: Loss=1.4323 (C:1.4323, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.208, Ratio=2.04x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.197, Ratio=2.03x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.189, Ratio=1.94x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.186, Ratio=1.90x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.206, Ratio=2.00x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.194, Ratio=2.04x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.191, Ratio=1.96x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.210, Ratio=2.04x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.199, Ratio=2.03x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.192, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.184, Ratio=1.93x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.184, Ratio=1.89x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.213, Ratio=2.06x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.193, Ratio=1.90x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.198, Ratio=1.92x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.205, Ratio=2.01x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.191, Ratio=1.93x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.209, Ratio=1.98x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.189, Ratio=1.94x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.204, Ratio=2.03x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.181, Ratio=1.92x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.180, Ratio=1.93x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.198, Ratio=1.98x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.195, Ratio=1.92x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.200, Ratio=1.97x, Gap=-2.654
Batch  75/537: Loss=1.4333 (C:1.4333, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.190, Ratio=1.97x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.194, Ratio=1.95x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.196, Ratio=2.02x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.207, Ratio=2.03x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.206, Ratio=1.98x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.217, Ratio=2.11x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.210, Ratio=1.98x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.207, Ratio=2.02x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.184, Ratio=1.94x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.196, Ratio=2.01x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.192, Ratio=1.98x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.188, Ratio=2.02x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.182, Ratio=1.94x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.204, Ratio=1.99x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.185, Ratio=1.92x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.225, Ratio=2.11x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.209, Ratio=2.07x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.199, Ratio=1.97x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.210, Ratio=2.06x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.200, Ratio=2.04x, Gap=-2.572
Batch 100/537: Loss=1.4090 (C:1.4090, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.201, Ratio=2.00x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.209, Ratio=2.00x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.200, Ratio=1.99x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.216, Ratio=2.01x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.222, Ratio=2.12x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.202, Ratio=1.92x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.194, Ratio=1.95x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.230, Ratio=2.17x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.216, Ratio=2.09x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.190, Ratio=1.97x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.202, Ratio=2.06x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.196, Ratio=1.97x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.198, Ratio=2.04x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.195, Ratio=1.97x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.198, Ratio=1.95x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.219, Ratio=2.06x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.201, Ratio=1.94x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.223, Ratio=2.10x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.225, Ratio=2.14x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.195, Ratio=1.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.193, Ratio=1.94x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.181, Ratio=1.92x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.188, Ratio=2.00x, Gap=-2.522
Batch 125/537: Loss=1.4283 (C:1.4283, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.196, Ratio=2.04x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.190, Ratio=1.96x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.205, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.194, Ratio=1.96x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.209, Ratio=1.99x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.223, Ratio=2.10x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.209, Ratio=2.00x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.210, Ratio=2.06x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.202, Ratio=1.96x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.223, Ratio=2.12x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.201, Ratio=2.07x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.182, Ratio=1.89x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.193, Ratio=2.04x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.198, Ratio=2.01x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.182, Ratio=1.91x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.204, Ratio=2.02x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.07x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.204, Ratio=1.98x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.212, Ratio=2.08x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.205, Ratio=2.02x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.185, Ratio=1.93x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.196, Ratio=1.99x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.199, Ratio=1.99x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.448
Batch 150/537: Loss=1.4203 (C:1.4203, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.211, Ratio=2.07x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.195, Ratio=1.94x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.190, Ratio=1.96x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.194, Ratio=1.92x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.208, Ratio=2.00x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.203, Ratio=1.98x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.209, Ratio=2.00x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.213, Ratio=2.05x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.199, Ratio=2.02x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.191, Ratio=1.97x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.174, Ratio=1.89x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.204, Ratio=2.04x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.191, Ratio=1.97x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.215, Ratio=2.09x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.212, Ratio=2.04x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.185, Ratio=1.88x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.208, Ratio=1.99x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.211, Ratio=2.03x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.204, Ratio=1.98x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.206, Ratio=2.04x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.196, Ratio=2.01x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.432
Batch 175/537: Loss=1.4221 (C:1.4221, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.203, Ratio=1.97x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.193, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.195, Ratio=1.99x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.215, Ratio=2.05x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.213, Ratio=2.09x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.206, Ratio=1.97x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.211, Ratio=2.01x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.197, Ratio=1.95x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.203, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.192, Ratio=1.91x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.222, Ratio=2.11x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.198, Ratio=2.01x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.196, Ratio=2.01x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.199, Ratio=2.04x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.192, Ratio=1.93x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.200, Ratio=2.05x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.197, Ratio=2.00x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.197, Ratio=1.91x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.194, Ratio=1.98x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.211, Ratio=2.07x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.201, Ratio=2.03x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.187, Ratio=1.90x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.187, Ratio=1.92x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.199, Ratio=1.99x, Gap=-2.735
Batch 200/537: Loss=1.4285 (C:1.4285, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.213, Ratio=2.01x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.195, Ratio=1.96x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.184, Ratio=1.91x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.198, Ratio=1.95x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.200, Ratio=2.03x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.207, Ratio=2.03x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.195, Ratio=1.97x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.204, Ratio=2.05x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.199, Ratio=2.01x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.213, Ratio=2.11x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.201, Ratio=2.06x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.210, Ratio=2.06x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.186, Ratio=1.93x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.193, Ratio=2.00x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.199, Ratio=2.02x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.207, Ratio=2.04x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.216, Ratio=2.08x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.220, Ratio=2.13x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.218, Ratio=2.02x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.186, Ratio=1.97x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=1.99x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.184, Ratio=1.91x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.193, Ratio=1.96x, Gap=-2.425
Batch 225/537: Loss=1.4389 (C:1.4389, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.197, Ratio=2.05x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.190, Ratio=1.93x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.203, Ratio=2.00x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.197, Ratio=2.04x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.195, Ratio=1.95x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=1.99x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.196, Ratio=1.93x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.225, Ratio=2.13x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.196, Ratio=1.93x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.209, Ratio=2.08x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.203, Ratio=1.99x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.188, Ratio=1.92x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.207, Ratio=2.02x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.199, Ratio=1.96x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.210, Ratio=2.03x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.210, Ratio=2.03x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.195, Ratio=1.93x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.202, Ratio=2.00x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.208, Ratio=2.04x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.194, Ratio=1.96x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.227, Ratio=2.19x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.188, Ratio=2.00x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.196, Ratio=2.02x, Gap=-2.724
Batch 250/537: Loss=1.4180 (C:1.4180, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.202, Ratio=1.99x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.193, Ratio=1.95x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.208, Ratio=2.07x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.199, Ratio=2.00x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.215, Ratio=2.10x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.197, Ratio=2.01x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.189, Ratio=1.97x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.209, Ratio=2.06x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.205, Ratio=2.07x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.217, Ratio=2.06x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.200, Ratio=1.97x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.205, Ratio=2.04x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.217, Ratio=2.12x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.191, Ratio=1.93x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.196, Ratio=2.00x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.198, Ratio=1.99x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.201, Ratio=2.05x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=1.99x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.197, Ratio=1.94x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.221, Ratio=2.08x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.200, Ratio=1.93x, Gap=-2.489
Batch 275/537: Loss=1.4484 (C:1.4484, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.204, Ratio=1.98x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.214, Ratio=2.06x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.207, Ratio=1.96x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.192, Ratio=1.93x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.180, Ratio=1.93x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.202, Ratio=2.05x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.188, Ratio=1.96x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.182, Ratio=1.91x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.186, Ratio=1.99x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.174, Ratio=1.86x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.215, Ratio=2.07x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.190, Ratio=1.93x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.215, Ratio=2.04x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.211, Ratio=2.00x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.202, Ratio=2.02x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.203, Ratio=2.02x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.183, Ratio=1.88x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.214, Ratio=2.12x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.204, Ratio=2.01x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.187, Ratio=1.95x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.195, Ratio=1.93x, Gap=-2.668
Batch 300/537: Loss=1.4478 (C:1.4478, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.182, Ratio=1.90x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.190, Ratio=1.95x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.182, Ratio=1.89x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.224, Ratio=2.19x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.206, Ratio=2.07x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.210, Ratio=2.06x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.199, Ratio=1.95x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.205, Ratio=2.00x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.190, Ratio=1.91x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.187, Ratio=1.95x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.182, Ratio=1.92x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.191, Ratio=1.93x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.214, Ratio=2.06x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.192, Ratio=1.98x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.205, Ratio=2.06x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.216, Ratio=2.10x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.197, Ratio=1.92x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.196, Ratio=1.96x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.212, Ratio=2.09x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.190, Ratio=1.92x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.202, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.208, Ratio=2.04x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.203, Ratio=2.03x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.735
Batch 325/537: Loss=1.3932 (C:1.3932, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.202, Ratio=2.00x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.204, Ratio=2.04x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.196, Ratio=2.01x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.203, Ratio=1.93x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.189, Ratio=1.90x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.201, Ratio=2.00x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.198, Ratio=2.01x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.196, Ratio=2.00x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.208, Ratio=2.03x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.216, Ratio=2.01x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.202, Ratio=2.05x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.191, Ratio=1.97x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.215, Ratio=2.11x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.186, Ratio=1.94x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.208, Ratio=2.04x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.191, Ratio=1.93x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.209, Ratio=2.10x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.211, Ratio=2.05x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.218, Ratio=2.09x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.218, Ratio=2.10x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.204, Ratio=2.03x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.192, Ratio=1.92x, Gap=-2.425
Batch 350/537: Loss=1.4545 (C:1.4545, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.187, Ratio=1.93x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.193, Ratio=1.92x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.193, Ratio=1.99x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.196, Ratio=2.04x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.196, Ratio=2.03x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.187, Ratio=1.94x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.173, Ratio=1.91x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.204, Ratio=1.98x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.193, Ratio=2.00x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.202, Ratio=2.00x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.211, Ratio=2.08x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.210, Ratio=2.02x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.202, Ratio=2.00x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.185, Ratio=1.96x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.218, Ratio=2.14x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.200, Ratio=2.05x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.207, Ratio=2.02x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.204, Ratio=2.03x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.196, Ratio=1.98x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.195, Ratio=1.95x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.204, Ratio=1.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.215, Ratio=2.08x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.215, Ratio=2.05x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.188, Ratio=1.94x, Gap=-2.452
Batch 375/537: Loss=1.4472 (C:1.4472, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.203, Ratio=1.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.195, Ratio=2.00x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.210, Ratio=2.01x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.204, Ratio=2.01x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.194, Ratio=1.93x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.191, Ratio=1.93x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.188, Ratio=1.91x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.197, Ratio=1.96x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.195, Ratio=2.00x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.204, Ratio=2.08x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.206, Ratio=2.06x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.200, Ratio=1.95x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.202, Ratio=1.98x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.222, Ratio=2.15x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.196, Ratio=1.94x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.208, Ratio=2.06x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.194, Ratio=1.96x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.217, Ratio=2.09x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.188, Ratio=1.90x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.180, Ratio=1.93x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.209, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.195, Ratio=2.00x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.208, Ratio=2.07x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.201, Ratio=2.04x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.211, Ratio=2.08x, Gap=-2.578
Batch 400/537: Loss=1.3945 (C:1.3945, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.202, Ratio=2.03x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.199, Ratio=2.06x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.202, Ratio=1.95x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.213, Ratio=2.03x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.213, Ratio=2.10x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.219, Ratio=2.06x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.215, Ratio=2.07x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.201, Ratio=1.97x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.202, Ratio=1.99x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.204, Ratio=2.06x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.199, Ratio=2.02x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.196, Ratio=1.98x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.186, Ratio=1.91x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.193, Ratio=1.98x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.210, Ratio=2.07x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.184, Ratio=1.88x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.194, Ratio=1.96x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.206, Ratio=1.97x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.213, Ratio=2.05x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.189, Ratio=1.95x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.217, Ratio=2.13x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.206, Ratio=2.06x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.203, Ratio=2.01x, Gap=-2.527
Batch 425/537: Loss=1.4187 (C:1.4187, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.214, Ratio=2.08x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.209, Ratio=2.06x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.210, Ratio=1.99x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.210, Ratio=2.03x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.183, Ratio=1.91x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.201, Ratio=1.98x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.201, Ratio=1.96x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.199, Ratio=1.99x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.197, Ratio=1.96x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.201, Ratio=2.00x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.198, Ratio=1.99x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.205, Ratio=2.03x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.202, Ratio=2.07x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.198, Ratio=1.97x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.06x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.204, Ratio=1.99x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.215, Ratio=2.14x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.208, Ratio=1.98x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.191, Ratio=1.93x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.205, Ratio=2.01x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.185, Ratio=1.91x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.198, Ratio=2.02x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.199, Ratio=1.99x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.457
Batch 450/537: Loss=1.3962 (C:1.3962, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.192, Ratio=1.97x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.208, Ratio=1.98x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.198, Ratio=1.94x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.204, Ratio=2.02x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.181, Ratio=1.90x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.199, Ratio=2.02x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.194, Ratio=1.93x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.199, Ratio=2.00x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.209, Ratio=2.08x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.194, Ratio=2.00x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.186, Ratio=1.98x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.194, Ratio=2.04x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.205, Ratio=1.98x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.199, Ratio=1.95x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.201, Ratio=2.01x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.202, Ratio=2.04x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.204, Ratio=1.97x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.189, Ratio=1.96x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.226, Ratio=2.16x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.213, Ratio=2.01x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.198, Ratio=1.96x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.206, Ratio=2.02x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.190, Ratio=1.92x, Gap=-2.451
Batch 475/537: Loss=1.4538 (C:1.4538, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.213, Ratio=2.10x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.205, Ratio=2.07x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.193, Ratio=2.01x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.230, Ratio=2.19x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.200, Ratio=1.98x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.208, Ratio=2.02x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.211, Ratio=2.05x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.225, Ratio=2.10x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.191, Ratio=1.95x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.199, Ratio=1.95x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.209, Ratio=2.02x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.190, Ratio=1.93x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.196, Ratio=1.97x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.195, Ratio=1.94x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.212, Ratio=2.11x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.208, Ratio=2.02x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.209, Ratio=2.02x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.204, Ratio=1.99x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.189, Ratio=1.94x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.206, Ratio=2.05x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.203, Ratio=2.07x, Gap=-2.559
Batch 500/537: Loss=1.4021 (C:1.4021, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.193, Ratio=1.98x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.184, Ratio=1.95x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.196, Ratio=2.02x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.195, Ratio=1.95x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.191, Ratio=1.97x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.201, Ratio=2.04x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.185, Ratio=1.91x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.209, Ratio=2.07x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.207, Ratio=2.03x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.211, Ratio=2.10x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.211, Ratio=1.99x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.204, Ratio=1.98x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.194, Ratio=1.99x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.203, Ratio=2.00x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.208, Ratio=2.00x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.211, Ratio=2.05x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.208, Ratio=2.05x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.204, Ratio=2.01x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.193, Ratio=1.96x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.195, Ratio=1.96x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.202, Ratio=1.97x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.208, Ratio=2.04x, Gap=-2.596
Batch 525/537: Loss=1.4087 (C:1.4087, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.220, Ratio=2.17x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.198, Ratio=2.01x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.195, Ratio=1.97x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.194, Ratio=1.93x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.202, Ratio=2.00x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.204, Ratio=2.01x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.208, Ratio=2.05x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.212, Ratio=2.07x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.205, Ratio=2.02x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.214, Ratio=2.04x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.194, Ratio=1.93x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.218, Ratio=2.09x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.217, Ratio=2.06x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.223, Ratio=2.09x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.219, Ratio=2.13x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.218, Ratio=2.13x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.203, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.192, Ratio=1.94x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.213, Ratio=2.05x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.210, Ratio=2.11x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.232, Ratio=2.13x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.203, Ratio=1.99x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.213, Ratio=2.03x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.206, Ratio=2.01x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.202, Ratio=1.97x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.195, Ratio=1.95x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.212, Ratio=2.03x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.219, Ratio=2.11x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.197, Ratio=2.00x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.00x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.204, Ratio=2.01x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.202, Ratio=1.98x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.214, Ratio=2.07x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.216, Ratio=2.07x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.223, Ratio=2.08x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.221, Ratio=2.10x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.190, Ratio=1.93x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.209, Ratio=2.04x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.214, Ratio=2.02x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.204, Ratio=1.99x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.201, Ratio=2.02x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.224, Ratio=2.09x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.207, Ratio=1.99x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.214, Ratio=2.05x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.214, Ratio=2.07x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.221, Ratio=2.12x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.205, Ratio=2.03x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.212, Ratio=2.03x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.207, Ratio=2.08x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.211, Ratio=2.04x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.210, Ratio=2.10x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.211, Ratio=2.06x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.222, Ratio=2.10x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.197, Ratio=1.92x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.226, Ratio=2.17x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.211, Ratio=2.03x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.207, Ratio=2.01x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.210, Ratio=2.02x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.210, Ratio=2.02x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.227, Ratio=2.13x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.209, Ratio=1.99x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.205, Ratio=2.02x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.229, Ratio=2.17x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.205, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.200, Ratio=1.97x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.219, Ratio=2.06x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.211, Ratio=2.09x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.203, Ratio=2.03x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.216, Ratio=2.06x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.220, Ratio=2.11x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.195, Ratio=2.01x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.213, Ratio=2.01x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.210, Ratio=2.03x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.04x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=2.00x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.214, Ratio=2.04x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.220, Ratio=2.12x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.217, Ratio=2.09x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.210, Ratio=2.00x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.201, Ratio=1.97x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.219, Ratio=2.15x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.205, Ratio=2.03x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.214, Ratio=2.11x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.215, Ratio=2.05x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.222, Ratio=2.11x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.211, Ratio=2.00x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.199, Ratio=2.02x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.212, Ratio=2.03x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.205, Ratio=2.04x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.203, Ratio=2.03x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.214, Ratio=2.11x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.214, Ratio=2.00x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.216, Ratio=2.09x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.226, Ratio=2.17x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.211, Ratio=2.07x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.217, Ratio=2.05x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.202, Ratio=2.03x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.232, Ratio=2.21x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.208, Ratio=2.01x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.226, Ratio=2.11x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.205, Ratio=1.97x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.215, Ratio=2.06x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.201, Ratio=1.95x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.209, Ratio=2.04x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.200, Ratio=1.96x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.187, Ratio=1.90x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.210, Ratio=2.03x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.220, Ratio=2.07x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.214, Ratio=2.03x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.218, Ratio=2.09x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.206, Ratio=2.04x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.08x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.196, Ratio=1.96x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.222, Ratio=2.07x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.194, Ratio=1.95x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.201, Ratio=1.95x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.226, Ratio=2.13x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.189, Ratio=1.94x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.213, Ratio=2.04x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.212, Ratio=2.05x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.197, Ratio=2.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.205, Ratio=2.05x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.205, Ratio=2.00x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.213, Ratio=2.09x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.209, Ratio=2.02x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.220, Ratio=2.04x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.215, Ratio=2.08x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.201, Ratio=1.95x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.225, Ratio=2.14x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.210, Ratio=2.09x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.09x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.214, Ratio=2.03x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.219, Ratio=2.05x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.211, Ratio=2.04x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.206, Ratio=2.05x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.222, Ratio=2.05x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.203, Ratio=2.00x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.207, Ratio=2.01x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.201, Ratio=2.06x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.215, Ratio=2.07x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.211, Ratio=2.08x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.206, Ratio=1.99x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.215, Ratio=2.00x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.226, Ratio=2.11x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.220, Ratio=2.10x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.203, Ratio=1.97x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.210, Ratio=2.02x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.222, Ratio=2.14x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.212, Ratio=2.05x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.195, Ratio=1.93x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.213, Ratio=2.02x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.189, Ratio=1.97x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.222, Ratio=2.13x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.225, Ratio=2.10x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.218, Ratio=2.02x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.199, Ratio=1.94x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.209, Ratio=2.07x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.194, Ratio=1.96x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.212, Ratio=2.06x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.216, Ratio=2.15x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.209, Ratio=2.03x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.219, Ratio=2.13x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.213, Ratio=2.03x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.208, Ratio=2.07x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.221, Ratio=2.10x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.190, Ratio=1.99x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.212, Ratio=2.03x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.199, Ratio=1.94x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.203, Ratio=1.99x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.206, Ratio=2.03x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.207, Ratio=2.01x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.216, Ratio=2.09x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.220, Ratio=2.13x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.225, Ratio=2.15x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.202, Ratio=1.96x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.209, Ratio=1.99x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.211, Ratio=2.01x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.189, Ratio=1.89x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.201, Ratio=1.96x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.207, Ratio=2.05x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.220, Ratio=2.08x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.196, Ratio=1.94x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.199, Ratio=1.99x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.210, Ratio=2.02x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.210, Ratio=2.04x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.223, Ratio=2.19x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.215, Ratio=2.05x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.224, Ratio=2.12x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.219, Ratio=2.13x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.206, Ratio=2.02x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.206, Ratio=2.02x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.204, Ratio=2.01x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.200, Ratio=1.95x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.214, Ratio=2.04x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.215, Ratio=2.01x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.203, Ratio=1.99x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.211, Ratio=1.98x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.215, Ratio=2.12x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.203, Ratio=2.06x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.199, Ratio=2.04x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.210, Ratio=1.99x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.221, Ratio=2.10x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.193, Ratio=2.00x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.220, Ratio=2.08x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.211, Ratio=2.03x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.200, Ratio=2.01x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.214, Ratio=2.09x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.205, Ratio=2.01x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.217, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.218, Ratio=2.10x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.224, Ratio=2.16x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.219, Ratio=2.14x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.01x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.209, Ratio=2.07x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.216, Ratio=2.08x, Gap=-2.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.208, Ratio=2.07x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.226, Ratio=2.15x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.208, Ratio=2.01x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.207, Ratio=1.98x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.204, Ratio=1.98x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.197, Ratio=1.99x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.213, Ratio=2.02x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.224, Ratio=2.13x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.204, Ratio=2.06x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.202, Ratio=2.04x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.211, Ratio=2.03x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.221, Ratio=2.11x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.203, Ratio=1.99x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.225, Ratio=2.11x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.227, Ratio=2.12x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.211, Ratio=2.05x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.199, Ratio=1.95x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.207, Ratio=2.02x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.228, Ratio=2.11x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.215, Ratio=2.03x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.205, Ratio=2.00x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.212, Ratio=2.07x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.208, Ratio=2.09x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.216, Ratio=2.13x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.207, Ratio=2.04x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.203, Ratio=2.05x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.213, Ratio=2.10x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.233, Ratio=2.12x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.210, Ratio=2.06x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.217, Ratio=2.07x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.226, Ratio=2.14x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.200, Ratio=2.01x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.224, Ratio=2.14x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.203, Ratio=2.10x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.04x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.08x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.209, Ratio=2.06x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.203, Ratio=1.99x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.201, Ratio=1.98x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.219, Ratio=2.09x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.209, Ratio=2.00x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.214, Ratio=2.10x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.211, Ratio=2.00x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.202, Ratio=2.00x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.225, Ratio=2.14x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.196, Ratio=1.98x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.222, Ratio=2.11x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.227, Ratio=2.15x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.205, Ratio=1.98x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.199, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.211, Ratio=2.01x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.199, Ratio=1.96x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.222, Ratio=2.07x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.208, Ratio=2.08x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.221, Ratio=2.12x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.216, Ratio=2.11x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.196, Ratio=1.96x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.226, Ratio=2.11x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.229, Ratio=2.18x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.210, Ratio=2.09x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.212, Ratio=2.04x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.213, Ratio=2.09x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.203, Ratio=1.99x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.199, Ratio=1.95x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.217, Ratio=2.12x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.218, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.219, Ratio=2.07x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.183, Ratio=1.89x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.217, Ratio=2.07x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.221, Ratio=2.08x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.207, Ratio=2.07x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.215, Ratio=2.07x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.193, Ratio=1.93x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.220, Ratio=2.08x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.208, Ratio=2.04x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.220, Ratio=2.12x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.226, Ratio=2.06x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.213, Ratio=2.08x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.208, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.216, Ratio=2.03x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.198, Ratio=2.00x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.205, Ratio=2.01x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.206, Ratio=1.93x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.06x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.204, Ratio=1.98x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.224, Ratio=2.13x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.217, Ratio=2.05x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.203, Ratio=2.04x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.215, Ratio=2.05x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.222, Ratio=2.17x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.215, Ratio=2.05x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.209, Ratio=2.01x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.211, Ratio=2.04x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.216, Ratio=2.07x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.192, Ratio=2.01x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.216, Ratio=2.04x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.231, Ratio=2.16x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.201, Ratio=2.04x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.211, Ratio=2.00x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.221, Ratio=2.15x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.205, Ratio=2.01x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.219, Ratio=2.07x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.222, Ratio=2.15x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.213, Ratio=2.11x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.206, Ratio=2.05x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.225, Ratio=2.11x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.222, Ratio=2.08x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.219, Ratio=2.07x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.199, Ratio=2.00x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.212, Ratio=2.03x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.220, Ratio=2.12x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.196, Ratio=1.94x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.06x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.210, Ratio=2.01x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.226, Ratio=2.15x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.210, Ratio=2.00x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.213, Ratio=2.03x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.197, Ratio=1.93x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.201, Ratio=1.96x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.03x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.198, Ratio=1.94x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.220, Ratio=2.09x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.221, Ratio=2.10x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.206, Ratio=1.97x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.210, Ratio=2.01x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.217, Ratio=2.04x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.220, Ratio=2.11x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.194, Ratio=1.95x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.221, Ratio=2.15x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.215, Ratio=2.06x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.203, Ratio=1.98x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.207, Ratio=2.02x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.207, Ratio=2.00x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.215, Ratio=2.04x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.207, Ratio=2.06x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.231, Ratio=2.10x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.227, Ratio=2.14x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.211, Ratio=2.07x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.190, Ratio=1.91x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.210, Ratio=2.04x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.219, Ratio=2.08x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.212, Ratio=2.11x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.223, Ratio=2.11x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.221, Ratio=2.10x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.191, Ratio=1.92x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.211, Ratio=2.09x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.211, Ratio=2.07x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.232, Ratio=2.20x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.193, Ratio=1.97x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.223, Ratio=2.13x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.216, Ratio=2.03x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.217, Ratio=2.14x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.200, Ratio=1.99x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.222, Ratio=2.13x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.215, Ratio=2.10x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.218, Ratio=2.07x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.235, Ratio=2.21x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.203, Ratio=2.00x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.224, Ratio=2.11x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.216, Ratio=2.09x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.219, Ratio=2.09x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.215, Ratio=2.08x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.225, Ratio=2.09x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.205, Ratio=1.96x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.204, Ratio=1.98x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.217, Ratio=2.09x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.214, Ratio=2.10x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.187, Ratio=1.93x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.191, Ratio=1.94x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.208, Ratio=2.02x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.215, Ratio=2.10x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.213, Ratio=2.04x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.195, Ratio=1.95x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.208, Ratio=2.06x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.192, Ratio=1.94x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.220, Ratio=2.13x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.205, Ratio=1.96x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.216, Ratio=2.06x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.234, Ratio=2.15x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.216, Ratio=2.11x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.208, Ratio=1.99x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.204, Ratio=1.99x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.213, Ratio=2.10x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.214, Ratio=2.06x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.224, Ratio=2.09x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.195, Ratio=1.94x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.216, Ratio=2.02x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.209, Ratio=2.01x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.218, Ratio=2.11x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.208, Ratio=2.04x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.211, Ratio=2.02x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.213, Ratio=2.03x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.196, Ratio=1.99x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.206, Ratio=1.99x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.220, Ratio=2.09x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.220, Ratio=2.06x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.207, Ratio=2.04x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.210, Ratio=2.03x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.206, Ratio=2.08x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.02x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.214, Ratio=2.11x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.217, Ratio=2.10x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.216, Ratio=2.06x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.213, Ratio=2.12x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.03x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.221, Ratio=2.12x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.204, Ratio=1.99x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.196, Ratio=1.94x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.223, Ratio=2.13x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.216, Ratio=2.08x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.218, Ratio=2.08x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.198, Ratio=2.03x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.197, Ratio=1.95x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.221, Ratio=2.08x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.219, Ratio=2.09x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=2.00x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.219, Ratio=2.06x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.209, Ratio=2.04x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.202, Ratio=2.00x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.193, Ratio=1.97x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.211, Ratio=2.03x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.00x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.208, Ratio=2.06x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.211, Ratio=2.01x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.204, Ratio=1.99x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.211, Ratio=2.02x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.220, Ratio=2.09x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.232, Ratio=2.16x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.207, Ratio=2.01x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.196, Ratio=2.00x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.226, Ratio=2.09x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.204, Ratio=2.02x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.203, Ratio=2.03x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.219, Ratio=2.03x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.215, Ratio=2.06x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.223, Ratio=2.08x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.220, Ratio=2.09x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.221, Ratio=2.09x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.211, Ratio=2.05x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.213, Ratio=2.02x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.201, Ratio=1.96x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.210, Ratio=2.03x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.195, Ratio=1.98x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.228, Ratio=2.17x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.218, Ratio=2.12x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.212, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.220, Ratio=2.10x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.206, Ratio=2.01x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.221, Ratio=2.10x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.202, Ratio=2.07x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.215, Ratio=2.04x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.213, Ratio=2.04x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.199, Ratio=2.04x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.204, Ratio=2.04x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.200, Ratio=1.99x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.219, Ratio=2.11x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.200, Ratio=1.97x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.217, Ratio=2.07x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.200, Ratio=1.98x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.216, Ratio=2.10x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.211, Ratio=2.11x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.202, Ratio=2.01x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.217, Ratio=2.13x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.205, Ratio=2.02x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.209, Ratio=2.04x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.216, Ratio=2.08x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.216, Ratio=2.10x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.214, Ratio=2.06x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.205, Ratio=1.99x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.225, Ratio=2.11x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.214, Ratio=2.04x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.217, Ratio=2.14x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.211, Ratio=2.02x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.208, Ratio=2.05x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.216, Ratio=2.05x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.208, Ratio=2.06x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.206, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.214, Ratio=2.06x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.214, Ratio=2.00x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.192, Ratio=1.94x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.236, Ratio=2.19x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.192, Ratio=1.97x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.224, Ratio=2.10x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.221, Ratio=2.08x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.194, Ratio=1.93x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.225, Ratio=2.13x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.202, Ratio=2.05x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=2.00x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.217, Ratio=2.08x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.218, Ratio=2.10x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.210, Ratio=2.00x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.203, Ratio=2.01x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.213, Ratio=2.05x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.203, Ratio=1.99x, Gap=-2.338

============================================================
Epoch 5/20 completed in 29.9s
Train: Loss=1.4225 (C:1.4225, R:0.0018) Ratio=2.02x
Val:   Loss=1.4065 (C:1.4065, R:0.0018) Ratio=2.15x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.4065)
Checkpoint saved at epoch 5
============================================================

Epoch 6 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.203, Ratio=2.02x, Gap=-2.860
Batch   0/537: Loss=1.4184 (C:1.4184, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.234, Ratio=2.12x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.199, Ratio=1.99x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.202, Ratio=1.98x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.217, Ratio=2.05x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.204, Ratio=2.08x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.205, Ratio=2.05x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.200, Ratio=2.04x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.211, Ratio=2.09x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.199, Ratio=1.97x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.211, Ratio=2.06x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.206, Ratio=1.99x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.206, Ratio=2.00x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.05x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.196, Ratio=1.92x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.209, Ratio=2.09x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.188, Ratio=1.91x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.201, Ratio=1.97x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.203, Ratio=2.04x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.190, Ratio=2.00x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.192, Ratio=1.97x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.202, Ratio=2.02x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.215, Ratio=2.12x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.189, Ratio=1.88x, Gap=-2.457
Batch  25/537: Loss=1.4675 (C:1.4675, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.199, Ratio=1.96x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.207, Ratio=1.96x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.211, Ratio=2.05x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.196, Ratio=1.90x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.205, Ratio=2.02x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.192, Ratio=1.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.203, Ratio=2.12x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.223, Ratio=2.18x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.198, Ratio=2.01x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.199, Ratio=1.98x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.217, Ratio=2.10x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.193, Ratio=1.96x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.206, Ratio=2.03x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.203, Ratio=2.01x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.197, Ratio=1.95x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.199, Ratio=2.01x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.205, Ratio=2.01x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.219, Ratio=2.12x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.213, Ratio=2.02x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.192, Ratio=1.99x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.185, Ratio=1.91x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.195, Ratio=1.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.217, Ratio=2.11x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.197, Ratio=1.99x, Gap=-2.457
Batch  50/537: Loss=1.4276 (C:1.4276, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.224, Ratio=2.09x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.197, Ratio=2.00x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.207, Ratio=2.07x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.199, Ratio=1.97x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.212, Ratio=2.07x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.185, Ratio=1.89x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.188, Ratio=1.92x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.198, Ratio=1.98x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.196, Ratio=1.93x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.201, Ratio=1.96x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.208, Ratio=2.06x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.194, Ratio=1.98x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.210, Ratio=2.04x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.204, Ratio=2.09x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.197, Ratio=1.97x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.205, Ratio=2.06x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.202, Ratio=2.03x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.212, Ratio=2.06x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.220, Ratio=2.06x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.189, Ratio=1.90x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.194, Ratio=1.93x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.212, Ratio=2.10x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.202, Ratio=2.01x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.208, Ratio=2.09x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.210, Ratio=2.00x, Gap=-2.699
Batch  75/537: Loss=1.4180 (C:1.4180, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.210, Ratio=2.08x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.199, Ratio=2.02x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.190, Ratio=1.91x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.212, Ratio=2.06x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.220, Ratio=2.06x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.223, Ratio=2.12x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.196, Ratio=1.95x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.197, Ratio=1.97x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.209, Ratio=2.08x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.188, Ratio=1.95x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.198, Ratio=1.98x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.206, Ratio=2.07x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.211, Ratio=2.08x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.195, Ratio=2.00x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.198, Ratio=1.95x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.209, Ratio=2.07x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.194, Ratio=1.96x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.212, Ratio=2.03x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.190, Ratio=1.91x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.220, Ratio=2.07x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.190, Ratio=1.89x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.207, Ratio=2.01x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.200, Ratio=1.97x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.193, Ratio=1.97x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.213, Ratio=2.07x, Gap=-2.813
Batch 100/537: Loss=1.3996 (C:1.3996, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.203, Ratio=2.06x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.232, Ratio=2.17x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.219, Ratio=2.08x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.182, Ratio=1.93x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.220, Ratio=2.09x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.220, Ratio=2.11x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.196, Ratio=1.99x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.212, Ratio=2.07x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.193, Ratio=2.01x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.202, Ratio=2.07x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.202, Ratio=2.01x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.201, Ratio=1.96x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.207, Ratio=2.08x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.209, Ratio=2.06x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.186, Ratio=1.97x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.197, Ratio=2.00x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.211, Ratio=2.02x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.195, Ratio=1.99x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.197, Ratio=2.04x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.203, Ratio=2.00x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.209, Ratio=2.00x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.191, Ratio=2.00x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.220, Ratio=2.14x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.223, Ratio=2.14x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.204, Ratio=2.04x, Gap=-2.790
Batch 125/537: Loss=1.4133 (C:1.4133, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.211, Ratio=2.05x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.214, Ratio=2.06x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.202, Ratio=1.99x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.208, Ratio=2.05x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.196, Ratio=2.00x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.200, Ratio=1.97x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.201, Ratio=2.05x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.204, Ratio=2.08x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.201, Ratio=1.99x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.235, Ratio=2.15x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.212, Ratio=2.04x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.204, Ratio=2.01x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.211, Ratio=2.01x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.204, Ratio=2.00x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.217, Ratio=2.10x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.214, Ratio=2.10x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.207, Ratio=2.02x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.206, Ratio=2.03x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.216, Ratio=2.10x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.208, Ratio=2.00x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.206, Ratio=2.00x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.190, Ratio=1.91x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.211, Ratio=2.04x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.388
Batch 150/537: Loss=1.3826 (C:1.3826, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.194, Ratio=2.00x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.207, Ratio=1.99x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.194, Ratio=1.99x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.196, Ratio=1.99x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.188, Ratio=1.93x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.202, Ratio=2.02x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.196, Ratio=1.97x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.209, Ratio=2.13x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.197, Ratio=2.00x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.221, Ratio=2.11x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.213, Ratio=2.05x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.191, Ratio=1.94x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.205, Ratio=2.10x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.211, Ratio=2.09x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.217, Ratio=2.03x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.202, Ratio=1.99x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.200, Ratio=1.98x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.225, Ratio=2.13x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.209, Ratio=2.01x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.202, Ratio=2.02x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.745
Batch 175/537: Loss=1.4411 (C:1.4411, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.171, Ratio=1.85x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.204, Ratio=2.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.203, Ratio=2.02x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.207, Ratio=2.04x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.224, Ratio=2.12x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.193, Ratio=1.96x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.195, Ratio=1.98x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.197, Ratio=2.01x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.204, Ratio=1.96x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.208, Ratio=2.06x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.207, Ratio=2.02x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.202, Ratio=1.97x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.208, Ratio=2.02x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.197, Ratio=2.03x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.194, Ratio=1.97x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.212, Ratio=2.08x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.193, Ratio=2.01x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.214, Ratio=2.10x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.213, Ratio=2.06x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.228, Ratio=2.18x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.205, Ratio=2.00x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.208, Ratio=2.02x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.210, Ratio=2.01x, Gap=-2.713
Batch 200/537: Loss=1.4171 (C:1.4171, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.05x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.199, Ratio=1.99x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.203, Ratio=2.03x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.212, Ratio=2.09x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.204, Ratio=2.07x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.204, Ratio=2.03x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.210, Ratio=2.07x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.201, Ratio=2.03x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.188, Ratio=1.97x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.212, Ratio=2.08x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.201, Ratio=1.99x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.211, Ratio=2.05x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.196, Ratio=1.98x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.236, Ratio=2.20x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.213, Ratio=2.05x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.218, Ratio=2.11x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.204, Ratio=2.00x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.205, Ratio=2.05x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.205, Ratio=2.06x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.191, Ratio=1.96x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.190, Ratio=1.99x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.197, Ratio=1.98x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.226, Ratio=2.10x, Gap=-2.552
Batch 225/537: Loss=1.3854 (C:1.3854, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.207, Ratio=2.04x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.210, Ratio=2.05x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.211, Ratio=2.01x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.222, Ratio=2.12x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.210, Ratio=2.07x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.193, Ratio=1.96x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.201, Ratio=2.02x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.213, Ratio=2.05x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.199, Ratio=2.01x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.202, Ratio=1.97x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.202, Ratio=1.99x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.217, Ratio=2.08x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.190, Ratio=1.94x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.211, Ratio=2.02x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.204, Ratio=1.99x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.206, Ratio=2.04x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.202, Ratio=1.97x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.204, Ratio=2.07x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.211, Ratio=2.07x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.202, Ratio=2.01x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.192, Ratio=2.00x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.209, Ratio=2.09x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.198, Ratio=1.97x, Gap=-2.636
Batch 250/537: Loss=1.4341 (C:1.4341, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.00x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.201, Ratio=1.97x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.193, Ratio=1.97x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.225, Ratio=2.08x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.06x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.197, Ratio=2.01x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.194, Ratio=1.98x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.213, Ratio=2.16x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.223, Ratio=2.11x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.03x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.210, Ratio=2.12x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.202, Ratio=1.99x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.204, Ratio=1.97x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.207, Ratio=2.06x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.194, Ratio=1.99x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.213, Ratio=2.10x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.196, Ratio=1.93x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.193, Ratio=1.95x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.206, Ratio=2.07x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.195, Ratio=1.98x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.225, Ratio=2.16x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.208, Ratio=2.00x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.198, Ratio=1.93x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.217, Ratio=2.04x, Gap=-2.792
Batch 275/537: Loss=1.4067 (C:1.4067, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.228, Ratio=2.11x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.218, Ratio=2.03x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.205, Ratio=1.99x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.186, Ratio=1.92x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.193, Ratio=1.97x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.07x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.208, Ratio=2.03x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.196, Ratio=1.97x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.206, Ratio=2.12x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.192, Ratio=1.96x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.06x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.211, Ratio=2.03x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.200, Ratio=1.99x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.195, Ratio=2.00x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.214, Ratio=2.10x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.210, Ratio=2.01x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.215, Ratio=2.10x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.200, Ratio=1.98x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.216, Ratio=2.03x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.193, Ratio=1.99x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.210, Ratio=2.03x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.219, Ratio=2.07x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.201, Ratio=2.00x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.204, Ratio=2.03x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.217, Ratio=2.05x, Gap=-2.562
Batch 300/537: Loss=1.4016 (C:1.4016, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.210, Ratio=2.02x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.222, Ratio=2.17x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.199, Ratio=1.97x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.194, Ratio=2.02x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.194, Ratio=2.02x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.180, Ratio=1.89x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.191, Ratio=1.97x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.204, Ratio=2.04x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.198, Ratio=1.98x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.213, Ratio=2.03x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.201, Ratio=1.95x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.211, Ratio=2.08x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.209, Ratio=2.02x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.196, Ratio=1.96x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.212, Ratio=2.12x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.216, Ratio=2.03x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.224, Ratio=2.18x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.03x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.198, Ratio=2.01x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.203, Ratio=2.06x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.207, Ratio=2.02x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.194, Ratio=1.96x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.200, Ratio=1.98x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.208, Ratio=2.03x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.203, Ratio=2.03x, Gap=-2.803
Batch 325/537: Loss=1.4137 (C:1.4137, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.204, Ratio=1.94x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.208, Ratio=2.13x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.207, Ratio=2.04x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.206, Ratio=1.97x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.207, Ratio=2.08x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.205, Ratio=1.98x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.214, Ratio=2.06x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.213, Ratio=2.04x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.197, Ratio=1.99x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.191, Ratio=1.99x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.196, Ratio=2.02x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.211, Ratio=2.06x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.209, Ratio=2.03x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.205, Ratio=2.03x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.216, Ratio=2.13x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.203, Ratio=2.01x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.213, Ratio=1.99x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.219, Ratio=2.07x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.218, Ratio=2.07x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.209, Ratio=2.12x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.216, Ratio=2.12x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.612
Batch 350/537: Loss=1.3930 (C:1.3930, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.209, Ratio=2.03x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.203, Ratio=1.98x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.214, Ratio=2.05x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.218, Ratio=2.09x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.202, Ratio=2.00x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.218, Ratio=2.08x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.211, Ratio=2.07x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.216, Ratio=2.06x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.231, Ratio=2.16x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.200, Ratio=2.04x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.207, Ratio=2.02x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.191, Ratio=1.98x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.211, Ratio=2.10x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.218, Ratio=2.07x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.223, Ratio=2.07x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.209, Ratio=2.07x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.226, Ratio=2.16x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.203, Ratio=2.02x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.211, Ratio=2.04x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.213, Ratio=2.04x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.217, Ratio=2.11x, Gap=-2.575
Batch 375/537: Loss=1.3852 (C:1.3852, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.200, Ratio=2.03x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.197, Ratio=2.01x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.209, Ratio=2.01x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.203, Ratio=2.04x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.196, Ratio=1.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.210, Ratio=2.02x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.210, Ratio=2.01x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.214, Ratio=2.10x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.195, Ratio=2.00x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.197, Ratio=1.97x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.196, Ratio=1.99x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.190, Ratio=1.98x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.218, Ratio=2.07x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.188, Ratio=1.90x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.202, Ratio=2.02x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.185, Ratio=1.99x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.212, Ratio=2.08x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.184, Ratio=1.94x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.198, Ratio=1.96x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.215, Ratio=2.09x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.193, Ratio=1.93x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.195, Ratio=1.99x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.204, Ratio=2.00x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.193, Ratio=1.96x, Gap=-2.618
Batch 400/537: Loss=1.4397 (C:1.4397, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.218, Ratio=2.10x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.205, Ratio=2.01x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.03x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.211, Ratio=2.11x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.199, Ratio=1.97x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=2.00x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.226, Ratio=2.11x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.204, Ratio=2.05x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.214, Ratio=2.05x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.212, Ratio=2.06x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.200, Ratio=1.98x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.219, Ratio=2.18x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.219, Ratio=2.10x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.207, Ratio=2.10x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.222, Ratio=2.08x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.227, Ratio=2.16x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.203, Ratio=1.98x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.210, Ratio=2.05x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.221, Ratio=2.12x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.216, Ratio=2.08x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.201, Ratio=2.05x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.214, Ratio=2.08x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.193, Ratio=2.01x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.199, Ratio=2.03x, Gap=-2.514
Batch 425/537: Loss=1.4168 (C:1.4168, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.196, Ratio=1.98x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.216, Ratio=2.11x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.201, Ratio=1.98x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.212, Ratio=2.08x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.206, Ratio=1.99x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.219, Ratio=2.09x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.218, Ratio=2.08x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.206, Ratio=2.11x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.203, Ratio=2.00x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.200, Ratio=2.03x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.223, Ratio=2.09x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.190, Ratio=1.89x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.195, Ratio=2.01x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.203, Ratio=2.00x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.222, Ratio=2.10x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.198, Ratio=1.97x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.218, Ratio=2.04x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.226, Ratio=2.06x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.195, Ratio=1.96x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.216, Ratio=2.05x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.217, Ratio=2.10x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.209, Ratio=2.04x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.217, Ratio=2.11x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.209, Ratio=2.04x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.205, Ratio=2.02x, Gap=-2.475
Batch 450/537: Loss=1.4140 (C:1.4140, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.211, Ratio=2.10x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.204, Ratio=2.10x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.199, Ratio=2.02x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.194, Ratio=1.99x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.218, Ratio=2.08x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.223, Ratio=2.09x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.196, Ratio=1.99x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.204, Ratio=2.01x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.197, Ratio=1.98x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.202, Ratio=2.02x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.210, Ratio=2.02x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.194, Ratio=2.00x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.216, Ratio=2.09x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.198, Ratio=2.03x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.195, Ratio=2.03x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.198, Ratio=1.99x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.208, Ratio=2.04x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.211, Ratio=2.02x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.221, Ratio=2.09x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.192, Ratio=1.95x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.201, Ratio=2.00x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.225, Ratio=2.15x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.208, Ratio=2.02x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.210, Ratio=2.02x, Gap=-2.469
Batch 475/537: Loss=1.4146 (C:1.4146, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.211, Ratio=2.03x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.215, Ratio=2.08x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.223, Ratio=2.13x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.199, Ratio=2.02x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.205, Ratio=1.98x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.217, Ratio=2.16x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.197, Ratio=1.97x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.199, Ratio=2.01x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.206, Ratio=2.02x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.197, Ratio=2.01x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.210, Ratio=2.01x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.220, Ratio=2.10x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.198, Ratio=2.03x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.199, Ratio=1.98x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.206, Ratio=2.02x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.201, Ratio=2.00x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.196, Ratio=1.94x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.224, Ratio=2.05x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.208, Ratio=2.02x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.203, Ratio=2.05x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.193, Ratio=2.04x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.197, Ratio=2.02x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.211, Ratio=2.06x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.208, Ratio=2.06x, Gap=-2.638
Batch 500/537: Loss=1.4033 (C:1.4033, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.196, Ratio=2.00x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.216, Ratio=2.05x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.228, Ratio=2.19x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.209, Ratio=2.07x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.205, Ratio=2.00x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.217, Ratio=2.10x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.213, Ratio=2.06x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.210, Ratio=1.98x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.213, Ratio=2.05x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.229, Ratio=2.12x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.223, Ratio=2.08x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.220, Ratio=2.12x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.203, Ratio=1.99x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.208, Ratio=2.05x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.199, Ratio=1.95x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.226, Ratio=2.09x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.208, Ratio=2.08x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.228, Ratio=2.12x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.216, Ratio=2.06x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.189, Ratio=1.94x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.195, Ratio=1.96x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.217, Ratio=2.08x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.226, Ratio=2.12x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.209, Ratio=2.04x, Gap=-2.537
Batch 525/537: Loss=1.4097 (C:1.4097, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.201, Ratio=1.98x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.212, Ratio=2.10x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.203, Ratio=2.05x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.230, Ratio=2.17x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.198, Ratio=2.03x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.219, Ratio=2.15x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.210, Ratio=2.10x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.208, Ratio=2.03x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.209, Ratio=2.08x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.230, Ratio=2.13x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.220, Ratio=2.14x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.220, Ratio=2.19x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.205, Ratio=2.04x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.193, Ratio=2.00x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.202, Ratio=2.03x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.214, Ratio=2.12x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.199, Ratio=2.00x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.200, Ratio=1.99x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.213, Ratio=2.06x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.207, Ratio=2.10x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.210, Ratio=2.08x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.224, Ratio=2.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.215, Ratio=2.11x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.210, Ratio=2.08x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.213, Ratio=2.08x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.223, Ratio=2.14x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.192, Ratio=1.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.208, Ratio=2.03x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.196, Ratio=2.07x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.206, Ratio=2.11x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.212, Ratio=2.08x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.213, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.205, Ratio=2.00x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.193, Ratio=1.99x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.198, Ratio=1.97x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.218, Ratio=2.10x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.213, Ratio=2.11x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.213, Ratio=2.08x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.216, Ratio=2.05x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.207, Ratio=2.04x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.210, Ratio=2.04x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.199, Ratio=1.93x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.218, Ratio=2.09x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.207, Ratio=2.05x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.212, Ratio=2.10x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.196, Ratio=1.96x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.218, Ratio=2.14x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.219, Ratio=2.08x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.213, Ratio=2.04x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.217, Ratio=2.13x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.204, Ratio=2.06x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.223, Ratio=2.23x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.201, Ratio=2.01x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.196, Ratio=2.01x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.207, Ratio=2.10x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.212, Ratio=2.08x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.209, Ratio=2.09x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.203, Ratio=2.01x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.234, Ratio=2.23x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.221, Ratio=2.10x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.205, Ratio=2.03x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.208, Ratio=2.08x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.207, Ratio=2.06x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.228, Ratio=2.20x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.214, Ratio=2.05x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.218, Ratio=2.08x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.218, Ratio=2.09x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.214, Ratio=2.10x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.223, Ratio=2.14x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.225, Ratio=2.11x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.205, Ratio=2.06x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.208, Ratio=2.01x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.218, Ratio=2.12x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.222, Ratio=2.11x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.193, Ratio=1.98x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.222, Ratio=2.12x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.221, Ratio=2.13x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.213, Ratio=2.06x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.226, Ratio=2.20x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.10x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.222, Ratio=2.14x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.212, Ratio=2.05x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.225, Ratio=2.19x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.203, Ratio=2.02x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.216, Ratio=2.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.204, Ratio=2.07x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.204, Ratio=2.05x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.219, Ratio=2.14x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.207, Ratio=2.02x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.203, Ratio=2.00x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.212, Ratio=2.05x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.227, Ratio=2.17x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.207, Ratio=2.06x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.215, Ratio=2.10x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.205, Ratio=1.98x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.198, Ratio=1.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.225, Ratio=2.21x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.225, Ratio=2.14x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.205, Ratio=2.03x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.221, Ratio=2.12x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.212, Ratio=2.06x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.218, Ratio=2.07x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.228, Ratio=2.22x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.212, Ratio=2.06x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.221, Ratio=2.11x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.197, Ratio=2.01x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.197, Ratio=2.02x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.190, Ratio=1.98x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.215, Ratio=2.09x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.220, Ratio=2.11x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.218, Ratio=2.16x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.219, Ratio=2.15x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.219, Ratio=2.13x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.206, Ratio=2.05x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.233, Ratio=2.19x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.200, Ratio=2.03x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.204, Ratio=2.03x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.210, Ratio=2.06x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.218, Ratio=2.15x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.217, Ratio=2.10x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.221, Ratio=2.13x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.226, Ratio=2.14x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.217, Ratio=2.07x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.202, Ratio=2.03x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.215, Ratio=2.11x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.201, Ratio=2.00x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.204, Ratio=2.05x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.197, Ratio=2.00x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.213, Ratio=2.07x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.208, Ratio=2.02x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.208, Ratio=2.08x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.203, Ratio=2.04x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.219, Ratio=2.13x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.215, Ratio=2.16x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.190, Ratio=1.94x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.211, Ratio=2.10x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.210, Ratio=2.01x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.210, Ratio=2.08x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.220, Ratio=2.09x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.211, Ratio=2.01x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.201, Ratio=2.01x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.207, Ratio=1.99x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.206, Ratio=2.03x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.235, Ratio=2.19x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.230, Ratio=2.13x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.198, Ratio=1.96x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.203, Ratio=2.04x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.06x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.205, Ratio=2.01x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.219, Ratio=2.08x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.203, Ratio=1.99x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.215, Ratio=2.10x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.205, Ratio=2.02x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.203, Ratio=2.00x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.230, Ratio=2.13x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.227, Ratio=2.20x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.203, Ratio=2.07x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.204, Ratio=2.03x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.206, Ratio=2.02x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.231, Ratio=2.24x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.200, Ratio=2.01x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.213, Ratio=2.07x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.233, Ratio=2.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.209, Ratio=2.07x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.215, Ratio=2.07x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.231, Ratio=2.28x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.206, Ratio=2.09x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.226, Ratio=2.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.222, Ratio=2.12x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.200, Ratio=1.98x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.229, Ratio=2.22x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.217, Ratio=2.13x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.225, Ratio=2.17x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.221, Ratio=2.08x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.217, Ratio=2.09x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.219, Ratio=2.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.214, Ratio=2.10x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.220, Ratio=2.11x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.227, Ratio=2.16x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.215, Ratio=2.05x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.234, Ratio=2.22x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.205, Ratio=2.07x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.216, Ratio=2.07x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.197, Ratio=1.98x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.210, Ratio=2.09x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.199, Ratio=2.03x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.203, Ratio=2.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.212, Ratio=2.08x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.223, Ratio=2.13x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.214, Ratio=2.12x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.216, Ratio=2.14x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.226, Ratio=2.17x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.197, Ratio=1.96x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.220, Ratio=2.13x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.228, Ratio=2.18x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.220, Ratio=2.15x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.226, Ratio=2.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.203, Ratio=2.15x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.222, Ratio=2.15x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.199, Ratio=1.99x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.212, Ratio=2.09x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.230, Ratio=2.15x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.204, Ratio=2.05x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.214, Ratio=2.12x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.227, Ratio=2.16x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.207, Ratio=2.05x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.204, Ratio=2.02x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.204, Ratio=2.06x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.225, Ratio=2.12x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.221, Ratio=2.15x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.225, Ratio=2.15x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.215, Ratio=2.08x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.196, Ratio=2.02x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.218, Ratio=2.08x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.206, Ratio=2.06x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.221, Ratio=2.14x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.217, Ratio=2.10x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.209, Ratio=2.06x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.211, Ratio=2.09x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.215, Ratio=2.08x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.215, Ratio=2.11x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.217, Ratio=2.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.217, Ratio=2.16x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.214, Ratio=2.07x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.205, Ratio=1.99x, Gap=-2.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.208, Ratio=2.07x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.216, Ratio=2.11x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.03x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.217, Ratio=2.13x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.229, Ratio=2.20x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.196, Ratio=2.01x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.218, Ratio=2.13x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.208, Ratio=2.06x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.208, Ratio=2.10x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.227, Ratio=2.19x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.229, Ratio=2.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.208, Ratio=2.08x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.215, Ratio=2.11x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.212, Ratio=2.01x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.217, Ratio=2.09x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.220, Ratio=2.12x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.235, Ratio=2.20x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.229, Ratio=2.14x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.201, Ratio=2.03x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.201, Ratio=2.04x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.227, Ratio=2.17x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.204, Ratio=2.01x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.208, Ratio=2.03x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.216, Ratio=2.09x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.206, Ratio=2.05x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.203, Ratio=2.02x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.214, Ratio=2.13x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.205, Ratio=2.08x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.203, Ratio=2.00x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.10x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.221, Ratio=2.08x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.220, Ratio=2.10x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.205, Ratio=2.05x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.206, Ratio=2.05x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.205, Ratio=2.03x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.220, Ratio=2.08x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.215, Ratio=2.08x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.218, Ratio=2.14x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.198, Ratio=2.02x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.202, Ratio=2.01x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.220, Ratio=2.11x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.209, Ratio=2.05x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.220, Ratio=2.11x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.189, Ratio=1.96x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.192, Ratio=1.96x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.213, Ratio=2.06x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.214, Ratio=2.09x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.205, Ratio=2.11x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.208, Ratio=2.07x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.219, Ratio=2.10x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.206, Ratio=2.07x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.194, Ratio=1.99x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.228, Ratio=2.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.06x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.211, Ratio=2.05x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.197, Ratio=2.05x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.197, Ratio=2.00x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.202, Ratio=2.05x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.207, Ratio=2.04x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.220, Ratio=2.09x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.223, Ratio=2.16x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.218, Ratio=2.16x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.225, Ratio=2.17x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.218, Ratio=2.14x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.215, Ratio=2.08x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.214, Ratio=2.13x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.08x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.220, Ratio=2.12x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.206, Ratio=2.02x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.226, Ratio=2.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.204, Ratio=2.05x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.201, Ratio=2.04x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.232, Ratio=2.19x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.200, Ratio=1.99x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.218, Ratio=2.13x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.199, Ratio=1.99x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.203, Ratio=2.00x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.202, Ratio=2.00x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.211, Ratio=2.08x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.223, Ratio=2.11x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.227, Ratio=2.17x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.214, Ratio=2.07x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.210, Ratio=2.05x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.207, Ratio=2.10x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.219, Ratio=2.09x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.226, Ratio=2.17x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.196, Ratio=2.00x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.224, Ratio=2.21x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.214, Ratio=2.12x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.227, Ratio=2.09x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.229, Ratio=2.14x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.205, Ratio=2.00x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.200, Ratio=2.00x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.209, Ratio=2.02x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.226, Ratio=2.14x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.197, Ratio=2.00x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.203, Ratio=2.03x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.205, Ratio=2.10x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.215, Ratio=2.06x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.208, Ratio=2.07x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.226, Ratio=2.16x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.207, Ratio=2.06x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.215, Ratio=2.06x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.211, Ratio=2.09x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.207, Ratio=2.05x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.210, Ratio=2.04x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.209, Ratio=2.07x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.211, Ratio=2.10x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.208, Ratio=2.04x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.216, Ratio=2.06x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.213, Ratio=2.10x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.203, Ratio=2.06x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.211, Ratio=2.09x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.216, Ratio=2.06x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.210, Ratio=2.04x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.210, Ratio=2.02x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.220, Ratio=2.17x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.229, Ratio=2.16x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.212, Ratio=2.09x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.11x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.230, Ratio=2.20x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.198, Ratio=2.04x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.205, Ratio=2.00x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.226, Ratio=2.17x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.217, Ratio=2.11x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.198, Ratio=2.03x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.205, Ratio=2.05x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.206, Ratio=2.03x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.215, Ratio=2.05x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.217, Ratio=2.11x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.221, Ratio=2.15x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.220, Ratio=2.16x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.215, Ratio=2.05x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.217, Ratio=2.14x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.202, Ratio=2.04x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.207, Ratio=2.00x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.216, Ratio=2.12x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.202, Ratio=2.03x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.220, Ratio=2.14x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.212, Ratio=2.06x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.203, Ratio=2.02x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.205, Ratio=2.03x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.202, Ratio=2.03x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.214, Ratio=2.11x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.201, Ratio=2.01x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.207, Ratio=2.06x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.207, Ratio=2.02x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.218, Ratio=2.08x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.230, Ratio=2.19x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.208, Ratio=2.05x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.236, Ratio=2.30x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.208, Ratio=2.08x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.198, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.219, Ratio=2.11x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.227, Ratio=2.16x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.229, Ratio=2.15x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.218, Ratio=2.09x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.209, Ratio=2.09x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.217, Ratio=2.09x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.198, Ratio=2.04x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.198, Ratio=2.01x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.204, Ratio=2.08x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.199, Ratio=1.97x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.216, Ratio=2.09x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.218, Ratio=2.14x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.210, Ratio=2.10x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.202, Ratio=2.04x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.201, Ratio=2.08x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.200, Ratio=2.00x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.226, Ratio=2.15x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.217, Ratio=2.10x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.221, Ratio=2.12x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.205, Ratio=2.04x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.217, Ratio=2.08x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.232, Ratio=2.18x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.220, Ratio=2.15x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.213, Ratio=2.07x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.226, Ratio=2.14x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.218, Ratio=2.13x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.200, Ratio=2.00x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.209, Ratio=2.08x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.210, Ratio=2.05x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.216, Ratio=2.05x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.245, Ratio=2.29x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.205, Ratio=2.11x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.233, Ratio=2.21x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.219, Ratio=2.11x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.228, Ratio=2.19x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.198, Ratio=2.05x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.219, Ratio=2.11x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.211, Ratio=2.01x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.218, Ratio=2.08x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.201, Ratio=2.02x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.231, Ratio=2.16x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.200, Ratio=2.02x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.214, Ratio=2.12x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.213, Ratio=2.10x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.196, Ratio=2.00x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.200, Ratio=1.99x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.213, Ratio=2.08x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.213, Ratio=2.06x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.228, Ratio=2.22x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.218, Ratio=2.16x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.206, Ratio=2.07x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.211, Ratio=2.07x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.201, Ratio=2.02x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.217, Ratio=2.06x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.219, Ratio=2.10x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.219, Ratio=2.13x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.213, Ratio=2.08x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.208, Ratio=2.00x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.225, Ratio=2.16x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.227, Ratio=2.13x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.201, Ratio=2.05x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.204, Ratio=2.02x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.196, Ratio=1.94x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.213, Ratio=2.04x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.221, Ratio=2.12x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.11x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.206, Ratio=2.06x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.231, Ratio=2.20x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.221, Ratio=2.11x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.212, Ratio=2.07x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.222, Ratio=2.12x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.229, Ratio=2.15x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.198, Ratio=2.02x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.203, Ratio=1.98x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.220, Ratio=2.09x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.209, Ratio=2.11x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.218, Ratio=2.11x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.221, Ratio=2.11x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.214, Ratio=2.12x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.218, Ratio=2.10x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.210, Ratio=2.14x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.208, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.207, Ratio=2.01x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.220, Ratio=2.12x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.214, Ratio=2.08x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.222, Ratio=2.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.228, Ratio=2.15x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.230, Ratio=2.23x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.210, Ratio=2.00x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.217, Ratio=2.07x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.225, Ratio=2.19x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.197, Ratio=1.99x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.212, Ratio=2.09x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.230, Ratio=2.18x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.204, Ratio=1.98x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.218, Ratio=2.09x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.195, Ratio=2.00x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.199, Ratio=2.01x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.211, Ratio=2.06x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.223, Ratio=2.16x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.203, Ratio=2.02x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.204, Ratio=2.04x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.212, Ratio=2.05x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.233, Ratio=2.19x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.222, Ratio=2.14x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.206, Ratio=2.06x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.215, Ratio=2.07x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.215, Ratio=2.10x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.214, Ratio=2.09x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.216, Ratio=2.13x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.209, Ratio=2.06x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.216, Ratio=2.04x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.209, Ratio=2.05x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.224, Ratio=2.15x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.223, Ratio=2.12x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.206, Ratio=2.03x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.227, Ratio=2.19x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.218, Ratio=2.13x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.211, Ratio=2.09x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.229, Ratio=2.17x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.206, Ratio=2.04x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.201, Ratio=2.02x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.205, Ratio=2.07x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.204, Ratio=2.04x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.213, Ratio=2.10x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.203, Ratio=2.08x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.209, Ratio=2.11x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.225, Ratio=2.12x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.219, Ratio=2.08x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.221, Ratio=2.08x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.219, Ratio=2.15x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.232, Ratio=2.18x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.213, Ratio=2.07x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.232, Ratio=2.24x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.212, Ratio=2.07x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.223, Ratio=2.12x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.216, Ratio=2.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.206, Ratio=2.05x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.221, Ratio=2.07x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.208, Ratio=2.06x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.206, Ratio=2.11x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.218, Ratio=2.07x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.217, Ratio=2.09x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.214, Ratio=2.08x, Gap=-2.415

============================================================
Epoch 6/20 completed in 29.8s
Train: Loss=1.4131 (C:1.4131, R:0.0018) Ratio=2.10x
Val:   Loss=1.3953 (C:1.3953, R:0.0018) Ratio=2.27x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.3953)
============================================================

🌍 Updating global dataset at epoch 7
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.558 ± 0.711
    Neg distances: 1.248 ± 0.853
    Separation ratio: 2.24x
    Gap: -2.677
    ✅ Good global separation

Epoch 7 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.769
Batch   0/537: Loss=1.3452 (C:1.3452, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.258, Ratio=2.26x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.246, Ratio=2.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.252, Ratio=2.23x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.250, Ratio=2.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.250, Ratio=2.27x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.253, Ratio=2.25x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.251, Ratio=2.20x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.244, Ratio=2.11x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.264, Ratio=2.30x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.263, Ratio=2.31x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.261, Ratio=2.30x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.245, Ratio=2.18x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.247, Ratio=2.23x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.252, Ratio=2.25x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.241, Ratio=2.15x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.254, Ratio=2.19x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.265, Ratio=2.28x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.224, Ratio=2.07x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.242, Ratio=2.24x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.230, Ratio=2.13x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.241, Ratio=2.20x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.242, Ratio=2.20x, Gap=-2.540
Batch  25/537: Loss=1.3586 (C:1.3586, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.237, Ratio=2.14x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.247, Ratio=2.17x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.250, Ratio=2.18x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.238, Ratio=2.15x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.258, Ratio=2.37x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.250, Ratio=2.24x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.250, Ratio=2.24x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.262, Ratio=2.33x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.242, Ratio=2.13x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.264, Ratio=2.36x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.274, Ratio=2.36x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.248, Ratio=2.21x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.244, Ratio=2.24x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.233, Ratio=2.15x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.245, Ratio=2.22x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.245, Ratio=2.17x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.234, Ratio=2.16x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.247, Ratio=2.19x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.33x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.253, Ratio=2.24x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.254, Ratio=2.20x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.248, Ratio=2.17x, Gap=-2.562
Batch  50/537: Loss=1.3702 (C:1.3702, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.236, Ratio=2.10x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.238, Ratio=2.14x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.250, Ratio=2.26x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.237, Ratio=2.18x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.245, Ratio=2.14x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.226, Ratio=2.13x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.242, Ratio=2.17x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.250, Ratio=2.18x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.246, Ratio=2.15x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.265, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.261, Ratio=2.22x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.266, Ratio=2.23x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.247, Ratio=2.12x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.253, Ratio=2.25x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.248, Ratio=2.25x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.257, Ratio=2.20x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.245, Ratio=2.18x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.231, Ratio=2.09x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.242, Ratio=2.21x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.227, Ratio=2.06x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.244, Ratio=2.17x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.239, Ratio=2.11x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.250, Ratio=2.20x, Gap=-3.100
Batch  75/537: Loss=1.3594 (C:1.3594, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.246, Ratio=2.20x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.245, Ratio=2.16x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.246, Ratio=2.23x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.265, Ratio=2.25x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.232, Ratio=2.14x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.262, Ratio=2.21x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.270, Ratio=2.27x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.227, Ratio=2.07x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.257, Ratio=2.16x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.248, Ratio=2.22x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.250, Ratio=2.19x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.228, Ratio=2.12x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.259, Ratio=2.31x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.244, Ratio=2.25x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.242, Ratio=2.16x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.245, Ratio=2.19x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.257, Ratio=2.24x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.238, Ratio=2.18x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.255, Ratio=2.25x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.247, Ratio=2.19x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.259, Ratio=2.28x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.239, Ratio=2.17x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.21x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.240, Ratio=2.21x, Gap=-2.638
Batch 100/537: Loss=1.3595 (C:1.3595, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.245, Ratio=2.20x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.252, Ratio=2.24x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.244, Ratio=2.25x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.271, Ratio=2.30x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.259, Ratio=2.23x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.255, Ratio=2.19x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.265, Ratio=2.25x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.271, Ratio=2.24x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.246, Ratio=2.14x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.250, Ratio=2.23x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.262, Ratio=2.26x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.247, Ratio=2.22x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.263, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.233, Ratio=2.17x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.245, Ratio=2.21x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.253, Ratio=2.18x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.245, Ratio=2.16x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.240, Ratio=2.23x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.240, Ratio=2.14x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.270, Ratio=2.33x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.255, Ratio=2.21x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.250, Ratio=2.22x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.244, Ratio=2.19x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.250, Ratio=2.21x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.263, Ratio=2.19x, Gap=-2.761
Batch 125/537: Loss=1.3573 (C:1.3573, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.263, Ratio=2.23x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.264, Ratio=2.29x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.234, Ratio=2.15x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.245, Ratio=2.19x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.245, Ratio=2.24x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.236, Ratio=2.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.264, Ratio=2.30x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.274, Ratio=2.45x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.255, Ratio=2.16x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.241, Ratio=2.19x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.253, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.247, Ratio=2.22x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.261, Ratio=2.25x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.265, Ratio=2.27x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.242, Ratio=2.17x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.246, Ratio=2.23x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.252, Ratio=2.20x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.256, Ratio=2.30x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.262, Ratio=2.25x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.267, Ratio=2.27x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.265, Ratio=2.26x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.262, Ratio=2.25x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.256, Ratio=2.26x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.257, Ratio=2.23x, Gap=-2.560
Batch 150/537: Loss=1.3461 (C:1.3461, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.241, Ratio=2.23x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.251, Ratio=2.19x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.255, Ratio=2.23x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.254, Ratio=2.25x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.233, Ratio=2.12x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.264, Ratio=2.24x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.236, Ratio=2.12x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.252, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.224, Ratio=2.04x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.258, Ratio=2.36x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.240, Ratio=2.13x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.247, Ratio=2.22x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.241, Ratio=2.21x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.249, Ratio=2.17x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.249, Ratio=2.19x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.239, Ratio=2.19x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.237, Ratio=2.22x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.253, Ratio=2.15x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.271, Ratio=2.34x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.250, Ratio=2.20x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.259, Ratio=2.27x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.236, Ratio=2.17x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.247, Ratio=2.29x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.253, Ratio=2.22x, Gap=-3.014
Batch 175/537: Loss=1.3540 (C:1.3540, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.251, Ratio=2.24x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.225, Ratio=2.07x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.255, Ratio=2.21x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.253, Ratio=2.23x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.240, Ratio=2.20x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.249, Ratio=2.14x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.237, Ratio=2.27x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.237, Ratio=2.13x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.250, Ratio=2.24x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.252, Ratio=2.30x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.26x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.267, Ratio=2.28x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.250, Ratio=2.11x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.226, Ratio=2.03x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.269, Ratio=2.25x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.250, Ratio=2.17x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.257, Ratio=2.24x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.263, Ratio=2.24x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.253, Ratio=2.28x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.243, Ratio=2.17x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.241, Ratio=2.17x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.262, Ratio=2.28x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.249, Ratio=2.20x, Gap=-2.732
Batch 200/537: Loss=1.3602 (C:1.3602, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.268, Ratio=2.28x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.240, Ratio=2.17x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.27x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.264, Ratio=2.28x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.252, Ratio=2.26x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.262, Ratio=2.29x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.254, Ratio=2.19x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.240, Ratio=2.13x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.242, Ratio=2.19x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.245, Ratio=2.17x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.238, Ratio=2.15x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.260, Ratio=2.34x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.243, Ratio=2.16x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.246, Ratio=2.19x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.260, Ratio=2.24x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.240, Ratio=2.15x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.248, Ratio=2.13x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.247, Ratio=2.18x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.267, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.564
Batch 225/537: Loss=1.3351 (C:1.3351, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.255, Ratio=2.19x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.269, Ratio=2.26x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.269, Ratio=2.20x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.249, Ratio=2.10x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.246, Ratio=2.17x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.242, Ratio=2.17x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.248, Ratio=2.13x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.32x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.230, Ratio=2.14x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.242, Ratio=2.22x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.254, Ratio=2.21x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.258, Ratio=2.25x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.241, Ratio=2.14x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.236, Ratio=2.20x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.243, Ratio=2.15x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.251, Ratio=2.23x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.250, Ratio=2.20x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.255, Ratio=2.26x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.268, Ratio=2.46x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.271, Ratio=2.32x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.259, Ratio=2.25x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.251, Ratio=2.22x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.249, Ratio=2.15x, Gap=-2.794
Batch 250/537: Loss=1.3780 (C:1.3780, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.278, Ratio=2.35x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.255, Ratio=2.23x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.236, Ratio=2.12x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.244, Ratio=2.20x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.250, Ratio=2.18x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.241, Ratio=2.25x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.265, Ratio=2.31x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.229, Ratio=2.14x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.247, Ratio=2.21x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.258, Ratio=2.16x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.245, Ratio=2.20x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.252, Ratio=2.18x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.253, Ratio=2.23x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.246, Ratio=2.19x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.256, Ratio=2.24x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.253, Ratio=2.23x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.243, Ratio=2.17x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.231, Ratio=2.13x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.241, Ratio=2.19x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.253, Ratio=2.16x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.244, Ratio=2.16x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.250, Ratio=2.22x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.279, Ratio=2.47x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.262, Ratio=2.22x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.243, Ratio=2.12x, Gap=-2.659
Batch 275/537: Loss=1.3855 (C:1.3855, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.252, Ratio=2.25x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.246, Ratio=2.26x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.245, Ratio=2.13x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.259, Ratio=2.23x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.233, Ratio=2.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.239, Ratio=2.13x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.253, Ratio=2.19x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.249, Ratio=2.22x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.259, Ratio=2.18x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.262, Ratio=2.20x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.265, Ratio=2.23x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.250, Ratio=2.16x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.249, Ratio=2.13x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.241, Ratio=2.16x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.245, Ratio=2.27x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.237, Ratio=2.17x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.245, Ratio=2.17x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.236, Ratio=2.21x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.262, Ratio=2.26x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.269, Ratio=2.25x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.255, Ratio=2.13x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.263, Ratio=2.26x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.28x, Gap=-2.585
Batch 300/537: Loss=1.3378 (C:1.3378, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.258, Ratio=2.30x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.246, Ratio=2.18x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.244, Ratio=2.11x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.249, Ratio=2.27x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.256, Ratio=2.19x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.255, Ratio=2.28x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.236, Ratio=2.14x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.258, Ratio=2.26x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.252, Ratio=2.22x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.269, Ratio=2.26x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.267, Ratio=2.24x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.247, Ratio=2.19x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.247, Ratio=2.07x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.253, Ratio=2.17x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.237, Ratio=2.07x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.251, Ratio=2.23x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.237, Ratio=2.16x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.269, Ratio=2.32x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.258, Ratio=2.23x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.238, Ratio=2.16x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.249, Ratio=2.19x, Gap=-2.826
Batch 325/537: Loss=1.3611 (C:1.3611, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.257, Ratio=2.23x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.242, Ratio=2.18x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.255, Ratio=2.19x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.249, Ratio=2.13x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.251, Ratio=2.23x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.257, Ratio=2.17x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.247, Ratio=2.21x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.254, Ratio=2.16x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.249, Ratio=2.26x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.249, Ratio=2.26x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.254, Ratio=2.29x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.254, Ratio=2.20x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.267, Ratio=2.34x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.251, Ratio=2.17x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.254, Ratio=2.21x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.256, Ratio=2.24x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.253, Ratio=2.18x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.229, Ratio=2.23x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.237, Ratio=2.11x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.266, Ratio=2.34x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.244, Ratio=2.21x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.229, Ratio=2.17x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.244, Ratio=2.23x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.247, Ratio=2.21x, Gap=-2.727
Batch 350/537: Loss=1.3585 (C:1.3585, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.230, Ratio=2.18x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.253, Ratio=2.22x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.251, Ratio=2.24x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.250, Ratio=2.20x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.266, Ratio=2.32x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.242, Ratio=2.15x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.27x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.247, Ratio=2.16x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.254, Ratio=2.22x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.254, Ratio=2.31x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.249, Ratio=2.28x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.244, Ratio=2.21x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.259, Ratio=2.18x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.254, Ratio=2.17x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.260, Ratio=2.27x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.276, Ratio=2.33x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.250, Ratio=2.17x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.238, Ratio=2.18x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.239, Ratio=2.13x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.245, Ratio=2.14x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.265, Ratio=2.31x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.262, Ratio=2.31x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.258, Ratio=2.25x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.251, Ratio=2.26x, Gap=-2.901
Batch 375/537: Loss=1.3434 (C:1.3434, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.256, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.250, Ratio=2.26x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.246, Ratio=2.14x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.243, Ratio=2.24x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.254, Ratio=2.23x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.250, Ratio=2.19x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.259, Ratio=2.22x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.267, Ratio=2.29x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.254, Ratio=2.21x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.250, Ratio=2.13x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.240, Ratio=2.19x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.232, Ratio=2.14x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.268, Ratio=2.31x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.266, Ratio=2.28x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.250, Ratio=2.25x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.248, Ratio=2.25x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.265, Ratio=2.33x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.241, Ratio=2.16x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.249, Ratio=2.19x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.258, Ratio=2.30x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.253, Ratio=2.18x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.257, Ratio=2.26x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.253, Ratio=2.24x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.258, Ratio=2.27x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.249, Ratio=2.23x, Gap=-2.914
Batch 400/537: Loss=1.3491 (C:1.3491, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.230, Ratio=2.13x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.257, Ratio=2.37x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.256, Ratio=2.26x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.257, Ratio=2.23x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.242, Ratio=2.21x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.230, Ratio=2.16x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.272, Ratio=2.30x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.269, Ratio=2.31x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.274, Ratio=2.38x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.261, Ratio=2.24x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.233, Ratio=2.09x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.264, Ratio=2.21x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.234, Ratio=2.16x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.245, Ratio=2.16x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.239, Ratio=2.20x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.246, Ratio=2.25x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.251, Ratio=2.25x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.255, Ratio=2.21x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.268, Ratio=2.33x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.245, Ratio=2.26x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.233, Ratio=2.11x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.246, Ratio=2.15x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.239, Ratio=2.13x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.256, Ratio=2.28x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.248, Ratio=2.20x, Gap=-2.932
Batch 425/537: Loss=1.3600 (C:1.3600, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.248, Ratio=2.20x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.256, Ratio=2.25x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.240, Ratio=2.19x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.249, Ratio=2.14x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.242, Ratio=2.24x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.248, Ratio=2.24x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.269, Ratio=2.33x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.266, Ratio=2.37x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.256, Ratio=2.20x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.263, Ratio=2.19x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.236, Ratio=2.19x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.250, Ratio=2.25x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.243, Ratio=2.15x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.246, Ratio=2.17x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.263, Ratio=2.21x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.255, Ratio=2.16x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.248, Ratio=2.20x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.241, Ratio=2.23x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.249, Ratio=2.23x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.243, Ratio=2.20x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.246, Ratio=2.16x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.264, Ratio=2.27x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.245, Ratio=2.23x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.251, Ratio=2.23x, Gap=-2.805
Batch 450/537: Loss=1.3487 (C:1.3487, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.259, Ratio=2.25x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.268, Ratio=2.24x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.263, Ratio=2.25x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.26x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.253, Ratio=2.20x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.250, Ratio=2.20x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.232, Ratio=2.13x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.246, Ratio=2.19x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.249, Ratio=2.23x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.243, Ratio=2.20x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.239, Ratio=2.20x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.261, Ratio=2.24x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.262, Ratio=2.28x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.243, Ratio=2.12x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.276, Ratio=2.32x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.251, Ratio=2.16x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.240, Ratio=2.14x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.241, Ratio=2.11x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.264, Ratio=2.22x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.262, Ratio=2.24x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.253, Ratio=2.17x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.252, Ratio=2.17x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.232, Ratio=2.12x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.25x, Gap=-2.904
Batch 475/537: Loss=1.3401 (C:1.3401, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.234, Ratio=2.21x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.256, Ratio=2.34x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.252, Ratio=2.23x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.242, Ratio=2.17x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.229, Ratio=2.04x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.246, Ratio=2.13x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.263, Ratio=2.32x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.256, Ratio=2.21x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.246, Ratio=2.21x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.249, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.250, Ratio=2.17x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.242, Ratio=2.17x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.239, Ratio=2.16x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.218, Ratio=2.03x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.245, Ratio=2.14x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.251, Ratio=2.14x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.248, Ratio=2.23x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.242, Ratio=2.14x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.248, Ratio=2.13x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.236, Ratio=2.19x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.257, Ratio=2.24x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.251, Ratio=2.19x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.242, Ratio=2.15x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.255, Ratio=2.19x, Gap=-2.815
Batch 500/537: Loss=1.3571 (C:1.3571, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.234, Ratio=2.12x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.246, Ratio=2.16x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.243, Ratio=2.18x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.240, Ratio=2.24x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.232, Ratio=2.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.244, Ratio=2.14x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.251, Ratio=2.27x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.239, Ratio=2.22x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.240, Ratio=2.22x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.256, Ratio=2.19x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.245, Ratio=2.13x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.248, Ratio=2.20x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.264, Ratio=2.24x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.238, Ratio=2.16x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.243, Ratio=2.15x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.256, Ratio=2.31x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.254, Ratio=2.17x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.249, Ratio=2.21x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.28x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.249, Ratio=2.26x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.242, Ratio=2.13x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.260, Ratio=2.23x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.250, Ratio=2.22x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.260, Ratio=2.28x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.254, Ratio=2.21x, Gap=-2.477
Batch 525/537: Loss=1.3548 (C:1.3548, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.244, Ratio=2.24x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.257, Ratio=2.24x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.254, Ratio=2.20x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.251, Ratio=2.17x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.264, Ratio=2.23x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.239, Ratio=2.13x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.248, Ratio=2.23x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.233, Ratio=2.16x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.245, Ratio=2.26x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.254, Ratio=2.30x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.249, Ratio=2.26x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.238, Ratio=2.23x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.266, Ratio=2.38x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.237, Ratio=2.24x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.263, Ratio=2.37x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.255, Ratio=2.33x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.239, Ratio=2.24x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.265, Ratio=2.37x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.255, Ratio=2.34x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.238, Ratio=2.29x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.276, Ratio=2.44x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.277, Ratio=2.42x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.223, Ratio=2.15x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.247, Ratio=2.27x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.253, Ratio=2.29x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.252, Ratio=2.27x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.258, Ratio=2.40x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.254, Ratio=2.30x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.256, Ratio=2.34x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.241, Ratio=2.19x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.245, Ratio=2.31x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.257, Ratio=2.30x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.248, Ratio=2.33x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.245, Ratio=2.28x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.238, Ratio=2.20x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.248, Ratio=2.29x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.255, Ratio=2.35x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.253, Ratio=2.30x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.25x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.248, Ratio=2.19x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.253, Ratio=2.34x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.251, Ratio=2.30x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.259, Ratio=2.31x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.240, Ratio=2.24x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.265, Ratio=2.34x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.240, Ratio=2.20x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.279, Ratio=2.53x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.240, Ratio=2.19x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.242, Ratio=2.19x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.257, Ratio=2.34x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.243, Ratio=2.20x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.261, Ratio=2.34x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.229, Ratio=2.10x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.254, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.260, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.241, Ratio=2.26x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.278, Ratio=2.47x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.246, Ratio=2.31x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.237, Ratio=2.24x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.258, Ratio=2.34x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.237, Ratio=2.24x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.254, Ratio=2.29x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.245, Ratio=2.25x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.224, Ratio=2.23x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.262, Ratio=2.33x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.245, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.237, Ratio=2.21x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.241, Ratio=2.20x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.251, Ratio=2.23x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.249, Ratio=2.26x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.260, Ratio=2.26x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.248, Ratio=2.31x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.246, Ratio=2.30x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.245, Ratio=2.20x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.258, Ratio=2.36x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.238, Ratio=2.24x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.263, Ratio=2.43x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.241, Ratio=2.14x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.257, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.232, Ratio=2.19x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.255, Ratio=2.29x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.261, Ratio=2.29x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.254, Ratio=2.31x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.243, Ratio=2.21x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.274, Ratio=2.41x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.243, Ratio=2.23x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.246, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.257, Ratio=2.26x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.236, Ratio=2.21x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.258, Ratio=2.29x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.242, Ratio=2.30x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.262, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.275, Ratio=2.40x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.268, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.246, Ratio=2.28x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.242, Ratio=2.27x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.234, Ratio=2.20x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.246, Ratio=2.27x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.249, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.227, Ratio=2.23x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.244, Ratio=2.25x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.268, Ratio=2.36x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.243, Ratio=2.26x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.255, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.253, Ratio=2.24x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.245, Ratio=2.25x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.255, Ratio=2.28x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.262, Ratio=2.30x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.254, Ratio=2.35x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.260, Ratio=2.36x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.254, Ratio=2.33x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.234, Ratio=2.20x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.228, Ratio=2.17x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.253, Ratio=2.31x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.238, Ratio=2.30x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.255, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.246, Ratio=2.18x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.254, Ratio=2.26x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.259, Ratio=2.33x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.244, Ratio=2.24x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.260, Ratio=2.34x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.252, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.242, Ratio=2.23x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.255, Ratio=2.25x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.251, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.264, Ratio=2.41x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.259, Ratio=2.32x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.256, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.253, Ratio=2.27x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.230, Ratio=2.17x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.260, Ratio=2.34x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.249, Ratio=2.27x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.246, Ratio=2.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.252, Ratio=2.28x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.246, Ratio=2.26x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.261, Ratio=2.29x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.260, Ratio=2.37x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.251, Ratio=2.31x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.241, Ratio=2.24x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.250, Ratio=2.35x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.244, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.239, Ratio=2.27x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.242, Ratio=2.25x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.246, Ratio=2.21x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.245, Ratio=2.26x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.259, Ratio=2.36x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.276, Ratio=2.51x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.239, Ratio=2.20x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.263, Ratio=2.38x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.258, Ratio=2.30x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.249, Ratio=2.33x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.255, Ratio=2.31x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.250, Ratio=2.27x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.247, Ratio=2.22x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.247, Ratio=2.25x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.229, Ratio=2.15x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.255, Ratio=2.33x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.255, Ratio=2.34x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.248, Ratio=2.29x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.228, Ratio=2.23x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.251, Ratio=2.28x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.241, Ratio=2.23x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.243, Ratio=2.18x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.243, Ratio=2.24x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.261, Ratio=2.35x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.253, Ratio=2.31x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.246, Ratio=2.23x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.260, Ratio=2.34x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.247, Ratio=2.21x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.252, Ratio=2.27x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.241, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.253, Ratio=2.29x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.246, Ratio=2.28x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.245, Ratio=2.21x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.245, Ratio=2.23x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.254, Ratio=2.36x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.262, Ratio=2.44x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.264, Ratio=2.36x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.252, Ratio=2.35x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.239, Ratio=2.20x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.261, Ratio=2.34x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.272, Ratio=2.41x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.243, Ratio=2.27x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.251, Ratio=2.23x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.245, Ratio=2.24x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.267, Ratio=2.37x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.251, Ratio=2.32x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.241, Ratio=2.31x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.240, Ratio=2.23x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.236, Ratio=2.24x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.260, Ratio=2.37x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.246, Ratio=2.28x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.247, Ratio=2.27x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.255, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.252, Ratio=2.24x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.245, Ratio=2.26x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.264, Ratio=2.33x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.263, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.259, Ratio=2.37x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.261, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.269, Ratio=2.46x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.248, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.237, Ratio=2.16x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.253, Ratio=2.27x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.239, Ratio=2.18x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.253, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.247, Ratio=2.31x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.244, Ratio=2.33x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.244, Ratio=2.23x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.232, Ratio=2.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.254, Ratio=2.36x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.248, Ratio=2.25x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.251, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.253, Ratio=2.28x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.258, Ratio=2.37x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.250, Ratio=2.20x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.239, Ratio=2.21x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.244, Ratio=2.25x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.257, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.251, Ratio=2.33x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.241, Ratio=2.19x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.259, Ratio=2.29x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.262, Ratio=2.33x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.263, Ratio=2.38x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.246, Ratio=2.29x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.271, Ratio=2.47x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.262, Ratio=2.30x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.263, Ratio=2.32x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.237, Ratio=2.15x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.239, Ratio=2.19x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.240, Ratio=2.16x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.270, Ratio=2.41x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.248, Ratio=2.26x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.255, Ratio=2.31x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.241, Ratio=2.22x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.252, Ratio=2.25x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.256, Ratio=2.36x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.261, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.251, Ratio=2.26x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.231, Ratio=2.18x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.268, Ratio=2.38x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.233, Ratio=2.14x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.257, Ratio=2.41x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.252, Ratio=2.30x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.250, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.248, Ratio=2.26x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.244, Ratio=2.25x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.246, Ratio=2.24x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.241, Ratio=2.23x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.250, Ratio=2.27x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.258, Ratio=2.28x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.251, Ratio=2.26x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.263, Ratio=2.33x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.237, Ratio=2.20x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.243, Ratio=2.20x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.264, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.247, Ratio=2.26x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.259, Ratio=2.48x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.239, Ratio=2.18x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.263, Ratio=2.30x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.259, Ratio=2.31x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.251, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.27x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.245, Ratio=2.25x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.29x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.257, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.243, Ratio=2.19x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.240, Ratio=2.23x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.259, Ratio=2.29x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.244, Ratio=2.17x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.249, Ratio=2.23x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.248, Ratio=2.27x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.241, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.247, Ratio=2.26x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.258, Ratio=2.28x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.243, Ratio=2.18x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.251, Ratio=2.36x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.252, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.254, Ratio=2.31x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.259, Ratio=2.35x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.241, Ratio=2.16x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.251, Ratio=2.22x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.256, Ratio=2.31x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.241, Ratio=2.21x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.263, Ratio=2.36x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.233, Ratio=2.20x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.256, Ratio=2.31x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.257, Ratio=2.39x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.233, Ratio=2.21x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.259, Ratio=2.32x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.250, Ratio=2.35x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.244, Ratio=2.19x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.245, Ratio=2.25x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.253, Ratio=2.24x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.260, Ratio=2.40x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.244, Ratio=2.18x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.244, Ratio=2.21x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.250, Ratio=2.28x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.264, Ratio=2.30x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.248, Ratio=2.26x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.257, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.264, Ratio=2.38x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.249, Ratio=2.26x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.250, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.244, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.241, Ratio=2.25x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.242, Ratio=2.20x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.257, Ratio=2.30x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.258, Ratio=2.29x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.265, Ratio=2.31x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.254, Ratio=2.31x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.253, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.264, Ratio=2.40x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.35x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.257, Ratio=2.32x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.248, Ratio=2.25x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.251, Ratio=2.23x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.246, Ratio=2.28x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.263, Ratio=2.46x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.254, Ratio=2.35x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.265, Ratio=2.32x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.261, Ratio=2.27x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.27x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.243, Ratio=2.24x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.240, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.249, Ratio=2.28x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.34x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.240, Ratio=2.23x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.253, Ratio=2.37x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.250, Ratio=2.36x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.257, Ratio=2.35x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.259, Ratio=2.34x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.258, Ratio=2.33x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.246, Ratio=2.27x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.261, Ratio=2.29x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.237, Ratio=2.21x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.262, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.242, Ratio=2.22x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.249, Ratio=2.28x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.255, Ratio=2.30x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.230, Ratio=2.17x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.251, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.271, Ratio=2.38x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.233, Ratio=2.17x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.243, Ratio=2.21x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.248, Ratio=2.29x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.256, Ratio=2.28x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.235, Ratio=2.24x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.269, Ratio=2.41x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.242, Ratio=2.25x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.240, Ratio=2.18x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.263, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.233, Ratio=2.12x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.246, Ratio=2.26x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.253, Ratio=2.32x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.238, Ratio=2.24x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.264, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.256, Ratio=2.33x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.264, Ratio=2.41x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.258, Ratio=2.35x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.266, Ratio=2.49x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.248, Ratio=2.24x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.259, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.247, Ratio=2.26x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.268, Ratio=2.34x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.254, Ratio=2.36x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.250, Ratio=2.27x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.264, Ratio=2.40x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.279, Ratio=2.46x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.250, Ratio=2.28x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.243, Ratio=2.35x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.266, Ratio=2.41x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.27x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.237, Ratio=2.24x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.261, Ratio=2.41x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.257, Ratio=2.34x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.270, Ratio=2.38x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.242, Ratio=2.29x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.255, Ratio=2.29x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.242, Ratio=2.27x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.260, Ratio=2.36x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.259, Ratio=2.36x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.255, Ratio=2.28x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.261, Ratio=2.36x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.239, Ratio=2.18x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.264, Ratio=2.35x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.258, Ratio=2.41x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.268, Ratio=2.38x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.265, Ratio=2.38x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.236, Ratio=2.19x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.241, Ratio=2.18x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.263, Ratio=2.39x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.260, Ratio=2.32x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.266, Ratio=2.42x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.246, Ratio=2.23x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.259, Ratio=2.33x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.243, Ratio=2.29x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.243, Ratio=2.24x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.241, Ratio=2.17x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.28x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.239, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.251, Ratio=2.27x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.250, Ratio=2.28x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.261, Ratio=2.39x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.221, Ratio=2.13x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.237, Ratio=2.17x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.239, Ratio=2.21x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.241, Ratio=2.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.243, Ratio=2.21x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.252, Ratio=2.36x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.220, Ratio=2.13x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.249, Ratio=2.26x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.257, Ratio=2.39x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.256, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.265, Ratio=2.36x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.248, Ratio=2.28x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.254, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.240, Ratio=2.20x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.260, Ratio=2.39x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.261, Ratio=2.25x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.264, Ratio=2.37x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.256, Ratio=2.32x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.238, Ratio=2.15x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.264, Ratio=2.37x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.257, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.265, Ratio=2.40x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.253, Ratio=2.30x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.248, Ratio=2.35x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.236, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.259, Ratio=2.32x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.244, Ratio=2.25x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.246, Ratio=2.23x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.249, Ratio=2.34x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.247, Ratio=2.35x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.231, Ratio=2.16x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.275, Ratio=2.45x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.245, Ratio=2.24x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.262, Ratio=2.30x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.264, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.255, Ratio=2.33x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.242, Ratio=2.21x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.248, Ratio=2.23x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.246, Ratio=2.24x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.266, Ratio=2.40x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.259, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.236, Ratio=2.16x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.254, Ratio=2.21x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.251, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.265, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.225, Ratio=2.20x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.240, Ratio=2.27x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.245, Ratio=2.26x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.258, Ratio=2.33x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.242, Ratio=2.20x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.250, Ratio=2.31x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.238, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.249, Ratio=2.24x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.241, Ratio=2.15x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.252, Ratio=2.36x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.264, Ratio=2.29x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.240, Ratio=2.21x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.253, Ratio=2.28x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.260, Ratio=2.35x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.236, Ratio=2.18x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.258, Ratio=2.29x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.252, Ratio=2.27x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.244, Ratio=2.27x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.231, Ratio=2.14x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.250, Ratio=2.31x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.27x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.263, Ratio=2.41x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.242, Ratio=2.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.244, Ratio=2.21x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.253, Ratio=2.29x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.260, Ratio=2.36x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.254, Ratio=2.32x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.276, Ratio=2.38x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.247, Ratio=2.28x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.255, Ratio=2.40x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.261, Ratio=2.36x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.247, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.250, Ratio=2.24x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.276, Ratio=2.43x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.252, Ratio=2.30x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.242, Ratio=2.25x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.237, Ratio=2.17x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.253, Ratio=2.30x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.267, Ratio=2.40x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.256, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.232, Ratio=2.10x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.260, Ratio=2.35x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.249, Ratio=2.23x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.242, Ratio=2.20x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.257, Ratio=2.37x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.262, Ratio=2.34x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.255, Ratio=2.25x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.230, Ratio=2.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.253, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.252, Ratio=2.36x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.243, Ratio=2.18x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.255, Ratio=2.35x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.240, Ratio=2.27x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.247, Ratio=2.29x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.265, Ratio=2.33x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.244, Ratio=2.25x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.249, Ratio=2.36x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.238, Ratio=2.23x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.265, Ratio=2.37x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.239, Ratio=2.26x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.257, Ratio=2.33x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.250, Ratio=2.35x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.256, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.242, Ratio=2.20x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.250, Ratio=2.21x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.248, Ratio=2.28x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.244, Ratio=2.29x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.238, Ratio=2.19x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.270, Ratio=2.36x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.247, Ratio=2.20x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.267, Ratio=2.37x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.252, Ratio=2.31x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.250, Ratio=2.34x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.241, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.259, Ratio=2.35x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.246, Ratio=2.20x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.259, Ratio=2.28x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.256, Ratio=2.35x, Gap=-2.390

============================================================
Epoch 7/20 completed in 35.5s
Train: Loss=1.3558 (C:1.3558, R:0.0018) Ratio=2.21x
Val:   Loss=1.3350 (C:1.3350, R:0.0018) Ratio=2.37x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.3350)
============================================================

Epoch 8 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.225, Ratio=2.11x, Gap=-2.585
Batch   0/537: Loss=1.3934 (C:1.3934, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.263, Ratio=2.32x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.274, Ratio=2.39x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.248, Ratio=2.17x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.252, Ratio=2.20x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.264, Ratio=2.26x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.264, Ratio=2.21x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.265, Ratio=2.22x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.252, Ratio=2.26x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.249, Ratio=2.23x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.241, Ratio=2.18x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.245, Ratio=2.13x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.247, Ratio=2.24x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.273, Ratio=2.31x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.259, Ratio=2.28x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.256, Ratio=2.25x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.263, Ratio=2.31x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.252, Ratio=2.20x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.273, Ratio=2.34x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.271, Ratio=2.41x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.235, Ratio=2.12x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.248, Ratio=2.22x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.262, Ratio=2.31x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.257, Ratio=2.25x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.249, Ratio=2.18x, Gap=-2.694
Batch  25/537: Loss=1.3634 (C:1.3634, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.266, Ratio=2.37x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.245, Ratio=2.21x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.255, Ratio=2.12x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.262, Ratio=2.21x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.262, Ratio=2.23x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.259, Ratio=2.21x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.261, Ratio=2.29x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.265, Ratio=2.26x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.270, Ratio=2.30x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.264, Ratio=2.32x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.266, Ratio=2.28x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.258, Ratio=2.35x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.255, Ratio=2.29x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.240, Ratio=2.16x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.259, Ratio=2.22x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.253, Ratio=2.13x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.233, Ratio=2.10x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.261, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.257, Ratio=2.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.271, Ratio=2.32x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.245, Ratio=2.21x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.250, Ratio=2.22x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.270, Ratio=2.32x, Gap=-3.185
Batch  50/537: Loss=1.3230 (C:1.3230, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.270, Ratio=2.37x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.244, Ratio=2.18x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.240, Ratio=2.19x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.246, Ratio=2.22x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.258, Ratio=2.27x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.270, Ratio=2.34x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.266, Ratio=2.27x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.273, Ratio=2.32x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.253, Ratio=2.17x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.258, Ratio=2.23x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.256, Ratio=2.18x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.245, Ratio=2.19x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.254, Ratio=2.28x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.260, Ratio=2.23x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.248, Ratio=2.19x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.257, Ratio=2.26x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.249, Ratio=2.23x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.272, Ratio=2.35x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.270, Ratio=2.39x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.29x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.247, Ratio=2.16x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.241, Ratio=2.17x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.253, Ratio=2.21x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.260, Ratio=2.33x, Gap=-2.723
Batch  75/537: Loss=1.3234 (C:1.3234, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.244, Ratio=2.13x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.263, Ratio=2.24x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.246, Ratio=2.19x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.242, Ratio=2.15x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.255, Ratio=2.21x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.252, Ratio=2.21x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.242, Ratio=2.17x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.247, Ratio=2.18x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.242, Ratio=2.22x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.256, Ratio=2.27x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.239, Ratio=2.18x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.264, Ratio=2.23x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.243, Ratio=2.17x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.25x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.235, Ratio=2.24x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.264, Ratio=2.20x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.267, Ratio=2.24x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.254, Ratio=2.21x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.249, Ratio=2.26x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.256, Ratio=2.28x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.227, Ratio=2.13x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.250, Ratio=2.18x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.268, Ratio=2.33x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.257, Ratio=2.24x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.253, Ratio=2.22x, Gap=-2.625
Batch 100/537: Loss=1.3517 (C:1.3517, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.263, Ratio=2.30x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.256, Ratio=2.20x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.263, Ratio=2.25x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.25x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.26x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.258, Ratio=2.18x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.271, Ratio=2.37x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.265, Ratio=2.26x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.236, Ratio=2.18x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.250, Ratio=2.27x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.272, Ratio=2.39x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.270, Ratio=2.36x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.250, Ratio=2.20x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.247, Ratio=2.22x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.233, Ratio=2.16x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.249, Ratio=2.17x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.238, Ratio=2.12x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.259, Ratio=2.21x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.252, Ratio=2.16x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.279, Ratio=2.32x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.243, Ratio=2.16x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.254, Ratio=2.15x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.247, Ratio=2.29x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.255, Ratio=2.28x, Gap=-2.727
Batch 125/537: Loss=1.3342 (C:1.3342, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.251, Ratio=2.34x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.254, Ratio=2.21x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.257, Ratio=2.21x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.274, Ratio=2.25x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.241, Ratio=2.16x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.269, Ratio=2.32x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.272, Ratio=2.33x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.254, Ratio=2.19x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.256, Ratio=2.17x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.255, Ratio=2.29x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.247, Ratio=2.23x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.268, Ratio=2.40x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.282, Ratio=2.37x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.26x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.258, Ratio=2.27x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.275, Ratio=2.33x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.248, Ratio=2.27x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.253, Ratio=2.17x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.242, Ratio=2.15x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.273, Ratio=2.32x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.228, Ratio=2.14x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.257, Ratio=2.21x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.243, Ratio=2.24x, Gap=-2.571
Batch 150/537: Loss=1.3499 (C:1.3499, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.237, Ratio=2.22x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.246, Ratio=2.22x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.259, Ratio=2.26x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.257, Ratio=2.24x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.248, Ratio=2.20x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.268, Ratio=2.35x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.263, Ratio=2.29x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.235, Ratio=2.10x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.250, Ratio=2.21x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.249, Ratio=2.18x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.258, Ratio=2.24x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.242, Ratio=2.22x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.250, Ratio=2.26x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.263, Ratio=2.25x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.261, Ratio=2.20x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.275, Ratio=2.37x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.243, Ratio=2.16x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.245, Ratio=2.28x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.249, Ratio=2.16x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.253, Ratio=2.16x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.252, Ratio=2.23x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.239, Ratio=2.16x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.264, Ratio=2.28x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.234, Ratio=2.09x, Gap=-2.765
Batch 175/537: Loss=1.3964 (C:1.3964, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.260, Ratio=2.26x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.251, Ratio=2.22x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.254, Ratio=2.23x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.251, Ratio=2.16x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.255, Ratio=2.22x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.251, Ratio=2.27x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.268, Ratio=2.36x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.248, Ratio=2.20x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.265, Ratio=2.30x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.260, Ratio=2.21x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.257, Ratio=2.25x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.268, Ratio=2.32x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.255, Ratio=2.26x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.273, Ratio=2.32x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.246, Ratio=2.20x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.255, Ratio=2.29x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.257, Ratio=2.30x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.247, Ratio=2.25x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.253, Ratio=2.23x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.254, Ratio=2.23x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.266, Ratio=2.27x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.27x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.240, Ratio=2.22x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.265, Ratio=2.26x, Gap=-2.540
Batch 200/537: Loss=1.3368 (C:1.3368, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.242, Ratio=2.12x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.268, Ratio=2.34x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.260, Ratio=2.23x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.272, Ratio=2.37x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.255, Ratio=2.20x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.261, Ratio=2.27x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.252, Ratio=2.23x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.264, Ratio=2.25x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.256, Ratio=2.29x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.268, Ratio=2.31x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.236, Ratio=2.16x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.256, Ratio=2.21x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.240, Ratio=2.10x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.265, Ratio=2.23x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.250, Ratio=2.18x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.239, Ratio=2.15x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.267, Ratio=2.25x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.258, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.250, Ratio=2.27x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.262, Ratio=2.30x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.249, Ratio=2.24x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.266, Ratio=2.27x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.245, Ratio=2.18x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.257, Ratio=2.20x, Gap=-2.895
Batch 225/537: Loss=1.3563 (C:1.3563, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.255, Ratio=2.19x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.268, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.249, Ratio=2.18x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.239, Ratio=2.19x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.262, Ratio=2.22x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.24x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.247, Ratio=2.19x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.240, Ratio=2.17x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.271, Ratio=2.35x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.243, Ratio=2.21x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.245, Ratio=2.22x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.29x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.258, Ratio=2.23x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.255, Ratio=2.19x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.256, Ratio=2.29x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.258, Ratio=2.27x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.233, Ratio=2.08x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.266, Ratio=2.28x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.256, Ratio=2.22x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.236, Ratio=2.08x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.250, Ratio=2.19x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.253, Ratio=2.21x, Gap=-2.587
Batch 250/537: Loss=1.3542 (C:1.3542, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.263, Ratio=2.34x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.239, Ratio=2.18x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.247, Ratio=2.19x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.258, Ratio=2.20x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.257, Ratio=2.28x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.264, Ratio=2.28x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.249, Ratio=2.24x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.265, Ratio=2.27x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.259, Ratio=2.38x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.236, Ratio=2.09x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.244, Ratio=2.15x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.246, Ratio=2.20x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.242, Ratio=2.16x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.265, Ratio=2.32x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.266, Ratio=2.24x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.246, Ratio=2.25x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.261, Ratio=2.25x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.247, Ratio=2.27x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.237, Ratio=2.21x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.260, Ratio=2.31x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.257, Ratio=2.30x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.265, Ratio=2.31x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.279, Ratio=2.35x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.247, Ratio=2.13x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.270, Ratio=2.28x, Gap=-2.665
Batch 275/537: Loss=1.3318 (C:1.3318, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.258, Ratio=2.22x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.252, Ratio=2.19x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.264, Ratio=2.26x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.242, Ratio=2.15x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.257, Ratio=2.20x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.254, Ratio=2.31x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.248, Ratio=2.29x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.258, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.234, Ratio=2.16x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.241, Ratio=2.17x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.257, Ratio=2.22x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.246, Ratio=2.17x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.264, Ratio=2.24x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.269, Ratio=2.31x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.240, Ratio=2.17x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.273, Ratio=2.30x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.246, Ratio=2.21x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.233, Ratio=2.18x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.260, Ratio=2.30x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.265, Ratio=2.33x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.247, Ratio=2.18x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.255, Ratio=2.24x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.245, Ratio=2.14x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.276, Ratio=2.32x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.262, Ratio=2.24x, Gap=-2.664
Batch 300/537: Loss=1.3447 (C:1.3447, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.239, Ratio=2.11x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.254, Ratio=2.21x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.251, Ratio=2.27x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.237, Ratio=2.18x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.259, Ratio=2.29x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.274, Ratio=2.34x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.268, Ratio=2.33x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.254, Ratio=2.26x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.252, Ratio=2.26x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.254, Ratio=2.19x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.268, Ratio=2.37x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.269, Ratio=2.36x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.265, Ratio=2.22x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.237, Ratio=2.15x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.233, Ratio=2.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.246, Ratio=2.26x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.260, Ratio=2.28x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.255, Ratio=2.33x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.262, Ratio=2.25x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.247, Ratio=2.25x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.241, Ratio=2.14x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.251, Ratio=2.23x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.236, Ratio=2.14x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.256, Ratio=2.26x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.277, Ratio=2.37x, Gap=-2.621
Batch 325/537: Loss=1.3047 (C:1.3047, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.255, Ratio=2.19x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.265, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.246, Ratio=2.14x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.267, Ratio=2.32x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.253, Ratio=2.20x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.259, Ratio=2.31x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.255, Ratio=2.20x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.261, Ratio=2.28x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.249, Ratio=2.28x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.247, Ratio=2.25x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.268, Ratio=2.29x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.251, Ratio=2.26x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.273, Ratio=2.29x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.260, Ratio=2.27x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.257, Ratio=2.21x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.260, Ratio=2.26x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.255, Ratio=2.19x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.276, Ratio=2.35x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.249, Ratio=2.21x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.256, Ratio=2.21x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.247, Ratio=2.19x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.233, Ratio=2.13x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.248, Ratio=2.26x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.256, Ratio=2.20x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.254, Ratio=2.25x, Gap=-2.791
Batch 350/537: Loss=1.3431 (C:1.3431, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.246, Ratio=2.19x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.260, Ratio=2.23x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.256, Ratio=2.23x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.259, Ratio=2.26x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.250, Ratio=2.22x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.239, Ratio=2.17x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.254, Ratio=2.16x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.269, Ratio=2.25x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.241, Ratio=2.11x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.272, Ratio=2.24x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.247, Ratio=2.22x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.254, Ratio=2.29x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.271, Ratio=2.30x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.250, Ratio=2.19x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.265, Ratio=2.32x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.262, Ratio=2.29x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.243, Ratio=2.13x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.283, Ratio=2.43x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.239, Ratio=2.15x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.272, Ratio=2.30x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.272, Ratio=2.32x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.280, Ratio=2.36x, Gap=-2.545
Batch 375/537: Loss=1.3054 (C:1.3054, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.255, Ratio=2.31x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.254, Ratio=2.23x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.264, Ratio=2.22x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.253, Ratio=2.19x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.21x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.264, Ratio=2.25x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.271, Ratio=2.29x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.262, Ratio=2.31x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.253, Ratio=2.15x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.262, Ratio=2.23x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.237, Ratio=2.21x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.246, Ratio=2.24x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.263, Ratio=2.27x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.270, Ratio=2.29x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.242, Ratio=2.13x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.264, Ratio=2.36x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.249, Ratio=2.15x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.267, Ratio=2.28x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.270, Ratio=2.35x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.256, Ratio=2.18x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.269, Ratio=2.25x, Gap=-2.752
Batch 400/537: Loss=1.3389 (C:1.3389, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.255, Ratio=2.29x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.264, Ratio=2.32x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.262, Ratio=2.27x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.264, Ratio=2.30x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.261, Ratio=2.29x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.252, Ratio=2.24x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.234, Ratio=2.20x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.26x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.250, Ratio=2.27x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.234, Ratio=2.14x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.269, Ratio=2.26x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.256, Ratio=2.28x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.252, Ratio=2.25x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.245, Ratio=2.16x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.259, Ratio=2.32x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.273, Ratio=2.34x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.270, Ratio=2.29x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.254, Ratio=2.23x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.274, Ratio=2.36x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.251, Ratio=2.18x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.258, Ratio=2.26x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.259, Ratio=2.26x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.252, Ratio=2.20x, Gap=-2.653
Batch 425/537: Loss=1.3597 (C:1.3597, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.230, Ratio=2.14x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.238, Ratio=2.19x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.248, Ratio=2.32x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.260, Ratio=2.38x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.243, Ratio=2.24x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.248, Ratio=2.20x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.245, Ratio=2.15x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.245, Ratio=2.13x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.279, Ratio=2.41x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.260, Ratio=2.27x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.261, Ratio=2.26x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.248, Ratio=2.20x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.243, Ratio=2.16x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.269, Ratio=2.35x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.269, Ratio=2.33x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.250, Ratio=2.21x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.243, Ratio=2.19x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.254, Ratio=2.18x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.255, Ratio=2.23x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.262, Ratio=2.25x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.277, Ratio=2.39x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.242, Ratio=2.15x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.242, Ratio=2.15x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.235, Ratio=2.08x, Gap=-2.850
Batch 450/537: Loss=1.3995 (C:1.3995, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.259, Ratio=2.25x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.255, Ratio=2.29x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.283, Ratio=2.36x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.238, Ratio=2.15x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.243, Ratio=2.17x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.260, Ratio=2.21x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.226, Ratio=2.10x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.242, Ratio=2.13x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.251, Ratio=2.17x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.231, Ratio=2.15x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.251, Ratio=2.20x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.248, Ratio=2.26x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.250, Ratio=2.22x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.264, Ratio=2.21x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.276, Ratio=2.35x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.266, Ratio=2.27x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.253, Ratio=2.25x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.249, Ratio=2.16x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.242, Ratio=2.19x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.276, Ratio=2.33x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.254, Ratio=2.20x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.254, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.229, Ratio=2.03x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.240, Ratio=2.19x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.238, Ratio=2.14x, Gap=-2.637
Batch 475/537: Loss=1.3788 (C:1.3788, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.251, Ratio=2.22x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.251, Ratio=2.24x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.259, Ratio=2.19x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.263, Ratio=2.25x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.261, Ratio=2.20x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.270, Ratio=2.30x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.267, Ratio=2.25x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.271, Ratio=2.28x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.261, Ratio=2.18x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.257, Ratio=2.30x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.260, Ratio=2.26x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.244, Ratio=2.21x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.252, Ratio=2.26x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.33x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.33x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.261, Ratio=2.26x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.266, Ratio=2.27x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.263, Ratio=2.28x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.262, Ratio=2.17x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.254, Ratio=2.19x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.246, Ratio=2.11x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.256, Ratio=2.20x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.259, Ratio=2.21x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.271, Ratio=2.30x, Gap=-2.633
Batch 500/537: Loss=1.3261 (C:1.3261, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.274, Ratio=2.35x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.256, Ratio=2.25x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.242, Ratio=2.21x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.259, Ratio=2.27x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.266, Ratio=2.34x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.267, Ratio=2.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.250, Ratio=2.23x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.246, Ratio=2.21x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.243, Ratio=2.32x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.252, Ratio=2.28x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.253, Ratio=2.26x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.262, Ratio=2.24x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.240, Ratio=2.18x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.255, Ratio=2.22x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.260, Ratio=2.19x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.261, Ratio=2.31x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.246, Ratio=2.27x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.241, Ratio=2.24x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.255, Ratio=2.25x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.250, Ratio=2.18x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.237, Ratio=2.18x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.258, Ratio=2.24x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.268, Ratio=2.33x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.245, Ratio=2.16x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.265, Ratio=2.23x, Gap=-3.094
Batch 525/537: Loss=1.3469 (C:1.3469, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.264, Ratio=2.25x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.246, Ratio=2.16x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.252, Ratio=2.20x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.257, Ratio=2.30x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.262, Ratio=2.27x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.248, Ratio=2.21x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.252, Ratio=2.24x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.249, Ratio=2.26x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.264, Ratio=2.34x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.243, Ratio=2.19x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.256, Ratio=2.21x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.256, Ratio=2.33x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.263, Ratio=2.28x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.241, Ratio=2.19x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.260, Ratio=2.34x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.235, Ratio=2.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.258, Ratio=2.31x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.264, Ratio=2.38x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.274, Ratio=2.42x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.259, Ratio=2.35x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.271, Ratio=2.34x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.265, Ratio=2.34x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.267, Ratio=2.40x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.265, Ratio=2.39x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.252, Ratio=2.24x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.273, Ratio=2.42x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.251, Ratio=2.24x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.274, Ratio=2.44x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.258, Ratio=2.30x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.256, Ratio=2.26x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.242, Ratio=2.20x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.246, Ratio=2.25x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.270, Ratio=2.38x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.259, Ratio=2.29x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.247, Ratio=2.18x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.258, Ratio=2.24x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.273, Ratio=2.44x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.284, Ratio=2.39x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.257, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.264, Ratio=2.37x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.274, Ratio=2.40x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.257, Ratio=2.35x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.274, Ratio=2.43x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.264, Ratio=2.27x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.252, Ratio=2.33x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.267, Ratio=2.42x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.265, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.253, Ratio=2.32x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.251, Ratio=2.26x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.268, Ratio=2.38x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.254, Ratio=2.36x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.262, Ratio=2.32x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.254, Ratio=2.29x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.271, Ratio=2.43x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.267, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.255, Ratio=2.28x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.265, Ratio=2.28x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.270, Ratio=2.34x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.258, Ratio=2.23x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.263, Ratio=2.33x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.267, Ratio=2.35x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.253, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.272, Ratio=2.43x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.258, Ratio=2.28x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.263, Ratio=2.28x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.242, Ratio=2.25x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.290, Ratio=2.52x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.24x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.266, Ratio=2.32x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.26x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.253, Ratio=2.28x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.264, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.269, Ratio=2.37x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.272, Ratio=2.35x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.259, Ratio=2.32x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.287, Ratio=2.48x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.270, Ratio=2.35x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.262, Ratio=2.32x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.279, Ratio=2.39x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.263, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.257, Ratio=2.32x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.268, Ratio=2.34x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.247, Ratio=2.24x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.261, Ratio=2.25x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.255, Ratio=2.34x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.246, Ratio=2.22x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.268, Ratio=2.37x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.274, Ratio=2.46x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.252, Ratio=2.30x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.244, Ratio=2.23x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.257, Ratio=2.28x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.265, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.272, Ratio=2.34x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.261, Ratio=2.34x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.259, Ratio=2.21x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.236, Ratio=2.17x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.264, Ratio=2.34x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.264, Ratio=2.41x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.278, Ratio=2.44x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.274, Ratio=2.37x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.249, Ratio=2.30x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.255, Ratio=2.30x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.270, Ratio=2.41x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.246, Ratio=2.19x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.269, Ratio=2.34x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.271, Ratio=2.48x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.254, Ratio=2.27x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.230, Ratio=2.13x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.238, Ratio=2.21x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.273, Ratio=2.40x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.265, Ratio=2.25x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.253, Ratio=2.28x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.274, Ratio=2.42x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.272, Ratio=2.40x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.247, Ratio=2.29x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.275, Ratio=2.38x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.259, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.256, Ratio=2.28x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.270, Ratio=2.37x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.266, Ratio=2.40x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.262, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.248, Ratio=2.22x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.263, Ratio=2.29x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.272, Ratio=2.45x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.260, Ratio=2.36x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.280, Ratio=2.40x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.260, Ratio=2.27x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.254, Ratio=2.25x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.266, Ratio=2.41x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.269, Ratio=2.34x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.256, Ratio=2.33x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.257, Ratio=2.25x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.271, Ratio=2.39x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.267, Ratio=2.32x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.245, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.244, Ratio=2.19x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.259, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.254, Ratio=2.18x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.249, Ratio=2.20x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.272, Ratio=2.38x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.262, Ratio=2.34x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.270, Ratio=2.45x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.262, Ratio=2.30x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.258, Ratio=2.28x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.270, Ratio=2.41x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.260, Ratio=2.27x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.257, Ratio=2.34x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.258, Ratio=2.25x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.260, Ratio=2.31x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.255, Ratio=2.31x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.268, Ratio=2.36x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.269, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.254, Ratio=2.29x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.265, Ratio=2.43x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.263, Ratio=2.37x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.253, Ratio=2.32x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.258, Ratio=2.21x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.256, Ratio=2.30x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.258, Ratio=2.20x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.281, Ratio=2.39x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.264, Ratio=2.32x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.257, Ratio=2.28x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.244, Ratio=2.23x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.261, Ratio=2.28x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.256, Ratio=2.27x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.256, Ratio=2.36x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.263, Ratio=2.32x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.239, Ratio=2.22x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.272, Ratio=2.42x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.281, Ratio=2.49x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.261, Ratio=2.25x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.255, Ratio=2.26x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.265, Ratio=2.34x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.260, Ratio=2.38x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.245, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.266, Ratio=2.32x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.274, Ratio=2.36x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.269, Ratio=2.38x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.249, Ratio=2.22x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.269, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.268, Ratio=2.42x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.265, Ratio=2.29x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.248, Ratio=2.32x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.275, Ratio=2.47x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.260, Ratio=2.36x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.263, Ratio=2.38x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.271, Ratio=2.36x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.255, Ratio=2.31x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.250, Ratio=2.26x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.261, Ratio=2.37x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.265, Ratio=2.34x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.282, Ratio=2.46x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.245, Ratio=2.21x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.269, Ratio=2.46x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.264, Ratio=2.35x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.268, Ratio=2.32x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.261, Ratio=2.37x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.269, Ratio=2.27x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.249, Ratio=2.27x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.263, Ratio=2.36x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.263, Ratio=2.41x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.248, Ratio=2.20x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.243, Ratio=2.15x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.253, Ratio=2.28x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.271, Ratio=2.33x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.266, Ratio=2.39x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.260, Ratio=2.35x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.264, Ratio=2.29x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.263, Ratio=2.28x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.241, Ratio=2.16x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.260, Ratio=2.30x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.261, Ratio=2.34x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.255, Ratio=2.24x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.269, Ratio=2.42x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.264, Ratio=2.37x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.261, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.269, Ratio=2.40x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.268, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.274, Ratio=2.47x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.271, Ratio=2.39x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.252, Ratio=2.32x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.256, Ratio=2.34x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.248, Ratio=2.21x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.260, Ratio=2.38x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.27x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.268, Ratio=2.34x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.283, Ratio=2.46x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.262, Ratio=2.37x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.252, Ratio=2.27x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.247, Ratio=2.29x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.279, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.258, Ratio=2.26x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.268, Ratio=2.36x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.261, Ratio=2.30x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.255, Ratio=2.26x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.238, Ratio=2.22x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.259, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.258, Ratio=2.29x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.284, Ratio=2.48x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.283, Ratio=2.56x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.35x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.265, Ratio=2.32x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.250, Ratio=2.25x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.272, Ratio=2.32x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.263, Ratio=2.27x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.259, Ratio=2.26x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.265, Ratio=2.34x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.255, Ratio=2.25x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.265, Ratio=2.27x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.265, Ratio=2.34x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.260, Ratio=2.35x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.270, Ratio=2.36x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.281, Ratio=2.39x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.265, Ratio=2.28x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.272, Ratio=2.34x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.250, Ratio=2.28x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.266, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.259, Ratio=2.32x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.258, Ratio=2.35x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.259, Ratio=2.34x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.265, Ratio=2.40x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.248, Ratio=2.22x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.263, Ratio=2.38x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.245, Ratio=2.20x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.262, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.243, Ratio=2.14x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.266, Ratio=2.28x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.272, Ratio=2.41x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.245, Ratio=2.27x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.267, Ratio=2.36x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.263, Ratio=2.30x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.249, Ratio=2.26x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.273, Ratio=2.43x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.265, Ratio=2.35x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.270, Ratio=2.33x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.277, Ratio=2.40x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.261, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.246, Ratio=2.19x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.248, Ratio=2.29x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.260, Ratio=2.31x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.26x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.277, Ratio=2.39x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.246, Ratio=2.17x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.251, Ratio=2.31x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.269, Ratio=2.40x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.264, Ratio=2.28x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.245, Ratio=2.19x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.244, Ratio=2.23x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.261, Ratio=2.31x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.245, Ratio=2.23x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.255, Ratio=2.26x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.245, Ratio=2.23x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.273, Ratio=2.36x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.250, Ratio=2.21x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.264, Ratio=2.39x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.260, Ratio=2.26x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.271, Ratio=2.36x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.246, Ratio=2.19x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.266, Ratio=2.31x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.245, Ratio=2.24x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.269, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.256, Ratio=2.27x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.271, Ratio=2.36x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.268, Ratio=2.34x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.261, Ratio=2.37x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.254, Ratio=2.43x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.266, Ratio=2.34x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.268, Ratio=2.34x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.263, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.261, Ratio=2.36x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.251, Ratio=2.23x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.258, Ratio=2.32x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.283, Ratio=2.40x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.250, Ratio=2.25x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.243, Ratio=2.26x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.264, Ratio=2.27x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.268, Ratio=2.36x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.261, Ratio=2.42x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.250, Ratio=2.27x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.253, Ratio=2.21x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.271, Ratio=2.37x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.253, Ratio=2.24x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.252, Ratio=2.22x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.250, Ratio=2.17x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.266, Ratio=2.28x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.24x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.25x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.263, Ratio=2.36x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.255, Ratio=2.32x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.258, Ratio=2.25x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.253, Ratio=2.37x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.264, Ratio=2.34x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.255, Ratio=2.25x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.259, Ratio=2.37x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.250, Ratio=2.22x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.258, Ratio=2.40x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.269, Ratio=2.47x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.276, Ratio=2.46x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.269, Ratio=2.34x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.260, Ratio=2.31x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.258, Ratio=2.35x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.264, Ratio=2.26x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.265, Ratio=2.34x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.268, Ratio=2.29x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.268, Ratio=2.35x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.248, Ratio=2.28x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.259, Ratio=2.33x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.275, Ratio=2.39x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.278, Ratio=2.38x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.259, Ratio=2.32x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.270, Ratio=2.41x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.26x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.248, Ratio=2.29x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.264, Ratio=2.33x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.278, Ratio=2.49x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.279, Ratio=2.40x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.244, Ratio=2.19x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.238, Ratio=2.21x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.260, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.254, Ratio=2.30x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.251, Ratio=2.28x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.272, Ratio=2.37x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.245, Ratio=2.17x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.252, Ratio=2.27x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.26x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.259, Ratio=2.31x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.254, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.241, Ratio=2.17x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.273, Ratio=2.31x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.275, Ratio=2.44x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.266, Ratio=2.40x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.253, Ratio=2.21x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.276, Ratio=2.44x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.263, Ratio=2.31x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.240, Ratio=2.17x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.249, Ratio=2.30x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.267, Ratio=2.42x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.268, Ratio=2.32x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.261, Ratio=2.38x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.241, Ratio=2.20x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.251, Ratio=2.30x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.268, Ratio=2.37x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.263, Ratio=2.32x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.262, Ratio=2.36x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.258, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.254, Ratio=2.34x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.241, Ratio=2.20x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.250, Ratio=2.22x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.269, Ratio=2.38x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.250, Ratio=2.32x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.269, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.265, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.284, Ratio=2.48x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.265, Ratio=2.32x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.252, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.269, Ratio=2.37x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.258, Ratio=2.22x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.253, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.257, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.263, Ratio=2.32x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.259, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.255, Ratio=2.33x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.253, Ratio=2.23x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.249, Ratio=2.32x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.262, Ratio=2.32x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.268, Ratio=2.29x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.279, Ratio=2.55x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.278, Ratio=2.37x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.244, Ratio=2.31x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.272, Ratio=2.31x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.283, Ratio=2.42x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.231, Ratio=2.17x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.281, Ratio=2.43x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.254, Ratio=2.33x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.259, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.262, Ratio=2.34x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.267, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.235, Ratio=2.15x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.263, Ratio=2.33x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.260, Ratio=2.24x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.265, Ratio=2.37x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.26x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.264, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.24x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.246, Ratio=2.22x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.247, Ratio=2.28x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.259, Ratio=2.27x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.255, Ratio=2.32x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.270, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.261, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.262, Ratio=2.37x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.242, Ratio=2.24x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.268, Ratio=2.42x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.256, Ratio=2.35x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.248, Ratio=2.22x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.264, Ratio=2.31x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.250, Ratio=2.29x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.257, Ratio=2.26x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.266, Ratio=2.35x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.257, Ratio=2.32x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.271, Ratio=2.37x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.261, Ratio=2.39x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.260, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.265, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.243, Ratio=2.25x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.272, Ratio=2.46x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.261, Ratio=2.29x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.280, Ratio=2.44x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.254, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.250, Ratio=2.26x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.267, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.239, Ratio=2.16x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.259, Ratio=2.41x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.262, Ratio=2.34x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.247, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.35x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.272, Ratio=2.42x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.255, Ratio=2.34x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.269, Ratio=2.40x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.279, Ratio=2.52x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.273, Ratio=2.31x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.256, Ratio=2.31x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.257, Ratio=2.23x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.266, Ratio=2.36x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.27x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.264, Ratio=2.37x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.263, Ratio=2.33x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.249, Ratio=2.16x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.248, Ratio=2.25x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.262, Ratio=2.37x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.240, Ratio=2.21x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.272, Ratio=2.29x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.268, Ratio=2.32x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.260, Ratio=2.31x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.269, Ratio=2.38x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.265, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.272, Ratio=2.35x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.259, Ratio=2.37x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.261, Ratio=2.40x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.256, Ratio=2.30x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.259, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.253, Ratio=2.26x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.266, Ratio=2.34x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.260, Ratio=2.27x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.265, Ratio=2.38x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.253, Ratio=2.31x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.251, Ratio=2.27x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.260, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.249, Ratio=2.30x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.251, Ratio=2.24x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.273, Ratio=2.38x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.246, Ratio=2.21x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.258, Ratio=2.26x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.261, Ratio=2.35x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.251, Ratio=2.22x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.257, Ratio=2.34x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.247, Ratio=2.29x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.267, Ratio=2.39x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.247, Ratio=2.26x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.257, Ratio=2.33x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.239, Ratio=2.21x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.261, Ratio=2.27x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.263, Ratio=2.34x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.246, Ratio=2.22x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.258, Ratio=2.33x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.258, Ratio=2.35x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.249, Ratio=2.26x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.265, Ratio=2.33x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.270, Ratio=2.33x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.274, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.273, Ratio=2.44x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.270, Ratio=2.35x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.259, Ratio=2.34x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.260, Ratio=2.35x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.270, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.246, Ratio=2.21x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.261, Ratio=2.28x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.275, Ratio=2.34x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.247, Ratio=2.18x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.253, Ratio=2.32x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.257, Ratio=2.31x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.273, Ratio=2.40x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.254, Ratio=2.25x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.267, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.251, Ratio=2.25x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.264, Ratio=2.36x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.240, Ratio=2.21x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.269, Ratio=2.40x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.255, Ratio=2.30x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.275, Ratio=2.44x, Gap=-2.664

============================================================
Epoch 8/20 completed in 30.1s
Train: Loss=1.3480 (C:1.3480, R:0.0018) Ratio=2.24x
Val:   Loss=1.3259 (C:1.3259, R:0.0018) Ratio=2.44x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.3259)
============================================================

Epoch 9 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.258, Ratio=2.28x, Gap=-2.642
Batch   0/537: Loss=1.3367 (C:1.3367, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.271, Ratio=2.36x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.274, Ratio=2.30x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.248, Ratio=2.20x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.272, Ratio=2.29x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.251, Ratio=2.21x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.252, Ratio=2.20x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.248, Ratio=2.30x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.230, Ratio=2.21x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.233, Ratio=2.19x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.247, Ratio=2.24x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.246, Ratio=2.26x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.252, Ratio=2.25x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.26x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.274, Ratio=2.28x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.284, Ratio=2.43x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.265, Ratio=2.20x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.248, Ratio=2.15x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.245, Ratio=2.13x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.255, Ratio=2.18x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.262, Ratio=2.39x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.274, Ratio=2.37x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.277, Ratio=2.35x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.271, Ratio=2.37x, Gap=-2.771
Batch  25/537: Loss=1.3080 (C:1.3080, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.268, Ratio=2.36x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.262, Ratio=2.30x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.268, Ratio=2.36x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.253, Ratio=2.20x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.261, Ratio=2.33x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.232, Ratio=2.11x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.243, Ratio=2.25x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.230, Ratio=2.16x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.32x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.270, Ratio=2.28x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.257, Ratio=2.23x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.262, Ratio=2.26x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.264, Ratio=2.24x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.256, Ratio=2.23x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.247, Ratio=2.21x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.264, Ratio=2.21x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.240, Ratio=2.19x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.261, Ratio=2.40x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.251, Ratio=2.23x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.243, Ratio=2.25x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.239, Ratio=2.29x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.248, Ratio=2.23x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.21x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.256, Ratio=2.28x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.253, Ratio=2.22x, Gap=-2.829
Batch  50/537: Loss=1.3532 (C:1.3532, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.257, Ratio=2.25x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.265, Ratio=2.28x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.262, Ratio=2.27x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.268, Ratio=2.33x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.237, Ratio=2.16x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.255, Ratio=2.22x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.272, Ratio=2.30x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.268, Ratio=2.28x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.253, Ratio=2.22x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.248, Ratio=2.22x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.263, Ratio=2.31x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.258, Ratio=2.30x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.244, Ratio=2.19x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.267, Ratio=2.33x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.270, Ratio=2.35x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.272, Ratio=2.28x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.256, Ratio=2.23x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.247, Ratio=2.16x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.279, Ratio=2.39x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.259, Ratio=2.30x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.252, Ratio=2.24x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.266, Ratio=2.29x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.277, Ratio=2.31x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.260, Ratio=2.29x, Gap=-2.893
Batch  75/537: Loss=1.3342 (C:1.3342, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.262, Ratio=2.20x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.252, Ratio=2.21x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.246, Ratio=2.18x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.244, Ratio=2.24x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.253, Ratio=2.24x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.271, Ratio=2.30x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.267, Ratio=2.26x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.271, Ratio=2.29x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.273, Ratio=2.31x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.277, Ratio=2.41x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.268, Ratio=2.28x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.24x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.264, Ratio=2.30x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.265, Ratio=2.25x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.270, Ratio=2.27x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.245, Ratio=2.19x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.260, Ratio=2.27x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.253, Ratio=2.18x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.254, Ratio=2.19x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.263, Ratio=2.25x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.264, Ratio=2.27x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.274, Ratio=2.37x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.257, Ratio=2.22x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.262, Ratio=2.30x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.266, Ratio=2.31x, Gap=-2.873
Batch 100/537: Loss=1.3264 (C:1.3264, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.262, Ratio=2.24x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.246, Ratio=2.17x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.264, Ratio=2.34x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.254, Ratio=2.22x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.272, Ratio=2.25x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.259, Ratio=2.27x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.270, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.263, Ratio=2.29x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.269, Ratio=2.32x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.283, Ratio=2.41x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.254, Ratio=2.29x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.250, Ratio=2.23x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.269, Ratio=2.31x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.258, Ratio=2.26x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.265, Ratio=2.39x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.274, Ratio=2.37x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.254, Ratio=2.23x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.252, Ratio=2.20x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.253, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.258, Ratio=2.31x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.269, Ratio=2.34x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.255, Ratio=2.24x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.255, Ratio=2.28x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.258, Ratio=2.28x, Gap=-2.640
Batch 125/537: Loss=1.3334 (C:1.3334, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.247, Ratio=2.19x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.270, Ratio=2.30x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.255, Ratio=2.22x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.266, Ratio=2.26x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.267, Ratio=2.35x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.275, Ratio=2.30x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.257, Ratio=2.27x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.278, Ratio=2.34x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.276, Ratio=2.39x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.269, Ratio=2.33x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.265, Ratio=2.21x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.249, Ratio=2.28x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.21x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.258, Ratio=2.33x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.264, Ratio=2.31x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.272, Ratio=2.31x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.249, Ratio=2.27x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.279, Ratio=2.37x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.267, Ratio=2.29x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.246, Ratio=2.16x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.247, Ratio=2.17x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.261, Ratio=2.25x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.240, Ratio=2.23x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.252, Ratio=2.20x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.274, Ratio=2.40x, Gap=-2.970
Batch 150/537: Loss=1.3046 (C:1.3046, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.237, Ratio=2.14x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.245, Ratio=2.25x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.29x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.266, Ratio=2.33x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.273, Ratio=2.38x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.260, Ratio=2.20x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.271, Ratio=2.31x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.277, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.252, Ratio=2.22x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.248, Ratio=2.19x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.265, Ratio=2.26x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.256, Ratio=2.25x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.259, Ratio=2.30x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.239, Ratio=2.17x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.257, Ratio=2.29x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.269, Ratio=2.38x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.251, Ratio=2.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.269, Ratio=2.33x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.249, Ratio=2.28x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.258, Ratio=2.25x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.286, Ratio=2.43x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.255, Ratio=2.29x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.266, Ratio=2.31x, Gap=-2.686
Batch 175/537: Loss=1.3276 (C:1.3276, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.276, Ratio=2.34x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.256, Ratio=2.29x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.249, Ratio=2.18x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.246, Ratio=2.18x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.245, Ratio=2.24x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.246, Ratio=2.11x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.260, Ratio=2.36x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.263, Ratio=2.23x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.243, Ratio=2.19x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.244, Ratio=2.22x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.251, Ratio=2.21x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.242, Ratio=2.18x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.263, Ratio=2.21x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.252, Ratio=2.28x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.270, Ratio=2.27x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.262, Ratio=2.22x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.262, Ratio=2.31x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.271, Ratio=2.28x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.258, Ratio=2.23x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.242, Ratio=2.20x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.273, Ratio=2.34x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.257, Ratio=2.26x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.257, Ratio=2.22x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.247, Ratio=2.21x, Gap=-2.950
Batch 200/537: Loss=1.3580 (C:1.3580, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.255, Ratio=2.29x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.258, Ratio=2.30x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.256, Ratio=2.32x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.250, Ratio=2.20x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.263, Ratio=2.24x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.26x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.245, Ratio=2.24x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.250, Ratio=2.18x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.260, Ratio=2.22x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.263, Ratio=2.25x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.265, Ratio=2.27x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.250, Ratio=2.19x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.236, Ratio=2.11x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.258, Ratio=2.29x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.275, Ratio=2.35x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.244, Ratio=2.18x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.257, Ratio=2.21x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.262, Ratio=2.33x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.241, Ratio=2.11x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.259, Ratio=2.20x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.272, Ratio=2.31x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.265, Ratio=2.29x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.275, Ratio=2.32x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.235, Ratio=2.18x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.255, Ratio=2.17x, Gap=-2.700
Batch 225/537: Loss=1.3655 (C:1.3655, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.284, Ratio=2.38x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.275, Ratio=2.37x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.243, Ratio=2.10x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.260, Ratio=2.26x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.261, Ratio=2.40x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.265, Ratio=2.29x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.266, Ratio=2.31x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.272, Ratio=2.39x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.242, Ratio=2.20x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.285, Ratio=2.37x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.31x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.242, Ratio=2.10x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.260, Ratio=2.19x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.254, Ratio=2.20x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.256, Ratio=2.25x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.246, Ratio=2.19x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.247, Ratio=2.26x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.251, Ratio=2.24x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.278, Ratio=2.43x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.261, Ratio=2.37x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.274, Ratio=2.33x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.262, Ratio=2.27x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.269, Ratio=2.22x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.255, Ratio=2.19x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.281, Ratio=2.35x, Gap=-2.805
Batch 250/537: Loss=1.3099 (C:1.3099, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.244, Ratio=2.17x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.238, Ratio=2.15x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.263, Ratio=2.26x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.258, Ratio=2.27x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.263, Ratio=2.26x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.240, Ratio=2.17x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.259, Ratio=2.20x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.236, Ratio=2.09x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.260, Ratio=2.16x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.273, Ratio=2.32x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.236, Ratio=2.13x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.265, Ratio=2.24x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.273, Ratio=2.33x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.254, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.237, Ratio=2.17x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.250, Ratio=2.21x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.251, Ratio=2.25x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.251, Ratio=2.28x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.253, Ratio=2.30x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.274, Ratio=2.34x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.260, Ratio=2.18x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.256, Ratio=2.29x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.243, Ratio=2.18x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.247, Ratio=2.22x, Gap=-2.901
Batch 275/537: Loss=1.3581 (C:1.3581, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.231, Ratio=2.09x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.245, Ratio=2.27x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.242, Ratio=2.18x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.251, Ratio=2.19x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.253, Ratio=2.22x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.267, Ratio=2.39x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.248, Ratio=2.18x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.257, Ratio=2.24x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.274, Ratio=2.41x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.273, Ratio=2.39x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.275, Ratio=2.27x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.260, Ratio=2.24x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.249, Ratio=2.15x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.249, Ratio=2.21x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.273, Ratio=2.34x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.259, Ratio=2.31x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.263, Ratio=2.40x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.238, Ratio=2.22x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.258, Ratio=2.24x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.267, Ratio=2.26x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.261, Ratio=2.23x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.257, Ratio=2.16x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.270, Ratio=2.30x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.253, Ratio=2.24x, Gap=-2.748
Batch 300/537: Loss=1.3489 (C:1.3489, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.246, Ratio=2.16x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.260, Ratio=2.22x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.254, Ratio=2.20x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.228, Ratio=2.14x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.259, Ratio=2.29x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.253, Ratio=2.24x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.249, Ratio=2.16x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.272, Ratio=2.30x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.264, Ratio=2.23x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.257, Ratio=2.23x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.242, Ratio=2.23x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.262, Ratio=2.25x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.256, Ratio=2.32x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.255, Ratio=2.26x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.246, Ratio=2.30x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.259, Ratio=2.34x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.248, Ratio=2.20x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.263, Ratio=2.20x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.258, Ratio=2.24x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.235, Ratio=2.15x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.255, Ratio=2.21x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.252, Ratio=2.20x, Gap=-2.892
Batch 325/537: Loss=1.3606 (C:1.3606, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.250, Ratio=2.23x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.278, Ratio=2.35x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.282, Ratio=2.38x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.265, Ratio=2.33x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.275, Ratio=2.34x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.269, Ratio=2.30x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.261, Ratio=2.30x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.253, Ratio=2.26x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.248, Ratio=2.22x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.283, Ratio=2.47x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.25x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.271, Ratio=2.29x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.252, Ratio=2.19x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.265, Ratio=2.23x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.254, Ratio=2.31x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.254, Ratio=2.25x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.253, Ratio=2.33x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.263, Ratio=2.23x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.268, Ratio=2.32x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.257, Ratio=2.23x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.263, Ratio=2.23x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.271, Ratio=2.34x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.264, Ratio=2.24x, Gap=-2.851
Batch 350/537: Loss=1.3445 (C:1.3445, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.265, Ratio=2.25x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.266, Ratio=2.24x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.263, Ratio=2.23x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.257, Ratio=2.21x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.254, Ratio=2.28x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.250, Ratio=2.24x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.264, Ratio=2.27x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.254, Ratio=2.27x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.252, Ratio=2.24x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.262, Ratio=2.30x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.275, Ratio=2.33x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.275, Ratio=2.27x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.268, Ratio=2.30x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.263, Ratio=2.25x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.254, Ratio=2.29x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.242, Ratio=2.23x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.255, Ratio=2.33x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.247, Ratio=2.18x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.267, Ratio=2.34x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.264, Ratio=2.33x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.255, Ratio=2.23x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.269, Ratio=2.37x, Gap=-2.823
Batch 375/537: Loss=1.3129 (C:1.3129, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.271, Ratio=2.29x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.264, Ratio=2.27x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.258, Ratio=2.28x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.248, Ratio=2.19x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.269, Ratio=2.28x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.241, Ratio=2.26x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.251, Ratio=2.27x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.248, Ratio=2.23x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.263, Ratio=2.19x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.261, Ratio=2.38x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.274, Ratio=2.32x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.259, Ratio=2.31x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.257, Ratio=2.25x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.259, Ratio=2.31x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.276, Ratio=2.36x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.275, Ratio=2.36x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.253, Ratio=2.26x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.268, Ratio=2.32x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.265, Ratio=2.29x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.247, Ratio=2.22x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.268, Ratio=2.26x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.261, Ratio=2.21x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.271, Ratio=2.30x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-3.016
Batch 400/537: Loss=1.3343 (C:1.3343, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.266, Ratio=2.31x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.249, Ratio=2.27x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.258, Ratio=2.20x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.256, Ratio=2.18x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.261, Ratio=2.28x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.265, Ratio=2.26x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.272, Ratio=2.36x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.276, Ratio=2.34x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.264, Ratio=2.23x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.252, Ratio=2.17x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.265, Ratio=2.24x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.259, Ratio=2.27x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.260, Ratio=2.26x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.249, Ratio=2.26x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.254, Ratio=2.25x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.260, Ratio=2.32x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.242, Ratio=2.14x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.285, Ratio=2.41x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.247, Ratio=2.24x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.247, Ratio=2.18x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.265, Ratio=2.26x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.252, Ratio=2.15x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.269, Ratio=2.32x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.270, Ratio=2.39x, Gap=-2.680
Batch 425/537: Loss=1.3030 (C:1.3030, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.263, Ratio=2.19x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.263, Ratio=2.32x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.270, Ratio=2.40x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.263, Ratio=2.23x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.250, Ratio=2.22x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.260, Ratio=2.27x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.252, Ratio=2.20x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.271, Ratio=2.31x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.258, Ratio=2.27x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.269, Ratio=2.27x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.237, Ratio=2.22x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.268, Ratio=2.28x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.255, Ratio=2.24x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.255, Ratio=2.22x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.255, Ratio=2.16x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.269, Ratio=2.23x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.265, Ratio=2.27x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.267, Ratio=2.28x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.270, Ratio=2.36x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.242, Ratio=2.17x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.255, Ratio=2.23x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.253, Ratio=2.18x, Gap=-3.043
Batch 450/537: Loss=1.3620 (C:1.3620, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.256, Ratio=2.26x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.271, Ratio=2.36x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.227, Ratio=2.12x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.261, Ratio=2.29x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.261, Ratio=2.29x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.275, Ratio=2.33x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.273, Ratio=2.27x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.267, Ratio=2.26x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.267, Ratio=2.23x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.260, Ratio=2.19x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.252, Ratio=2.22x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.244, Ratio=2.19x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.260, Ratio=2.34x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.256, Ratio=2.20x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.257, Ratio=2.25x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.260, Ratio=2.24x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.267, Ratio=2.28x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.248, Ratio=2.21x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.260, Ratio=2.24x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.253, Ratio=2.22x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.238, Ratio=2.26x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.247, Ratio=2.18x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.263, Ratio=2.33x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.270, Ratio=2.33x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.257, Ratio=2.25x, Gap=-3.031
Batch 475/537: Loss=1.3438 (C:1.3438, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.253, Ratio=2.28x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.255, Ratio=2.16x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.254, Ratio=2.23x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.250, Ratio=2.17x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.273, Ratio=2.33x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.273, Ratio=2.26x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.232, Ratio=2.15x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.273, Ratio=2.30x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.263, Ratio=2.27x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.265, Ratio=2.27x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.258, Ratio=2.36x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.272, Ratio=2.32x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.263, Ratio=2.28x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.267, Ratio=2.32x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.268, Ratio=2.32x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.265, Ratio=2.33x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.276, Ratio=2.43x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.264, Ratio=2.34x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.268, Ratio=2.34x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.259, Ratio=2.27x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.257, Ratio=2.23x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.243, Ratio=2.18x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.257, Ratio=2.31x, Gap=-3.069
Batch 500/537: Loss=1.3320 (C:1.3320, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.266, Ratio=2.28x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.260, Ratio=2.27x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.248, Ratio=2.27x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.258, Ratio=2.21x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.278, Ratio=2.34x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.258, Ratio=2.27x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.264, Ratio=2.27x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.264, Ratio=2.26x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.260, Ratio=2.27x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.263, Ratio=2.33x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.255, Ratio=2.22x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.247, Ratio=2.19x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.261, Ratio=2.26x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.253, Ratio=2.22x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.251, Ratio=2.27x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.237, Ratio=2.14x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.270, Ratio=2.29x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.256, Ratio=2.22x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.262, Ratio=2.32x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.276, Ratio=2.31x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.259, Ratio=2.20x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.287, Ratio=2.36x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.251, Ratio=2.24x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.276, Ratio=2.33x, Gap=-2.775
Batch 525/537: Loss=1.3220 (C:1.3220, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.282, Ratio=2.37x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.284, Ratio=2.42x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.35x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.266, Ratio=2.25x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.263, Ratio=2.27x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.265, Ratio=2.31x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.246, Ratio=2.20x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.259, Ratio=2.23x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.250, Ratio=2.19x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.260, Ratio=2.28x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.268, Ratio=2.33x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.269, Ratio=2.39x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.263, Ratio=2.24x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.267, Ratio=2.39x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.269, Ratio=2.38x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.281, Ratio=2.42x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.264, Ratio=2.25x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.256, Ratio=2.29x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.284, Ratio=2.49x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.263, Ratio=2.35x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.277, Ratio=2.47x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.269, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.270, Ratio=2.35x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.263, Ratio=2.25x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.251, Ratio=2.29x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.277, Ratio=2.38x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.287, Ratio=2.50x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.263, Ratio=2.36x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.266, Ratio=2.33x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.269, Ratio=2.38x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.263, Ratio=2.36x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.253, Ratio=2.28x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.271, Ratio=2.35x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.244, Ratio=2.18x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.264, Ratio=2.34x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.268, Ratio=2.38x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.292, Ratio=2.46x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.282, Ratio=2.45x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.247, Ratio=2.26x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.272, Ratio=2.41x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.281, Ratio=2.46x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.277, Ratio=2.40x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.260, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.256, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.256, Ratio=2.35x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.255, Ratio=2.22x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.259, Ratio=2.43x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.260, Ratio=2.30x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.262, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.274, Ratio=2.48x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.270, Ratio=2.40x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.265, Ratio=2.36x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.268, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.272, Ratio=2.35x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.269, Ratio=2.38x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.276, Ratio=2.44x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.271, Ratio=2.39x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.33x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.272, Ratio=2.37x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.285, Ratio=2.52x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.277, Ratio=2.45x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.259, Ratio=2.34x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.283, Ratio=2.52x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.261, Ratio=2.33x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.271, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.249, Ratio=2.25x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.257, Ratio=2.28x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.270, Ratio=2.34x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.271, Ratio=2.40x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.268, Ratio=2.35x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.258, Ratio=2.33x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.275, Ratio=2.34x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.274, Ratio=2.49x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.256, Ratio=2.27x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.274, Ratio=2.36x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.270, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.273, Ratio=2.36x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.266, Ratio=2.34x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.32x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.247, Ratio=2.20x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.274, Ratio=2.42x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.253, Ratio=2.18x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.261, Ratio=2.33x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.263, Ratio=2.28x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.271, Ratio=2.36x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.262, Ratio=2.30x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.248, Ratio=2.24x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.252, Ratio=2.27x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.279, Ratio=2.40x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.282, Ratio=2.43x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.281, Ratio=2.48x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.270, Ratio=2.40x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.267, Ratio=2.37x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.284, Ratio=2.52x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.248, Ratio=2.19x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.281, Ratio=2.45x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.265, Ratio=2.30x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.270, Ratio=2.47x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.264, Ratio=2.29x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.257, Ratio=2.27x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.278, Ratio=2.38x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.244, Ratio=2.20x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.266, Ratio=2.33x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.262, Ratio=2.31x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.257, Ratio=2.26x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.24x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.272, Ratio=2.41x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.280, Ratio=2.43x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.241, Ratio=2.19x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.270, Ratio=2.35x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.245, Ratio=2.20x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.263, Ratio=2.32x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.263, Ratio=2.33x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.263, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.275, Ratio=2.47x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.261, Ratio=2.35x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.270, Ratio=2.31x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.264, Ratio=2.36x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.256, Ratio=2.34x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.261, Ratio=2.34x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.268, Ratio=2.37x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.259, Ratio=2.40x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.279, Ratio=2.40x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.280, Ratio=2.44x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.244, Ratio=2.23x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.272, Ratio=2.40x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.249, Ratio=2.25x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.275, Ratio=2.38x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.246, Ratio=2.16x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.271, Ratio=2.37x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.262, Ratio=2.28x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.268, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.255, Ratio=2.29x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.273, Ratio=2.39x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.274, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.264, Ratio=2.32x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.259, Ratio=2.25x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.276, Ratio=2.38x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.267, Ratio=2.35x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.278, Ratio=2.45x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.258, Ratio=2.32x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.271, Ratio=2.34x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.272, Ratio=2.29x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.274, Ratio=2.35x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.245, Ratio=2.32x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.268, Ratio=2.33x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.265, Ratio=2.34x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.269, Ratio=2.32x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.252, Ratio=2.17x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.263, Ratio=2.36x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.250, Ratio=2.26x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.266, Ratio=2.31x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.252, Ratio=2.22x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.263, Ratio=2.38x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.265, Ratio=2.36x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.284, Ratio=2.52x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.245, Ratio=2.26x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.282, Ratio=2.45x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.264, Ratio=2.37x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.258, Ratio=2.36x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.267, Ratio=2.29x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.265, Ratio=2.36x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.257, Ratio=2.29x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.255, Ratio=2.24x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.284, Ratio=2.47x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.267, Ratio=2.36x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.280, Ratio=2.45x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.273, Ratio=2.39x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.277, Ratio=2.39x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.249, Ratio=2.30x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.270, Ratio=2.41x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.277, Ratio=2.45x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.250, Ratio=2.27x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.253, Ratio=2.25x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.266, Ratio=2.40x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.269, Ratio=2.30x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.254, Ratio=2.26x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.257, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.276, Ratio=2.42x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.277, Ratio=2.41x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.269, Ratio=2.41x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.275, Ratio=2.40x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.256, Ratio=2.26x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.272, Ratio=2.36x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.245, Ratio=2.24x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.254, Ratio=2.25x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.255, Ratio=2.30x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.262, Ratio=2.37x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.275, Ratio=2.45x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.257, Ratio=2.30x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.239, Ratio=2.14x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.283, Ratio=2.49x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.250, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.267, Ratio=2.32x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.267, Ratio=2.39x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.272, Ratio=2.42x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.266, Ratio=2.31x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.252, Ratio=2.21x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.283, Ratio=2.52x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.270, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.264, Ratio=2.35x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.273, Ratio=2.41x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.259, Ratio=2.35x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.256, Ratio=2.22x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.260, Ratio=2.30x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.257, Ratio=2.34x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.32x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.254, Ratio=2.24x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.256, Ratio=2.37x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.256, Ratio=2.32x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.268, Ratio=2.40x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.264, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.274, Ratio=2.37x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.278, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.272, Ratio=2.33x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.264, Ratio=2.23x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.261, Ratio=2.31x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.254, Ratio=2.21x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.261, Ratio=2.25x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.281, Ratio=2.41x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.268, Ratio=2.39x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.269, Ratio=2.41x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.276, Ratio=2.46x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.276, Ratio=2.39x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.257, Ratio=2.31x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.255, Ratio=2.31x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.247, Ratio=2.27x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.267, Ratio=2.43x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.268, Ratio=2.35x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.259, Ratio=2.35x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.288, Ratio=2.50x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.247, Ratio=2.19x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.268, Ratio=2.41x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.280, Ratio=2.40x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.272, Ratio=2.40x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.254, Ratio=2.30x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.275, Ratio=2.37x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.268, Ratio=2.38x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.259, Ratio=2.28x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.263, Ratio=2.40x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.254, Ratio=2.28x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.277, Ratio=2.42x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.249, Ratio=2.27x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.260, Ratio=2.30x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.254, Ratio=2.28x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.270, Ratio=2.38x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.276, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.272, Ratio=2.33x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.272, Ratio=2.45x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.239, Ratio=2.18x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.271, Ratio=2.32x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.274, Ratio=2.34x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.256, Ratio=2.27x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.273, Ratio=2.41x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.291, Ratio=2.54x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.243, Ratio=2.21x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.264, Ratio=2.29x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.266, Ratio=2.42x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.261, Ratio=2.35x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.277, Ratio=2.39x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.269, Ratio=2.46x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.267, Ratio=2.39x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.246, Ratio=2.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.252, Ratio=2.25x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.266, Ratio=2.41x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.267, Ratio=2.32x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.284, Ratio=2.44x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.258, Ratio=2.29x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.260, Ratio=2.30x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.251, Ratio=2.20x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.241, Ratio=2.19x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.263, Ratio=2.35x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.262, Ratio=2.23x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.253, Ratio=2.30x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.279, Ratio=2.46x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.265, Ratio=2.39x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.275, Ratio=2.39x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.268, Ratio=2.33x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.275, Ratio=2.44x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.282, Ratio=2.48x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.269, Ratio=2.33x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.257, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.262, Ratio=2.38x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.277, Ratio=2.37x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.246, Ratio=2.23x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.289, Ratio=2.49x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.277, Ratio=2.46x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.251, Ratio=2.25x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.250, Ratio=2.27x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.262, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.263, Ratio=2.34x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.272, Ratio=2.36x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.269, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.264, Ratio=2.28x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.273, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.273, Ratio=2.39x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.260, Ratio=2.30x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.260, Ratio=2.23x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.284, Ratio=2.44x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.271, Ratio=2.34x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.275, Ratio=2.39x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.272, Ratio=2.47x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.271, Ratio=2.33x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.252, Ratio=2.28x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.261, Ratio=2.40x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.266, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.275, Ratio=2.43x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.258, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.274, Ratio=2.50x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.259, Ratio=2.35x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.250, Ratio=2.26x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.260, Ratio=2.32x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.275, Ratio=2.41x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.273, Ratio=2.39x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.270, Ratio=2.35x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.259, Ratio=2.36x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.274, Ratio=2.36x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.262, Ratio=2.31x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.251, Ratio=2.20x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.264, Ratio=2.41x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.265, Ratio=2.33x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.258, Ratio=2.29x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.244, Ratio=2.25x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.276, Ratio=2.41x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.261, Ratio=2.32x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.267, Ratio=2.35x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.258, Ratio=2.35x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.252, Ratio=2.34x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.267, Ratio=2.35x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.261, Ratio=2.34x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.260, Ratio=2.34x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.261, Ratio=2.28x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.260, Ratio=2.29x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.268, Ratio=2.37x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.257, Ratio=2.24x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.266, Ratio=2.34x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.266, Ratio=2.41x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.254, Ratio=2.25x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.257, Ratio=2.31x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.256, Ratio=2.33x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.275, Ratio=2.43x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.258, Ratio=2.25x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.283, Ratio=2.53x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.268, Ratio=2.31x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.263, Ratio=2.29x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.243, Ratio=2.16x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.273, Ratio=2.39x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.267, Ratio=2.37x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.263, Ratio=2.40x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.262, Ratio=2.30x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.264, Ratio=2.34x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.268, Ratio=2.36x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.253, Ratio=2.27x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.255, Ratio=2.27x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.256, Ratio=2.25x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.267, Ratio=2.34x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.265, Ratio=2.38x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.266, Ratio=2.36x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.274, Ratio=2.34x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.263, Ratio=2.25x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.261, Ratio=2.42x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.265, Ratio=2.38x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.260, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.280, Ratio=2.51x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.265, Ratio=2.38x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.260, Ratio=2.27x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.267, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.268, Ratio=2.33x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.246, Ratio=2.29x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.271, Ratio=2.43x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.279, Ratio=2.44x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.279, Ratio=2.56x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.284, Ratio=2.54x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.267, Ratio=2.40x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.263, Ratio=2.34x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.270, Ratio=2.37x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.49x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.266, Ratio=2.35x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.277, Ratio=2.39x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.250, Ratio=2.25x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.275, Ratio=2.35x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.259, Ratio=2.29x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.32x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.272, Ratio=2.33x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.260, Ratio=2.31x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.249, Ratio=2.19x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.255, Ratio=2.26x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.256, Ratio=2.24x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.273, Ratio=2.37x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.247, Ratio=2.28x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.279, Ratio=2.43x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.289, Ratio=2.52x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.272, Ratio=2.38x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.270, Ratio=2.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.285, Ratio=2.46x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.263, Ratio=2.29x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.264, Ratio=2.33x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.254, Ratio=2.33x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.276, Ratio=2.44x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.283, Ratio=2.43x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.276, Ratio=2.43x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.255, Ratio=2.26x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.267, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.271, Ratio=2.28x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.254, Ratio=2.26x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.270, Ratio=2.40x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.262, Ratio=2.28x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.258, Ratio=2.26x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.285, Ratio=2.44x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.256, Ratio=2.24x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.256, Ratio=2.33x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.256, Ratio=2.26x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.267, Ratio=2.38x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.289, Ratio=2.45x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.272, Ratio=2.36x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.261, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.263, Ratio=2.23x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.240, Ratio=2.23x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.270, Ratio=2.43x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.274, Ratio=2.38x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.275, Ratio=2.33x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.266, Ratio=2.37x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.259, Ratio=2.30x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.273, Ratio=2.41x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.269, Ratio=2.39x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.265, Ratio=2.33x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.260, Ratio=2.35x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.280, Ratio=2.48x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.261, Ratio=2.33x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.251, Ratio=2.26x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.261, Ratio=2.38x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.271, Ratio=2.34x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.254, Ratio=2.28x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.267, Ratio=2.31x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.260, Ratio=2.32x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.253, Ratio=2.29x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.239, Ratio=2.32x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.259, Ratio=2.34x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.246, Ratio=2.28x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.253, Ratio=2.26x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.266, Ratio=2.45x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.266, Ratio=2.37x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.260, Ratio=2.38x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.274, Ratio=2.43x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.275, Ratio=2.48x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.270, Ratio=2.33x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.273, Ratio=2.36x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.266, Ratio=2.39x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.260, Ratio=2.24x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.264, Ratio=2.28x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.274, Ratio=2.42x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.271, Ratio=2.43x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.262, Ratio=2.31x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.263, Ratio=2.35x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.264, Ratio=2.45x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.258, Ratio=2.24x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.272, Ratio=2.38x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.272, Ratio=2.35x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.270, Ratio=2.34x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.260, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.267, Ratio=2.34x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.273, Ratio=2.42x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.273, Ratio=2.47x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.265, Ratio=2.35x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.261, Ratio=2.25x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.257, Ratio=2.29x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.278, Ratio=2.38x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.261, Ratio=2.31x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.276, Ratio=2.44x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.272, Ratio=2.43x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.271, Ratio=2.46x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.256, Ratio=2.28x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.280, Ratio=2.51x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.268, Ratio=2.38x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.254, Ratio=2.30x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.266, Ratio=2.43x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.268, Ratio=2.30x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.285, Ratio=2.42x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.281, Ratio=2.45x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.251, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.273, Ratio=2.48x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.259, Ratio=2.33x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.256, Ratio=2.29x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.284, Ratio=2.37x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.251, Ratio=2.29x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.257, Ratio=2.35x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.268, Ratio=2.37x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.273, Ratio=2.39x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.269, Ratio=2.42x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.267, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.252, Ratio=2.30x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.274, Ratio=2.43x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.272, Ratio=2.41x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.271, Ratio=2.35x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.268, Ratio=2.37x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.264, Ratio=2.32x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.265, Ratio=2.37x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.260, Ratio=2.27x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.261, Ratio=2.38x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.257, Ratio=2.22x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.251, Ratio=2.30x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.266, Ratio=2.33x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.256, Ratio=2.35x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.270, Ratio=2.33x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.250, Ratio=2.28x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.259, Ratio=2.33x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.264, Ratio=2.40x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.259, Ratio=2.28x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.269, Ratio=2.31x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.263, Ratio=2.30x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.243, Ratio=2.22x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.257, Ratio=2.30x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.258, Ratio=2.35x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.273, Ratio=2.35x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.265, Ratio=2.41x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.233, Ratio=2.22x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.274, Ratio=2.35x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.264, Ratio=2.32x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.279, Ratio=2.42x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.244, Ratio=2.28x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.264, Ratio=2.46x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.272, Ratio=2.47x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.262, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.285, Ratio=2.45x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.251, Ratio=2.29x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.254, Ratio=2.31x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.265, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.267, Ratio=2.35x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.274, Ratio=2.34x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.275, Ratio=2.37x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.262, Ratio=2.39x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.261, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.270, Ratio=2.40x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.251, Ratio=2.28x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.273, Ratio=2.33x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.258, Ratio=2.32x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.262, Ratio=2.30x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.258, Ratio=2.31x, Gap=-2.492

============================================================
Epoch 9/20 completed in 29.9s
Train: Loss=1.3408 (C:1.3408, R:0.0018) Ratio=2.33x
Val:   Loss=1.3182 (C:1.3182, R:0.0018) Ratio=2.52x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.3182)
============================================================

🌍 Updating global dataset at epoch 10
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.504 ± 0.667
    Neg distances: 1.296 ± 0.841
    Separation ratio: 2.57x
    Gap: -2.786
    ✅ Good global separation

Epoch 10 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.283, Ratio=2.44x, Gap=-2.765
Batch   0/537: Loss=1.2895 (C:1.2895, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.287, Ratio=2.42x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.286, Ratio=2.50x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.298, Ratio=2.54x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.290, Ratio=2.46x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.309, Ratio=2.52x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.303, Ratio=2.54x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.295, Ratio=2.48x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.308, Ratio=2.56x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.293, Ratio=2.43x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.294, Ratio=2.50x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.273, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.299, Ratio=2.56x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.289, Ratio=2.47x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.283, Ratio=2.43x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.285, Ratio=2.40x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.293, Ratio=2.57x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.293, Ratio=2.52x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.271, Ratio=2.33x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.298, Ratio=2.52x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.298, Ratio=2.49x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.306, Ratio=2.57x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.295, Ratio=2.45x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.288, Ratio=2.38x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.296, Ratio=2.39x, Gap=-2.838
Batch  25/537: Loss=1.2978 (C:1.2978, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.295, Ratio=2.47x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.289, Ratio=2.51x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.278, Ratio=2.45x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.305, Ratio=2.52x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.289, Ratio=2.45x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.292, Ratio=2.45x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.292, Ratio=2.50x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.276, Ratio=2.30x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.303, Ratio=2.55x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.280, Ratio=2.35x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.293, Ratio=2.38x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.290, Ratio=2.46x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.315, Ratio=2.69x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.285, Ratio=2.39x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.309, Ratio=2.59x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.287, Ratio=2.44x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.283, Ratio=2.41x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.293, Ratio=2.37x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.285, Ratio=2.48x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.291, Ratio=2.47x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.304, Ratio=2.49x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.291, Ratio=2.45x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.296, Ratio=2.51x, Gap=-2.887
Batch  50/537: Loss=1.2714 (C:1.2714, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.300, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.292, Ratio=2.43x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.298, Ratio=2.49x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.299, Ratio=2.48x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.298, Ratio=2.51x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.302, Ratio=2.50x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.290, Ratio=2.39x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.290, Ratio=2.46x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.285, Ratio=2.40x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.292, Ratio=2.43x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.300, Ratio=2.52x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.292, Ratio=2.44x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.295, Ratio=2.58x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.306, Ratio=2.59x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.302, Ratio=2.50x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.309, Ratio=2.44x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.295, Ratio=2.46x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.297, Ratio=2.43x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.300, Ratio=2.47x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.278, Ratio=2.39x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.307, Ratio=2.52x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.281, Ratio=2.44x, Gap=-2.912
Batch  75/537: Loss=1.2948 (C:1.2948, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.303, Ratio=2.59x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.299, Ratio=2.55x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.312, Ratio=2.55x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.286, Ratio=2.36x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.309, Ratio=2.66x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.306, Ratio=2.66x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.296, Ratio=2.46x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.293, Ratio=2.40x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.288, Ratio=2.42x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.303, Ratio=2.49x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.286, Ratio=2.37x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.308, Ratio=2.63x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.57x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.317, Ratio=2.64x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.295, Ratio=2.55x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.292, Ratio=2.45x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.294, Ratio=2.47x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.302, Ratio=2.52x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.297, Ratio=2.50x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.285, Ratio=2.43x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.286, Ratio=2.50x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.276, Ratio=2.42x, Gap=-2.837
Batch 100/537: Loss=1.3004 (C:1.3004, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.300, Ratio=2.54x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.307, Ratio=2.56x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.289, Ratio=2.46x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.306, Ratio=2.54x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.284, Ratio=2.43x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.283, Ratio=2.41x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.305, Ratio=2.52x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.282, Ratio=2.47x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.304, Ratio=2.60x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.291, Ratio=2.46x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.291, Ratio=2.50x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.306, Ratio=2.47x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.313, Ratio=2.55x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.317, Ratio=2.70x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.297, Ratio=2.45x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.293, Ratio=2.40x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.286, Ratio=2.37x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.278, Ratio=2.36x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.271, Ratio=2.40x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.294, Ratio=2.47x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.312, Ratio=2.60x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.286, Ratio=2.42x, Gap=-2.830
Batch 125/537: Loss=1.2938 (C:1.2938, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.290, Ratio=2.47x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.303, Ratio=2.50x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.300, Ratio=2.48x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.288, Ratio=2.52x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.287, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.311, Ratio=2.61x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.294, Ratio=2.44x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.292, Ratio=2.41x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.294, Ratio=2.44x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.309, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.321, Ratio=2.64x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.296, Ratio=2.45x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.296, Ratio=2.48x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.308, Ratio=2.57x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.293, Ratio=2.47x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.272, Ratio=2.34x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.273, Ratio=2.49x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.296, Ratio=2.49x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.287, Ratio=2.41x, Gap=-2.779
Batch 150/537: Loss=1.2989 (C:1.2989, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.293, Ratio=2.46x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.302, Ratio=2.51x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.298, Ratio=2.46x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.292, Ratio=2.42x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.300, Ratio=2.58x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.297, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.303, Ratio=2.57x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.294, Ratio=2.44x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.291, Ratio=2.49x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.308, Ratio=2.47x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.314, Ratio=2.51x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.284, Ratio=2.37x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.294, Ratio=2.47x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.314, Ratio=2.57x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.297, Ratio=2.52x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.287, Ratio=2.43x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.296, Ratio=2.48x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.285, Ratio=2.47x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.289, Ratio=2.52x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.300, Ratio=2.57x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.272, Ratio=2.37x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.307, Ratio=2.50x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.297, Ratio=2.47x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.806
Batch 175/537: Loss=1.3018 (C:1.3018, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.309, Ratio=2.57x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.291, Ratio=2.35x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.291, Ratio=2.45x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.307, Ratio=2.58x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.278, Ratio=2.39x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.298, Ratio=2.44x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.314, Ratio=2.59x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.317, Ratio=2.66x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.311, Ratio=2.57x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.276, Ratio=2.39x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.286, Ratio=2.38x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.42x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.290, Ratio=2.49x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.287, Ratio=2.35x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.305, Ratio=2.52x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.309, Ratio=2.62x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.294, Ratio=2.46x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.292, Ratio=2.48x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.280, Ratio=2.39x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.293, Ratio=2.50x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.281, Ratio=2.35x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.304, Ratio=2.53x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.300, Ratio=2.48x, Gap=-3.163
Batch 200/537: Loss=1.2783 (C:1.2783, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.289, Ratio=2.46x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.299, Ratio=2.62x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.300, Ratio=2.48x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.313, Ratio=2.63x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.267, Ratio=2.38x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.304, Ratio=2.58x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.280, Ratio=2.39x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.276, Ratio=2.43x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.293, Ratio=2.49x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.292, Ratio=2.49x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.278, Ratio=2.33x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.287, Ratio=2.37x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.297, Ratio=2.45x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.294, Ratio=2.51x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.295, Ratio=2.46x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.313, Ratio=2.65x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.286, Ratio=2.51x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.53x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.279, Ratio=2.35x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.288, Ratio=2.48x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.291, Ratio=2.41x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.278, Ratio=2.37x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.293, Ratio=2.45x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.283, Ratio=2.39x, Gap=-2.835
Batch 225/537: Loss=1.3046 (C:1.3046, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.297, Ratio=2.53x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.281, Ratio=2.29x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.287, Ratio=2.44x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.298, Ratio=2.53x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.288, Ratio=2.45x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.293, Ratio=2.52x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.282, Ratio=2.36x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.306, Ratio=2.48x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.305, Ratio=2.57x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.313, Ratio=2.61x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.294, Ratio=2.40x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.280, Ratio=2.42x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.274, Ratio=2.35x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.51x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.306, Ratio=2.65x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.294, Ratio=2.53x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.288, Ratio=2.42x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.306, Ratio=2.50x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.289, Ratio=2.49x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.282, Ratio=2.34x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.312, Ratio=2.58x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.306, Ratio=2.52x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.297, Ratio=2.69x, Gap=-2.642
Batch 250/537: Loss=1.2367 (C:1.2367, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.279, Ratio=2.51x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.304, Ratio=2.47x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.292, Ratio=2.44x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.301, Ratio=2.50x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.292, Ratio=2.45x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.299, Ratio=2.62x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.43x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.284, Ratio=2.37x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.302, Ratio=2.49x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.287, Ratio=2.42x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.322, Ratio=2.65x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.287, Ratio=2.49x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.278, Ratio=2.39x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.312, Ratio=2.56x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.270, Ratio=2.33x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.278, Ratio=2.30x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.315, Ratio=2.60x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.307, Ratio=2.60x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.281, Ratio=2.38x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.276, Ratio=2.40x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.304, Ratio=2.48x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.282, Ratio=2.34x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.289, Ratio=2.41x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.294, Ratio=2.54x, Gap=-2.963
Batch 275/537: Loss=1.2646 (C:1.2646, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.310, Ratio=2.51x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.305, Ratio=2.58x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.284, Ratio=2.32x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.297, Ratio=2.47x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.293, Ratio=2.44x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.306, Ratio=2.56x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.283, Ratio=2.44x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.286, Ratio=2.43x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.319, Ratio=2.67x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.304, Ratio=2.47x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.294, Ratio=2.46x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.285, Ratio=2.42x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.302, Ratio=2.40x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.299, Ratio=2.49x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.296, Ratio=2.42x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.292, Ratio=2.40x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.291, Ratio=2.46x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.291, Ratio=2.47x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.292, Ratio=2.45x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.272, Ratio=2.34x, Gap=-2.905
Batch 300/537: Loss=1.3203 (C:1.3203, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.294, Ratio=2.48x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.286, Ratio=2.40x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.290, Ratio=2.37x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.299, Ratio=2.59x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.287, Ratio=2.38x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.301, Ratio=2.48x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.288, Ratio=2.42x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.303, Ratio=2.43x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.307, Ratio=2.51x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.283, Ratio=2.43x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.286, Ratio=2.46x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.310, Ratio=2.46x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.287, Ratio=2.37x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.293, Ratio=2.52x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.72x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.293, Ratio=2.48x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.309, Ratio=2.57x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.284, Ratio=2.38x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.299, Ratio=2.51x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.281, Ratio=2.45x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.299, Ratio=2.48x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.294, Ratio=2.54x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.311, Ratio=2.65x, Gap=-2.644
Batch 325/537: Loss=1.2385 (C:1.2385, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.287, Ratio=2.44x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.297, Ratio=2.46x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.44x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.289, Ratio=2.43x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.297, Ratio=2.52x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.288, Ratio=2.49x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.276, Ratio=2.36x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.297, Ratio=2.47x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.307, Ratio=2.48x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.296, Ratio=2.54x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.294, Ratio=2.45x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.292, Ratio=2.45x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.292, Ratio=2.47x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.279, Ratio=2.40x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.288, Ratio=2.52x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.289, Ratio=2.51x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.312, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.299, Ratio=2.61x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.290, Ratio=2.59x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.293, Ratio=2.42x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.295, Ratio=2.41x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.307, Ratio=2.53x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.281, Ratio=2.43x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.297, Ratio=2.56x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.281, Ratio=2.46x, Gap=-2.760
Batch 350/537: Loss=1.2888 (C:1.2888, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.299, Ratio=2.48x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.291, Ratio=2.53x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.316, Ratio=2.63x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.299, Ratio=2.43x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.295, Ratio=2.52x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.299, Ratio=2.48x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.299, Ratio=2.49x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.321, Ratio=2.57x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.292, Ratio=2.43x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.299, Ratio=2.51x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.286, Ratio=2.46x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.279, Ratio=2.37x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.310, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.285, Ratio=2.54x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.276, Ratio=2.40x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.276, Ratio=2.42x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.296, Ratio=2.60x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.298, Ratio=2.43x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.315, Ratio=2.54x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.309, Ratio=2.63x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.303, Ratio=2.51x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.302, Ratio=2.44x, Gap=-2.854
Batch 375/537: Loss=1.2852 (C:1.2852, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.301, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.299, Ratio=2.51x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.308, Ratio=2.48x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.313, Ratio=2.62x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.316, Ratio=2.61x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.289, Ratio=2.45x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.287, Ratio=2.36x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.267, Ratio=2.43x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.298, Ratio=2.51x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.291, Ratio=2.52x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.285, Ratio=2.38x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.285, Ratio=2.30x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.295, Ratio=2.48x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.297, Ratio=2.44x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.291, Ratio=2.44x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.311, Ratio=2.62x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.275, Ratio=2.36x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.302, Ratio=2.54x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.41x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.270, Ratio=2.36x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.295, Ratio=2.52x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.281, Ratio=2.42x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.304, Ratio=2.46x, Gap=-2.918
Batch 400/537: Loss=1.2786 (C:1.2786, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.285, Ratio=2.43x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.286, Ratio=2.40x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.300, Ratio=2.46x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.290, Ratio=2.43x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.321, Ratio=2.65x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.310, Ratio=2.51x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.302, Ratio=2.54x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.296, Ratio=2.50x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.309, Ratio=2.62x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.50x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.284, Ratio=2.40x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.288, Ratio=2.46x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.284, Ratio=2.40x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.298, Ratio=2.50x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.310, Ratio=2.50x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.315, Ratio=2.61x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.304, Ratio=2.56x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.301, Ratio=2.43x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.289, Ratio=2.45x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.284, Ratio=2.48x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.308, Ratio=2.63x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.290, Ratio=2.50x, Gap=-2.878
Batch 425/537: Loss=1.2773 (C:1.2773, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.302, Ratio=2.50x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.314, Ratio=2.57x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.290, Ratio=2.42x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.304, Ratio=2.55x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.278, Ratio=2.39x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.294, Ratio=2.55x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.305, Ratio=2.53x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.307, Ratio=2.58x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.299, Ratio=2.60x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.299, Ratio=2.51x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.284, Ratio=2.39x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.284, Ratio=2.35x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.50x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.301, Ratio=2.50x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.293, Ratio=2.48x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.309, Ratio=2.52x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.301, Ratio=2.54x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.286, Ratio=2.47x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.299, Ratio=2.52x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.308, Ratio=2.58x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.313, Ratio=2.65x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.296, Ratio=2.51x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.294, Ratio=2.51x, Gap=-2.979
Batch 450/537: Loss=1.2700 (C:1.2700, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.46x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.289, Ratio=2.40x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.316, Ratio=2.54x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.305, Ratio=2.56x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.297, Ratio=2.41x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.299, Ratio=2.36x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.306, Ratio=2.49x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.279, Ratio=2.43x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.275, Ratio=2.37x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.272, Ratio=2.49x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.273, Ratio=2.40x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.49x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.288, Ratio=2.44x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.301, Ratio=2.47x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.294, Ratio=2.42x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.303, Ratio=2.44x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.293, Ratio=2.34x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.298, Ratio=2.53x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.317, Ratio=2.59x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.302, Ratio=2.56x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.303, Ratio=2.51x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.273, Ratio=2.40x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.290, Ratio=2.48x, Gap=-3.020
Batch 475/537: Loss=1.2794 (C:1.2794, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.281, Ratio=2.41x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.286, Ratio=2.43x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.299, Ratio=2.46x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.308, Ratio=2.65x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.297, Ratio=2.45x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.295, Ratio=2.44x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.302, Ratio=2.55x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.285, Ratio=2.45x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.289, Ratio=2.44x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.303, Ratio=2.50x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.286, Ratio=2.45x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.307, Ratio=2.48x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.288, Ratio=2.42x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.301, Ratio=2.46x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.295, Ratio=2.49x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.305, Ratio=2.60x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.285, Ratio=2.47x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.285, Ratio=2.46x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.283, Ratio=2.40x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.298, Ratio=2.43x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.276, Ratio=2.43x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.314, Ratio=2.60x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.61x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.293, Ratio=2.51x, Gap=-2.982
Batch 500/537: Loss=1.2765 (C:1.2765, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.301, Ratio=2.52x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.315, Ratio=2.60x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.322, Ratio=2.53x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.290, Ratio=2.41x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.309, Ratio=2.51x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.299, Ratio=2.45x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.294, Ratio=2.37x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.294, Ratio=2.45x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.293, Ratio=2.51x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.301, Ratio=2.54x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.288, Ratio=2.43x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.288, Ratio=2.42x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.290, Ratio=2.45x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.295, Ratio=2.48x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.296, Ratio=2.50x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.288, Ratio=2.46x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.302, Ratio=2.50x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.310, Ratio=2.60x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.315, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.301, Ratio=2.52x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.291, Ratio=2.42x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.280, Ratio=2.38x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.302, Ratio=2.53x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.286, Ratio=2.45x, Gap=-2.738
Batch 525/537: Loss=1.2894 (C:1.2894, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.283, Ratio=2.41x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.291, Ratio=2.52x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.300, Ratio=2.52x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.43x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.302, Ratio=2.44x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.287, Ratio=2.36x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.312, Ratio=2.58x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.305, Ratio=2.51x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.293, Ratio=2.49x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.299, Ratio=2.39x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.295, Ratio=2.45x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.298, Ratio=2.63x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.293, Ratio=2.47x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.315, Ratio=2.82x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.289, Ratio=2.45x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.297, Ratio=2.60x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.61x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.54x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.312, Ratio=2.69x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.304, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.304, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.283, Ratio=2.42x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.300, Ratio=2.65x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.316, Ratio=2.71x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.286, Ratio=2.48x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.308, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.312, Ratio=2.69x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.295, Ratio=2.56x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.294, Ratio=2.51x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.307, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.281, Ratio=2.43x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.312, Ratio=2.63x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.319, Ratio=2.68x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.311, Ratio=2.65x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.287, Ratio=2.50x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.311, Ratio=2.60x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.304, Ratio=2.54x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.292, Ratio=2.50x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.312, Ratio=2.62x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.284, Ratio=2.48x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.319, Ratio=2.71x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.304, Ratio=2.62x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.294, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.286, Ratio=2.42x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.306, Ratio=2.74x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.321, Ratio=2.66x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.305, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.294, Ratio=2.58x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.305, Ratio=2.62x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.319, Ratio=2.69x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.302, Ratio=2.56x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.301, Ratio=2.57x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.299, Ratio=2.59x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.301, Ratio=2.56x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.279, Ratio=2.41x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.306, Ratio=2.61x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.294, Ratio=2.53x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.305, Ratio=2.63x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.320, Ratio=2.80x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.298, Ratio=2.55x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.313, Ratio=2.65x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.301, Ratio=2.62x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.302, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.295, Ratio=2.63x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.292, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.306, Ratio=2.56x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.286, Ratio=2.50x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.291, Ratio=2.51x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.285, Ratio=2.48x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.300, Ratio=2.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.295, Ratio=2.46x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.280, Ratio=2.44x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.308, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.294, Ratio=2.52x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.301, Ratio=2.54x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.293, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.311, Ratio=2.71x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.300, Ratio=2.68x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.319, Ratio=2.75x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.291, Ratio=2.49x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.296, Ratio=2.55x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.293, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.288, Ratio=2.50x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.301, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.295, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.300, Ratio=2.59x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.295, Ratio=2.55x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.293, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.289, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.293, Ratio=2.51x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.56x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.299, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.300, Ratio=2.64x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.310, Ratio=2.76x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.318, Ratio=2.70x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.308, Ratio=2.54x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.283, Ratio=2.44x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.283, Ratio=2.53x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.296, Ratio=2.54x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.296, Ratio=2.48x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.316, Ratio=2.85x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.303, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.285, Ratio=2.53x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.307, Ratio=2.67x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.297, Ratio=2.59x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.288, Ratio=2.51x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.306, Ratio=2.64x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.287, Ratio=2.57x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.61x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.292, Ratio=2.48x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.308, Ratio=2.66x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.288, Ratio=2.46x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.308, Ratio=2.68x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.294, Ratio=2.54x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.305, Ratio=2.63x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.311, Ratio=2.72x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.284, Ratio=2.46x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.312, Ratio=2.68x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.319, Ratio=2.69x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.296, Ratio=2.59x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.304, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.304, Ratio=2.57x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.295, Ratio=2.51x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.302, Ratio=2.56x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.56x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.309, Ratio=2.65x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.304, Ratio=2.60x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.299, Ratio=2.66x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.304, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.303, Ratio=2.66x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.296, Ratio=2.56x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.300, Ratio=2.66x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.293, Ratio=2.54x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.293, Ratio=2.56x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.317, Ratio=2.73x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.304, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.277, Ratio=2.51x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.308, Ratio=2.65x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.317, Ratio=2.77x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.306, Ratio=2.57x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.310, Ratio=2.72x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.315, Ratio=2.70x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.285, Ratio=2.42x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.300, Ratio=2.67x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.301, Ratio=2.57x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.285, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.295, Ratio=2.65x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.299, Ratio=2.57x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.298, Ratio=2.54x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.286, Ratio=2.51x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.292, Ratio=2.60x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.306, Ratio=2.69x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.307, Ratio=2.63x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.292, Ratio=2.47x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.288, Ratio=2.48x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.325, Ratio=2.78x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.316, Ratio=2.70x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.306, Ratio=2.55x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.292, Ratio=2.57x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.300, Ratio=2.56x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.303, Ratio=2.68x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.302, Ratio=2.62x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.312, Ratio=2.73x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.288, Ratio=2.48x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.314, Ratio=2.69x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.305, Ratio=2.58x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.296, Ratio=2.52x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.56x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.287, Ratio=2.51x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.308, Ratio=2.63x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.313, Ratio=2.71x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.315, Ratio=2.66x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.300, Ratio=2.66x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.293, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.313, Ratio=2.66x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.309, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.316, Ratio=2.71x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.303, Ratio=2.63x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.291, Ratio=2.48x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.300, Ratio=2.66x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.302, Ratio=2.57x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.296, Ratio=2.49x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.301, Ratio=2.58x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.307, Ratio=2.73x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.312, Ratio=2.69x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.282, Ratio=2.50x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.295, Ratio=2.57x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.294, Ratio=2.54x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.317, Ratio=2.68x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.301, Ratio=2.58x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.283, Ratio=2.47x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.302, Ratio=2.68x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.50x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.296, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.301, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.292, Ratio=2.45x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.286, Ratio=2.51x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.292, Ratio=2.46x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.288, Ratio=2.54x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.313, Ratio=2.63x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.287, Ratio=2.50x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.301, Ratio=2.63x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.312, Ratio=2.66x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.302, Ratio=2.60x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.297, Ratio=2.57x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.306, Ratio=2.63x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.304, Ratio=2.63x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.298, Ratio=2.57x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.314, Ratio=2.66x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.301, Ratio=2.56x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.295, Ratio=2.51x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.301, Ratio=2.59x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.326, Ratio=2.77x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.286, Ratio=2.44x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.288, Ratio=2.53x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.296, Ratio=2.64x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.306, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.301, Ratio=2.58x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.304, Ratio=2.62x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.300, Ratio=2.56x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.292, Ratio=2.55x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.288, Ratio=2.58x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.315, Ratio=2.69x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.306, Ratio=2.67x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.302, Ratio=2.57x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.284, Ratio=2.49x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.295, Ratio=2.51x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.290, Ratio=2.43x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.314, Ratio=2.74x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.294, Ratio=2.59x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.288, Ratio=2.48x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.299, Ratio=2.62x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.293, Ratio=2.55x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.301, Ratio=2.58x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.304, Ratio=2.65x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.285, Ratio=2.48x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.292, Ratio=2.53x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.289, Ratio=2.45x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.308, Ratio=2.69x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.298, Ratio=2.54x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.283, Ratio=2.44x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.313, Ratio=2.76x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.311, Ratio=2.58x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.303, Ratio=2.52x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.293, Ratio=2.49x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.281, Ratio=2.42x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.289, Ratio=2.48x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.58x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.297, Ratio=2.52x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.309, Ratio=2.63x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.289, Ratio=2.47x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.297, Ratio=2.52x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.268, Ratio=2.40x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.288, Ratio=2.50x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.288, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.305, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.309, Ratio=2.66x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.302, Ratio=2.62x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.300, Ratio=2.58x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.291, Ratio=2.56x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.290, Ratio=2.50x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.320, Ratio=2.69x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.311, Ratio=2.63x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.306, Ratio=2.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.305, Ratio=2.54x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.287, Ratio=2.59x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.301, Ratio=2.57x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.287, Ratio=2.53x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.297, Ratio=2.58x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.297, Ratio=2.59x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.302, Ratio=2.64x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.288, Ratio=2.53x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.280, Ratio=2.40x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.319, Ratio=2.75x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.305, Ratio=2.60x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.290, Ratio=2.49x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.315, Ratio=2.74x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.292, Ratio=2.50x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.299, Ratio=2.52x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.301, Ratio=2.58x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.299, Ratio=2.64x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.323, Ratio=2.72x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.288, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.316, Ratio=2.69x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.305, Ratio=2.64x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.315, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.299, Ratio=2.68x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.280, Ratio=2.44x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.324, Ratio=2.78x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.310, Ratio=2.69x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.295, Ratio=2.49x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.317, Ratio=2.75x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.306, Ratio=2.57x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.311, Ratio=2.68x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.319, Ratio=2.75x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.289, Ratio=2.49x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.311, Ratio=2.65x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.316, Ratio=2.60x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.299, Ratio=2.49x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.309, Ratio=2.59x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.295, Ratio=2.60x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.306, Ratio=2.55x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.292, Ratio=2.45x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.283, Ratio=2.56x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.316, Ratio=2.68x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.319, Ratio=2.84x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.295, Ratio=2.49x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.298, Ratio=2.59x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.290, Ratio=2.54x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.301, Ratio=2.60x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.286, Ratio=2.41x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.291, Ratio=2.50x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.300, Ratio=2.56x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.280, Ratio=2.41x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.294, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.287, Ratio=2.55x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.326, Ratio=2.82x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.303, Ratio=2.64x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.299, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.294, Ratio=2.54x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.289, Ratio=2.50x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.298, Ratio=2.53x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.311, Ratio=2.69x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.290, Ratio=2.54x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.310, Ratio=2.66x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.319, Ratio=2.68x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.300, Ratio=2.62x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.287, Ratio=2.40x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.294, Ratio=2.56x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.279, Ratio=2.49x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.278, Ratio=2.39x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.301, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.300, Ratio=2.58x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.289, Ratio=2.57x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.306, Ratio=2.63x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.302, Ratio=2.53x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.298, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.279, Ratio=2.50x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.294, Ratio=2.51x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.302, Ratio=2.65x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.300, Ratio=2.53x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.284, Ratio=2.56x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.289, Ratio=2.48x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.307, Ratio=2.71x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.290, Ratio=2.56x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.295, Ratio=2.59x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.301, Ratio=2.65x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.317, Ratio=2.71x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.301, Ratio=2.59x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.298, Ratio=2.57x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.308, Ratio=2.63x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.287, Ratio=2.52x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.304, Ratio=2.63x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.292, Ratio=2.60x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.305, Ratio=2.60x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.292, Ratio=2.54x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.316, Ratio=2.72x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.302, Ratio=2.62x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.55x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.311, Ratio=2.57x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.313, Ratio=2.70x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.297, Ratio=2.60x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.289, Ratio=2.55x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.303, Ratio=2.66x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.290, Ratio=2.44x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.286, Ratio=2.44x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.288, Ratio=2.51x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.290, Ratio=2.52x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.284, Ratio=2.52x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.304, Ratio=2.65x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.297, Ratio=2.54x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.288, Ratio=2.60x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.295, Ratio=2.47x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.300, Ratio=2.58x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.306, Ratio=2.57x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.301, Ratio=2.63x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.301, Ratio=2.66x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.281, Ratio=2.49x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.302, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.313, Ratio=2.74x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.299, Ratio=2.76x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.306, Ratio=2.59x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.293, Ratio=2.49x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.316, Ratio=2.58x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.283, Ratio=2.49x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.295, Ratio=2.54x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.291, Ratio=2.59x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.268, Ratio=2.40x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.308, Ratio=2.67x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.302, Ratio=2.63x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.303, Ratio=2.57x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.282, Ratio=2.47x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.281, Ratio=2.48x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.319, Ratio=2.73x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.301, Ratio=2.56x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.297, Ratio=2.57x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.293, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.289, Ratio=2.45x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.304, Ratio=2.56x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.317, Ratio=2.69x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.312, Ratio=2.78x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.303, Ratio=2.58x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.288, Ratio=2.52x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.309, Ratio=2.69x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.301, Ratio=2.64x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.303, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.298, Ratio=2.62x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.280, Ratio=2.45x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.299, Ratio=2.61x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.302, Ratio=2.56x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.302, Ratio=2.56x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.314, Ratio=2.64x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.317, Ratio=2.70x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.308, Ratio=2.67x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.294, Ratio=2.53x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.279, Ratio=2.44x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.61x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.305, Ratio=2.62x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.296, Ratio=2.54x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.289, Ratio=2.49x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.302, Ratio=2.56x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.317, Ratio=2.79x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.303, Ratio=2.57x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.315, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.311, Ratio=2.67x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.312, Ratio=2.64x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.301, Ratio=2.62x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.297, Ratio=2.53x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.289, Ratio=2.54x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.287, Ratio=2.49x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.294, Ratio=2.61x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.318, Ratio=2.68x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.305, Ratio=2.62x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.297, Ratio=2.66x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.304, Ratio=2.57x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.301, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.292, Ratio=2.48x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.271, Ratio=2.38x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.310, Ratio=2.64x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.306, Ratio=2.59x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.303, Ratio=2.64x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.287, Ratio=2.46x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.306, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.309, Ratio=2.65x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.316, Ratio=2.71x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.310, Ratio=2.75x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.281, Ratio=2.41x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.304, Ratio=2.55x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.56x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.297, Ratio=2.57x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.302, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.301, Ratio=2.65x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.301, Ratio=2.61x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.299, Ratio=2.54x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.297, Ratio=2.52x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.304, Ratio=2.56x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.279, Ratio=2.39x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.313, Ratio=2.66x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.295, Ratio=2.45x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.303, Ratio=2.66x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.299, Ratio=2.47x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.297, Ratio=2.55x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.298, Ratio=2.55x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.297, Ratio=2.58x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.311, Ratio=2.63x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.301, Ratio=2.61x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.304, Ratio=2.73x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.310, Ratio=2.62x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.297, Ratio=2.55x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.294, Ratio=2.49x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.304, Ratio=2.62x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.324, Ratio=2.75x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.303, Ratio=2.60x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.304, Ratio=2.64x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.290, Ratio=2.48x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.287, Ratio=2.49x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.312, Ratio=2.71x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.312, Ratio=2.68x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.302, Ratio=2.59x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.301, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.307, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.301, Ratio=2.54x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.298, Ratio=2.57x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.310, Ratio=2.63x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.304, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.291, Ratio=2.53x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.309, Ratio=2.68x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.290, Ratio=2.42x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.299, Ratio=2.60x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.289, Ratio=2.52x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.318, Ratio=2.67x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.310, Ratio=2.67x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.292, Ratio=2.52x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.293, Ratio=2.58x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.289, Ratio=2.48x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.308, Ratio=2.63x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.297, Ratio=2.52x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.298, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.293, Ratio=2.55x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.308, Ratio=2.65x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.310, Ratio=2.68x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.302, Ratio=2.63x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.287, Ratio=2.44x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.288, Ratio=2.45x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.321, Ratio=2.70x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.297, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.302, Ratio=2.66x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.278, Ratio=2.37x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.305, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.302, Ratio=2.66x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.322, Ratio=2.76x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.306, Ratio=2.65x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.304, Ratio=2.60x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.290, Ratio=2.61x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.287, Ratio=2.55x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.288, Ratio=2.53x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.294, Ratio=2.55x, Gap=-2.730

============================================================
Epoch 10/20 completed in 35.3s
Train: Loss=1.2796 (C:1.2796, R:0.0018) Ratio=2.38x
Val:   Loss=1.2546 (C:1.2546, R:0.0018) Ratio=2.61x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.2546)
Checkpoint saved at epoch 10
============================================================

Epoch 11 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.43x, Gap=-2.925
Batch   0/537: Loss=1.2908 (C:1.2908, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.311, Ratio=2.61x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.295, Ratio=2.41x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.289, Ratio=2.46x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.294, Ratio=2.52x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.307, Ratio=2.58x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.284, Ratio=2.40x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.308, Ratio=2.52x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.302, Ratio=2.59x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.299, Ratio=2.63x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.288, Ratio=2.46x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.300, Ratio=2.52x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.300, Ratio=2.66x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.305, Ratio=2.54x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.37x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.302, Ratio=2.60x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.286, Ratio=2.44x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.305, Ratio=2.56x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.286, Ratio=2.38x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.284, Ratio=2.49x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.280, Ratio=2.44x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.295, Ratio=2.49x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.300, Ratio=2.53x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.757
Batch  25/537: Loss=1.2742 (C:1.2742, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.312, Ratio=2.61x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.294, Ratio=2.40x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.295, Ratio=2.50x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.318, Ratio=2.65x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.313, Ratio=2.62x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.290, Ratio=2.44x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.303, Ratio=2.59x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.280, Ratio=2.47x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.291, Ratio=2.48x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.320, Ratio=2.66x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.297, Ratio=2.43x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.297, Ratio=2.54x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.309, Ratio=2.53x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.296, Ratio=2.48x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.293, Ratio=2.45x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.289, Ratio=2.38x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.58x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.294, Ratio=2.40x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.318, Ratio=2.58x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.286, Ratio=2.40x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.290, Ratio=2.44x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.282, Ratio=2.47x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.52x, Gap=-2.963
Batch  50/537: Loss=1.2676 (C:1.2676, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.56x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.323, Ratio=2.63x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.278, Ratio=2.34x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.299, Ratio=2.48x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.306, Ratio=2.45x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.281, Ratio=2.35x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.308, Ratio=2.50x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.309, Ratio=2.51x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.289, Ratio=2.46x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.302, Ratio=2.50x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.50x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.305, Ratio=2.52x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.299, Ratio=2.49x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.296, Ratio=2.54x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.308, Ratio=2.58x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.299, Ratio=2.57x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.279, Ratio=2.35x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.305, Ratio=2.56x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.302, Ratio=2.51x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.295, Ratio=2.35x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.300, Ratio=2.49x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.303, Ratio=2.49x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.309, Ratio=2.52x, Gap=-2.789
Batch  75/537: Loss=1.2660 (C:1.2660, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.297, Ratio=2.45x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.304, Ratio=2.50x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.300, Ratio=2.53x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.282, Ratio=2.37x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.58x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.50x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.288, Ratio=2.43x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.291, Ratio=2.51x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.56x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.303, Ratio=2.52x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.43x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.284, Ratio=2.46x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.288, Ratio=2.35x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.293, Ratio=2.48x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.306, Ratio=2.56x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.308, Ratio=2.53x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.264, Ratio=2.35x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.295, Ratio=2.48x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.302, Ratio=2.51x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.302, Ratio=2.60x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.56x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.299, Ratio=2.49x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.295, Ratio=2.47x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.300, Ratio=2.53x, Gap=-2.771
Batch 100/537: Loss=1.2671 (C:1.2671, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.304, Ratio=2.50x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.293, Ratio=2.48x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.288, Ratio=2.46x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.302, Ratio=2.55x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.288, Ratio=2.39x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.305, Ratio=2.52x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.285, Ratio=2.46x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.289, Ratio=2.46x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.311, Ratio=2.61x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.297, Ratio=2.46x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.294, Ratio=2.47x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.275, Ratio=2.37x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.293, Ratio=2.50x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.297, Ratio=2.53x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.318, Ratio=2.65x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.300, Ratio=2.45x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.302, Ratio=2.53x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.299, Ratio=2.51x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.300, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.312, Ratio=2.68x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.305, Ratio=2.61x, Gap=-2.800
Batch 125/537: Loss=1.2489 (C:1.2489, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.306, Ratio=2.61x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.309, Ratio=2.57x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.302, Ratio=2.54x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.293, Ratio=2.45x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.304, Ratio=2.53x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.288, Ratio=2.41x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.289, Ratio=2.45x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.298, Ratio=2.38x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.307, Ratio=2.56x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.298, Ratio=2.64x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.295, Ratio=2.49x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.283, Ratio=2.42x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.311, Ratio=2.54x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.287, Ratio=2.49x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.297, Ratio=2.44x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.298, Ratio=2.60x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.310, Ratio=2.59x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.314, Ratio=2.63x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.313, Ratio=2.61x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.301, Ratio=2.44x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.291, Ratio=2.37x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.301, Ratio=2.59x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.294, Ratio=2.60x, Gap=-2.824
Batch 150/537: Loss=1.2544 (C:1.2544, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.279, Ratio=2.43x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.301, Ratio=2.59x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.292, Ratio=2.46x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.314, Ratio=2.63x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.317, Ratio=2.54x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.302, Ratio=2.51x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.312, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.299, Ratio=2.40x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.294, Ratio=2.41x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.326, Ratio=2.65x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.292, Ratio=2.45x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.57x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.280, Ratio=2.42x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.286, Ratio=2.49x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.278, Ratio=2.45x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.292, Ratio=2.45x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.300, Ratio=2.47x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.306, Ratio=2.45x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.294, Ratio=2.51x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.290, Ratio=2.40x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.304, Ratio=2.60x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.314, Ratio=2.56x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.310, Ratio=2.53x, Gap=-2.920
Batch 175/537: Loss=1.2632 (C:1.2632, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.290, Ratio=2.53x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.301, Ratio=2.47x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.312, Ratio=2.58x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.307, Ratio=2.52x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.310, Ratio=2.56x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.308, Ratio=2.57x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.304, Ratio=2.55x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.306, Ratio=2.55x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.57x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.297, Ratio=2.59x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.295, Ratio=2.59x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.286, Ratio=2.48x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.304, Ratio=2.58x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.285, Ratio=2.43x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.301, Ratio=2.52x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.44x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.51x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.314, Ratio=2.70x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.281, Ratio=2.35x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.302, Ratio=2.54x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.309, Ratio=2.62x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.324, Ratio=2.75x, Gap=-2.774
Batch 200/537: Loss=1.2120 (C:1.2120, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.315, Ratio=2.58x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.314, Ratio=2.57x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.294, Ratio=2.48x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.310, Ratio=2.73x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.311, Ratio=2.63x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.310, Ratio=2.53x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.287, Ratio=2.46x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.306, Ratio=2.51x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.293, Ratio=2.43x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.284, Ratio=2.48x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.284, Ratio=2.41x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.53x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.61x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.42x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.293, Ratio=2.51x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.291, Ratio=2.40x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.294, Ratio=2.56x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.280, Ratio=2.38x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.316, Ratio=2.62x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.299, Ratio=2.52x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.294, Ratio=2.53x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.299, Ratio=2.51x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.321, Ratio=2.68x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.312, Ratio=2.57x, Gap=-2.654
Batch 225/537: Loss=1.2525 (C:1.2525, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.302, Ratio=2.49x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.290, Ratio=2.46x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.60x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.304, Ratio=2.50x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.297, Ratio=2.47x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.300, Ratio=2.51x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.305, Ratio=2.54x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.304, Ratio=2.65x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.299, Ratio=2.54x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.282, Ratio=2.35x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.303, Ratio=2.52x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.301, Ratio=2.48x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.276, Ratio=2.41x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.288, Ratio=2.45x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.303, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.320, Ratio=2.72x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.306, Ratio=2.59x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.57x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.305, Ratio=2.48x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.284, Ratio=2.45x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.294, Ratio=2.46x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.275, Ratio=2.29x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.306, Ratio=2.53x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.310, Ratio=2.61x, Gap=-2.764
Batch 250/537: Loss=1.2462 (C:1.2462, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.294, Ratio=2.47x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.290, Ratio=2.41x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.292, Ratio=2.52x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.289, Ratio=2.43x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.284, Ratio=2.38x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.281, Ratio=2.36x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.291, Ratio=2.55x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.286, Ratio=2.44x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.326, Ratio=2.69x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.307, Ratio=2.59x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.312, Ratio=2.63x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.303, Ratio=2.44x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.295, Ratio=2.47x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.59x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.311, Ratio=2.61x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.305, Ratio=2.64x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.307, Ratio=2.59x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.308, Ratio=2.59x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.291, Ratio=2.36x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.294, Ratio=2.45x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.304, Ratio=2.60x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.298, Ratio=2.47x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.275, Ratio=2.37x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.57x, Gap=-2.785
Batch 275/537: Loss=1.2579 (C:1.2579, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.290, Ratio=2.49x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.300, Ratio=2.49x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.312, Ratio=2.62x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.308, Ratio=2.49x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.310, Ratio=2.50x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.317, Ratio=2.59x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.284, Ratio=2.35x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.291, Ratio=2.48x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.308, Ratio=2.52x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.310, Ratio=2.60x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.289, Ratio=2.53x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.291, Ratio=2.43x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.307, Ratio=2.61x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.281, Ratio=2.42x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.61x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.289, Ratio=2.45x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.54x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.292, Ratio=2.46x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.312, Ratio=2.50x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.305, Ratio=2.62x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.271, Ratio=2.34x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.302, Ratio=2.57x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.290, Ratio=2.37x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.58x, Gap=-2.971
Batch 300/537: Loss=1.2492 (C:1.2492, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.287, Ratio=2.43x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.312, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.292, Ratio=2.48x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.294, Ratio=2.46x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.313, Ratio=2.63x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.313, Ratio=2.55x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.295, Ratio=2.45x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.304, Ratio=2.46x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.275, Ratio=2.46x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.286, Ratio=2.31x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.286, Ratio=2.42x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.297, Ratio=2.53x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.314, Ratio=2.62x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.308, Ratio=2.52x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.286, Ratio=2.46x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.300, Ratio=2.55x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.295, Ratio=2.46x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.304, Ratio=2.56x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.291, Ratio=2.39x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.314, Ratio=2.62x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.288, Ratio=2.42x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.316, Ratio=2.52x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.958
Batch 325/537: Loss=1.3033 (C:1.3033, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.296, Ratio=2.52x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.51x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.288, Ratio=2.39x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.285, Ratio=2.49x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.299, Ratio=2.47x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.298, Ratio=2.49x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.283, Ratio=2.56x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.303, Ratio=2.50x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.323, Ratio=2.75x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.57x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.288, Ratio=2.45x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.293, Ratio=2.51x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.287, Ratio=2.37x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.289, Ratio=2.44x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.318, Ratio=2.61x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.293, Ratio=2.43x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.290, Ratio=2.50x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.288, Ratio=2.43x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.294, Ratio=2.46x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.315, Ratio=2.66x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.293, Ratio=2.53x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.298, Ratio=2.49x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.301, Ratio=2.45x, Gap=-3.003
Batch 350/537: Loss=1.2839 (C:1.2839, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.295, Ratio=2.50x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.297, Ratio=2.48x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.286, Ratio=2.44x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.307, Ratio=2.56x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.293, Ratio=2.48x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.294, Ratio=2.51x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.299, Ratio=2.47x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.300, Ratio=2.58x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.290, Ratio=2.40x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.296, Ratio=2.41x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.58x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.300, Ratio=2.56x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.322, Ratio=2.52x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.305, Ratio=2.55x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.301, Ratio=2.55x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.298, Ratio=2.50x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.309, Ratio=2.57x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.277, Ratio=2.42x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.284, Ratio=2.42x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.288, Ratio=2.44x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.297, Ratio=2.42x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.289, Ratio=2.52x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.60x, Gap=-2.731
Batch 375/537: Loss=1.2487 (C:1.2487, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.298, Ratio=2.52x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.312, Ratio=2.58x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.303, Ratio=2.51x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.312, Ratio=2.61x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.279, Ratio=2.34x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.303, Ratio=2.50x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.306, Ratio=2.47x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.283, Ratio=2.38x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.310, Ratio=2.55x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.290, Ratio=2.53x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.296, Ratio=2.44x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.320, Ratio=2.61x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.299, Ratio=2.50x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.303, Ratio=2.49x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.301, Ratio=2.51x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.288, Ratio=2.45x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.300, Ratio=2.52x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.291, Ratio=2.40x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.285, Ratio=2.44x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.295, Ratio=2.53x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.286, Ratio=2.41x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.303, Ratio=2.57x, Gap=-2.847
Batch 400/537: Loss=1.2579 (C:1.2579, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.306, Ratio=2.48x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.292, Ratio=2.47x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.309, Ratio=2.59x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.309, Ratio=2.55x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.57x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.289, Ratio=2.45x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.288, Ratio=2.45x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.287, Ratio=2.43x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.299, Ratio=2.53x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.293, Ratio=2.42x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.303, Ratio=2.58x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.289, Ratio=2.41x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.299, Ratio=2.57x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.310, Ratio=2.55x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.308, Ratio=2.49x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.313, Ratio=2.62x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.288, Ratio=2.44x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.303, Ratio=2.45x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.289, Ratio=2.54x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.289, Ratio=2.44x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.44x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.287, Ratio=2.45x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.307, Ratio=2.50x, Gap=-2.871
Batch 425/537: Loss=1.2717 (C:1.2717, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.303, Ratio=2.54x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.300, Ratio=2.58x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.287, Ratio=2.44x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.281, Ratio=2.40x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.296, Ratio=2.39x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.286, Ratio=2.40x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.290, Ratio=2.44x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.300, Ratio=2.62x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.304, Ratio=2.56x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.288, Ratio=2.44x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.287, Ratio=2.47x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.297, Ratio=2.54x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.300, Ratio=2.44x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.302, Ratio=2.55x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.308, Ratio=2.60x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.280, Ratio=2.34x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.62x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.310, Ratio=2.64x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.305, Ratio=2.55x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.277, Ratio=2.35x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.305, Ratio=2.51x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.313, Ratio=2.62x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.292, Ratio=2.42x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.286, Ratio=2.38x, Gap=-2.786
Batch 450/537: Loss=1.3084 (C:1.3084, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.296, Ratio=2.52x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.306, Ratio=2.55x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.52x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.283, Ratio=2.40x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.290, Ratio=2.48x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.57x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.296, Ratio=2.62x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.298, Ratio=2.56x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.307, Ratio=2.56x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.58x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.303, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.307, Ratio=2.54x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.293, Ratio=2.41x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.292, Ratio=2.50x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.296, Ratio=2.48x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.300, Ratio=2.53x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.311, Ratio=2.58x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.309, Ratio=2.47x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.311, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.298, Ratio=2.52x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.303, Ratio=2.57x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.307, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.309, Ratio=2.49x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.51x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.279, Ratio=2.40x, Gap=-2.743
Batch 475/537: Loss=1.3046 (C:1.3046, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.295, Ratio=2.53x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.295, Ratio=2.50x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.57x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.285, Ratio=2.36x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.284, Ratio=2.45x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.288, Ratio=2.39x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.293, Ratio=2.52x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.290, Ratio=2.43x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.303, Ratio=2.47x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.303, Ratio=2.45x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.308, Ratio=2.52x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.312, Ratio=2.56x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.294, Ratio=2.45x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.302, Ratio=2.50x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.303, Ratio=2.41x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.302, Ratio=2.52x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.299, Ratio=2.57x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.289, Ratio=2.48x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.276, Ratio=2.43x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.291, Ratio=2.55x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.293, Ratio=2.47x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.50x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.304, Ratio=2.57x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.295, Ratio=2.44x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.305, Ratio=2.55x, Gap=-2.812
Batch 500/537: Loss=1.2619 (C:1.2619, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.292, Ratio=2.41x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.308, Ratio=2.48x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.302, Ratio=2.48x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.284, Ratio=2.40x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.304, Ratio=2.49x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.311, Ratio=2.58x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.301, Ratio=2.53x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.303, Ratio=2.61x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.284, Ratio=2.45x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.312, Ratio=2.50x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.304, Ratio=2.47x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.311, Ratio=2.51x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.301, Ratio=2.47x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.287, Ratio=2.40x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.300, Ratio=2.49x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.301, Ratio=2.52x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.301, Ratio=2.55x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.298, Ratio=2.51x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.296, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.300, Ratio=2.53x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.302, Ratio=2.55x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.297, Ratio=2.51x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.743
Batch 525/537: Loss=1.2571 (C:1.2571, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.290, Ratio=2.38x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.312, Ratio=2.55x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.296, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.308, Ratio=2.54x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.286, Ratio=2.40x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.302, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.316, Ratio=2.58x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.307, Ratio=2.44x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.317, Ratio=2.60x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.294, Ratio=2.53x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.302, Ratio=2.57x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.303, Ratio=2.64x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.311, Ratio=2.60x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.305, Ratio=2.67x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.326, Ratio=2.86x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.313, Ratio=2.78x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.301, Ratio=2.58x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.289, Ratio=2.51x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.303, Ratio=2.51x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.316, Ratio=2.76x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.313, Ratio=2.67x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.300, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.292, Ratio=2.51x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.298, Ratio=2.54x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.291, Ratio=2.47x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.315, Ratio=2.69x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.302, Ratio=2.58x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.289, Ratio=2.55x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.302, Ratio=2.55x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.285, Ratio=2.57x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.303, Ratio=2.58x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.311, Ratio=2.60x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.306, Ratio=2.57x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.316, Ratio=2.74x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.310, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.61x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.291, Ratio=2.49x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.301, Ratio=2.61x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.290, Ratio=2.56x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.301, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.310, Ratio=2.67x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.296, Ratio=2.67x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.288, Ratio=2.45x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.309, Ratio=2.71x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.312, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.301, Ratio=2.63x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.303, Ratio=2.67x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.294, Ratio=2.50x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.299, Ratio=2.62x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.296, Ratio=2.56x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.300, Ratio=2.63x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.309, Ratio=2.66x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.331, Ratio=2.87x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.60x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.301, Ratio=2.68x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.293, Ratio=2.54x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.314, Ratio=2.65x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.317, Ratio=2.73x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.294, Ratio=2.54x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.296, Ratio=2.63x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.289, Ratio=2.52x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.303, Ratio=2.69x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.294, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.298, Ratio=2.59x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.307, Ratio=2.55x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.308, Ratio=2.69x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.320, Ratio=2.79x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.309, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.296, Ratio=2.45x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.300, Ratio=2.61x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.281, Ratio=2.50x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.315, Ratio=2.61x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.76x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.295, Ratio=2.50x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.304, Ratio=2.70x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.311, Ratio=2.63x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.289, Ratio=2.48x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.56x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.295, Ratio=2.52x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.295, Ratio=2.53x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.311, Ratio=2.66x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.318, Ratio=2.69x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.318, Ratio=2.73x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.305, Ratio=2.76x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.292, Ratio=2.60x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.295, Ratio=2.53x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.312, Ratio=2.78x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.306, Ratio=2.64x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.312, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.293, Ratio=2.57x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.301, Ratio=2.62x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.305, Ratio=2.70x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.299, Ratio=2.66x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.317, Ratio=2.78x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.305, Ratio=2.61x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.290, Ratio=2.60x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.53x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.295, Ratio=2.54x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.305, Ratio=2.71x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.320, Ratio=2.76x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.306, Ratio=2.70x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.319, Ratio=2.56x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.302, Ratio=2.52x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.288, Ratio=2.51x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.308, Ratio=2.72x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.317, Ratio=2.77x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.304, Ratio=2.68x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.270, Ratio=2.40x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.309, Ratio=2.83x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.302, Ratio=2.58x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.295, Ratio=2.55x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.311, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.311, Ratio=2.66x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.297, Ratio=2.65x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.310, Ratio=2.75x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.304, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.301, Ratio=2.62x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.292, Ratio=2.59x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.55x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.298, Ratio=2.61x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.300, Ratio=2.58x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.303, Ratio=2.51x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.300, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.300, Ratio=2.52x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.311, Ratio=2.71x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.290, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.282, Ratio=2.46x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.295, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.294, Ratio=2.59x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.309, Ratio=2.64x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.307, Ratio=2.70x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.314, Ratio=2.71x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.315, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.308, Ratio=2.57x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.61x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.298, Ratio=2.54x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.309, Ratio=2.66x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.289, Ratio=2.54x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.316, Ratio=2.75x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.289, Ratio=2.49x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.306, Ratio=2.63x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.289, Ratio=2.49x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.298, Ratio=2.53x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.297, Ratio=2.64x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.62x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.313, Ratio=2.67x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.302, Ratio=2.66x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.296, Ratio=2.48x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.291, Ratio=2.48x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.311, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.304, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.55x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.317, Ratio=2.75x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.307, Ratio=2.54x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.289, Ratio=2.52x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.307, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.304, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.297, Ratio=2.61x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.315, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.302, Ratio=2.66x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.312, Ratio=2.70x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.325, Ratio=2.70x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.307, Ratio=2.62x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.314, Ratio=2.61x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.305, Ratio=2.55x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.307, Ratio=2.74x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.300, Ratio=2.65x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.305, Ratio=2.62x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.306, Ratio=2.67x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.292, Ratio=2.62x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.297, Ratio=2.50x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.317, Ratio=2.68x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.312, Ratio=2.68x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.293, Ratio=2.54x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.305, Ratio=2.55x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.300, Ratio=2.54x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.291, Ratio=2.69x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.293, Ratio=2.49x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.320, Ratio=2.77x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.315, Ratio=2.67x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.305, Ratio=2.62x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.321, Ratio=2.72x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.303, Ratio=2.61x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.308, Ratio=2.60x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.313, Ratio=2.72x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.310, Ratio=2.69x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.298, Ratio=2.54x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.303, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.325, Ratio=2.83x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.286, Ratio=2.43x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.289, Ratio=2.57x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.310, Ratio=2.64x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.295, Ratio=2.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.314, Ratio=2.69x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.304, Ratio=2.57x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.317, Ratio=2.75x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.296, Ratio=2.51x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.304, Ratio=2.63x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.296, Ratio=2.71x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.315, Ratio=2.68x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.297, Ratio=2.60x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.293, Ratio=2.60x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.291, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.297, Ratio=2.56x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.292, Ratio=2.48x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.317, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.301, Ratio=2.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.297, Ratio=2.65x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.311, Ratio=2.66x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.290, Ratio=2.54x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.302, Ratio=2.54x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.312, Ratio=2.69x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.307, Ratio=2.73x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.298, Ratio=2.60x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.293, Ratio=2.57x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.290, Ratio=2.56x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.300, Ratio=2.58x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.289, Ratio=2.65x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.309, Ratio=2.73x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.307, Ratio=2.63x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.297, Ratio=2.61x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.61x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.306, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.316, Ratio=2.69x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.309, Ratio=2.68x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.307, Ratio=2.64x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.316, Ratio=2.76x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.299, Ratio=2.63x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.300, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.315, Ratio=2.67x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.309, Ratio=2.63x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.308, Ratio=2.67x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.304, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.284, Ratio=2.52x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.301, Ratio=2.54x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.313, Ratio=2.68x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.54x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.308, Ratio=2.72x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.311, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.296, Ratio=2.49x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.294, Ratio=2.50x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.321, Ratio=2.70x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.308, Ratio=2.58x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.326, Ratio=2.70x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.294, Ratio=2.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.316, Ratio=2.65x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.311, Ratio=2.65x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.333, Ratio=2.90x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.308, Ratio=2.74x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.314, Ratio=2.65x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.298, Ratio=2.60x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.322, Ratio=2.70x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.297, Ratio=2.60x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.292, Ratio=2.63x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.320, Ratio=2.66x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.292, Ratio=2.49x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.298, Ratio=2.52x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.308, Ratio=2.65x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.321, Ratio=2.73x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.290, Ratio=2.51x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.292, Ratio=2.63x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.291, Ratio=2.48x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.305, Ratio=2.60x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.61x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.296, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.302, Ratio=2.57x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.305, Ratio=2.63x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.303, Ratio=2.63x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.304, Ratio=2.66x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.296, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.61x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.307, Ratio=2.60x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.320, Ratio=2.65x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.299, Ratio=2.69x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.319, Ratio=2.72x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.315, Ratio=2.66x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.306, Ratio=2.67x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.299, Ratio=2.62x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.314, Ratio=2.68x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.317, Ratio=2.64x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.297, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.309, Ratio=2.67x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.301, Ratio=2.58x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.306, Ratio=2.65x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.304, Ratio=2.63x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.308, Ratio=2.56x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.305, Ratio=2.69x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.307, Ratio=2.59x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.315, Ratio=2.65x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.312, Ratio=2.66x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.311, Ratio=2.61x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.313, Ratio=2.69x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.295, Ratio=2.57x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.308, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.291, Ratio=2.53x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.302, Ratio=2.70x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.291, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.303, Ratio=2.73x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.300, Ratio=2.51x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.295, Ratio=2.62x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.315, Ratio=2.65x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.317, Ratio=2.76x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.296, Ratio=2.49x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.281, Ratio=2.44x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.299, Ratio=2.59x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.320, Ratio=2.77x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.286, Ratio=2.50x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.301, Ratio=2.56x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.312, Ratio=2.76x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.296, Ratio=2.54x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.287, Ratio=2.42x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.318, Ratio=2.72x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.295, Ratio=2.54x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.50x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.295, Ratio=2.60x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.315, Ratio=2.67x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.304, Ratio=2.59x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.294, Ratio=2.52x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.318, Ratio=2.79x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.59x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.298, Ratio=2.59x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.289, Ratio=2.47x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.286, Ratio=2.50x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.291, Ratio=2.53x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.292, Ratio=2.56x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.303, Ratio=2.55x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.290, Ratio=2.45x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.300, Ratio=2.63x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.316, Ratio=2.75x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.300, Ratio=2.63x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.303, Ratio=2.57x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.308, Ratio=2.65x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.287, Ratio=2.58x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.293, Ratio=2.57x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.303, Ratio=2.61x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.297, Ratio=2.60x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.322, Ratio=2.78x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.304, Ratio=2.70x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.313, Ratio=2.67x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.323, Ratio=2.73x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.316, Ratio=2.67x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.302, Ratio=2.60x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.296, Ratio=2.59x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.315, Ratio=2.62x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.299, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.297, Ratio=2.62x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.287, Ratio=2.53x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.302, Ratio=2.71x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.313, Ratio=2.74x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.280, Ratio=2.46x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.299, Ratio=2.50x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.303, Ratio=2.63x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.277, Ratio=2.38x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.325, Ratio=2.79x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.306, Ratio=2.67x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.309, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.301, Ratio=2.59x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.299, Ratio=2.55x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.316, Ratio=2.68x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.294, Ratio=2.60x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.291, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.279, Ratio=2.42x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.300, Ratio=2.63x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.311, Ratio=2.69x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.307, Ratio=2.69x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.287, Ratio=2.43x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.291, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.294, Ratio=2.53x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.310, Ratio=2.60x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.304, Ratio=2.62x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.312, Ratio=2.67x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.325, Ratio=2.76x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.305, Ratio=2.62x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.322, Ratio=2.69x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.305, Ratio=2.61x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.315, Ratio=2.63x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.304, Ratio=2.62x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.299, Ratio=2.55x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.299, Ratio=2.55x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.305, Ratio=2.59x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.298, Ratio=2.58x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.297, Ratio=2.59x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.298, Ratio=2.61x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.296, Ratio=2.59x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.303, Ratio=2.58x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.311, Ratio=2.63x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.308, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.314, Ratio=2.78x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.314, Ratio=2.68x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.300, Ratio=2.66x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.308, Ratio=2.64x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.320, Ratio=2.75x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.298, Ratio=2.62x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.309, Ratio=2.71x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.301, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.296, Ratio=2.57x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.313, Ratio=2.70x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.313, Ratio=2.66x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.300, Ratio=2.67x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.305, Ratio=2.63x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.288, Ratio=2.48x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.61x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.304, Ratio=2.65x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.52x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.303, Ratio=2.62x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.61x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.293, Ratio=2.49x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.308, Ratio=2.53x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.305, Ratio=2.65x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.293, Ratio=2.51x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.293, Ratio=2.54x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.303, Ratio=2.63x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.296, Ratio=2.59x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.317, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.315, Ratio=2.76x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.296, Ratio=2.52x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.299, Ratio=2.52x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.308, Ratio=2.69x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.300, Ratio=2.64x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.307, Ratio=2.69x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.284, Ratio=2.50x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.290, Ratio=2.48x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.310, Ratio=2.66x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.313, Ratio=2.76x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.313, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.310, Ratio=2.74x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.306, Ratio=2.58x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.307, Ratio=2.62x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.312, Ratio=2.59x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.307, Ratio=2.68x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.307, Ratio=2.54x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.309, Ratio=2.68x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.305, Ratio=2.72x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.306, Ratio=2.63x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.274, Ratio=2.50x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.302, Ratio=2.65x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.298, Ratio=2.53x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.295, Ratio=2.63x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.301, Ratio=2.49x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.294, Ratio=2.51x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.311, Ratio=2.69x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.305, Ratio=2.67x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.303, Ratio=2.58x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.310, Ratio=2.76x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.317, Ratio=2.62x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.297, Ratio=2.64x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.291, Ratio=2.49x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.318, Ratio=2.73x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.315, Ratio=2.65x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.309, Ratio=2.72x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.283, Ratio=2.48x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.315, Ratio=2.66x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.296, Ratio=2.51x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.296, Ratio=2.56x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.322, Ratio=2.80x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.308, Ratio=2.63x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.315, Ratio=2.71x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.298, Ratio=2.56x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.286, Ratio=2.55x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.298, Ratio=2.53x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.290, Ratio=2.44x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.314, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.300, Ratio=2.56x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.292, Ratio=2.51x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.308, Ratio=2.63x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.305, Ratio=2.64x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.318, Ratio=2.72x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.322, Ratio=2.76x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.304, Ratio=2.61x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.306, Ratio=2.68x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.292, Ratio=2.55x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.304, Ratio=2.53x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.306, Ratio=2.58x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.294, Ratio=2.62x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.294, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.307, Ratio=2.61x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.312, Ratio=2.70x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.291, Ratio=2.49x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.326, Ratio=2.75x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.299, Ratio=2.58x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.301, Ratio=2.67x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.292, Ratio=2.54x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.301, Ratio=2.54x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.294, Ratio=2.56x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.309, Ratio=2.76x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.322, Ratio=2.83x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.305, Ratio=2.68x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.316, Ratio=2.75x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.322, Ratio=2.70x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.302, Ratio=2.60x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.301, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.317, Ratio=2.73x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.294, Ratio=2.58x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.313, Ratio=2.64x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.296, Ratio=2.62x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.297, Ratio=2.56x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.292, Ratio=2.54x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.308, Ratio=2.60x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.313, Ratio=2.74x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.278, Ratio=2.47x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.308, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.310, Ratio=2.64x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.315, Ratio=2.71x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.299, Ratio=2.50x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.306, Ratio=2.67x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.310, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.76x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.301, Ratio=2.48x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.285, Ratio=2.55x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.307, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.304, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.290, Ratio=2.47x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.304, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.304, Ratio=2.65x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.300, Ratio=2.54x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.309, Ratio=2.64x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.301, Ratio=2.60x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.312, Ratio=2.65x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.279, Ratio=2.42x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.320, Ratio=2.79x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.292, Ratio=2.55x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.299, Ratio=2.62x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.303, Ratio=2.60x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.291, Ratio=2.54x, Gap=-2.562

============================================================
Epoch 11/20 completed in 30.1s
Train: Loss=1.2731 (C:1.2731, R:0.0018) Ratio=2.46x
Val:   Loss=1.2475 (C:1.2475, R:0.0018) Ratio=2.68x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.2475)
============================================================

Epoch 12 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.294, Ratio=2.44x, Gap=-2.689
Batch   0/537: Loss=1.2874 (C:1.2874, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.309, Ratio=2.56x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.317, Ratio=2.62x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.310, Ratio=2.52x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.308, Ratio=2.54x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.52x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.50x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.284, Ratio=2.36x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.292, Ratio=2.59x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.282, Ratio=2.42x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.302, Ratio=2.60x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.291, Ratio=2.57x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.311, Ratio=2.58x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.323, Ratio=2.71x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.315, Ratio=2.58x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.320, Ratio=2.70x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.312, Ratio=2.62x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.310, Ratio=2.55x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.58x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.302, Ratio=2.55x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.316, Ratio=2.66x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.305, Ratio=2.59x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.300, Ratio=2.45x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.316, Ratio=2.68x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.302, Ratio=2.59x, Gap=-2.758
Batch  25/537: Loss=1.2541 (C:1.2541, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.298, Ratio=2.49x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.298, Ratio=2.50x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.306, Ratio=2.63x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.58x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.308, Ratio=2.61x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.319, Ratio=2.64x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.282, Ratio=2.35x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.298, Ratio=2.53x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.315, Ratio=2.47x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.315, Ratio=2.62x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.293, Ratio=2.43x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.314, Ratio=2.61x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.291, Ratio=2.40x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.292, Ratio=2.53x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.297, Ratio=2.52x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.313, Ratio=2.62x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.294, Ratio=2.48x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.317, Ratio=2.65x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.301, Ratio=2.43x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.318, Ratio=2.62x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.312, Ratio=2.60x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.308, Ratio=2.59x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.305, Ratio=2.60x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.301, Ratio=2.58x, Gap=-2.659
Batch  50/537: Loss=1.2580 (C:1.2580, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.292, Ratio=2.49x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.326, Ratio=2.68x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.297, Ratio=2.54x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.327, Ratio=2.73x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.306, Ratio=2.52x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.51x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.298, Ratio=2.56x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.298, Ratio=2.57x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.321, Ratio=2.71x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.296, Ratio=2.39x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.301, Ratio=2.53x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.296, Ratio=2.46x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.315, Ratio=2.61x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.292, Ratio=2.42x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.293, Ratio=2.48x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.300, Ratio=2.55x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.305, Ratio=2.53x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.280, Ratio=2.34x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.292, Ratio=2.45x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.318, Ratio=2.70x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.307, Ratio=2.58x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.313, Ratio=2.56x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.57x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.290, Ratio=2.42x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.322, Ratio=2.64x, Gap=-2.891
Batch  75/537: Loss=1.2389 (C:1.2389, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.290, Ratio=2.43x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.310, Ratio=2.65x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.309, Ratio=2.55x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.295, Ratio=2.48x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.301, Ratio=2.47x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.307, Ratio=2.49x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.301, Ratio=2.54x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.304, Ratio=2.55x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.302, Ratio=2.51x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.291, Ratio=2.51x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.298, Ratio=2.49x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.306, Ratio=2.54x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.302, Ratio=2.51x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.310, Ratio=2.57x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.301, Ratio=2.55x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.39x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.302, Ratio=2.51x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.51x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.321, Ratio=2.67x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.311, Ratio=2.61x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.298, Ratio=2.53x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.300, Ratio=2.56x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.294, Ratio=2.49x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-2.986
Batch 100/537: Loss=1.2628 (C:1.2628, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.300, Ratio=2.52x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.279, Ratio=2.39x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.287, Ratio=2.44x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.314, Ratio=2.52x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.304, Ratio=2.62x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.309, Ratio=2.52x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.300, Ratio=2.49x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.303, Ratio=2.56x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.310, Ratio=2.59x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.51x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.299, Ratio=2.48x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.311, Ratio=2.49x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.58x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.313, Ratio=2.51x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.52x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.310, Ratio=2.59x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.321, Ratio=2.67x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.320, Ratio=2.63x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.307, Ratio=2.58x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.316, Ratio=2.61x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.286, Ratio=2.45x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.304, Ratio=2.53x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.291, Ratio=2.50x, Gap=-2.970
Batch 125/537: Loss=1.2795 (C:1.2795, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.310, Ratio=2.56x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.299, Ratio=2.42x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.327, Ratio=2.77x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.297, Ratio=2.47x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.290, Ratio=2.40x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.290, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.301, Ratio=2.54x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.57x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.311, Ratio=2.60x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.304, Ratio=2.55x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.304, Ratio=2.55x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.310, Ratio=2.55x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.304, Ratio=2.55x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.311, Ratio=2.55x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.306, Ratio=2.63x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.305, Ratio=2.50x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.293, Ratio=2.55x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.307, Ratio=2.56x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.312, Ratio=2.68x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.315, Ratio=2.64x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.298, Ratio=2.52x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.306, Ratio=2.51x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.292, Ratio=2.42x, Gap=-2.959
Batch 150/537: Loss=1.2957 (C:1.2957, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.56x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.306, Ratio=2.49x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.313, Ratio=2.47x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.43x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.303, Ratio=2.47x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.301, Ratio=2.42x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.317, Ratio=2.57x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.310, Ratio=2.66x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.293, Ratio=2.53x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.296, Ratio=2.46x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.286, Ratio=2.42x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.306, Ratio=2.55x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.305, Ratio=2.51x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.60x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.304, Ratio=2.47x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.302, Ratio=2.51x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.315, Ratio=2.58x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.42x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.294, Ratio=2.50x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.286, Ratio=2.40x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.311, Ratio=2.63x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.312, Ratio=2.52x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.301, Ratio=2.47x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.307, Ratio=2.53x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.283, Ratio=2.35x, Gap=-2.763
Batch 175/537: Loss=1.3139 (C:1.3139, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.293, Ratio=2.46x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.307, Ratio=2.59x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.317, Ratio=2.65x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.309, Ratio=2.53x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.299, Ratio=2.49x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.312, Ratio=2.62x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.42x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.313, Ratio=2.60x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.309, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.290, Ratio=2.47x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.282, Ratio=2.45x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.303, Ratio=2.44x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.284, Ratio=2.39x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.298, Ratio=2.48x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.314, Ratio=2.55x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.298, Ratio=2.45x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.285, Ratio=2.41x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.311, Ratio=2.64x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.283, Ratio=2.51x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.288, Ratio=2.40x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.308, Ratio=2.63x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.294, Ratio=2.44x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.330, Ratio=2.69x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.305, Ratio=2.48x, Gap=-3.136
Batch 200/537: Loss=1.2785 (C:1.2785, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.294, Ratio=2.42x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.51x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.292, Ratio=2.58x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.331, Ratio=2.72x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.318, Ratio=2.62x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.312, Ratio=2.67x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.300, Ratio=2.58x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.302, Ratio=2.56x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.282, Ratio=2.37x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.301, Ratio=2.47x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.312, Ratio=2.55x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.296, Ratio=2.45x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.309, Ratio=2.51x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.295, Ratio=2.47x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.311, Ratio=2.59x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.306, Ratio=2.52x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.62x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.291, Ratio=2.46x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.312, Ratio=2.53x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.307, Ratio=2.59x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.308, Ratio=2.59x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.315, Ratio=2.67x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.312, Ratio=2.64x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.300, Ratio=2.51x, Gap=-2.872
Batch 225/537: Loss=1.2724 (C:1.2724, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.317, Ratio=2.65x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.320, Ratio=2.57x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.307, Ratio=2.51x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.305, Ratio=2.46x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.291, Ratio=2.53x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.289, Ratio=2.46x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.285, Ratio=2.45x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.298, Ratio=2.58x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.306, Ratio=2.55x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.316, Ratio=2.62x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.309, Ratio=2.56x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.308, Ratio=2.62x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.299, Ratio=2.46x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.315, Ratio=2.56x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.318, Ratio=2.56x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.306, Ratio=2.48x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.307, Ratio=2.43x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.300, Ratio=2.56x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.312, Ratio=2.66x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.299, Ratio=2.42x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.296, Ratio=2.48x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.315, Ratio=2.64x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.307, Ratio=2.63x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.269, Ratio=2.34x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.286, Ratio=2.49x, Gap=-2.723
Batch 250/537: Loss=1.2809 (C:1.2809, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.295, Ratio=2.65x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.304, Ratio=2.49x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.296, Ratio=2.47x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.310, Ratio=2.50x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.44x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.298, Ratio=2.51x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.288, Ratio=2.39x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.306, Ratio=2.51x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.290, Ratio=2.39x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.299, Ratio=2.48x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.285, Ratio=2.44x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.320, Ratio=2.69x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.55x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.311, Ratio=2.63x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.315, Ratio=2.53x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.289, Ratio=2.44x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.302, Ratio=2.46x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.316, Ratio=2.63x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.320, Ratio=2.65x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.314, Ratio=2.64x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.285, Ratio=2.39x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.317, Ratio=2.65x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.296, Ratio=2.53x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.292, Ratio=2.40x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.299, Ratio=2.54x, Gap=-2.897
Batch 275/537: Loss=1.2636 (C:1.2636, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.303, Ratio=2.55x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.294, Ratio=2.48x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.302, Ratio=2.45x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.304, Ratio=2.55x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.280, Ratio=2.42x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.291, Ratio=2.48x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.290, Ratio=2.46x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.307, Ratio=2.53x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.293, Ratio=2.41x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.307, Ratio=2.45x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.51x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.303, Ratio=2.52x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.294, Ratio=2.53x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.305, Ratio=2.52x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.310, Ratio=2.57x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.303, Ratio=2.57x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.287, Ratio=2.51x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.303, Ratio=2.52x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.303, Ratio=2.54x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.321, Ratio=2.72x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.295, Ratio=2.49x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.292, Ratio=2.43x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.304, Ratio=2.59x, Gap=-2.834
Batch 300/537: Loss=1.2542 (C:1.2542, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.296, Ratio=2.47x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.311, Ratio=2.58x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.295, Ratio=2.50x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.306, Ratio=2.52x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.268, Ratio=2.31x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.317, Ratio=2.53x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.285, Ratio=2.41x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.316, Ratio=2.68x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.282, Ratio=2.38x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.302, Ratio=2.57x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.294, Ratio=2.52x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.300, Ratio=2.48x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.293, Ratio=2.54x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.310, Ratio=2.59x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.53x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.292, Ratio=2.44x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.50x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.290, Ratio=2.47x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.289, Ratio=2.36x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.296, Ratio=2.50x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.315, Ratio=2.67x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.315, Ratio=2.61x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.307, Ratio=2.51x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.285, Ratio=2.43x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.299, Ratio=2.43x, Gap=-2.855
Batch 325/537: Loss=1.2888 (C:1.2888, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.313, Ratio=2.54x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.313, Ratio=2.62x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.52x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.298, Ratio=2.51x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.277, Ratio=2.46x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.53x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.60x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.281, Ratio=2.41x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.282, Ratio=2.35x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.323, Ratio=2.57x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.292, Ratio=2.38x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.300, Ratio=2.49x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.294, Ratio=2.44x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.286, Ratio=2.41x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.297, Ratio=2.48x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.295, Ratio=2.52x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.302, Ratio=2.54x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.290, Ratio=2.45x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.283, Ratio=2.38x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.305, Ratio=2.54x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.304, Ratio=2.52x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.308, Ratio=2.56x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.303, Ratio=2.42x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.307, Ratio=2.62x, Gap=-2.796
Batch 350/537: Loss=1.2438 (C:1.2438, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.296, Ratio=2.46x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.297, Ratio=2.48x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.285, Ratio=2.42x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.285, Ratio=2.43x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.291, Ratio=2.48x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.61x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.297, Ratio=2.53x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.296, Ratio=2.52x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.51x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.307, Ratio=2.62x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.308, Ratio=2.57x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.288, Ratio=2.49x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.262, Ratio=2.27x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.297, Ratio=2.49x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.307, Ratio=2.56x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.305, Ratio=2.59x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.303, Ratio=2.49x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.296, Ratio=2.47x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.298, Ratio=2.54x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.289, Ratio=2.55x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.317, Ratio=2.65x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.307, Ratio=2.54x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.306, Ratio=2.50x, Gap=-2.808
Batch 375/537: Loss=1.2704 (C:1.2704, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.300, Ratio=2.57x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.295, Ratio=2.52x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.306, Ratio=2.54x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.307, Ratio=2.50x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.303, Ratio=2.52x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.318, Ratio=2.54x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.301, Ratio=2.47x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.303, Ratio=2.52x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.317, Ratio=2.60x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.273, Ratio=2.45x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.310, Ratio=2.59x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.298, Ratio=2.48x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.282, Ratio=2.44x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.308, Ratio=2.46x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.289, Ratio=2.45x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.311, Ratio=2.62x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.292, Ratio=2.39x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.283, Ratio=2.43x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.304, Ratio=2.53x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.308, Ratio=2.61x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.310, Ratio=2.44x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.305, Ratio=2.56x, Gap=-2.737
Batch 400/537: Loss=1.2619 (C:1.2619, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.300, Ratio=2.51x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.292, Ratio=2.54x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.316, Ratio=2.62x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.284, Ratio=2.45x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.281, Ratio=2.50x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.304, Ratio=2.57x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.297, Ratio=2.45x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.316, Ratio=2.58x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.296, Ratio=2.52x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.287, Ratio=2.48x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.314, Ratio=2.48x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.59x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.283, Ratio=2.33x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.316, Ratio=2.68x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.296, Ratio=2.47x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.292, Ratio=2.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.298, Ratio=2.49x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.298, Ratio=2.54x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.275, Ratio=2.38x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.298, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.309, Ratio=2.59x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.299, Ratio=2.45x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.289, Ratio=2.46x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.300, Ratio=2.46x, Gap=-2.862
Batch 425/537: Loss=1.2811 (C:1.2811, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.313, Ratio=2.51x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.306, Ratio=2.56x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.288, Ratio=2.42x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.295, Ratio=2.44x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.295, Ratio=2.54x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.285, Ratio=2.48x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.290, Ratio=2.47x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.297, Ratio=2.58x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.52x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.315, Ratio=2.69x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.301, Ratio=2.49x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.290, Ratio=2.37x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.49x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.294, Ratio=2.48x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.306, Ratio=2.59x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.310, Ratio=2.61x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.294, Ratio=2.51x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.284, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.317, Ratio=2.62x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.302, Ratio=2.50x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.322, Ratio=2.63x, Gap=-2.978
Batch 450/537: Loss=1.2342 (C:1.2342, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.308, Ratio=2.54x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.292, Ratio=2.44x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.300, Ratio=2.50x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.88x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.309, Ratio=2.53x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.290, Ratio=2.46x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.305, Ratio=2.53x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.316, Ratio=2.61x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.315, Ratio=2.61x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.301, Ratio=2.46x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.288, Ratio=2.41x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.301, Ratio=2.52x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.281, Ratio=2.45x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.308, Ratio=2.49x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.315, Ratio=2.61x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.278, Ratio=2.38x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.301, Ratio=2.51x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.298, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.300, Ratio=2.49x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.321, Ratio=2.63x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.291, Ratio=2.52x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.275, Ratio=2.35x, Gap=-2.763
Batch 475/537: Loss=1.3213 (C:1.3213, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.299, Ratio=2.53x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.321, Ratio=2.64x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.283, Ratio=2.50x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.315, Ratio=2.69x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.293, Ratio=2.50x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.294, Ratio=2.44x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.299, Ratio=2.56x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.286, Ratio=2.48x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.328, Ratio=2.72x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.298, Ratio=2.47x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.307, Ratio=2.52x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.307, Ratio=2.54x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.311, Ratio=2.51x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.308, Ratio=2.52x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.312, Ratio=2.58x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.329, Ratio=2.71x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.42x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.293, Ratio=2.51x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.315, Ratio=2.73x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.297, Ratio=2.53x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.305, Ratio=2.57x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.301, Ratio=2.50x, Gap=-3.012
Batch 500/537: Loss=1.2726 (C:1.2726, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.292, Ratio=2.41x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.312, Ratio=2.55x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.308, Ratio=2.56x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.300, Ratio=2.45x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.303, Ratio=2.51x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.302, Ratio=2.59x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.291, Ratio=2.44x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.312, Ratio=2.63x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.300, Ratio=2.52x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.304, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.298, Ratio=2.48x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.297, Ratio=2.52x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.297, Ratio=2.55x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.306, Ratio=2.54x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.297, Ratio=2.44x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.309, Ratio=2.57x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.309, Ratio=2.58x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.292, Ratio=2.43x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.298, Ratio=2.42x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.311, Ratio=2.60x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.304, Ratio=2.56x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.303, Ratio=2.47x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.312, Ratio=2.68x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.287, Ratio=2.49x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.303, Ratio=2.52x, Gap=-2.736
Batch 525/537: Loss=1.2689 (C:1.2689, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.289, Ratio=2.43x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.299, Ratio=2.57x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.305, Ratio=2.53x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.314, Ratio=2.65x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.293, Ratio=2.44x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.289, Ratio=2.40x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.308, Ratio=2.54x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.59x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.319, Ratio=2.62x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.309, Ratio=2.64x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.309, Ratio=2.70x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.307, Ratio=2.69x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.306, Ratio=2.78x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.309, Ratio=2.62x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.298, Ratio=2.61x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.297, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.310, Ratio=2.67x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.310, Ratio=2.68x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.304, Ratio=2.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.299, Ratio=2.64x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.297, Ratio=2.53x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.301, Ratio=2.66x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.289, Ratio=2.43x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.296, Ratio=2.47x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.291, Ratio=2.43x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.311, Ratio=2.65x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.294, Ratio=2.55x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.317, Ratio=2.72x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.277, Ratio=2.41x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.301, Ratio=2.64x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.326, Ratio=2.86x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.319, Ratio=2.66x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.297, Ratio=2.50x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.296, Ratio=2.59x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.308, Ratio=2.72x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.299, Ratio=2.59x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.297, Ratio=2.58x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.300, Ratio=2.65x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.306, Ratio=2.65x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.296, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.308, Ratio=2.60x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.288, Ratio=2.53x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.299, Ratio=2.65x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.314, Ratio=2.73x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.293, Ratio=2.59x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.313, Ratio=2.72x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.304, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.310, Ratio=2.68x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.295, Ratio=2.53x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.298, Ratio=2.57x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.305, Ratio=2.68x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.288, Ratio=2.52x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.301, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.313, Ratio=2.68x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.301, Ratio=2.47x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.293, Ratio=2.55x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.298, Ratio=2.63x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.303, Ratio=2.70x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.305, Ratio=2.59x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.312, Ratio=2.73x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.284, Ratio=2.48x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.310, Ratio=2.69x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.316, Ratio=2.78x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.296, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.312, Ratio=2.63x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.292, Ratio=2.53x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.311, Ratio=2.74x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.323, Ratio=2.79x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.305, Ratio=2.63x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.298, Ratio=2.64x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.292, Ratio=2.59x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.290, Ratio=2.50x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.297, Ratio=2.61x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.291, Ratio=2.70x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.304, Ratio=2.64x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.292, Ratio=2.58x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.323, Ratio=2.80x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.327, Ratio=2.81x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.296, Ratio=2.63x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.322, Ratio=2.78x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.309, Ratio=2.70x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.293, Ratio=2.53x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.308, Ratio=2.68x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.304, Ratio=2.59x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.316, Ratio=2.81x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.304, Ratio=2.66x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.313, Ratio=2.64x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.309, Ratio=2.73x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.316, Ratio=2.73x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.311, Ratio=2.69x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.299, Ratio=2.61x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.315, Ratio=2.72x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.322, Ratio=2.76x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.288, Ratio=2.59x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.307, Ratio=2.72x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.313, Ratio=2.74x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.313, Ratio=2.77x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.303, Ratio=2.67x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.295, Ratio=2.56x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.287, Ratio=2.58x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.306, Ratio=2.61x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.306, Ratio=2.59x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.324, Ratio=2.79x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.293, Ratio=2.58x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.279, Ratio=2.38x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.317, Ratio=2.75x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.294, Ratio=2.54x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.297, Ratio=2.66x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.300, Ratio=2.76x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.323, Ratio=2.80x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.300, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.295, Ratio=2.52x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.333, Ratio=2.90x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.295, Ratio=2.56x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.292, Ratio=2.56x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.305, Ratio=2.56x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.302, Ratio=2.67x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.293, Ratio=2.64x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.288, Ratio=2.48x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.306, Ratio=2.67x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.304, Ratio=2.64x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.313, Ratio=2.73x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.290, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.313, Ratio=2.73x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.304, Ratio=2.68x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.280, Ratio=2.53x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.313, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.297, Ratio=2.62x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.306, Ratio=2.73x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.301, Ratio=2.71x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.308, Ratio=2.67x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.303, Ratio=2.60x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.303, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.307, Ratio=2.63x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.335, Ratio=2.83x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.306, Ratio=2.66x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.313, Ratio=2.66x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.314, Ratio=2.65x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.304, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.298, Ratio=2.59x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.295, Ratio=2.57x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.301, Ratio=2.61x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.306, Ratio=2.71x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.290, Ratio=2.47x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.301, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.280, Ratio=2.53x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.294, Ratio=2.51x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.292, Ratio=2.61x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.76x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.311, Ratio=2.68x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.300, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.298, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.306, Ratio=2.55x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.290, Ratio=2.64x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.294, Ratio=2.52x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.298, Ratio=2.64x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.305, Ratio=2.66x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.301, Ratio=2.62x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.292, Ratio=2.51x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.304, Ratio=2.79x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.272, Ratio=2.44x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.296, Ratio=2.64x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.305, Ratio=2.71x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.305, Ratio=2.78x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.309, Ratio=2.71x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.311, Ratio=2.71x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.310, Ratio=2.67x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.289, Ratio=2.57x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.291, Ratio=2.58x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.309, Ratio=2.73x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.312, Ratio=2.67x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.296, Ratio=2.59x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.304, Ratio=2.72x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.287, Ratio=2.53x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.304, Ratio=2.70x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.284, Ratio=2.45x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.298, Ratio=2.64x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.291, Ratio=2.57x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.290, Ratio=2.64x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.287, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.289, Ratio=2.58x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.308, Ratio=2.61x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.322, Ratio=2.74x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.308, Ratio=2.69x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.300, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.302, Ratio=2.75x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.302, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.306, Ratio=2.67x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.300, Ratio=2.63x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.302, Ratio=2.63x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.279, Ratio=2.53x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.304, Ratio=2.57x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.288, Ratio=2.57x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.305, Ratio=2.68x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.300, Ratio=2.67x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.311, Ratio=2.61x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.291, Ratio=2.59x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.302, Ratio=2.68x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.75x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.301, Ratio=2.56x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.304, Ratio=2.62x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.296, Ratio=2.68x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.294, Ratio=2.61x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.303, Ratio=2.75x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.308, Ratio=2.69x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.292, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.300, Ratio=2.68x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.303, Ratio=2.61x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.300, Ratio=2.66x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.310, Ratio=2.70x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.306, Ratio=2.70x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.281, Ratio=2.49x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.318, Ratio=2.72x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.320, Ratio=2.69x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.311, Ratio=2.73x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.52x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.299, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.300, Ratio=2.59x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.292, Ratio=2.61x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.323, Ratio=2.70x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.311, Ratio=2.65x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.320, Ratio=2.83x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.298, Ratio=2.60x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.320, Ratio=2.69x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.288, Ratio=2.56x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.308, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.297, Ratio=2.62x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.291, Ratio=2.55x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.317, Ratio=2.72x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.317, Ratio=2.71x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.312, Ratio=2.69x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.302, Ratio=2.73x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.309, Ratio=2.72x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.288, Ratio=2.60x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.301, Ratio=2.62x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.76x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.300, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.290, Ratio=2.57x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.287, Ratio=2.57x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.279, Ratio=2.45x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.306, Ratio=2.60x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.315, Ratio=2.76x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.320, Ratio=2.77x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.314, Ratio=2.75x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.307, Ratio=2.62x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.306, Ratio=2.61x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.307, Ratio=2.68x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.301, Ratio=2.56x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.309, Ratio=2.73x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.287, Ratio=2.51x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.291, Ratio=2.63x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.309, Ratio=2.64x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.299, Ratio=2.67x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.283, Ratio=2.48x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.308, Ratio=2.61x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.293, Ratio=2.53x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.305, Ratio=2.69x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.303, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.308, Ratio=2.72x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.310, Ratio=2.62x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.302, Ratio=2.58x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.308, Ratio=2.60x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.307, Ratio=2.58x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.300, Ratio=2.61x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.315, Ratio=2.75x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.295, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.296, Ratio=2.64x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.301, Ratio=2.55x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.290, Ratio=2.51x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.313, Ratio=2.70x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.310, Ratio=2.70x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.292, Ratio=2.61x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.299, Ratio=2.59x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.313, Ratio=2.71x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.301, Ratio=2.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.315, Ratio=2.81x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.290, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.313, Ratio=2.70x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.317, Ratio=2.79x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.299, Ratio=2.51x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.310, Ratio=2.66x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.285, Ratio=2.47x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.291, Ratio=2.62x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.288, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.307, Ratio=2.66x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.311, Ratio=2.69x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.291, Ratio=2.55x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.319, Ratio=2.79x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.293, Ratio=2.55x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.312, Ratio=2.75x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.305, Ratio=2.69x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.307, Ratio=2.70x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.303, Ratio=2.63x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.298, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.300, Ratio=2.62x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.314, Ratio=2.73x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.290, Ratio=2.65x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.302, Ratio=2.64x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.315, Ratio=2.72x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.293, Ratio=2.56x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.304, Ratio=2.67x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.314, Ratio=2.65x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.299, Ratio=2.58x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.312, Ratio=2.65x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.307, Ratio=2.78x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.297, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.317, Ratio=2.76x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.294, Ratio=2.50x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.302, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.299, Ratio=2.65x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.316, Ratio=2.86x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.330, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.303, Ratio=2.69x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.326, Ratio=2.80x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.296, Ratio=2.58x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.309, Ratio=2.77x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.295, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.314, Ratio=2.78x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.308, Ratio=2.72x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.298, Ratio=2.61x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.314, Ratio=2.78x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.298, Ratio=2.68x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.293, Ratio=2.56x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.305, Ratio=2.76x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.290, Ratio=2.54x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.299, Ratio=2.54x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.304, Ratio=2.68x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.313, Ratio=2.73x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.306, Ratio=2.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.299, Ratio=2.61x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.306, Ratio=2.65x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.301, Ratio=2.60x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.311, Ratio=2.79x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.311, Ratio=2.74x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.316, Ratio=2.80x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.301, Ratio=2.58x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.312, Ratio=2.69x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.309, Ratio=2.76x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.315, Ratio=2.75x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.307, Ratio=2.62x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.302, Ratio=2.63x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.313, Ratio=2.70x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.308, Ratio=2.66x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.296, Ratio=2.60x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.301, Ratio=2.66x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.316, Ratio=2.71x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.315, Ratio=2.76x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.300, Ratio=2.68x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.299, Ratio=2.62x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.304, Ratio=2.65x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.293, Ratio=2.63x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.313, Ratio=2.65x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.323, Ratio=2.76x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.308, Ratio=2.54x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.320, Ratio=2.77x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.307, Ratio=2.70x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.284, Ratio=2.49x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.281, Ratio=2.40x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.304, Ratio=2.61x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.293, Ratio=2.52x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.302, Ratio=2.67x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.305, Ratio=2.68x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.301, Ratio=2.56x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.303, Ratio=2.69x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.326, Ratio=2.82x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.301, Ratio=2.59x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.297, Ratio=2.51x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.296, Ratio=2.55x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.312, Ratio=2.73x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.289, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.276, Ratio=2.48x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.306, Ratio=2.63x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.300, Ratio=2.64x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.307, Ratio=2.69x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.310, Ratio=2.63x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.286, Ratio=2.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.302, Ratio=2.66x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.297, Ratio=2.61x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.304, Ratio=2.68x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.322, Ratio=2.87x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.286, Ratio=2.41x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.292, Ratio=2.57x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.299, Ratio=2.69x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.303, Ratio=2.67x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.291, Ratio=2.56x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.306, Ratio=2.76x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.306, Ratio=2.64x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.291, Ratio=2.55x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.320, Ratio=2.76x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.315, Ratio=2.74x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.294, Ratio=2.56x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.307, Ratio=2.64x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.307, Ratio=2.73x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.292, Ratio=2.55x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.287, Ratio=2.58x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.288, Ratio=2.59x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.304, Ratio=2.65x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.302, Ratio=2.62x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.297, Ratio=2.60x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.307, Ratio=2.72x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.316, Ratio=2.70x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.302, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.307, Ratio=2.57x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.302, Ratio=2.69x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.288, Ratio=2.48x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.301, Ratio=2.60x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.288, Ratio=2.59x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.298, Ratio=2.50x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.300, Ratio=2.52x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.311, Ratio=2.77x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.313, Ratio=2.80x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.307, Ratio=2.67x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.318, Ratio=2.73x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.307, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.289, Ratio=2.57x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.299, Ratio=2.60x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.303, Ratio=2.62x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.296, Ratio=2.57x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.314, Ratio=2.67x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.313, Ratio=2.67x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.288, Ratio=2.58x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.314, Ratio=2.63x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.301, Ratio=2.59x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.318, Ratio=2.75x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.303, Ratio=2.59x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.296, Ratio=2.67x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.300, Ratio=2.59x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.321, Ratio=2.79x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.287, Ratio=2.51x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.295, Ratio=2.61x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.315, Ratio=2.68x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.301, Ratio=2.72x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.308, Ratio=2.87x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.319, Ratio=2.80x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.298, Ratio=2.54x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.301, Ratio=2.53x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.311, Ratio=2.85x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.291, Ratio=2.50x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.322, Ratio=2.83x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.297, Ratio=2.60x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.304, Ratio=2.62x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.289, Ratio=2.59x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.307, Ratio=2.63x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.329, Ratio=2.80x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.326, Ratio=2.82x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.307, Ratio=2.73x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.318, Ratio=2.64x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.316, Ratio=2.78x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.291, Ratio=2.58x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.300, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.296, Ratio=2.61x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.301, Ratio=2.71x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.318, Ratio=2.73x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.313, Ratio=2.69x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.298, Ratio=2.64x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.317, Ratio=2.68x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.291, Ratio=2.46x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.313, Ratio=2.65x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.289, Ratio=2.58x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.323, Ratio=2.86x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.310, Ratio=2.70x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.299, Ratio=2.63x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.291, Ratio=2.60x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.310, Ratio=2.62x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.312, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.310, Ratio=2.61x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.296, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.305, Ratio=2.61x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.286, Ratio=2.62x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.304, Ratio=2.69x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.304, Ratio=2.64x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.305, Ratio=2.66x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.282, Ratio=2.45x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.313, Ratio=2.69x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.297, Ratio=2.64x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.315, Ratio=2.80x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.302, Ratio=2.62x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.317, Ratio=2.76x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.328, Ratio=2.90x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.315, Ratio=2.72x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.321, Ratio=2.87x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.314, Ratio=2.67x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.299, Ratio=2.65x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.297, Ratio=2.65x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.308, Ratio=2.67x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.308, Ratio=2.66x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.306, Ratio=2.61x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.293, Ratio=2.56x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.309, Ratio=2.66x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.315, Ratio=2.67x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.295, Ratio=2.59x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.313, Ratio=2.76x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.304, Ratio=2.52x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.314, Ratio=2.66x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.286, Ratio=2.52x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.307, Ratio=2.68x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.328, Ratio=2.87x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.312, Ratio=2.64x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.316, Ratio=2.74x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.298, Ratio=2.61x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.296, Ratio=2.69x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.308, Ratio=2.69x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.292, Ratio=2.56x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.318, Ratio=2.61x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.282, Ratio=2.47x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.312, Ratio=2.72x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.312, Ratio=2.74x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.289, Ratio=2.50x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.312, Ratio=2.77x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.323, Ratio=2.73x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.307, Ratio=2.67x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.293, Ratio=2.53x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.292, Ratio=2.54x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.300, Ratio=2.63x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.308, Ratio=2.69x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.318, Ratio=2.80x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.314, Ratio=2.72x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.304, Ratio=2.66x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.303, Ratio=2.62x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.296, Ratio=2.63x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.308, Ratio=2.64x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.306, Ratio=2.74x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.298, Ratio=2.60x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.284, Ratio=2.56x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.311, Ratio=2.65x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.304, Ratio=2.63x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.305, Ratio=2.69x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.305, Ratio=2.58x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.309, Ratio=2.67x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.305, Ratio=2.71x, Gap=-2.764

============================================================
Epoch 12/20 completed in 29.8s
Train: Loss=1.2675 (C:1.2675, R:0.0018) Ratio=2.46x
Val:   Loss=1.2428 (C:1.2428, R:0.0018) Ratio=2.77x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.2428)
============================================================

🌍 Updating global dataset at epoch 13
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.467 ± 0.643
    Neg distances: 1.336 ± 0.842
    Separation ratio: 2.86x
    Gap: -2.718
    ✅ Good global separation

Epoch 13 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.324, Ratio=2.70x, Gap=-2.960
Batch   0/537: Loss=1.2251 (C:1.2251, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.78x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.93x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.337, Ratio=2.78x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.329, Ratio=2.71x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.339, Ratio=2.77x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.322, Ratio=2.58x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.331, Ratio=2.87x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.336, Ratio=2.82x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.343, Ratio=2.80x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.336, Ratio=2.72x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.69x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.324, Ratio=2.72x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.330, Ratio=2.73x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.331, Ratio=2.68x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.325, Ratio=2.69x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.345, Ratio=2.77x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.323, Ratio=2.69x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.717
Batch  25/537: Loss=1.2202 (C:1.2202, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.327, Ratio=2.71x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.76x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.319, Ratio=2.62x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.329, Ratio=2.75x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.333, Ratio=2.74x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.325, Ratio=2.66x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.329, Ratio=2.71x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.326, Ratio=2.53x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.332, Ratio=2.72x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.320, Ratio=2.65x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.311, Ratio=2.50x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.330, Ratio=2.78x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.313, Ratio=2.64x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.310, Ratio=2.56x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.340, Ratio=2.85x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.318, Ratio=2.65x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.75x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.70x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.344, Ratio=2.63x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.316, Ratio=2.62x, Gap=-2.895
Batch  50/537: Loss=1.2458 (C:1.2458, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.339, Ratio=2.78x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.320, Ratio=2.65x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.308, Ratio=2.62x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.308, Ratio=2.54x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.327, Ratio=2.71x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.313, Ratio=2.57x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.329, Ratio=2.71x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.325, Ratio=2.69x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.329, Ratio=2.79x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.362, Ratio=2.90x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.334, Ratio=2.72x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.336, Ratio=2.79x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.320, Ratio=2.62x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.327, Ratio=2.72x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.68x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.333, Ratio=2.78x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.319, Ratio=2.69x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.347, Ratio=2.85x, Gap=-2.862
Batch  75/537: Loss=1.1890 (C:1.1890, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.66x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.316, Ratio=2.58x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.79x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.324, Ratio=2.60x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.340, Ratio=2.74x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.331, Ratio=2.75x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.71x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.64x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.337, Ratio=2.63x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.343, Ratio=2.81x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.325, Ratio=2.72x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.323, Ratio=2.78x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.317, Ratio=2.75x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.314, Ratio=2.55x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.316, Ratio=2.58x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.897
Batch 100/537: Loss=1.2018 (C:1.2018, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.330, Ratio=2.61x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.322, Ratio=2.65x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.70x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.340, Ratio=2.74x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.336, Ratio=2.90x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.312, Ratio=2.60x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.340, Ratio=2.76x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.76x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.343, Ratio=2.73x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.340, Ratio=2.82x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.320, Ratio=2.57x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.323, Ratio=2.66x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.321, Ratio=2.64x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.338, Ratio=2.78x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.341, Ratio=2.82x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.320, Ratio=2.54x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.325, Ratio=2.75x, Gap=-3.010
Batch 125/537: Loss=1.2180 (C:1.2180, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.331, Ratio=2.74x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.324, Ratio=2.71x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.323, Ratio=2.62x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.323, Ratio=2.67x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.306, Ratio=2.52x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.323, Ratio=2.70x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.78x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.371, Ratio=2.90x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.329, Ratio=2.61x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.85x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.330, Ratio=2.74x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.332, Ratio=2.76x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.89x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.333, Ratio=2.68x, Gap=-2.918
Batch 150/537: Loss=1.2265 (C:1.2265, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.339, Ratio=2.88x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.69x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.350, Ratio=2.78x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.77x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.73x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.308, Ratio=2.54x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.309, Ratio=2.50x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.65x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.332, Ratio=2.71x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.312, Ratio=2.63x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.320, Ratio=2.66x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.328, Ratio=2.75x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.330, Ratio=2.69x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.342, Ratio=2.84x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.341, Ratio=2.79x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.338, Ratio=2.83x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.989
Batch 175/537: Loss=1.2110 (C:1.2110, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.328, Ratio=2.73x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.330, Ratio=2.78x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.65x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.337, Ratio=2.67x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.322, Ratio=2.63x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.335, Ratio=2.86x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.306, Ratio=2.62x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.323, Ratio=2.64x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.333, Ratio=2.80x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.345, Ratio=2.79x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.87x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.339, Ratio=2.62x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.321, Ratio=2.67x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.337, Ratio=2.82x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.321, Ratio=2.78x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.323, Ratio=2.68x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.321, Ratio=2.68x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.323, Ratio=2.60x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.345, Ratio=2.86x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.328, Ratio=2.68x, Gap=-3.260
Batch 200/537: Loss=1.2304 (C:1.2304, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.353, Ratio=2.78x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.326, Ratio=2.64x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.66x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.323, Ratio=2.65x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.78x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.336, Ratio=2.78x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.324, Ratio=2.67x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.328, Ratio=2.72x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.64x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.332, Ratio=2.73x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.321, Ratio=2.61x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.321, Ratio=2.71x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.347, Ratio=2.83x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.334, Ratio=2.75x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.322, Ratio=2.68x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.320, Ratio=2.61x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.314, Ratio=2.48x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.321, Ratio=2.62x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.324, Ratio=2.65x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.332, Ratio=2.76x, Gap=-2.919
Batch 225/537: Loss=1.2109 (C:1.2109, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.326, Ratio=2.76x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.323, Ratio=2.74x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.338, Ratio=2.70x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.346, Ratio=2.85x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.319, Ratio=2.65x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.336, Ratio=2.75x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.68x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.323, Ratio=2.77x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.302, Ratio=2.40x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.317, Ratio=2.62x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.74x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.322, Ratio=2.67x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.325, Ratio=2.73x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.324, Ratio=2.65x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.60x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.318, Ratio=2.59x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.333, Ratio=2.67x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.335, Ratio=2.64x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.62x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.322, Ratio=2.70x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.336, Ratio=2.80x, Gap=-3.262
Batch 250/537: Loss=1.2046 (C:1.2046, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.75x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.335, Ratio=2.84x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.334, Ratio=2.72x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.331, Ratio=2.70x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.327, Ratio=2.74x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.335, Ratio=2.74x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.328, Ratio=2.64x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.313, Ratio=2.65x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.316, Ratio=2.60x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.325, Ratio=2.73x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.326, Ratio=2.67x, Gap=-3.319
Batch 275/537: Loss=1.2315 (C:1.2315, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.323, Ratio=2.64x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.330, Ratio=2.71x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.331, Ratio=2.77x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.315, Ratio=2.66x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.328, Ratio=2.70x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.343, Ratio=2.79x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.72x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.342, Ratio=2.75x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.72x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.329, Ratio=2.78x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.325, Ratio=2.59x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.314, Ratio=2.58x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.325, Ratio=2.77x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.73x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.332, Ratio=2.82x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.869
Batch 300/537: Loss=1.2369 (C:1.2369, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.57x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.69x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.338, Ratio=2.73x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.334, Ratio=2.73x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.320, Ratio=2.60x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.342, Ratio=2.90x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.77x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.344, Ratio=2.79x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.62x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.339, Ratio=2.65x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.330, Ratio=2.68x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.72x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.339, Ratio=2.70x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.59x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.327, Ratio=2.71x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.337, Ratio=2.80x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.320, Ratio=2.65x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.337, Ratio=2.80x, Gap=-3.119
Batch 325/537: Loss=1.2039 (C:1.2039, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.350, Ratio=2.89x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.330, Ratio=2.81x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.331, Ratio=2.73x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.336, Ratio=2.78x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.315, Ratio=2.60x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.327, Ratio=2.63x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.64x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.337, Ratio=2.78x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.331, Ratio=2.73x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.325, Ratio=2.66x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.345, Ratio=2.80x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.71x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.344, Ratio=2.82x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.362, Ratio=2.91x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.328, Ratio=2.68x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.346, Ratio=2.96x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.93x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.352, Ratio=2.86x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-3.025
Batch 350/537: Loss=1.1988 (C:1.1988, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.336, Ratio=2.76x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.333, Ratio=2.80x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.341, Ratio=2.84x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.323, Ratio=2.77x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.318, Ratio=2.69x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.320, Ratio=2.55x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.320, Ratio=2.53x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.72x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.342, Ratio=2.88x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.318, Ratio=2.63x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.331, Ratio=2.78x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.64x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.305, Ratio=2.51x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.308, Ratio=2.59x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.327, Ratio=2.72x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.322, Ratio=2.63x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.328, Ratio=2.70x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.916
Batch 375/537: Loss=1.1784 (C:1.1784, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.328, Ratio=2.69x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.341, Ratio=2.78x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.336, Ratio=2.61x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.321, Ratio=2.72x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.339, Ratio=2.82x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.70x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.331, Ratio=2.77x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.318, Ratio=2.61x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.309, Ratio=2.61x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.340, Ratio=2.72x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.325, Ratio=2.66x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.71x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.330, Ratio=2.64x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.334, Ratio=2.69x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.303, Ratio=2.62x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.323, Ratio=2.68x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.82x, Gap=-2.795
Batch 400/537: Loss=1.1958 (C:1.1958, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.322, Ratio=2.61x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.329, Ratio=2.78x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.338, Ratio=2.74x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.311, Ratio=2.58x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.320, Ratio=2.54x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.337, Ratio=2.78x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.314, Ratio=2.57x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.306, Ratio=2.55x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.318, Ratio=2.63x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.320, Ratio=2.69x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.323, Ratio=2.73x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.323, Ratio=2.65x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.321, Ratio=2.68x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.325, Ratio=2.71x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.73x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.333, Ratio=2.68x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.348, Ratio=2.68x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.355, Ratio=2.88x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.348, Ratio=2.87x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.331, Ratio=2.68x, Gap=-3.185
Batch 425/537: Loss=1.2282 (C:1.2282, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.62x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.59x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.344, Ratio=2.76x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.324, Ratio=2.65x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.318, Ratio=2.67x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.330, Ratio=2.73x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.323, Ratio=2.62x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.82x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.75x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.312, Ratio=2.63x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.330, Ratio=2.75x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.331, Ratio=2.79x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.317, Ratio=2.58x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.323, Ratio=2.69x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.320, Ratio=2.66x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.333, Ratio=2.75x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.352, Ratio=2.81x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.332, Ratio=2.72x, Gap=-3.342
Batch 450/537: Loss=1.2239 (C:1.2239, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.316, Ratio=2.60x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.333, Ratio=2.79x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.322, Ratio=2.84x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.330, Ratio=2.80x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.347, Ratio=2.86x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.315, Ratio=2.52x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.303, Ratio=2.47x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.314, Ratio=2.68x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.338, Ratio=2.64x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.336, Ratio=2.87x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.339, Ratio=2.80x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.312, Ratio=2.60x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.326, Ratio=2.69x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.325, Ratio=2.69x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.333, Ratio=2.74x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.352, Ratio=2.94x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.336, Ratio=2.82x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.335, Ratio=2.81x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.327, Ratio=2.73x, Gap=-3.248
Batch 475/537: Loss=1.2198 (C:1.2198, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.339, Ratio=2.68x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.338, Ratio=2.73x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.73x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.346, Ratio=2.92x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.353, Ratio=2.83x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.345, Ratio=2.78x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.338, Ratio=2.77x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.326, Ratio=2.73x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.302, Ratio=2.49x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.316, Ratio=2.57x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.335, Ratio=2.78x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.319, Ratio=2.56x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.325, Ratio=2.67x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.330, Ratio=2.70x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.322, Ratio=2.68x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.329, Ratio=2.68x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.321, Ratio=2.62x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.66x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.305, Ratio=2.54x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.345, Ratio=2.80x, Gap=-2.862
Batch 500/537: Loss=1.1962 (C:1.1962, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.320, Ratio=2.67x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.320, Ratio=2.66x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.306, Ratio=2.58x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.358, Ratio=3.02x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.67x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.344, Ratio=2.79x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.330, Ratio=2.67x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.315, Ratio=2.52x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.63x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.332, Ratio=2.76x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.325, Ratio=2.67x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.330, Ratio=2.71x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.63x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.77x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.306, Ratio=2.48x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.314, Ratio=2.50x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.329, Ratio=2.79x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.305, Ratio=2.47x, Gap=-2.811
Batch 525/537: Loss=1.2810 (C:1.2810, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.316, Ratio=2.58x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.326, Ratio=2.73x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.68x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.324, Ratio=2.64x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.74x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.296, Ratio=2.57x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.335, Ratio=2.93x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.346, Ratio=2.90x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.334, Ratio=2.76x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.322, Ratio=2.74x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.340, Ratio=2.94x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.342, Ratio=2.82x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.341, Ratio=2.94x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.335, Ratio=2.91x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.334, Ratio=2.85x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.335, Ratio=2.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.336, Ratio=2.90x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.321, Ratio=2.77x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.349, Ratio=3.00x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.327, Ratio=2.84x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.329, Ratio=2.89x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.337, Ratio=2.95x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.321, Ratio=2.81x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.333, Ratio=2.92x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.334, Ratio=2.85x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.336, Ratio=2.95x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.340, Ratio=2.83x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.332, Ratio=2.97x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.333, Ratio=2.92x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.338, Ratio=2.96x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.353, Ratio=3.06x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.323, Ratio=2.79x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.333, Ratio=2.86x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.333, Ratio=2.83x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.308, Ratio=2.68x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.355, Ratio=2.98x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.321, Ratio=2.72x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.327, Ratio=2.72x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.350, Ratio=2.99x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.354, Ratio=2.97x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.322, Ratio=2.73x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.353, Ratio=3.03x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.327, Ratio=2.83x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.352, Ratio=3.03x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.327, Ratio=2.86x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.322, Ratio=2.80x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.346, Ratio=2.99x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.333, Ratio=2.79x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.320, Ratio=2.74x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.330, Ratio=2.90x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.345, Ratio=3.07x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.341, Ratio=3.08x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.334, Ratio=2.93x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.338, Ratio=2.82x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.327, Ratio=2.86x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.340, Ratio=2.87x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.361, Ratio=3.09x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.336, Ratio=2.97x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.313, Ratio=2.70x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.340, Ratio=2.98x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.92x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.326, Ratio=2.82x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.323, Ratio=2.91x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.325, Ratio=2.71x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.342, Ratio=2.89x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.321, Ratio=2.70x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.323, Ratio=2.87x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.331, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.336, Ratio=2.88x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.332, Ratio=2.94x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.327, Ratio=2.78x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.348, Ratio=3.06x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.330, Ratio=2.73x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.334, Ratio=2.94x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.331, Ratio=2.77x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.338, Ratio=2.96x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.338, Ratio=2.85x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.333, Ratio=2.89x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.338, Ratio=2.83x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.336, Ratio=2.90x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.323, Ratio=2.81x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.315, Ratio=2.68x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.334, Ratio=2.85x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.333, Ratio=2.80x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.326, Ratio=2.79x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.336, Ratio=2.86x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.327, Ratio=2.79x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.320, Ratio=2.86x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.328, Ratio=2.88x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.328, Ratio=2.78x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.324, Ratio=2.84x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.331, Ratio=2.93x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.317, Ratio=2.73x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.324, Ratio=2.79x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.333, Ratio=2.89x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.342, Ratio=3.00x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.336, Ratio=2.92x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.331, Ratio=2.99x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.324, Ratio=2.81x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.337, Ratio=2.94x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.306, Ratio=2.63x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.323, Ratio=2.76x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.348, Ratio=3.04x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.321, Ratio=2.73x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.341, Ratio=2.99x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.313, Ratio=2.67x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.321, Ratio=2.70x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.333, Ratio=2.81x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.342, Ratio=2.98x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.326, Ratio=2.71x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.344, Ratio=2.99x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.321, Ratio=2.75x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.339, Ratio=2.91x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.326, Ratio=2.74x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.325, Ratio=2.85x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.324, Ratio=2.73x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.92x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.332, Ratio=2.79x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.330, Ratio=2.77x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.331, Ratio=2.84x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.321, Ratio=2.70x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.328, Ratio=2.80x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.340, Ratio=2.91x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.328, Ratio=2.82x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.336, Ratio=2.84x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.338, Ratio=2.94x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.355, Ratio=3.06x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.328, Ratio=2.81x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.345, Ratio=2.96x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.317, Ratio=2.74x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.332, Ratio=2.77x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.318, Ratio=2.79x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.328, Ratio=2.87x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.335, Ratio=2.97x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.338, Ratio=2.89x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.329, Ratio=2.92x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.336, Ratio=2.88x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.331, Ratio=2.89x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.329, Ratio=2.79x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.325, Ratio=2.79x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.327, Ratio=2.77x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.333, Ratio=2.88x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.310, Ratio=2.69x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.328, Ratio=2.78x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.325, Ratio=2.76x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.316, Ratio=2.74x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.339, Ratio=2.93x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.318, Ratio=2.67x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.327, Ratio=2.87x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.315, Ratio=2.67x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.326, Ratio=2.89x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.343, Ratio=2.95x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.334, Ratio=2.89x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.316, Ratio=2.73x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.339, Ratio=2.89x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.318, Ratio=2.80x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.330, Ratio=2.78x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.351, Ratio=2.91x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.333, Ratio=2.89x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.335, Ratio=2.91x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.324, Ratio=2.83x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.332, Ratio=2.94x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.323, Ratio=2.81x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.334, Ratio=2.85x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.324, Ratio=2.79x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.344, Ratio=2.95x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.336, Ratio=2.89x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.340, Ratio=2.88x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.330, Ratio=2.80x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.325, Ratio=2.79x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.337, Ratio=2.87x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.334, Ratio=2.83x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.327, Ratio=2.78x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.326, Ratio=2.83x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.331, Ratio=2.86x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.337, Ratio=2.88x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.345, Ratio=3.06x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.328, Ratio=2.88x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.350, Ratio=3.02x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.326, Ratio=2.86x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.326, Ratio=2.75x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.340, Ratio=2.93x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.330, Ratio=2.85x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.334, Ratio=2.80x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.326, Ratio=2.73x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.318, Ratio=2.69x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.318, Ratio=2.76x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.326, Ratio=2.82x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.81x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.328, Ratio=2.81x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.333, Ratio=2.87x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.329, Ratio=2.93x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.339, Ratio=2.91x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.321, Ratio=2.77x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.343, Ratio=3.09x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.336, Ratio=2.83x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.341, Ratio=2.98x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.333, Ratio=2.98x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.334, Ratio=2.96x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.87x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.319, Ratio=2.74x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.332, Ratio=2.87x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.350, Ratio=3.07x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.339, Ratio=2.92x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.325, Ratio=2.92x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.332, Ratio=2.93x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.341, Ratio=2.89x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.327, Ratio=2.78x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.308, Ratio=2.64x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.334, Ratio=2.80x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.345, Ratio=2.92x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.351, Ratio=2.99x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.332, Ratio=2.87x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.339, Ratio=2.92x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.328, Ratio=2.84x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.322, Ratio=2.75x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.346, Ratio=2.96x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.314, Ratio=2.68x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.324, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.322, Ratio=2.86x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.339, Ratio=2.94x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.350, Ratio=2.97x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.333, Ratio=2.97x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.332, Ratio=2.88x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.332, Ratio=2.91x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.326, Ratio=2.86x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.330, Ratio=2.83x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.337, Ratio=2.90x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.331, Ratio=2.84x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.334, Ratio=2.85x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.337, Ratio=2.87x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.313, Ratio=2.75x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.321, Ratio=2.83x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.337, Ratio=2.89x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.318, Ratio=2.73x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.82x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.331, Ratio=2.89x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.315, Ratio=2.77x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.319, Ratio=2.72x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.319, Ratio=2.72x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.342, Ratio=2.92x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.331, Ratio=2.80x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.331, Ratio=2.78x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.354, Ratio=3.18x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.355, Ratio=3.03x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.324, Ratio=2.72x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.336, Ratio=2.97x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.92x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.349, Ratio=3.09x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.351, Ratio=2.98x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.316, Ratio=2.63x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.343, Ratio=2.91x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.341, Ratio=2.94x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.338, Ratio=2.92x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.325, Ratio=2.80x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.310, Ratio=2.69x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.351, Ratio=3.00x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.350, Ratio=3.01x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.329, Ratio=2.92x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.91x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.336, Ratio=2.79x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.323, Ratio=2.74x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.346, Ratio=2.93x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.329, Ratio=2.84x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.346, Ratio=2.92x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.333, Ratio=2.83x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.322, Ratio=2.79x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.334, Ratio=2.83x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.325, Ratio=2.85x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.333, Ratio=2.87x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.314, Ratio=2.78x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.319, Ratio=2.75x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.331, Ratio=2.85x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.326, Ratio=2.60x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.324, Ratio=2.83x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.328, Ratio=2.76x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.344, Ratio=2.92x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.328, Ratio=2.77x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.325, Ratio=2.70x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.335, Ratio=2.84x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.340, Ratio=2.92x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.334, Ratio=2.95x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.344, Ratio=2.98x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.332, Ratio=2.88x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.324, Ratio=2.74x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.321, Ratio=2.71x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.353, Ratio=3.07x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.334, Ratio=2.94x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.332, Ratio=2.72x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.346, Ratio=3.07x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.323, Ratio=2.69x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.346, Ratio=2.97x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.72x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.328, Ratio=2.79x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.326, Ratio=2.67x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.320, Ratio=2.75x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.325, Ratio=2.78x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.305, Ratio=2.62x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.311, Ratio=2.72x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.305, Ratio=2.88x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.319, Ratio=2.69x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.323, Ratio=2.72x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.326, Ratio=2.78x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.330, Ratio=2.84x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.334, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.340, Ratio=2.87x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.321, Ratio=2.79x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.335, Ratio=2.86x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.335, Ratio=2.92x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.325, Ratio=2.84x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.344, Ratio=2.88x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.341, Ratio=2.90x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.340, Ratio=2.95x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.335, Ratio=2.94x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.338, Ratio=2.97x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.349, Ratio=3.08x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.341, Ratio=2.90x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.324, Ratio=2.75x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.89x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.343, Ratio=3.15x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.327, Ratio=2.77x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.329, Ratio=2.88x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.346, Ratio=2.97x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.336, Ratio=2.93x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.340, Ratio=2.98x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.330, Ratio=2.79x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.322, Ratio=2.82x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.327, Ratio=2.88x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.342, Ratio=3.09x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.340, Ratio=3.00x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.326, Ratio=2.85x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.330, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.315, Ratio=2.70x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.320, Ratio=2.73x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.333, Ratio=2.74x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.332, Ratio=2.77x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.337, Ratio=2.85x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.328, Ratio=2.84x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.322, Ratio=2.80x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.331, Ratio=2.77x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.332, Ratio=2.81x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.327, Ratio=2.78x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.324, Ratio=3.00x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.324, Ratio=2.76x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.343, Ratio=2.97x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.340, Ratio=2.95x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.329, Ratio=2.91x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.329, Ratio=2.74x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.335, Ratio=2.75x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.319, Ratio=2.72x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.351, Ratio=3.01x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.347, Ratio=2.97x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.312, Ratio=2.78x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.336, Ratio=2.92x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.302, Ratio=2.61x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.329, Ratio=2.89x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.332, Ratio=2.81x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.309, Ratio=2.65x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.337, Ratio=2.84x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.331, Ratio=2.88x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.325, Ratio=2.77x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.336, Ratio=2.93x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.335, Ratio=2.88x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.82x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.305, Ratio=2.70x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.345, Ratio=2.95x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.324, Ratio=2.78x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.322, Ratio=2.79x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.341, Ratio=2.93x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.352, Ratio=2.98x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.327, Ratio=2.93x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.340, Ratio=2.90x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.340, Ratio=2.99x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.340, Ratio=2.95x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.332, Ratio=2.81x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.332, Ratio=2.83x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.337, Ratio=2.97x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.343, Ratio=2.87x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.335, Ratio=2.88x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.342, Ratio=2.91x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.321, Ratio=2.66x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.337, Ratio=2.92x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.345, Ratio=2.97x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.330, Ratio=2.78x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.332, Ratio=2.86x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.308, Ratio=2.70x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.324, Ratio=2.71x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.340, Ratio=2.82x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.320, Ratio=2.85x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.342, Ratio=2.94x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.318, Ratio=2.69x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.323, Ratio=2.83x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.327, Ratio=2.80x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.339, Ratio=2.96x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.330, Ratio=2.82x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.337, Ratio=2.80x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.323, Ratio=2.79x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.333, Ratio=2.92x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.331, Ratio=2.86x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.332, Ratio=2.82x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.329, Ratio=2.82x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.337, Ratio=2.94x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.325, Ratio=2.77x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.317, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.313, Ratio=2.71x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.340, Ratio=3.02x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.333, Ratio=2.81x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.339, Ratio=2.93x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.343, Ratio=3.06x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.331, Ratio=2.86x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.313, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.328, Ratio=2.74x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.344, Ratio=2.92x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.317, Ratio=2.75x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.333, Ratio=2.86x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.328, Ratio=2.86x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.335, Ratio=2.91x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.325, Ratio=2.87x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.325, Ratio=2.81x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.334, Ratio=2.90x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.355, Ratio=3.00x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.313, Ratio=2.72x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.72x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.335, Ratio=2.89x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.313, Ratio=2.67x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.333, Ratio=2.85x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.322, Ratio=2.83x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.361, Ratio=3.19x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.338, Ratio=2.98x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.322, Ratio=2.73x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.336, Ratio=2.94x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.329, Ratio=2.86x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.322, Ratio=2.79x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.323, Ratio=2.76x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.338, Ratio=2.88x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.361, Ratio=3.05x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.341, Ratio=2.94x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.335, Ratio=3.02x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.311, Ratio=2.73x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.328, Ratio=2.74x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.325, Ratio=2.90x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.309, Ratio=2.75x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.332, Ratio=2.90x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.343, Ratio=2.91x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.339, Ratio=2.94x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.336, Ratio=2.92x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.339, Ratio=2.86x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.337, Ratio=2.85x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.316, Ratio=2.78x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.342, Ratio=2.99x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.325, Ratio=2.74x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.323, Ratio=2.73x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.332, Ratio=2.78x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.315, Ratio=2.75x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.332, Ratio=2.99x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.323, Ratio=2.82x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.325, Ratio=2.88x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.339, Ratio=2.92x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.333, Ratio=2.95x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.339, Ratio=2.85x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.341, Ratio=2.97x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.317, Ratio=2.71x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.324, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.323, Ratio=2.73x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.328, Ratio=2.78x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.355, Ratio=3.15x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.335, Ratio=2.90x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.321, Ratio=2.83x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.334, Ratio=2.88x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.340, Ratio=2.97x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.332, Ratio=2.87x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.344, Ratio=3.00x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.337, Ratio=2.88x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.327, Ratio=2.81x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.330, Ratio=2.83x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.346, Ratio=3.00x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.335, Ratio=2.97x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.324, Ratio=2.66x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.326, Ratio=2.90x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.343, Ratio=3.02x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.336, Ratio=2.83x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.334, Ratio=2.84x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.334, Ratio=2.98x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.341, Ratio=2.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.337, Ratio=3.00x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.334, Ratio=2.89x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.317, Ratio=2.69x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.341, Ratio=2.98x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.321, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.331, Ratio=2.83x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.322, Ratio=2.82x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.317, Ratio=2.63x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.324, Ratio=2.83x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.318, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.306, Ratio=2.69x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.329, Ratio=2.91x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.317, Ratio=2.76x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.329, Ratio=2.70x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.324, Ratio=2.76x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.312, Ratio=2.70x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.329, Ratio=2.83x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.328, Ratio=2.91x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.333, Ratio=2.89x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.341, Ratio=2.83x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.335, Ratio=2.91x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.323, Ratio=2.80x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.331, Ratio=2.78x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.344, Ratio=2.94x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.334, Ratio=2.91x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.335, Ratio=2.93x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.335, Ratio=2.81x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.342, Ratio=2.95x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.332, Ratio=2.92x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.340, Ratio=2.93x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.346, Ratio=2.97x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.331, Ratio=2.79x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.341, Ratio=3.00x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.321, Ratio=2.79x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.326, Ratio=2.83x, Gap=-2.700

============================================================
Epoch 13/20 completed in 36.1s
Train: Loss=1.2236 (C:1.2236, R:0.0018) Ratio=2.53x
Val:   Loss=1.1952 (C:1.1952, R:0.0018) Ratio=2.86x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1952)
============================================================

Epoch 14 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.314, Ratio=2.66x, Gap=-2.777
Batch   0/537: Loss=1.2376 (C:1.2376, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.330, Ratio=2.75x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.330, Ratio=2.76x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.78x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.343, Ratio=2.67x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.357, Ratio=2.87x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.324, Ratio=2.66x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.312, Ratio=2.55x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.339, Ratio=2.90x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.353, Ratio=2.84x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.348, Ratio=2.72x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.335, Ratio=2.85x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.323, Ratio=2.71x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.330, Ratio=2.69x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.323, Ratio=2.69x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.86x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.324, Ratio=2.67x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.350, Ratio=2.78x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.71x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.80x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.321, Ratio=2.69x, Gap=-3.036
Batch  25/537: Loss=1.2312 (C:1.2312, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.88x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.346, Ratio=2.90x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.318, Ratio=2.67x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.325, Ratio=2.74x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.342, Ratio=2.75x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.359, Ratio=2.90x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.338, Ratio=2.85x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.75x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.65x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.332, Ratio=2.78x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.345, Ratio=2.84x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.318, Ratio=2.65x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.325, Ratio=2.70x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.344, Ratio=2.93x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.324, Ratio=2.68x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.322, Ratio=2.67x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.345, Ratio=2.84x, Gap=-3.097
Batch  50/537: Loss=1.1900 (C:1.1900, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.338, Ratio=2.68x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.88x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.325, Ratio=2.73x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.326, Ratio=2.72x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.351, Ratio=2.93x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.76x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.328, Ratio=2.60x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.332, Ratio=2.79x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.319, Ratio=2.66x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.328, Ratio=2.74x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.322, Ratio=2.72x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.337, Ratio=2.74x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.336, Ratio=2.68x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.338, Ratio=2.78x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.346, Ratio=2.87x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.74x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.329, Ratio=2.72x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.86x, Gap=-2.895
Batch  75/537: Loss=1.1830 (C:1.1830, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.331, Ratio=2.79x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.328, Ratio=2.67x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.357, Ratio=2.91x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.348, Ratio=2.82x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.89x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.340, Ratio=2.80x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.312, Ratio=2.71x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.351, Ratio=2.92x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.328, Ratio=2.74x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.72x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.325, Ratio=2.67x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.61x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.299, Ratio=2.53x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.80x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.330, Ratio=2.63x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.334, Ratio=2.74x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.340, Ratio=2.66x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-3.108
Batch 100/537: Loss=1.2270 (C:1.2270, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.345, Ratio=2.82x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.329, Ratio=2.71x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.79x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.331, Ratio=2.83x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.333, Ratio=2.72x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.339, Ratio=2.65x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.316, Ratio=2.53x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.321, Ratio=2.67x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.325, Ratio=2.66x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.345, Ratio=2.90x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.70x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.345, Ratio=2.87x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.68x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.328, Ratio=2.54x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.318, Ratio=2.56x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.353, Ratio=2.89x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.347, Ratio=2.87x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.335, Ratio=2.64x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.318, Ratio=2.69x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.332, Ratio=2.79x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.80x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.88x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.839
Batch 125/537: Loss=1.2368 (C:1.2368, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.334, Ratio=2.72x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.329, Ratio=2.77x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.339, Ratio=2.84x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.326, Ratio=2.64x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.325, Ratio=2.67x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.358, Ratio=2.93x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.356, Ratio=2.84x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.83x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.371, Ratio=3.11x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.347, Ratio=2.86x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.332, Ratio=2.77x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.71x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.66x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.336, Ratio=2.82x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.74x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.340, Ratio=2.86x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.331, Ratio=2.69x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.344, Ratio=2.79x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.340, Ratio=2.81x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.70x, Gap=-2.750
Batch 150/537: Loss=1.2243 (C:1.2243, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.80x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.348, Ratio=2.87x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.334, Ratio=2.75x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.350, Ratio=2.77x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.334, Ratio=2.77x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.345, Ratio=2.80x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.321, Ratio=2.69x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.340, Ratio=2.80x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.65x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.322, Ratio=2.70x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.317, Ratio=2.69x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.327, Ratio=2.60x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.333, Ratio=2.70x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.337, Ratio=2.68x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.336, Ratio=2.81x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.335, Ratio=2.82x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.351, Ratio=2.79x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.317, Ratio=2.65x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.332, Ratio=2.71x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.82x, Gap=-2.814
Batch 175/537: Loss=1.1940 (C:1.1940, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.83x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.324, Ratio=2.74x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.334, Ratio=2.69x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.328, Ratio=2.61x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.71x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.335, Ratio=2.78x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.330, Ratio=2.77x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.82x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.346, Ratio=2.83x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.314, Ratio=2.60x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.340, Ratio=2.78x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.322, Ratio=2.65x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.324, Ratio=2.70x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.88x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.334, Ratio=2.71x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.75x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.326, Ratio=2.71x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.316, Ratio=2.66x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.338, Ratio=2.83x, Gap=-2.952
Batch 200/537: Loss=1.1960 (C:1.1960, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.339, Ratio=2.81x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.332, Ratio=2.77x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.315, Ratio=2.55x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.323, Ratio=2.73x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.333, Ratio=2.83x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.334, Ratio=2.71x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.342, Ratio=2.81x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.325, Ratio=2.66x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.325, Ratio=2.64x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.322, Ratio=2.67x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.327, Ratio=2.66x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.75x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.76x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.323, Ratio=2.66x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.343, Ratio=2.85x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.348, Ratio=2.81x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.63x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.324, Ratio=2.58x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.308, Ratio=2.59x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.311, Ratio=2.55x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.324, Ratio=2.78x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.329, Ratio=2.64x, Gap=-3.230
Batch 225/537: Loss=1.2357 (C:1.2357, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.84x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.80x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.332, Ratio=2.65x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.312, Ratio=2.62x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.75x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.76x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.329, Ratio=2.61x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.329, Ratio=2.71x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.338, Ratio=2.67x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.346, Ratio=2.87x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.321, Ratio=2.58x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.331, Ratio=2.77x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.344, Ratio=2.85x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.336, Ratio=2.58x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.320, Ratio=2.65x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.58x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.336, Ratio=2.78x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.320, Ratio=2.68x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.351, Ratio=2.80x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.324, Ratio=2.66x, Gap=-2.803
Batch 250/537: Loss=1.2325 (C:1.2325, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.351, Ratio=2.79x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.63x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.331, Ratio=2.61x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.340, Ratio=2.75x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.341, Ratio=2.77x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.349, Ratio=2.95x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.339, Ratio=2.66x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.343, Ratio=2.80x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.321, Ratio=2.65x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.334, Ratio=2.73x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.325, Ratio=2.66x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.339, Ratio=2.77x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.339, Ratio=2.84x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.315, Ratio=2.63x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.323, Ratio=2.67x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.67x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.323, Ratio=2.56x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.353, Ratio=2.88x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.323, Ratio=2.77x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.346, Ratio=2.83x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.70x, Gap=-3.726
Batch 275/537: Loss=1.2251 (C:1.2251, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.356, Ratio=3.03x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.340, Ratio=2.84x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.314, Ratio=2.60x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.334, Ratio=2.72x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.308, Ratio=2.52x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.330, Ratio=2.72x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.62x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.60x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.324, Ratio=2.68x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.83x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.314, Ratio=2.67x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.335, Ratio=2.70x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.332, Ratio=2.60x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.75x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.65x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.338, Ratio=2.76x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.335, Ratio=2.69x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.326, Ratio=2.73x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.311, Ratio=2.50x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.311, Ratio=2.60x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.321, Ratio=2.64x, Gap=-2.909
Batch 300/537: Loss=1.2395 (C:1.2395, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.321, Ratio=2.65x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.354, Ratio=2.94x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.350, Ratio=2.80x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.325, Ratio=2.68x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.311, Ratio=2.68x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.345, Ratio=2.86x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.72x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.334, Ratio=2.65x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.331, Ratio=2.69x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.338, Ratio=2.82x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.62x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.327, Ratio=2.71x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.313, Ratio=2.57x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.333, Ratio=2.77x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.85x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.330, Ratio=2.71x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.334, Ratio=2.74x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.329, Ratio=2.68x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.331, Ratio=2.62x, Gap=-3.400
Batch 325/537: Loss=1.2418 (C:1.2418, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.75x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.67x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.333, Ratio=2.70x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.304, Ratio=2.61x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.330, Ratio=2.69x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.331, Ratio=2.72x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.327, Ratio=2.69x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.318, Ratio=2.62x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.335, Ratio=2.73x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.321, Ratio=2.62x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.327, Ratio=2.71x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.318, Ratio=2.67x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.343, Ratio=2.75x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.341, Ratio=2.65x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.316, Ratio=2.58x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.330, Ratio=2.69x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.870
Batch 350/537: Loss=1.2534 (C:1.2534, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.310, Ratio=2.60x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.82x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.291, Ratio=2.49x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.333, Ratio=2.72x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.328, Ratio=2.69x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.90x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.71x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.326, Ratio=2.69x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.342, Ratio=2.78x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.323, Ratio=2.57x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.77x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.324, Ratio=2.59x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.306, Ratio=2.60x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.330, Ratio=2.70x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.320, Ratio=2.67x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.327, Ratio=2.70x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.308, Ratio=2.57x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.332, Ratio=2.73x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.54x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.350, Ratio=2.87x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.73x, Gap=-2.879
Batch 375/537: Loss=1.2146 (C:1.2146, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.318, Ratio=2.57x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.343, Ratio=2.81x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.75x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.340, Ratio=2.81x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.331, Ratio=2.76x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.303, Ratio=2.54x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.324, Ratio=2.70x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.347, Ratio=2.86x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.333, Ratio=2.84x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.331, Ratio=2.84x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.307, Ratio=2.51x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.333, Ratio=2.58x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.299, Ratio=2.55x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.343, Ratio=2.84x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.80x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.336, Ratio=2.68x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.336, Ratio=2.79x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.73x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.365, Ratio=2.92x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.316, Ratio=2.62x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.87x, Gap=-2.892
Batch 400/537: Loss=1.1846 (C:1.1846, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.56x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.314, Ratio=2.61x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.333, Ratio=2.71x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.338, Ratio=2.73x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.344, Ratio=2.78x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.59x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.332, Ratio=2.66x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.343, Ratio=2.79x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.338, Ratio=2.78x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.301, Ratio=2.54x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.330, Ratio=2.72x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.332, Ratio=2.67x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.329, Ratio=2.76x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.67x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.319, Ratio=2.74x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.344, Ratio=2.87x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.331, Ratio=2.66x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.347, Ratio=2.71x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.323, Ratio=2.66x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.339, Ratio=2.70x, Gap=-2.788
Batch 425/537: Loss=1.2220 (C:1.2220, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.336, Ratio=2.80x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.341, Ratio=2.74x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.79x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.316, Ratio=2.65x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.334, Ratio=2.80x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.317, Ratio=2.65x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.58x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.343, Ratio=2.83x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.334, Ratio=2.75x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.323, Ratio=2.67x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.353, Ratio=2.82x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.319, Ratio=2.76x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.333, Ratio=2.79x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.328, Ratio=2.78x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.331, Ratio=2.79x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.335, Ratio=2.69x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.338, Ratio=2.65x, Gap=-3.160
Batch 450/537: Loss=1.2308 (C:1.2308, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.320, Ratio=2.68x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.63x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.338, Ratio=2.72x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.322, Ratio=2.63x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.327, Ratio=2.68x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.349, Ratio=2.89x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.343, Ratio=2.87x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.344, Ratio=2.80x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.334, Ratio=2.76x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.324, Ratio=2.73x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.335, Ratio=2.74x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.66x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.333, Ratio=2.67x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.329, Ratio=2.67x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.306, Ratio=2.55x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.359, Ratio=2.83x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.73x, Gap=-2.819
Batch 475/537: Loss=1.2208 (C:1.2208, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.77x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.342, Ratio=2.67x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.350, Ratio=2.81x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.327, Ratio=2.74x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.323, Ratio=2.71x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.331, Ratio=2.68x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.319, Ratio=2.70x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.322, Ratio=2.58x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.92x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.338, Ratio=2.73x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.345, Ratio=2.84x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.339, Ratio=2.78x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.316, Ratio=2.62x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.315, Ratio=2.59x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.314, Ratio=2.62x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.320, Ratio=2.60x, Gap=-3.008
Batch 500/537: Loss=1.2507 (C:1.2507, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.331, Ratio=2.78x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.76x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.340, Ratio=2.74x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.335, Ratio=2.82x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.325, Ratio=2.73x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.298, Ratio=2.44x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.337, Ratio=2.72x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.323, Ratio=2.69x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.80x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.74x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.328, Ratio=2.76x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.325, Ratio=2.66x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.337, Ratio=2.77x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.313, Ratio=2.57x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.304, Ratio=2.59x, Gap=-2.791
Batch 525/537: Loss=1.2565 (C:1.2565, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.327, Ratio=2.70x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.337, Ratio=2.83x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.74x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.59x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.328, Ratio=2.76x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.346, Ratio=2.91x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.350, Ratio=3.00x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.328, Ratio=2.80x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.345, Ratio=2.88x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.354, Ratio=3.08x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.337, Ratio=2.94x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.338, Ratio=2.85x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.337, Ratio=2.83x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.360, Ratio=3.12x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.339, Ratio=2.85x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.336, Ratio=2.98x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.79x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.340, Ratio=2.84x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.337, Ratio=2.82x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.344, Ratio=2.85x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.355, Ratio=2.93x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.323, Ratio=2.72x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.323, Ratio=2.81x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.344, Ratio=2.98x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.335, Ratio=2.90x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.330, Ratio=2.86x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.341, Ratio=2.81x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.336, Ratio=2.85x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.342, Ratio=2.89x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.334, Ratio=2.81x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.333, Ratio=2.82x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.348, Ratio=2.93x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.90x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.340, Ratio=2.81x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.347, Ratio=3.00x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.338, Ratio=2.90x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.00x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.340, Ratio=2.95x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.340, Ratio=2.84x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.347, Ratio=3.00x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.339, Ratio=2.92x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.340, Ratio=2.87x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.335, Ratio=2.92x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.344, Ratio=2.99x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.342, Ratio=2.81x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.86x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.330, Ratio=2.74x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.361, Ratio=3.03x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.332, Ratio=2.78x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.353, Ratio=2.99x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.355, Ratio=2.99x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.346, Ratio=2.91x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.339, Ratio=2.90x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.328, Ratio=2.77x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.336, Ratio=2.85x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.354, Ratio=3.02x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.339, Ratio=2.90x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.350, Ratio=2.89x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.331, Ratio=2.83x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.330, Ratio=2.84x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.334, Ratio=2.86x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.369, Ratio=3.06x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.342, Ratio=2.79x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.330, Ratio=2.86x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.343, Ratio=2.97x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.329, Ratio=2.79x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.351, Ratio=3.02x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.363, Ratio=3.10x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.329, Ratio=2.86x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.346, Ratio=2.86x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.344, Ratio=2.91x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.334, Ratio=2.86x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.331, Ratio=2.76x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.328, Ratio=2.73x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.337, Ratio=2.86x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.363, Ratio=3.10x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.342, Ratio=2.90x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.331, Ratio=2.96x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.333, Ratio=2.92x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.336, Ratio=2.91x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.354, Ratio=2.99x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.325, Ratio=2.81x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.333, Ratio=2.77x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=2.99x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.322, Ratio=2.76x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.333, Ratio=2.99x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.334, Ratio=2.86x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.323, Ratio=2.71x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.349, Ratio=2.96x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.345, Ratio=2.91x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.340, Ratio=2.97x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.325, Ratio=2.94x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.323, Ratio=2.78x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.339, Ratio=2.93x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.90x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.338, Ratio=2.88x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.343, Ratio=3.00x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.351, Ratio=2.93x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.325, Ratio=2.74x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.345, Ratio=2.93x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.339, Ratio=2.82x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.346, Ratio=2.91x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.370, Ratio=3.09x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.353, Ratio=2.95x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.333, Ratio=2.84x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.341, Ratio=2.90x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.344, Ratio=2.96x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.332, Ratio=2.83x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.337, Ratio=2.82x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.346, Ratio=2.87x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.317, Ratio=2.65x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.352, Ratio=2.99x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.337, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.342, Ratio=2.88x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.331, Ratio=2.94x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.337, Ratio=2.87x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.344, Ratio=2.94x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.355, Ratio=3.04x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.359, Ratio=3.01x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.336, Ratio=2.97x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.334, Ratio=2.88x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.353, Ratio=3.00x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.334, Ratio=2.88x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.327, Ratio=2.78x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.331, Ratio=2.85x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.342, Ratio=3.04x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.333, Ratio=2.81x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.344, Ratio=2.84x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.349, Ratio=2.95x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.13x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.343, Ratio=2.96x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.81x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.348, Ratio=2.94x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.320, Ratio=2.81x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.337, Ratio=2.83x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.361, Ratio=3.08x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.350, Ratio=3.02x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.351, Ratio=2.93x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.349, Ratio=2.99x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.344, Ratio=2.87x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.326, Ratio=2.76x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.333, Ratio=2.83x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.336, Ratio=2.81x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.346, Ratio=2.93x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.352, Ratio=3.04x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.338, Ratio=2.94x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.330, Ratio=2.80x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.350, Ratio=2.83x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.332, Ratio=2.98x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.333, Ratio=2.87x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.342, Ratio=2.81x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.339, Ratio=2.89x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.339, Ratio=2.81x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.350, Ratio=2.89x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.350, Ratio=3.01x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.349, Ratio=3.08x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.341, Ratio=2.85x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.78x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.334, Ratio=2.76x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.334, Ratio=2.87x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.333, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.344, Ratio=3.00x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.323, Ratio=2.72x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.339, Ratio=2.88x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.333, Ratio=2.78x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.330, Ratio=2.82x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.335, Ratio=2.77x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.329, Ratio=2.81x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.327, Ratio=2.76x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.340, Ratio=2.93x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.342, Ratio=2.85x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.344, Ratio=2.83x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.347, Ratio=2.87x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.334, Ratio=2.74x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.359, Ratio=3.03x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.327, Ratio=2.72x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.362, Ratio=3.08x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.358, Ratio=3.00x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.334, Ratio=2.92x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.322, Ratio=2.76x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.342, Ratio=2.95x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.331, Ratio=2.84x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.337, Ratio=2.86x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.329, Ratio=2.81x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.356, Ratio=2.88x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.340, Ratio=2.93x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.322, Ratio=2.73x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.335, Ratio=2.78x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.318, Ratio=2.75x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.341, Ratio=2.81x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.338, Ratio=3.00x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.82x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.327, Ratio=2.75x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.343, Ratio=2.86x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.342, Ratio=2.92x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.327, Ratio=2.79x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.340, Ratio=2.83x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.338, Ratio=2.88x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.87x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.343, Ratio=2.97x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.338, Ratio=2.80x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.351, Ratio=3.06x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.336, Ratio=2.92x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.336, Ratio=2.91x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.342, Ratio=2.99x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.322, Ratio=2.74x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.336, Ratio=2.80x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.329, Ratio=2.75x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.353, Ratio=3.00x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.334, Ratio=2.77x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.346, Ratio=3.00x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.337, Ratio=2.88x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.356, Ratio=3.03x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.338, Ratio=2.95x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.353, Ratio=2.92x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.346, Ratio=3.03x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.341, Ratio=2.80x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.351, Ratio=2.97x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.346, Ratio=2.92x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.351, Ratio=3.02x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.358, Ratio=3.05x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.330, Ratio=2.76x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.337, Ratio=2.91x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.333, Ratio=2.88x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.357, Ratio=2.98x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.350, Ratio=2.91x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.338, Ratio=2.80x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.348, Ratio=2.91x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.347, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.354, Ratio=2.96x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.336, Ratio=2.83x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.323, Ratio=2.87x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.316, Ratio=2.66x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.87x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.337, Ratio=2.89x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.352, Ratio=2.98x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.327, Ratio=2.77x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.328, Ratio=2.86x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.319, Ratio=2.71x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.342, Ratio=2.84x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.330, Ratio=2.88x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.337, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.353, Ratio=3.01x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.338, Ratio=2.88x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.86x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.337, Ratio=2.94x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.357, Ratio=3.01x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.344, Ratio=2.83x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.359, Ratio=3.07x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.342, Ratio=2.94x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.353, Ratio=2.94x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.326, Ratio=2.82x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.336, Ratio=2.87x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.335, Ratio=2.91x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.83x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.347, Ratio=2.92x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.333, Ratio=2.95x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.345, Ratio=2.83x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.338, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.338, Ratio=2.84x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.08x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.353, Ratio=2.98x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.353, Ratio=3.02x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.332, Ratio=2.88x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.360, Ratio=3.10x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.332, Ratio=2.86x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.349, Ratio=2.90x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.340, Ratio=2.88x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.342, Ratio=2.89x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.331, Ratio=2.72x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.342, Ratio=2.92x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.328, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.341, Ratio=2.85x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.333, Ratio=2.82x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.325, Ratio=2.75x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.345, Ratio=2.97x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.352, Ratio=2.96x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.348, Ratio=2.97x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.329, Ratio=2.89x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.340, Ratio=2.91x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.358, Ratio=2.95x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.330, Ratio=2.74x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.72x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.341, Ratio=2.83x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.342, Ratio=2.97x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.318, Ratio=2.72x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.329, Ratio=2.77x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.344, Ratio=2.92x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.349, Ratio=2.98x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.347, Ratio=3.04x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.331, Ratio=2.85x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.356, Ratio=2.97x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.352, Ratio=2.97x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.338, Ratio=2.85x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.359, Ratio=3.00x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.343, Ratio=2.93x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.352, Ratio=2.98x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.336, Ratio=2.94x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.342, Ratio=2.97x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.345, Ratio=2.93x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.342, Ratio=2.91x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.324, Ratio=2.84x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.84x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.333, Ratio=2.77x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.331, Ratio=2.96x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.324, Ratio=2.77x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.87x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.341, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.342, Ratio=2.99x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.79x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.335, Ratio=2.87x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.345, Ratio=2.93x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.315, Ratio=2.66x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.340, Ratio=2.89x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.352, Ratio=2.98x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.336, Ratio=2.92x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.365, Ratio=3.12x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.337, Ratio=2.93x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.322, Ratio=2.72x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.345, Ratio=2.85x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.347, Ratio=2.94x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.348, Ratio=2.93x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.345, Ratio=2.91x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.349, Ratio=2.90x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.333, Ratio=2.81x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.340, Ratio=2.90x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.86x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.323, Ratio=2.79x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.346, Ratio=2.90x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.331, Ratio=2.76x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.342, Ratio=2.91x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.351, Ratio=2.94x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.339, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.371, Ratio=3.19x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.350, Ratio=3.05x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.340, Ratio=3.02x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.337, Ratio=2.82x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.343, Ratio=3.00x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.329, Ratio=2.73x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.344, Ratio=2.94x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.337, Ratio=2.85x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.343, Ratio=2.88x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.334, Ratio=2.82x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.323, Ratio=2.84x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.353, Ratio=2.96x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.345, Ratio=2.88x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.357, Ratio=3.13x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.348, Ratio=3.02x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.323, Ratio=2.78x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.80x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.347, Ratio=2.88x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.345, Ratio=2.86x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.351, Ratio=3.03x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.340, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.92x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.90x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.331, Ratio=2.85x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.338, Ratio=2.87x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.363, Ratio=3.00x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.334, Ratio=2.86x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.350, Ratio=3.02x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.343, Ratio=2.87x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.335, Ratio=2.88x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.332, Ratio=2.90x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.349, Ratio=2.93x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.339, Ratio=2.83x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.332, Ratio=2.76x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.331, Ratio=2.76x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.319, Ratio=2.72x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.327, Ratio=2.84x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.367, Ratio=3.14x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.344, Ratio=3.00x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.342, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.334, Ratio=2.85x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.90x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.357, Ratio=3.03x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.347, Ratio=2.97x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.354, Ratio=2.97x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.322, Ratio=2.81x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.336, Ratio=2.84x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.82x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.340, Ratio=2.92x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.343, Ratio=2.81x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.338, Ratio=2.90x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.339, Ratio=2.92x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.346, Ratio=2.84x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.341, Ratio=2.92x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.337, Ratio=2.88x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.90x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.348, Ratio=2.97x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.349, Ratio=2.90x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.331, Ratio=2.80x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.327, Ratio=2.76x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.345, Ratio=2.85x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.344, Ratio=2.98x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.89x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.333, Ratio=2.91x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.328, Ratio=2.84x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.347, Ratio=2.98x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.351, Ratio=3.00x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.334, Ratio=2.96x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.347, Ratio=2.96x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.345, Ratio=2.84x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.354, Ratio=2.91x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.328, Ratio=2.76x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.95x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.336, Ratio=2.86x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.340, Ratio=2.81x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.343, Ratio=2.95x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.333, Ratio=2.80x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.330, Ratio=2.75x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.324, Ratio=2.65x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.91x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.334, Ratio=2.87x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.340, Ratio=2.84x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.324, Ratio=2.71x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.335, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.344, Ratio=2.97x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.332, Ratio=2.89x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.344, Ratio=2.85x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.326, Ratio=2.80x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.347, Ratio=2.99x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.354, Ratio=3.05x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.341, Ratio=2.81x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.352, Ratio=3.02x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.367, Ratio=3.15x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.348, Ratio=2.94x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.337, Ratio=2.85x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.311, Ratio=2.62x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.334, Ratio=2.82x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.352, Ratio=2.99x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.352, Ratio=3.01x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.341, Ratio=2.85x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.351, Ratio=2.86x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.82x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.77x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.332, Ratio=2.86x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.341, Ratio=2.87x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.361, Ratio=3.14x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.328, Ratio=2.75x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.360, Ratio=3.01x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.337, Ratio=2.86x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.342, Ratio=2.93x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.350, Ratio=2.99x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.336, Ratio=2.84x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.352, Ratio=2.95x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.332, Ratio=2.84x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.326, Ratio=2.72x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.326, Ratio=2.75x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.336, Ratio=2.81x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.340, Ratio=2.89x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.336, Ratio=2.79x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.343, Ratio=2.93x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.306, Ratio=2.57x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.331, Ratio=2.84x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.324, Ratio=2.91x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.342, Ratio=2.93x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.332, Ratio=2.88x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.325, Ratio=2.82x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.318, Ratio=2.75x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.346, Ratio=2.90x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.357, Ratio=3.00x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.90x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.340, Ratio=2.90x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.342, Ratio=2.83x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.327, Ratio=2.75x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.344, Ratio=2.94x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.344, Ratio=2.89x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.90x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.351, Ratio=2.98x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.75x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.341, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.349, Ratio=3.08x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.332, Ratio=2.85x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.352, Ratio=2.97x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.338, Ratio=2.79x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.329, Ratio=2.91x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.91x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.351, Ratio=3.11x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.346, Ratio=2.85x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.333, Ratio=2.80x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.90x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.351, Ratio=2.92x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.327, Ratio=2.75x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.348, Ratio=2.97x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.349, Ratio=2.88x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.345, Ratio=2.90x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.345, Ratio=2.90x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.338, Ratio=2.84x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.338, Ratio=2.75x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.335, Ratio=2.88x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.340, Ratio=2.94x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.337, Ratio=2.84x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.333, Ratio=2.78x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.88x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.321, Ratio=2.71x, Gap=-2.639

============================================================
Epoch 14/20 completed in 30.5s
Train: Loss=1.2187 (C:1.2187, R:0.0018) Ratio=2.55x
Val:   Loss=1.1880 (C:1.1880, R:0.0018) Ratio=2.92x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1880)
============================================================

Epoch 15 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.89x, Gap=-3.121
Batch   0/537: Loss=1.1837 (C:1.1837, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.333, Ratio=2.78x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.328, Ratio=2.68x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.82x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.342, Ratio=2.88x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.327, Ratio=2.68x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.347, Ratio=3.02x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.325, Ratio=2.78x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.335, Ratio=2.73x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.329, Ratio=2.64x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.315, Ratio=2.61x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.344, Ratio=2.88x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.350, Ratio=2.77x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.323, Ratio=2.68x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.91x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.340, Ratio=2.80x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.340, Ratio=2.77x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.57x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.77x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.330, Ratio=2.82x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-2.991
Batch  25/537: Loss=1.2083 (C:1.2083, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.348, Ratio=2.88x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.92x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.82x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.344, Ratio=2.81x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.361, Ratio=2.86x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.326, Ratio=2.70x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.352, Ratio=2.87x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.348, Ratio=2.83x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.332, Ratio=2.61x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.326, Ratio=2.69x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.339, Ratio=2.89x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.319, Ratio=2.67x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.314, Ratio=2.72x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.338, Ratio=2.72x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.338, Ratio=2.78x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.323, Ratio=2.76x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.341, Ratio=2.78x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.336, Ratio=2.80x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.346, Ratio=2.94x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.61x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.333, Ratio=2.74x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-2.826
Batch  50/537: Loss=1.2361 (C:1.2361, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.341, Ratio=2.78x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.333, Ratio=2.77x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.347, Ratio=2.79x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.70x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.322, Ratio=2.69x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.340, Ratio=2.73x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.320, Ratio=2.64x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.344, Ratio=2.80x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.341, Ratio=2.84x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.78x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.343, Ratio=2.92x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.344, Ratio=2.89x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.00x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.340, Ratio=2.70x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.79x, Gap=-3.187
Batch  75/537: Loss=1.2014 (C:1.2014, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.334, Ratio=2.73x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.346, Ratio=2.76x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.346, Ratio=2.70x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.80x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.327, Ratio=2.69x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.85x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.353, Ratio=2.88x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.351, Ratio=2.85x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.343, Ratio=2.81x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.55x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.353, Ratio=2.95x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.320, Ratio=2.74x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.337, Ratio=2.80x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.336, Ratio=2.72x, Gap=-3.084
Batch 100/537: Loss=1.2192 (C:1.2192, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.309, Ratio=2.55x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.316, Ratio=2.63x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.329, Ratio=2.73x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.329, Ratio=2.69x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.326, Ratio=2.72x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.344, Ratio=2.89x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.345, Ratio=2.85x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.335, Ratio=2.80x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.82x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.331, Ratio=2.70x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.335, Ratio=2.75x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.353, Ratio=2.94x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.343, Ratio=2.76x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.347, Ratio=2.86x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.74x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.342, Ratio=2.82x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.321, Ratio=2.67x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.80x, Gap=-3.073
Batch 125/537: Loss=1.1969 (C:1.1969, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.354, Ratio=2.85x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.92x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.341, Ratio=2.75x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.341, Ratio=2.77x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.68x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.65x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.346, Ratio=2.82x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.320, Ratio=2.58x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.339, Ratio=2.80x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.64x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.316, Ratio=2.64x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.61x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.326, Ratio=2.73x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.355, Ratio=2.86x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.328, Ratio=2.72x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.327, Ratio=2.73x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.78x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.334, Ratio=2.81x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.325, Ratio=2.76x, Gap=-3.301
Batch 150/537: Loss=1.2168 (C:1.2168, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.343, Ratio=2.85x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.352, Ratio=2.82x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.318, Ratio=2.62x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.333, Ratio=2.78x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.337, Ratio=2.66x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.332, Ratio=2.65x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.326, Ratio=2.69x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.343, Ratio=2.88x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.68x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.341, Ratio=2.77x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.333, Ratio=2.74x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.331, Ratio=2.69x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.339, Ratio=2.84x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.332, Ratio=2.73x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.326, Ratio=2.70x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.331, Ratio=2.68x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-3.021
Batch 175/537: Loss=1.2315 (C:1.2315, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.345, Ratio=2.68x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.327, Ratio=2.75x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.324, Ratio=2.68x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.327, Ratio=2.69x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.324, Ratio=2.67x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.343, Ratio=2.78x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.349, Ratio=2.89x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.342, Ratio=2.85x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.330, Ratio=2.90x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.340, Ratio=2.71x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.349, Ratio=2.90x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.325, Ratio=2.65x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.325, Ratio=2.69x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.338, Ratio=2.84x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.319, Ratio=2.70x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.73x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.316, Ratio=2.54x, Gap=-2.865
Batch 200/537: Loss=1.2668 (C:1.2668, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.74x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.330, Ratio=2.77x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.328, Ratio=2.74x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.334, Ratio=2.71x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.334, Ratio=2.71x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.349, Ratio=2.78x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.76x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.335, Ratio=2.77x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.341, Ratio=2.78x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.332, Ratio=2.77x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.325, Ratio=2.76x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.316, Ratio=2.64x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.332, Ratio=2.73x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.69x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.346, Ratio=2.84x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.335, Ratio=2.78x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.334, Ratio=2.76x, Gap=-2.761
Batch 225/537: Loss=1.2127 (C:1.2127, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.320, Ratio=2.63x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.338, Ratio=2.78x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.81x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.317, Ratio=2.66x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.347, Ratio=2.84x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.66x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.352, Ratio=2.95x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.311, Ratio=2.57x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.344, Ratio=2.82x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.72x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.75x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.76x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.331, Ratio=2.69x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.324, Ratio=2.78x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.349, Ratio=2.88x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-3.035
Batch 250/537: Loss=1.2275 (C:1.2275, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.316, Ratio=2.53x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.338, Ratio=2.72x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.339, Ratio=2.75x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.324, Ratio=2.68x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.325, Ratio=2.71x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.342, Ratio=2.75x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.324, Ratio=2.68x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.334, Ratio=2.70x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.325, Ratio=2.65x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.328, Ratio=2.72x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.343, Ratio=2.96x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.315, Ratio=2.51x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.326, Ratio=2.64x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.337, Ratio=2.69x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.323, Ratio=2.70x, Gap=-2.892
Batch 275/537: Loss=1.2275 (C:1.2275, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.347, Ratio=2.86x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.328, Ratio=2.69x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.342, Ratio=2.89x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.343, Ratio=2.83x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.358, Ratio=3.02x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.338, Ratio=2.74x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.72x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.330, Ratio=2.72x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.338, Ratio=2.72x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.325, Ratio=2.73x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.76x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.320, Ratio=2.68x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.314, Ratio=2.60x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.329, Ratio=2.70x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.307, Ratio=2.60x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.359, Ratio=2.92x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.330, Ratio=2.77x, Gap=-2.771
Batch 300/537: Loss=1.2111 (C:1.2111, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.342, Ratio=2.88x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.82x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.334, Ratio=2.79x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.341, Ratio=2.82x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.321, Ratio=2.61x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.328, Ratio=2.74x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.336, Ratio=2.84x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.319, Ratio=2.69x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.348, Ratio=2.89x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.345, Ratio=2.89x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.341, Ratio=2.76x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.333, Ratio=2.76x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.93x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.310, Ratio=2.58x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.344, Ratio=2.76x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.64x, Gap=-3.363
Batch 325/537: Loss=1.2394 (C:1.2394, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.331, Ratio=2.78x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.352, Ratio=2.92x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.339, Ratio=2.77x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.86x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.352, Ratio=2.86x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.345, Ratio=2.93x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.323, Ratio=2.72x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.336, Ratio=2.84x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.324, Ratio=2.71x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.63x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.341, Ratio=2.75x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.325, Ratio=2.69x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.342, Ratio=2.76x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.332, Ratio=2.60x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.321, Ratio=2.66x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.323, Ratio=2.68x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.90x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.342, Ratio=2.71x, Gap=-2.913
Batch 350/537: Loss=1.2198 (C:1.2198, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.77x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.335, Ratio=2.79x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.350, Ratio=2.90x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.337, Ratio=2.74x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.318, Ratio=2.62x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.317, Ratio=2.68x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.340, Ratio=2.84x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.321, Ratio=2.69x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.317, Ratio=2.69x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.337, Ratio=2.74x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.73x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.316, Ratio=2.64x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.338, Ratio=2.81x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.313, Ratio=2.66x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.335, Ratio=2.77x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.329, Ratio=2.58x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.314, Ratio=2.57x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.57x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.348, Ratio=2.76x, Gap=-3.078
Batch 375/537: Loss=1.2048 (C:1.2048, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.336, Ratio=2.83x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.331, Ratio=2.80x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.327, Ratio=2.71x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.340, Ratio=2.92x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.58x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.332, Ratio=2.75x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.330, Ratio=2.69x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.345, Ratio=2.79x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.336, Ratio=2.72x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.65x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.319, Ratio=2.53x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.320, Ratio=2.75x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.339, Ratio=2.84x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.365, Ratio=3.08x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.327, Ratio=2.77x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.351, Ratio=2.86x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.354, Ratio=2.74x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-3.106
Batch 400/537: Loss=1.2080 (C:1.2080, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.321, Ratio=2.69x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.342, Ratio=2.84x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.315, Ratio=2.68x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.337, Ratio=2.84x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.75x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.335, Ratio=2.58x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.355, Ratio=2.84x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.80x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.332, Ratio=2.89x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.330, Ratio=2.68x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.351, Ratio=2.85x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.61x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.318, Ratio=2.60x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.331, Ratio=2.70x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.354, Ratio=2.83x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.863
Batch 425/537: Loss=1.1982 (C:1.1982, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.86x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.335, Ratio=2.64x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.326, Ratio=2.64x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.341, Ratio=2.71x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.321, Ratio=2.73x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.64x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.332, Ratio=2.78x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.321, Ratio=2.69x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.354, Ratio=2.85x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.340, Ratio=2.86x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.309, Ratio=2.54x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.326, Ratio=2.82x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.340, Ratio=2.68x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.341, Ratio=2.80x, Gap=-2.660
Batch 450/537: Loss=1.2024 (C:1.2024, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.355, Ratio=2.88x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.328, Ratio=2.60x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.341, Ratio=2.76x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.335, Ratio=2.79x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.328, Ratio=2.70x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.331, Ratio=2.72x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.319, Ratio=2.62x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.316, Ratio=2.64x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.345, Ratio=3.01x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.315, Ratio=2.64x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.367, Ratio=3.01x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.341, Ratio=2.69x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.347, Ratio=2.80x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.327, Ratio=2.70x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.70x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.337, Ratio=2.78x, Gap=-3.043
Batch 475/537: Loss=1.2089 (C:1.2089, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.357, Ratio=2.83x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.339, Ratio=2.77x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.76x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.333, Ratio=2.68x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.335, Ratio=2.78x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.329, Ratio=2.70x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.83x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.77x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.319, Ratio=2.67x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.333, Ratio=2.79x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.332, Ratio=2.84x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.327, Ratio=2.66x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.332, Ratio=2.68x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.332, Ratio=2.59x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.317, Ratio=2.51x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.66x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.319, Ratio=2.69x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.327, Ratio=2.71x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.308, Ratio=2.59x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.327, Ratio=2.85x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.325, Ratio=2.72x, Gap=-2.801
Batch 500/537: Loss=1.2176 (C:1.2176, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.315, Ratio=2.63x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.77x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.64x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.347, Ratio=2.72x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.342, Ratio=2.76x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.322, Ratio=2.69x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.333, Ratio=2.78x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.340, Ratio=2.71x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.325, Ratio=2.74x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.329, Ratio=2.75x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.340, Ratio=2.80x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.320, Ratio=2.67x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.60x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.85x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.338, Ratio=2.78x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.339, Ratio=2.69x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.322, Ratio=2.71x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.83x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.328, Ratio=2.77x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.348, Ratio=2.83x, Gap=-2.898
Batch 525/537: Loss=1.1966 (C:1.1966, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.312, Ratio=2.55x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.345, Ratio=2.75x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.324, Ratio=2.59x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.331, Ratio=2.77x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.323, Ratio=2.54x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.63x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.356, Ratio=2.88x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.348, Ratio=2.77x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.331, Ratio=2.72x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.353, Ratio=2.88x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.352, Ratio=2.93x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.87x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.325, Ratio=2.67x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.363, Ratio=2.97x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.351, Ratio=2.96x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.354, Ratio=3.03x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.338, Ratio=2.82x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.351, Ratio=3.00x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.339, Ratio=2.86x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.345, Ratio=2.87x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.353, Ratio=3.07x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.329, Ratio=2.76x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.336, Ratio=2.87x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.338, Ratio=2.89x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.352, Ratio=2.93x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.84x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.323, Ratio=2.71x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.351, Ratio=2.98x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.331, Ratio=2.85x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.351, Ratio=3.02x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.337, Ratio=2.81x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.332, Ratio=2.77x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.344, Ratio=2.91x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.332, Ratio=2.76x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.345, Ratio=3.00x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.341, Ratio=2.91x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.337, Ratio=2.77x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.352, Ratio=3.11x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.347, Ratio=2.95x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.329, Ratio=2.77x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.355, Ratio=2.97x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.86x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.326, Ratio=2.75x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.358, Ratio=3.02x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.344, Ratio=2.86x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.352, Ratio=2.90x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.333, Ratio=2.77x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.348, Ratio=2.93x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.344, Ratio=2.91x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.353, Ratio=3.01x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.352, Ratio=2.91x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.321, Ratio=2.65x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.337, Ratio=2.77x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.356, Ratio=2.96x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.352, Ratio=3.00x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.82x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.356, Ratio=3.02x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.333, Ratio=2.82x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.365, Ratio=3.20x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.338, Ratio=2.84x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.342, Ratio=2.81x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.342, Ratio=3.01x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.326, Ratio=2.80x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.326, Ratio=2.84x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.324, Ratio=2.70x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.358, Ratio=2.88x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.341, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.78x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.357, Ratio=3.07x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.357, Ratio=3.03x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.330, Ratio=2.88x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.358, Ratio=3.09x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.336, Ratio=2.82x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.338, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.333, Ratio=2.78x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.351, Ratio=2.91x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.340, Ratio=2.90x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.348, Ratio=3.02x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.347, Ratio=2.84x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.331, Ratio=2.74x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.351, Ratio=2.91x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.342, Ratio=2.99x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.357, Ratio=3.03x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.345, Ratio=2.87x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.341, Ratio=2.78x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.344, Ratio=2.94x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.345, Ratio=3.02x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.332, Ratio=2.88x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.347, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.344, Ratio=2.94x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.351, Ratio=2.94x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.348, Ratio=2.92x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.347, Ratio=3.00x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.354, Ratio=2.96x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.85x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.346, Ratio=2.92x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.340, Ratio=2.81x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.86x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.329, Ratio=2.78x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.349, Ratio=3.00x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.359, Ratio=3.03x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.92x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.327, Ratio=2.75x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.86x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.91x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.359, Ratio=3.02x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.337, Ratio=2.83x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.341, Ratio=2.91x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.351, Ratio=2.97x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.341, Ratio=2.83x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.358, Ratio=3.00x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.354, Ratio=3.03x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.348, Ratio=3.00x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.351, Ratio=2.87x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.357, Ratio=2.99x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.342, Ratio=2.96x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.340, Ratio=2.88x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.357, Ratio=3.08x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.341, Ratio=2.85x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.327, Ratio=2.72x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.353, Ratio=3.06x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.330, Ratio=2.82x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.343, Ratio=2.96x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.330, Ratio=2.72x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.337, Ratio=2.95x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.330, Ratio=2.94x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.71x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.336, Ratio=2.94x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.318, Ratio=2.74x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.347, Ratio=2.93x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.333, Ratio=2.79x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.344, Ratio=2.93x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.333, Ratio=2.76x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.329, Ratio=2.79x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.352, Ratio=3.04x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.344, Ratio=2.95x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.353, Ratio=2.92x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.329, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.368, Ratio=3.10x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.338, Ratio=2.92x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.335, Ratio=2.82x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.336, Ratio=2.87x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.353, Ratio=2.89x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.350, Ratio=2.97x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.344, Ratio=2.88x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.361, Ratio=3.02x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.338, Ratio=2.79x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.334, Ratio=2.79x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.335, Ratio=2.82x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.97x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.342, Ratio=2.92x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.343, Ratio=2.88x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.345, Ratio=2.94x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.356, Ratio=3.13x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.346, Ratio=3.00x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.355, Ratio=2.88x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.361, Ratio=3.05x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.343, Ratio=2.85x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.91x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.88x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.90x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.352, Ratio=2.93x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.343, Ratio=2.90x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.350, Ratio=2.93x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.353, Ratio=2.95x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.333, Ratio=2.80x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.332, Ratio=2.92x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.327, Ratio=2.82x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.341, Ratio=2.83x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.343, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.357, Ratio=3.01x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.350, Ratio=2.94x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.329, Ratio=2.74x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.360, Ratio=3.04x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.336, Ratio=2.87x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.336, Ratio=2.87x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.90x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.335, Ratio=2.88x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.344, Ratio=2.88x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.347, Ratio=2.85x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.350, Ratio=2.91x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.92x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.340, Ratio=2.98x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.370, Ratio=3.08x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.92x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.340, Ratio=2.78x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.333, Ratio=2.80x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.350, Ratio=2.95x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.351, Ratio=2.99x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.335, Ratio=2.83x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.343, Ratio=2.85x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.339, Ratio=2.89x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.345, Ratio=2.89x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.371, Ratio=3.24x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.90x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.355, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.347, Ratio=3.00x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.338, Ratio=2.74x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.75x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.90x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.346, Ratio=2.99x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.98x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.331, Ratio=2.79x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.346, Ratio=3.00x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.358, Ratio=3.01x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.346, Ratio=2.97x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.338, Ratio=2.85x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.335, Ratio=2.85x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.343, Ratio=2.94x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.344, Ratio=2.84x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.90x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.74x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.355, Ratio=2.96x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.351, Ratio=2.92x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.336, Ratio=2.78x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.339, Ratio=2.80x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.92x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.347, Ratio=2.95x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.334, Ratio=2.85x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.354, Ratio=3.06x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.89x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.336, Ratio=2.74x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.344, Ratio=2.96x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.340, Ratio=2.81x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.351, Ratio=2.97x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.360, Ratio=3.03x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.329, Ratio=2.73x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.357, Ratio=3.01x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.339, Ratio=2.90x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.322, Ratio=2.90x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.341, Ratio=2.91x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.337, Ratio=2.84x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.335, Ratio=2.80x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.351, Ratio=3.04x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.350, Ratio=2.94x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.340, Ratio=2.91x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.338, Ratio=2.80x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.340, Ratio=2.88x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.355, Ratio=3.15x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.321, Ratio=2.68x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.348, Ratio=2.86x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.359, Ratio=2.96x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.344, Ratio=2.96x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.350, Ratio=2.90x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.334, Ratio=2.81x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.343, Ratio=2.91x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.346, Ratio=2.95x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.330, Ratio=2.84x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.329, Ratio=2.81x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.340, Ratio=2.87x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.338, Ratio=2.82x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.353, Ratio=2.89x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.339, Ratio=2.96x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.353, Ratio=3.02x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.356, Ratio=3.07x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.346, Ratio=3.03x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.336, Ratio=2.79x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.327, Ratio=2.79x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.79x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.340, Ratio=3.03x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.332, Ratio=2.82x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.76x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.327, Ratio=2.81x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.344, Ratio=2.95x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.343, Ratio=2.83x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.336, Ratio=2.85x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.330, Ratio=2.76x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.83x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.352, Ratio=3.12x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.359, Ratio=3.04x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.344, Ratio=2.83x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.341, Ratio=2.91x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.362, Ratio=3.13x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.347, Ratio=2.96x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.340, Ratio=2.86x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.348, Ratio=2.92x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.346, Ratio=2.95x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.366, Ratio=3.00x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.325, Ratio=2.78x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.349, Ratio=2.99x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.343, Ratio=2.98x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.371, Ratio=3.13x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.358, Ratio=3.17x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.327, Ratio=2.76x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.341, Ratio=2.83x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.338, Ratio=2.94x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.350, Ratio=2.98x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.337, Ratio=2.88x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.343, Ratio=2.95x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.326, Ratio=2.69x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.343, Ratio=2.86x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.331, Ratio=2.87x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.328, Ratio=2.84x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.359, Ratio=3.08x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.361, Ratio=3.00x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.346, Ratio=2.87x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.351, Ratio=3.03x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.356, Ratio=2.94x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.324, Ratio=2.79x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.343, Ratio=2.82x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.338, Ratio=2.81x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.353, Ratio=2.96x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.347, Ratio=2.97x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.353, Ratio=2.99x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.342, Ratio=2.92x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.350, Ratio=2.87x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.318, Ratio=2.71x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.334, Ratio=2.77x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.364, Ratio=3.12x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.91x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.343, Ratio=2.91x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.74x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.354, Ratio=3.02x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.362, Ratio=3.17x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.346, Ratio=2.98x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.86x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.340, Ratio=2.86x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.346, Ratio=2.93x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.337, Ratio=2.81x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.344, Ratio=2.95x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.87x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.01x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.330, Ratio=2.80x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.330, Ratio=2.76x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.348, Ratio=2.89x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.345, Ratio=2.90x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.349, Ratio=2.93x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.357, Ratio=2.94x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.332, Ratio=2.96x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.371, Ratio=3.19x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.328, Ratio=2.90x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.346, Ratio=2.93x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.348, Ratio=2.89x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.337, Ratio=2.83x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.363, Ratio=3.03x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.354, Ratio=3.02x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.335, Ratio=2.81x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.330, Ratio=2.75x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.340, Ratio=2.92x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.331, Ratio=2.74x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.356, Ratio=2.98x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.340, Ratio=2.83x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.87x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.321, Ratio=2.76x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.339, Ratio=2.88x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.354, Ratio=3.01x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.344, Ratio=2.89x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.331, Ratio=2.79x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.353, Ratio=2.97x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.342, Ratio=2.90x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.352, Ratio=2.94x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.342, Ratio=2.95x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.327, Ratio=2.76x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.346, Ratio=2.91x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.355, Ratio=2.95x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.343, Ratio=2.83x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.82x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.340, Ratio=2.92x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.339, Ratio=2.86x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.347, Ratio=2.88x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.368, Ratio=3.10x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.68x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.355, Ratio=2.89x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.342, Ratio=2.98x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.345, Ratio=3.02x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.95x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.345, Ratio=2.91x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.338, Ratio=2.92x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.354, Ratio=2.95x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.321, Ratio=2.78x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.83x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.330, Ratio=2.82x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.328, Ratio=2.83x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.325, Ratio=2.67x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.338, Ratio=2.98x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.336, Ratio=2.82x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.349, Ratio=3.01x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.341, Ratio=2.94x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.94x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.348, Ratio=2.96x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.339, Ratio=2.86x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.342, Ratio=2.87x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.328, Ratio=2.75x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.359, Ratio=3.14x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.349, Ratio=2.96x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.343, Ratio=2.96x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.354, Ratio=2.91x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.346, Ratio=2.96x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.77x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.353, Ratio=2.93x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.348, Ratio=3.00x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.330, Ratio=2.87x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.98x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.330, Ratio=2.85x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.353, Ratio=3.04x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.80x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.338, Ratio=2.86x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.319, Ratio=2.75x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.352, Ratio=2.93x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.354, Ratio=2.99x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.338, Ratio=2.86x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.354, Ratio=2.98x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.349, Ratio=3.08x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.87x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.338, Ratio=3.01x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.341, Ratio=2.86x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.332, Ratio=2.80x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.345, Ratio=2.89x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.363, Ratio=3.02x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.349, Ratio=2.96x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.350, Ratio=2.80x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.352, Ratio=2.93x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.352, Ratio=3.00x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.344, Ratio=2.84x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.358, Ratio=2.97x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.338, Ratio=2.91x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.89x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.351, Ratio=2.97x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.353, Ratio=3.03x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.350, Ratio=2.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.84x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.348, Ratio=2.96x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.335, Ratio=2.85x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.89x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.359, Ratio=3.04x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.321, Ratio=2.74x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.335, Ratio=2.88x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.332, Ratio=2.77x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.343, Ratio=2.86x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.365, Ratio=3.12x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.346, Ratio=2.94x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.85x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.339, Ratio=2.88x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.334, Ratio=2.77x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.77x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.353, Ratio=3.02x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.349, Ratio=2.90x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.328, Ratio=2.81x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.342, Ratio=2.88x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.363, Ratio=3.09x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.353, Ratio=2.95x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.341, Ratio=2.87x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.334, Ratio=2.72x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.337, Ratio=2.89x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.344, Ratio=2.85x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.338, Ratio=2.83x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.324, Ratio=2.73x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.336, Ratio=2.75x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.344, Ratio=2.97x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.343, Ratio=2.93x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.349, Ratio=2.87x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.322, Ratio=2.73x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.345, Ratio=2.91x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.367, Ratio=3.00x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.336, Ratio=2.78x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.357, Ratio=2.97x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.347, Ratio=2.85x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.344, Ratio=2.88x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.336, Ratio=2.86x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=2.99x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.363, Ratio=3.05x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.335, Ratio=2.93x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.352, Ratio=2.94x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.353, Ratio=2.96x, Gap=-2.570

============================================================
Epoch 15/20 completed in 29.7s
Train: Loss=1.2146 (C:1.2146, R:0.0018) Ratio=2.62x
Val:   Loss=1.1848 (C:1.1848, R:0.0018) Ratio=2.97x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1848)
Checkpoint saved at epoch 15
============================================================

🌍 Updating global dataset at epoch 16
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.477 ± 0.651
    Neg distances: 1.346 ± 0.860
    Separation ratio: 2.83x
    Gap: -2.762
    ✅ Good global separation

Epoch 16 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-3.104
Batch   0/537: Loss=1.2286 (C:1.2286, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.335, Ratio=2.75x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.332, Ratio=2.74x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.335, Ratio=2.62x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.335, Ratio=2.61x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.344, Ratio=2.62x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.365, Ratio=2.78x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.78x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.73x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.354, Ratio=2.79x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.74x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.76x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.370, Ratio=2.77x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.71x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.83x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.335, Ratio=2.80x, Gap=-3.158
Batch  25/537: Loss=1.2143 (C:1.2143, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.363, Ratio=2.90x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.77x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.357, Ratio=2.91x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.365, Ratio=2.77x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.91x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.370, Ratio=2.99x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.335, Ratio=2.56x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.58x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.359, Ratio=2.81x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.330, Ratio=2.70x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.91x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.376, Ratio=2.89x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.369, Ratio=2.93x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.83x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.71x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.333, Ratio=2.61x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.76x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.356, Ratio=2.75x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.78x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.338, Ratio=2.73x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.352, Ratio=2.74x, Gap=-3.041
Batch  50/537: Loss=1.2183 (C:1.2183, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.369, Ratio=2.87x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.367, Ratio=2.82x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.347, Ratio=2.71x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.382, Ratio=2.91x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.79x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.363, Ratio=2.83x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.363, Ratio=2.74x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.379, Ratio=3.01x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.382, Ratio=3.00x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.362, Ratio=2.85x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.334, Ratio=2.78x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.331, Ratio=2.70x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.311, Ratio=2.55x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.351, Ratio=2.91x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.74x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.325, Ratio=2.57x, Gap=-3.145
Batch  75/537: Loss=1.2618 (C:1.2618, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.71x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.358, Ratio=2.78x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.364, Ratio=2.80x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.71x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.362, Ratio=2.76x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.73x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.350, Ratio=2.70x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.342, Ratio=2.63x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.342, Ratio=2.66x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.336, Ratio=2.65x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.342, Ratio=2.70x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.350, Ratio=2.76x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.82x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.353, Ratio=2.66x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.88x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.339, Ratio=2.65x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.78x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.359, Ratio=2.81x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.341, Ratio=2.79x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.370, Ratio=2.93x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.356, Ratio=2.83x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.353, Ratio=2.72x, Gap=-2.853
Batch 100/537: Loss=1.2207 (C:1.2207, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.82x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.356, Ratio=2.75x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.367, Ratio=2.93x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.68x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.324, Ratio=2.60x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.349, Ratio=2.61x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.348, Ratio=2.75x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.338, Ratio=2.55x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.74x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.355, Ratio=2.82x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.350, Ratio=2.69x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.75x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.344, Ratio=2.67x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.361, Ratio=2.84x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.65x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.365, Ratio=2.82x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.347, Ratio=2.72x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.349, Ratio=2.61x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.344, Ratio=2.54x, Gap=-3.092
Batch 125/537: Loss=1.2633 (C:1.2633, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.359, Ratio=2.85x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.78x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.86x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.348, Ratio=2.68x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.334, Ratio=2.59x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.345, Ratio=2.66x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.349, Ratio=2.61x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.339, Ratio=2.65x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.357, Ratio=2.83x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.363, Ratio=2.79x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.358, Ratio=2.79x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.358, Ratio=2.83x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.347, Ratio=2.75x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.349, Ratio=2.74x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.341, Ratio=2.83x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.349, Ratio=2.78x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.59x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.335, Ratio=2.72x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.336, Ratio=2.66x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.89x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.78x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.82x, Gap=-2.801
Batch 150/537: Loss=1.2022 (C:1.2022, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.345, Ratio=2.69x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.82x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.340, Ratio=2.62x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.344, Ratio=2.68x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.342, Ratio=2.55x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.69x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.355, Ratio=2.70x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.356, Ratio=2.74x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.74x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.345, Ratio=2.82x, Gap=-2.961
Batch 175/537: Loss=1.2114 (C:1.2114, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.359, Ratio=2.76x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.361, Ratio=2.71x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.356, Ratio=2.81x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.354, Ratio=2.76x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.370, Ratio=2.90x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.335, Ratio=2.74x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.359, Ratio=2.76x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.56x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.356, Ratio=2.69x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.364, Ratio=2.77x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.358, Ratio=2.80x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.351, Ratio=2.68x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.363, Ratio=2.80x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.74x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.376, Ratio=2.88x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.334, Ratio=2.65x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.904
Batch 200/537: Loss=1.2168 (C:1.2168, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.76x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.78x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.350, Ratio=2.72x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.326, Ratio=2.58x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.371, Ratio=2.88x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.62x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.352, Ratio=2.69x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.347, Ratio=2.71x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.330, Ratio=2.78x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.377, Ratio=3.04x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.70x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.347, Ratio=2.73x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.76x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.83x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.58x, Gap=-2.902
Batch 225/537: Loss=1.2538 (C:1.2538, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.74x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.331, Ratio=2.62x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.63x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.340, Ratio=2.64x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.340, Ratio=2.67x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.353, Ratio=2.80x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.355, Ratio=2.73x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.366, Ratio=2.82x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.345, Ratio=2.67x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.354, Ratio=2.73x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.344, Ratio=2.65x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.343, Ratio=2.57x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.360, Ratio=2.84x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.366, Ratio=2.88x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.357, Ratio=2.74x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.342, Ratio=2.76x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.350, Ratio=2.63x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.352, Ratio=2.74x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.352, Ratio=2.74x, Gap=-2.830
Batch 250/537: Loss=1.2146 (C:1.2146, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.340, Ratio=2.71x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.350, Ratio=2.76x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.358, Ratio=2.77x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.358, Ratio=2.78x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.350, Ratio=2.77x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.84x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.350, Ratio=2.79x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.366, Ratio=2.72x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.346, Ratio=2.68x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.367, Ratio=2.89x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.74x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.367, Ratio=2.87x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.339, Ratio=2.81x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.361, Ratio=2.95x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.76x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.341, Ratio=2.74x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.347, Ratio=2.62x, Gap=-2.967
Batch 275/537: Loss=1.2442 (C:1.2442, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.340, Ratio=2.66x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.361, Ratio=2.72x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.75x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.67x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.348, Ratio=2.97x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.359, Ratio=2.81x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.72x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.350, Ratio=2.92x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.72x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.339, Ratio=2.65x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.331, Ratio=2.60x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.67x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.352, Ratio=2.72x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.69x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.934
Batch 300/537: Loss=1.2108 (C:1.2108, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.356, Ratio=2.83x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.358, Ratio=2.85x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.337, Ratio=2.61x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.366, Ratio=2.82x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.68x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.77x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.356, Ratio=2.76x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.75x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.354, Ratio=2.78x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.369, Ratio=2.85x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.322, Ratio=2.47x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.348, Ratio=2.72x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.356, Ratio=2.73x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.379, Ratio=3.02x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.64x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.331, Ratio=2.68x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.356, Ratio=2.80x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.78x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.348, Ratio=2.71x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.354, Ratio=2.67x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.362, Ratio=2.74x, Gap=-3.078
Batch 325/537: Loss=1.2163 (C:1.2163, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.341, Ratio=2.62x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.353, Ratio=2.66x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.83x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.370, Ratio=2.82x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.351, Ratio=2.73x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.336, Ratio=2.62x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.351, Ratio=2.71x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.79x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.73x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.350, Ratio=2.94x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.339, Ratio=2.67x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.76x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.339, Ratio=2.80x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.357, Ratio=2.87x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.78x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.58x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.357, Ratio=2.67x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.334, Ratio=2.62x, Gap=-2.843
Batch 350/537: Loss=1.2475 (C:1.2475, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.345, Ratio=2.67x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.81x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.334, Ratio=2.75x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.383, Ratio=2.86x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.363, Ratio=2.84x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.319, Ratio=2.49x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.360, Ratio=2.82x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.355, Ratio=2.71x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.337, Ratio=2.65x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.367, Ratio=2.77x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.361, Ratio=2.82x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.347, Ratio=2.65x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.333, Ratio=2.60x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.74x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.342, Ratio=2.75x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.346, Ratio=2.79x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.80x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.362, Ratio=2.82x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.70x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.344, Ratio=2.67x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.351, Ratio=2.78x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.354, Ratio=2.72x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.351, Ratio=2.66x, Gap=-2.899
Batch 375/537: Loss=1.2397 (C:1.2397, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.372, Ratio=2.79x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.352, Ratio=2.81x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.327, Ratio=2.69x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.347, Ratio=2.76x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.344, Ratio=2.89x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.346, Ratio=2.58x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.370, Ratio=2.80x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.339, Ratio=2.54x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.372, Ratio=2.84x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.357, Ratio=2.72x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.373, Ratio=2.84x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.362, Ratio=2.85x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.340, Ratio=2.59x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.337, Ratio=2.80x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.334, Ratio=2.68x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.348, Ratio=2.63x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.355, Ratio=2.75x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.341, Ratio=2.56x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.349, Ratio=2.64x, Gap=-2.911
Batch 400/537: Loss=1.2357 (C:1.2357, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.372, Ratio=2.96x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.340, Ratio=2.67x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.360, Ratio=2.75x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.85x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.374, Ratio=2.91x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.81x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.341, Ratio=2.63x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.69x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.355, Ratio=2.82x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.66x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.367, Ratio=2.94x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.331, Ratio=2.77x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.358, Ratio=2.83x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.73x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.359, Ratio=2.74x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.66x, Gap=-3.113
Batch 425/537: Loss=1.2380 (C:1.2380, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.370, Ratio=2.92x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.67x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.351, Ratio=2.73x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.349, Ratio=2.74x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.335, Ratio=2.64x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.346, Ratio=2.61x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.74x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.355, Ratio=2.77x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.366, Ratio=2.81x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.365, Ratio=2.81x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.367, Ratio=2.87x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.369, Ratio=2.85x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.77x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.353, Ratio=2.65x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.343, Ratio=2.72x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.325, Ratio=2.57x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.350, Ratio=2.88x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.346, Ratio=2.70x, Gap=-2.928
Batch 450/537: Loss=1.2260 (C:1.2260, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.316, Ratio=2.56x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.336, Ratio=2.71x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.344, Ratio=2.79x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.90x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.378, Ratio=2.89x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.348, Ratio=2.68x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.345, Ratio=2.61x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.355, Ratio=2.71x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.78x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.345, Ratio=2.63x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.347, Ratio=2.75x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.373, Ratio=2.89x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.328, Ratio=2.58x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.353, Ratio=2.78x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.339, Ratio=2.68x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.340, Ratio=2.68x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.359, Ratio=2.84x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.359, Ratio=2.78x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.362, Ratio=2.75x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.342, Ratio=2.70x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.69x, Gap=-3.092
Batch 475/537: Loss=1.2335 (C:1.2335, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.345, Ratio=2.75x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.333, Ratio=2.67x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.76x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.87x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.359, Ratio=2.81x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.368, Ratio=2.80x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.356, Ratio=2.76x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.64x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.345, Ratio=2.68x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.358, Ratio=2.84x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.343, Ratio=2.63x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.354, Ratio=2.66x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.318, Ratio=2.60x, Gap=-3.171
Batch 500/537: Loss=1.2627 (C:1.2627, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.357, Ratio=2.82x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.340, Ratio=2.59x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.350, Ratio=2.79x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.357, Ratio=2.80x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.351, Ratio=2.79x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.68x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.361, Ratio=2.73x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.370, Ratio=2.79x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.345, Ratio=2.68x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.359, Ratio=2.73x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.354, Ratio=2.69x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.371, Ratio=2.83x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.348, Ratio=2.67x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.361, Ratio=2.84x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.355, Ratio=2.96x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.78x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.347, Ratio=2.67x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.346, Ratio=2.76x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.360, Ratio=2.78x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.358, Ratio=2.75x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.351, Ratio=2.72x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-3.158
Batch 525/537: Loss=1.2157 (C:1.2157, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.363, Ratio=2.89x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.350, Ratio=2.82x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.325, Ratio=2.58x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.74x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.74x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.342, Ratio=2.68x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.79x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.337, Ratio=2.67x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.99x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.367, Ratio=3.04x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.357, Ratio=2.97x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.369, Ratio=2.91x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.351, Ratio=2.96x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.357, Ratio=2.87x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.368, Ratio=3.13x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.370, Ratio=2.99x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.86x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.365, Ratio=2.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.383, Ratio=3.03x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.367, Ratio=2.86x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.368, Ratio=2.93x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.349, Ratio=2.78x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.355, Ratio=3.06x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.94x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.371, Ratio=3.06x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.364, Ratio=3.02x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.350, Ratio=2.92x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.81x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.83x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.350, Ratio=2.78x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.358, Ratio=2.84x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.355, Ratio=2.98x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.368, Ratio=2.89x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.84x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.379, Ratio=3.07x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.360, Ratio=3.01x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.351, Ratio=2.79x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.348, Ratio=3.06x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.86x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.355, Ratio=2.96x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.351, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.370, Ratio=2.94x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.379, Ratio=3.12x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.383, Ratio=3.06x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.00x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.374, Ratio=3.07x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.375, Ratio=3.09x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.355, Ratio=2.88x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.66x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.362, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.98x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.344, Ratio=2.76x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.351, Ratio=2.83x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.361, Ratio=2.88x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.367, Ratio=2.89x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.343, Ratio=2.73x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.93x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.350, Ratio=2.90x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.351, Ratio=2.78x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.363, Ratio=2.93x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.380, Ratio=3.13x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.359, Ratio=3.01x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.368, Ratio=2.88x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.357, Ratio=2.86x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.87x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.358, Ratio=2.91x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.338, Ratio=2.80x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.362, Ratio=2.79x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.360, Ratio=3.04x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.371, Ratio=3.14x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.75x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.83x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.363, Ratio=2.91x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.379, Ratio=3.13x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.85x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.344, Ratio=2.79x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.343, Ratio=2.80x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.89x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.370, Ratio=3.12x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.356, Ratio=3.09x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.359, Ratio=2.88x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.350, Ratio=2.92x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.382, Ratio=3.17x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.370, Ratio=2.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.376, Ratio=3.07x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.364, Ratio=3.02x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.367, Ratio=3.05x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.365, Ratio=2.94x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.375, Ratio=3.02x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.357, Ratio=2.76x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.364, Ratio=3.04x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.358, Ratio=2.87x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.372, Ratio=3.14x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.98x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.359, Ratio=2.96x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.373, Ratio=2.97x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.361, Ratio=3.04x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.91x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.348, Ratio=2.82x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.334, Ratio=2.72x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.349, Ratio=2.93x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.379, Ratio=3.03x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.03x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.368, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.77x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.04x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.368, Ratio=2.90x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.371, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.349, Ratio=2.89x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.358, Ratio=2.88x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.368, Ratio=3.02x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.346, Ratio=2.77x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.69x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.368, Ratio=3.00x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.375, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=3.00x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.334, Ratio=2.82x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.374, Ratio=3.05x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.354, Ratio=2.90x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.89x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.361, Ratio=2.87x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.381, Ratio=2.98x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.366, Ratio=2.99x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.342, Ratio=2.73x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.79x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.352, Ratio=2.86x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.341, Ratio=2.90x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.352, Ratio=2.74x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.364, Ratio=2.95x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.349, Ratio=2.82x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.80x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.89x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.87x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.02x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.82x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.362, Ratio=2.91x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.97x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.86x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.358, Ratio=2.84x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.342, Ratio=2.85x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.78x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.357, Ratio=2.97x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.368, Ratio=2.94x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.368, Ratio=3.09x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.361, Ratio=2.86x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.362, Ratio=2.97x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.78x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.369, Ratio=2.91x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.92x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.362, Ratio=2.86x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.380, Ratio=3.05x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.00x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.359, Ratio=2.83x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.354, Ratio=2.85x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.363, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.84x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.98x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.360, Ratio=2.86x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.357, Ratio=2.84x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.83x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.349, Ratio=2.91x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.89x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.364, Ratio=3.10x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.80x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.361, Ratio=2.81x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.352, Ratio=2.91x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.361, Ratio=2.99x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.372, Ratio=3.10x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.86x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.365, Ratio=2.91x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.368, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.339, Ratio=2.81x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.363, Ratio=2.94x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.347, Ratio=2.80x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.98x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.346, Ratio=2.85x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.338, Ratio=2.75x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.06x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.349, Ratio=2.92x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.352, Ratio=3.01x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.91x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.96x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.368, Ratio=3.05x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.357, Ratio=2.98x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.367, Ratio=2.96x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.93x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.93x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.353, Ratio=2.79x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.10x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.355, Ratio=2.95x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.368, Ratio=2.95x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.368, Ratio=3.04x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.74x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.358, Ratio=2.91x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.367, Ratio=2.96x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.353, Ratio=2.84x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.362, Ratio=2.85x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.00x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.98x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.354, Ratio=2.81x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.355, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.336, Ratio=2.82x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.363, Ratio=2.91x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.357, Ratio=2.84x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.346, Ratio=2.83x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.351, Ratio=2.88x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.372, Ratio=2.97x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.355, Ratio=2.95x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.352, Ratio=2.91x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.385, Ratio=3.06x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.375, Ratio=3.11x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.84x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.371, Ratio=3.09x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.362, Ratio=2.89x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.369, Ratio=2.90x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.346, Ratio=2.76x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.364, Ratio=2.85x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.356, Ratio=2.98x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.348, Ratio=2.87x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.356, Ratio=2.91x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.345, Ratio=2.91x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.360, Ratio=2.86x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.86x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.367, Ratio=3.08x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.374, Ratio=3.02x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.364, Ratio=2.85x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.71x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.84x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.362, Ratio=2.90x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.83x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.356, Ratio=2.79x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.372, Ratio=3.06x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.361, Ratio=2.93x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.351, Ratio=2.85x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.87x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.369, Ratio=3.06x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.365, Ratio=3.05x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.73x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.349, Ratio=2.83x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.369, Ratio=3.02x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.93x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.371, Ratio=3.03x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.352, Ratio=2.80x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.349, Ratio=2.88x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.377, Ratio=3.05x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.346, Ratio=2.83x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.361, Ratio=2.92x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.370, Ratio=3.08x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.354, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.359, Ratio=2.93x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.86x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.369, Ratio=2.95x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.343, Ratio=2.81x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.77x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.365, Ratio=2.93x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.364, Ratio=2.90x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.362, Ratio=2.85x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.351, Ratio=2.77x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.00x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.364, Ratio=2.81x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.375, Ratio=2.94x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.385, Ratio=3.19x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.362, Ratio=2.78x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.365, Ratio=2.97x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.337, Ratio=2.84x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.91x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.351, Ratio=2.97x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.372, Ratio=3.00x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.96x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.368, Ratio=3.09x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.359, Ratio=2.88x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.83x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.365, Ratio=3.09x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.05x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.378, Ratio=3.10x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.380, Ratio=3.06x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.344, Ratio=2.83x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.377, Ratio=2.96x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.364, Ratio=2.94x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.350, Ratio=2.82x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.372, Ratio=3.19x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.340, Ratio=2.96x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.357, Ratio=2.92x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.338, Ratio=2.84x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.361, Ratio=2.87x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.367, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.353, Ratio=2.90x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.383, Ratio=3.24x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.362, Ratio=2.90x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.367, Ratio=2.90x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.361, Ratio=2.87x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.372, Ratio=2.95x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.74x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.371, Ratio=2.94x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.363, Ratio=2.94x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.359, Ratio=2.85x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.91x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.83x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.373, Ratio=3.12x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.92x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.74x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.98x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.383, Ratio=3.08x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.86x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.364, Ratio=2.92x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.353, Ratio=2.83x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.84x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.353, Ratio=2.93x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.347, Ratio=2.88x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.358, Ratio=3.00x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.362, Ratio=2.90x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.96x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.354, Ratio=2.89x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.364, Ratio=2.93x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.365, Ratio=2.94x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.370, Ratio=2.93x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.342, Ratio=2.80x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.352, Ratio=2.93x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.378, Ratio=3.23x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.93x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.355, Ratio=2.80x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.76x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.371, Ratio=3.13x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.95x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.354, Ratio=2.73x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.81x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.346, Ratio=2.81x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.361, Ratio=2.87x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.345, Ratio=2.88x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.360, Ratio=2.86x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.90x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.86x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.361, Ratio=2.84x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.376, Ratio=3.06x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.355, Ratio=2.85x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.347, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.359, Ratio=2.83x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.347, Ratio=2.86x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.339, Ratio=2.89x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.335, Ratio=2.79x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.382, Ratio=3.11x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.374, Ratio=3.11x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.354, Ratio=2.85x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.84x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.94x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.353, Ratio=2.82x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.366, Ratio=2.85x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.88x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-2.649

============================================================
Epoch 16/20 completed in 35.3s
Train: Loss=1.2189 (C:1.2189, R:0.0018) Ratio=2.62x
Val:   Loss=1.1867 (C:1.1867, R:0.0018) Ratio=3.05x
Reconstruction weight: 0.000
No improvement for 1 epochs
============================================================

Epoch 17 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.368, Ratio=2.83x, Gap=-3.172
Batch   0/537: Loss=1.1981 (C:1.1981, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.374, Ratio=2.87x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.368, Ratio=2.82x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.362, Ratio=2.85x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.346, Ratio=2.63x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.351, Ratio=2.77x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.379, Ratio=2.96x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.354, Ratio=2.71x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.353, Ratio=2.76x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.331, Ratio=2.56x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.360, Ratio=2.79x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.347, Ratio=2.72x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.337, Ratio=2.67x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.365, Ratio=2.96x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.339, Ratio=2.64x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.356, Ratio=2.81x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.345, Ratio=2.70x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.78x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.356, Ratio=2.83x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.345, Ratio=2.72x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.344, Ratio=2.81x, Gap=-3.151
Batch  25/537: Loss=1.2088 (C:1.2088, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.361, Ratio=2.82x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.327, Ratio=2.61x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.83x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.67x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.367, Ratio=2.93x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.67x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.349, Ratio=2.77x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.82x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.329, Ratio=2.57x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.374, Ratio=2.87x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.355, Ratio=2.80x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.360, Ratio=2.70x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.67x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.81x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.345, Ratio=2.80x, Gap=-2.953
Batch  50/537: Loss=1.2145 (C:1.2145, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.349, Ratio=2.77x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.331, Ratio=2.73x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.348, Ratio=2.73x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.345, Ratio=2.79x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.355, Ratio=2.78x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.339, Ratio=2.50x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.362, Ratio=2.82x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.349, Ratio=2.67x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.371, Ratio=2.86x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.353, Ratio=2.79x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.82x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.359, Ratio=2.85x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.349, Ratio=2.64x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.358, Ratio=2.86x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.371, Ratio=2.96x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.354, Ratio=2.77x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.351, Ratio=2.72x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.351, Ratio=2.73x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.350, Ratio=2.70x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.341, Ratio=2.57x, Gap=-3.159
Batch  75/537: Loss=1.2614 (C:1.2614, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.370, Ratio=2.86x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.364, Ratio=2.93x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.71x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.342, Ratio=2.71x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.351, Ratio=2.86x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.78x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.351, Ratio=2.78x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.357, Ratio=2.74x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.89x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.352, Ratio=2.88x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.339, Ratio=2.60x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.333, Ratio=2.72x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.367, Ratio=2.87x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.361, Ratio=2.85x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.346, Ratio=2.69x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.355, Ratio=2.80x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.347, Ratio=2.67x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.361, Ratio=2.86x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.359, Ratio=2.87x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.373, Ratio=2.95x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.366, Ratio=2.91x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.359, Ratio=2.71x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.337, Ratio=2.80x, Gap=-3.201
Batch 100/537: Loss=1.2166 (C:1.2166, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.331, Ratio=2.67x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.324, Ratio=2.55x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.347, Ratio=2.69x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.329, Ratio=2.73x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.361, Ratio=2.85x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.332, Ratio=2.61x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.361, Ratio=2.83x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.362, Ratio=2.85x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.340, Ratio=2.75x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.342, Ratio=2.68x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.359, Ratio=2.74x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.361, Ratio=2.89x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.71x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.349, Ratio=2.74x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.353, Ratio=2.80x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.348, Ratio=2.71x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.344, Ratio=2.77x, Gap=-3.300
Batch 125/537: Loss=1.2162 (C:1.2162, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.368, Ratio=2.85x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.61x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.351, Ratio=2.87x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.66x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.380, Ratio=2.88x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.341, Ratio=2.77x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.374, Ratio=2.90x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.333, Ratio=2.61x, Gap=-3.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.70x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.362, Ratio=2.89x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.359, Ratio=2.84x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.361, Ratio=2.73x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.365, Ratio=2.83x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.362, Ratio=2.79x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.345, Ratio=2.65x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.374, Ratio=2.89x, Gap=-2.827
Batch 150/537: Loss=1.1824 (C:1.1824, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.347, Ratio=2.83x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.336, Ratio=2.68x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.76x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.77x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.73x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.332, Ratio=2.73x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.354, Ratio=2.69x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.373, Ratio=2.91x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.73x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.357, Ratio=2.73x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.64x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.346, Ratio=2.65x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.350, Ratio=2.79x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.368, Ratio=2.91x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.351, Ratio=2.74x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.359, Ratio=2.72x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.376, Ratio=3.00x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.348, Ratio=2.82x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.61x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.358, Ratio=2.76x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-2.980
Batch 175/537: Loss=1.1877 (C:1.1877, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.377, Ratio=2.96x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.363, Ratio=2.76x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.362, Ratio=2.86x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.83x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.70x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.350, Ratio=2.77x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.358, Ratio=2.85x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.345, Ratio=2.69x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.361, Ratio=2.79x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.362, Ratio=2.73x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.345, Ratio=2.67x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.364, Ratio=2.85x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.360, Ratio=2.84x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.360, Ratio=2.85x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.903
Batch 200/537: Loss=1.1885 (C:1.1885, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.355, Ratio=2.73x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.360, Ratio=2.91x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.343, Ratio=2.77x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.75x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.367, Ratio=2.86x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.353, Ratio=2.71x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.351, Ratio=2.66x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.380, Ratio=3.01x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.349, Ratio=2.65x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.77x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.358, Ratio=2.79x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.367, Ratio=2.94x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.346, Ratio=2.83x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.346, Ratio=2.80x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.330, Ratio=2.64x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.79x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.354, Ratio=2.74x, Gap=-3.251
Batch 225/537: Loss=1.2189 (C:1.2189, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.346, Ratio=2.74x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.358, Ratio=2.77x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.71x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.363, Ratio=2.74x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.87x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.346, Ratio=2.80x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.79x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.72x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.362, Ratio=2.81x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.327, Ratio=2.60x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.365, Ratio=2.80x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.01x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.358, Ratio=2.82x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.340, Ratio=2.61x, Gap=-2.830
Batch 250/537: Loss=1.2484 (C:1.2484, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.79x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.319, Ratio=2.68x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.76x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.346, Ratio=2.66x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.352, Ratio=2.71x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.370, Ratio=2.86x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.373, Ratio=2.88x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.351, Ratio=2.73x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.369, Ratio=2.94x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.350, Ratio=2.83x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.365, Ratio=2.78x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.358, Ratio=2.79x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.358, Ratio=2.84x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.348, Ratio=2.73x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.370, Ratio=2.78x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.74x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.82x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.342, Ratio=2.70x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.360, Ratio=2.76x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.76x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-3.106
Batch 275/537: Loss=1.2286 (C:1.2286, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.342, Ratio=2.79x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.357, Ratio=2.67x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.362, Ratio=2.70x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.355, Ratio=2.79x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.358, Ratio=2.79x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.345, Ratio=2.65x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.336, Ratio=2.63x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.330, Ratio=2.68x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.342, Ratio=2.73x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.344, Ratio=2.70x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.359, Ratio=2.81x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.364, Ratio=2.84x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.72x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.342, Ratio=2.66x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.351, Ratio=2.73x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.74x, Gap=-2.944
Batch 300/537: Loss=1.2199 (C:1.2199, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.346, Ratio=2.80x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.345, Ratio=2.61x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.77x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.342, Ratio=2.66x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.361, Ratio=2.77x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.375, Ratio=2.94x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.66x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.362, Ratio=2.83x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.328, Ratio=2.57x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.367, Ratio=3.01x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.359, Ratio=2.79x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.80x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.335, Ratio=2.63x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.365, Ratio=2.76x, Gap=-2.939
Batch 325/537: Loss=1.2088 (C:1.2088, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.357, Ratio=2.84x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.365, Ratio=2.82x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.371, Ratio=2.93x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.360, Ratio=2.80x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.347, Ratio=2.64x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.77x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.363, Ratio=2.75x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.355, Ratio=2.84x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.335, Ratio=2.64x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.332, Ratio=2.72x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.354, Ratio=2.82x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.75x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.340, Ratio=2.69x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.367, Ratio=2.88x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.359, Ratio=2.83x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.366, Ratio=2.78x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.337, Ratio=2.59x, Gap=-2.988
Batch 350/537: Loss=1.2566 (C:1.2566, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.74x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.328, Ratio=2.51x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.05x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.343, Ratio=2.75x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.342, Ratio=2.67x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.343, Ratio=2.61x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.355, Ratio=2.74x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.362, Ratio=2.73x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.343, Ratio=2.69x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.368, Ratio=2.92x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.355, Ratio=2.81x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.362, Ratio=2.79x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.373, Ratio=2.87x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.348, Ratio=2.68x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.82x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.69x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.346, Ratio=2.71x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.368, Ratio=2.90x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.355, Ratio=2.76x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.332, Ratio=2.61x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.388, Ratio=2.98x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.963
Batch 375/537: Loss=1.2335 (C:1.2335, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.340, Ratio=2.77x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.364, Ratio=2.88x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.73x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.332, Ratio=2.54x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.351, Ratio=2.73x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.360, Ratio=2.89x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.372, Ratio=2.88x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.358, Ratio=2.86x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.365, Ratio=2.86x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.87x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.356, Ratio=2.71x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.334, Ratio=2.55x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.373, Ratio=2.84x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.353, Ratio=2.72x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.345, Ratio=2.63x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.79x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.70x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.77x, Gap=-2.922
Batch 400/537: Loss=1.2195 (C:1.2195, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.347, Ratio=2.62x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.329, Ratio=2.56x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.359, Ratio=2.80x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.355, Ratio=2.72x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.74x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.341, Ratio=2.66x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.351, Ratio=2.83x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.64x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.76x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.351, Ratio=2.74x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.82x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.335, Ratio=2.60x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.346, Ratio=2.76x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.352, Ratio=2.67x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.363, Ratio=2.81x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.339, Ratio=2.64x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.80x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.339, Ratio=2.67x, Gap=-3.557
Batch 425/537: Loss=1.2377 (C:1.2377, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.350, Ratio=2.68x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.366, Ratio=2.81x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.350, Ratio=2.81x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.351, Ratio=2.70x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.83x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.355, Ratio=2.80x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.341, Ratio=2.57x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.315, Ratio=2.75x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.321, Ratio=2.66x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.340, Ratio=2.64x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.355, Ratio=2.69x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.69x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.372, Ratio=2.88x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.351, Ratio=2.78x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.78x, Gap=-2.950
Batch 450/537: Loss=1.2112 (C:1.2112, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.362, Ratio=2.86x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.336, Ratio=2.62x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.339, Ratio=2.58x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.364, Ratio=2.87x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.353, Ratio=2.74x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.343, Ratio=2.69x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.355, Ratio=2.67x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.365, Ratio=2.85x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.335, Ratio=2.63x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.364, Ratio=2.80x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.352, Ratio=2.75x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.361, Ratio=2.77x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.352, Ratio=2.73x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.351, Ratio=2.80x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.353, Ratio=2.67x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-3.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.354, Ratio=2.71x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.360, Ratio=2.74x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.347, Ratio=2.65x, Gap=-2.849
Batch 475/537: Loss=1.2342 (C:1.2342, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.354, Ratio=2.79x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.340, Ratio=2.77x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.350, Ratio=2.63x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.348, Ratio=2.69x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.363, Ratio=2.85x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.375, Ratio=2.88x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.341, Ratio=2.56x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.349, Ratio=2.87x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.87x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.83x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.336, Ratio=2.58x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.360, Ratio=2.79x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.375, Ratio=2.86x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.368, Ratio=2.82x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.62x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.352, Ratio=2.72x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.365, Ratio=2.93x, Gap=-2.932
Batch 500/537: Loss=1.1765 (C:1.1765, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.339, Ratio=2.67x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.77x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.358, Ratio=2.82x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.348, Ratio=2.71x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.342, Ratio=2.68x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.75x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.357, Ratio=2.80x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.337, Ratio=2.55x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.64x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.89x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.349, Ratio=2.74x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.351, Ratio=2.68x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.363, Ratio=2.89x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.342, Ratio=2.71x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.355, Ratio=2.74x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.357, Ratio=2.76x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.338, Ratio=2.60x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.67x, Gap=-2.978
Batch 525/537: Loss=1.2380 (C:1.2380, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.355, Ratio=2.79x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.74x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.72x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.83x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.352, Ratio=2.81x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.66x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.354, Ratio=2.81x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.340, Ratio=2.83x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.366, Ratio=3.07x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.346, Ratio=2.89x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.98x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.365, Ratio=2.92x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.344, Ratio=2.76x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.340, Ratio=2.85x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.352, Ratio=2.98x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.02x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.364, Ratio=2.99x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.381, Ratio=3.04x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.05x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.91x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.373, Ratio=3.09x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.381, Ratio=3.04x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.379, Ratio=3.06x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.365, Ratio=2.84x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.375, Ratio=3.00x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.371, Ratio=3.03x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.90x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.354, Ratio=2.92x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.368, Ratio=2.90x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.381, Ratio=3.12x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.359, Ratio=3.08x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.88x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.83x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.374, Ratio=3.07x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.87x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.368, Ratio=3.01x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.371, Ratio=3.03x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.344, Ratio=2.93x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.359, Ratio=3.00x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.361, Ratio=3.03x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.92x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.375, Ratio=3.20x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.361, Ratio=2.94x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.355, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.345, Ratio=2.95x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.96x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.381, Ratio=3.07x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.355, Ratio=3.09x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.356, Ratio=3.00x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.344, Ratio=2.76x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.358, Ratio=2.86x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.365, Ratio=2.95x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.375, Ratio=3.13x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.365, Ratio=2.91x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.06x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.71x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.371, Ratio=3.06x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.352, Ratio=2.82x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.347, Ratio=2.80x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.358, Ratio=2.96x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.355, Ratio=2.99x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.362, Ratio=3.07x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.98x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.364, Ratio=2.90x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.341, Ratio=2.81x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.349, Ratio=3.01x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.356, Ratio=2.89x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.362, Ratio=2.97x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.93x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.358, Ratio=2.93x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.360, Ratio=2.87x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.335, Ratio=2.80x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.368, Ratio=3.11x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.350, Ratio=2.93x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.349, Ratio=2.89x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.361, Ratio=3.03x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.79x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.347, Ratio=2.87x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.376, Ratio=3.01x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.366, Ratio=3.03x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.345, Ratio=2.88x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.369, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.353, Ratio=2.90x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.354, Ratio=2.80x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.366, Ratio=2.94x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.339, Ratio=2.88x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.354, Ratio=2.92x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.385, Ratio=3.14x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.83x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.363, Ratio=3.08x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.342, Ratio=2.84x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.350, Ratio=2.93x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.346, Ratio=2.82x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.349, Ratio=2.82x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.354, Ratio=2.88x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.359, Ratio=3.10x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.361, Ratio=2.98x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.94x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.342, Ratio=2.76x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.359, Ratio=2.88x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.95x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.340, Ratio=2.77x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.85x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.341, Ratio=2.78x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.355, Ratio=2.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.97x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.94x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.372, Ratio=2.97x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.351, Ratio=2.87x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.367, Ratio=3.06x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.345, Ratio=2.86x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.58x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.85x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.368, Ratio=2.91x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.367, Ratio=3.09x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.87x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.368, Ratio=2.99x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.358, Ratio=2.93x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.349, Ratio=2.86x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.366, Ratio=3.05x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.346, Ratio=2.93x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.345, Ratio=2.85x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.346, Ratio=2.99x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.364, Ratio=3.02x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.345, Ratio=2.85x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.358, Ratio=2.95x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.361, Ratio=3.03x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.359, Ratio=3.03x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.338, Ratio=2.61x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.363, Ratio=2.94x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.382, Ratio=3.20x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.97x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.353, Ratio=3.01x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.86x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.351, Ratio=2.93x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.365, Ratio=3.05x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.373, Ratio=2.96x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.10x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.358, Ratio=3.01x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.359, Ratio=2.83x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.350, Ratio=2.97x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.91x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.374, Ratio=3.18x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.348, Ratio=2.95x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.09x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.339, Ratio=2.81x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.365, Ratio=2.90x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.84x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.359, Ratio=3.05x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.334, Ratio=2.64x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.355, Ratio=2.93x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.353, Ratio=2.98x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.01x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.330, Ratio=2.74x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.336, Ratio=2.74x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.360, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.374, Ratio=3.03x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.88x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.358, Ratio=2.91x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.356, Ratio=2.90x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.93x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.342, Ratio=2.86x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.366, Ratio=3.02x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.95x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.354, Ratio=2.91x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.338, Ratio=2.80x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.354, Ratio=3.02x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.373, Ratio=2.96x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.356, Ratio=2.95x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.334, Ratio=2.85x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.99x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.346, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.370, Ratio=2.90x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.350, Ratio=2.95x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.358, Ratio=2.96x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.355, Ratio=2.88x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.380, Ratio=3.15x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.368, Ratio=3.00x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.94x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.365, Ratio=2.91x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.88x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.379, Ratio=3.07x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.336, Ratio=2.78x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.368, Ratio=3.02x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.357, Ratio=2.90x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.353, Ratio=2.93x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.358, Ratio=2.99x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.86x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.349, Ratio=2.89x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.04x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.369, Ratio=3.13x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.352, Ratio=2.87x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.87x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.346, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.354, Ratio=2.90x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.94x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.371, Ratio=3.06x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.373, Ratio=3.09x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.349, Ratio=2.93x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.363, Ratio=2.85x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.361, Ratio=2.87x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.357, Ratio=2.97x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.367, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.91x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.357, Ratio=2.97x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.365, Ratio=2.93x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.332, Ratio=2.79x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.351, Ratio=2.90x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.359, Ratio=2.86x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.352, Ratio=3.04x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.362, Ratio=2.99x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.344, Ratio=2.90x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.354, Ratio=2.92x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.373, Ratio=3.09x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.360, Ratio=3.06x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.84x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.05x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.99x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.346, Ratio=2.81x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.84x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.357, Ratio=3.03x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.365, Ratio=2.91x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.351, Ratio=2.75x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.373, Ratio=2.97x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.364, Ratio=2.92x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.92x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.351, Ratio=2.89x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.90x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.357, Ratio=2.85x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.370, Ratio=3.14x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.352, Ratio=3.01x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.355, Ratio=2.80x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.355, Ratio=3.14x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.348, Ratio=2.93x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.371, Ratio=3.01x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.336, Ratio=2.71x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.77x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.355, Ratio=2.88x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.95x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.94x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.361, Ratio=2.94x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.97x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.344, Ratio=2.85x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.386, Ratio=3.22x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.363, Ratio=2.88x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.365, Ratio=3.06x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.87x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.351, Ratio=2.87x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.358, Ratio=3.06x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.351, Ratio=2.89x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.381, Ratio=3.07x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.360, Ratio=2.87x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.10x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.90x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.92x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.372, Ratio=3.05x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.376, Ratio=3.15x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.359, Ratio=3.02x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.355, Ratio=2.85x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.351, Ratio=2.93x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.360, Ratio=2.89x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.354, Ratio=2.93x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.357, Ratio=2.91x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.374, Ratio=3.15x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.88x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.357, Ratio=3.03x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.349, Ratio=2.94x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.361, Ratio=3.12x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.346, Ratio=2.82x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.98x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.01x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.354, Ratio=2.84x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.365, Ratio=3.08x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.06x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.349, Ratio=2.87x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.351, Ratio=2.79x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.344, Ratio=2.86x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.93x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.336, Ratio=2.79x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.358, Ratio=3.11x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.352, Ratio=3.03x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.373, Ratio=2.94x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.362, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.358, Ratio=3.05x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.01x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.352, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.343, Ratio=2.80x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.334, Ratio=2.83x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.370, Ratio=3.09x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.345, Ratio=3.01x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.357, Ratio=2.96x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.86x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.374, Ratio=3.03x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.352, Ratio=2.92x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.341, Ratio=2.83x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.76x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.350, Ratio=2.89x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.367, Ratio=3.13x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.348, Ratio=2.82x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.350, Ratio=2.88x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.371, Ratio=2.95x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.365, Ratio=2.85x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.363, Ratio=3.03x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.360, Ratio=3.03x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.338, Ratio=2.77x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.80x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.356, Ratio=3.03x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.355, Ratio=2.92x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.357, Ratio=3.02x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.348, Ratio=2.98x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.85x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.365, Ratio=3.05x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.358, Ratio=2.87x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.361, Ratio=3.01x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.357, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.354, Ratio=2.98x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.362, Ratio=2.99x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.89x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.345, Ratio=2.91x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.373, Ratio=3.13x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.367, Ratio=2.93x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.381, Ratio=3.14x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.350, Ratio=2.85x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.343, Ratio=2.82x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.359, Ratio=3.03x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.370, Ratio=3.13x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.360, Ratio=2.89x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.355, Ratio=3.06x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.00x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.376, Ratio=3.01x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.382, Ratio=3.10x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=2.99x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.364, Ratio=2.88x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.96x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.371, Ratio=3.10x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.357, Ratio=2.95x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.96x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.371, Ratio=3.19x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.362, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.360, Ratio=2.95x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.361, Ratio=3.10x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.345, Ratio=2.93x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.367, Ratio=3.07x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.361, Ratio=3.00x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.350, Ratio=2.94x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.365, Ratio=2.91x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.76x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.371, Ratio=2.93x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.98x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.363, Ratio=2.95x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.348, Ratio=2.86x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.96x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.368, Ratio=3.08x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.366, Ratio=2.91x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.361, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.82x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.359, Ratio=2.85x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.84x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.345, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.343, Ratio=2.79x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.75x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.350, Ratio=2.93x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.365, Ratio=3.11x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.355, Ratio=2.92x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.89x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.01x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.358, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.93x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.361, Ratio=2.94x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.354, Ratio=2.87x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.346, Ratio=2.93x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.372, Ratio=3.04x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.364, Ratio=2.86x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.353, Ratio=2.89x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.362, Ratio=3.05x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.94x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.336, Ratio=2.73x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.361, Ratio=2.92x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.373, Ratio=3.09x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.368, Ratio=3.10x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.86x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.363, Ratio=2.93x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.85x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.385, Ratio=3.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.375, Ratio=3.03x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.90x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.353, Ratio=2.89x, Gap=-2.761

============================================================
Epoch 17/20 completed in 31.1s
Train: Loss=1.2153 (C:1.2153, R:0.0018) Ratio=2.70x
Val:   Loss=1.1839 (C:1.1839, R:0.0018) Ratio=3.13x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1839)
============================================================

Epoch 18 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.378, Ratio=2.99x, Gap=-2.805
Batch   0/537: Loss=1.1631 (C:1.1631, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.321, Ratio=2.64x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.361, Ratio=2.81x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.68x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.367, Ratio=2.86x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.331, Ratio=2.76x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.350, Ratio=2.79x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.342, Ratio=2.65x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.78x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.356, Ratio=2.79x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.342, Ratio=2.82x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.358, Ratio=2.97x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.359, Ratio=2.81x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.371, Ratio=2.80x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.365, Ratio=2.88x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.356, Ratio=2.83x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.343, Ratio=2.63x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.353, Ratio=2.79x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.370, Ratio=2.85x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.766
Batch  25/537: Loss=1.2028 (C:1.2028, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.75x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.361, Ratio=2.82x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.97x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.353, Ratio=2.68x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.80x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.372, Ratio=2.97x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.66x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.365, Ratio=2.79x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.88x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.359, Ratio=2.90x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.359, Ratio=2.85x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.344, Ratio=2.66x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.74x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.359, Ratio=2.85x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.352, Ratio=2.91x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-3.156
Batch  50/537: Loss=1.2529 (C:1.2529, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.95x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.359, Ratio=2.74x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.82x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.355, Ratio=2.85x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.352, Ratio=2.82x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.355, Ratio=2.78x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.366, Ratio=2.85x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.65x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.88x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.87x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.359, Ratio=2.81x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.359, Ratio=2.78x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.84x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.356, Ratio=2.79x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.354, Ratio=2.82x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.86x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.360, Ratio=2.85x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.370, Ratio=2.90x, Gap=-2.876
Batch  75/537: Loss=1.1799 (C:1.1799, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.84x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.354, Ratio=2.92x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.82x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.357, Ratio=2.67x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.339, Ratio=2.66x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.340, Ratio=2.63x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.90x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.81x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.90x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.356, Ratio=2.72x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.344, Ratio=2.81x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.359, Ratio=2.86x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.357, Ratio=2.80x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.361, Ratio=2.77x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.367, Ratio=2.87x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.76x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.68x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.365, Ratio=2.97x, Gap=-2.970
Batch 100/537: Loss=1.1726 (C:1.1726, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.352, Ratio=2.80x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.349, Ratio=2.70x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.365, Ratio=2.72x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.351, Ratio=2.72x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.356, Ratio=2.75x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.370, Ratio=2.83x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.363, Ratio=2.90x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.365, Ratio=2.89x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.348, Ratio=2.72x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.353, Ratio=2.69x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.355, Ratio=2.86x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.71x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.370, Ratio=2.90x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.365, Ratio=2.78x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.361, Ratio=2.74x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.372, Ratio=2.92x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.66x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.348, Ratio=2.72x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.861
Batch 125/537: Loss=1.2104 (C:1.2104, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.363, Ratio=2.80x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.364, Ratio=2.85x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.345, Ratio=2.89x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.76x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.355, Ratio=2.68x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.342, Ratio=2.69x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.377, Ratio=3.02x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.343, Ratio=2.71x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.347, Ratio=2.73x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.78x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.347, Ratio=2.71x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.84x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.344, Ratio=2.64x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.358, Ratio=2.96x, Gap=-2.740
Batch 150/537: Loss=1.1763 (C:1.1763, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.71x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.347, Ratio=2.80x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.359, Ratio=2.89x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.86x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.57x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.336, Ratio=2.70x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.346, Ratio=2.70x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.353, Ratio=2.71x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.76x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.375, Ratio=2.91x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.351, Ratio=2.68x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.330, Ratio=2.56x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.83x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.356, Ratio=2.83x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.69x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.345, Ratio=2.61x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.371, Ratio=2.95x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.359, Ratio=2.86x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.364, Ratio=2.74x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-3.385
Batch 175/537: Loss=1.2307 (C:1.2307, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.372, Ratio=2.96x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.344, Ratio=2.73x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.72x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.340, Ratio=2.66x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.84x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.359, Ratio=2.82x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.362, Ratio=2.84x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.357, Ratio=2.71x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.336, Ratio=2.63x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.366, Ratio=2.76x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.335, Ratio=2.70x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.334, Ratio=2.65x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.358, Ratio=2.72x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.355, Ratio=2.78x, Gap=-3.004
Batch 200/537: Loss=1.2103 (C:1.2103, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.356, Ratio=2.73x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.72x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.355, Ratio=2.80x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.331, Ratio=2.62x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.346, Ratio=2.74x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.85x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.355, Ratio=2.79x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.370, Ratio=2.86x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.74x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.79x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.71x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.364, Ratio=2.69x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.346, Ratio=2.69x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.368, Ratio=2.85x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.360, Ratio=2.80x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.344, Ratio=2.84x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.354, Ratio=2.79x, Gap=-2.909
Batch 225/537: Loss=1.2096 (C:1.2096, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.334, Ratio=2.72x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.67x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.74x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.351, Ratio=2.70x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.352, Ratio=2.68x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.361, Ratio=2.87x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.76x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.338, Ratio=2.72x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.324, Ratio=2.73x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.59x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.346, Ratio=2.90x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.357, Ratio=2.76x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.84x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.358, Ratio=2.87x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.347, Ratio=2.70x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.357, Ratio=2.79x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.377, Ratio=2.89x, Gap=-2.871
Batch 250/537: Loss=1.1790 (C:1.1790, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.347, Ratio=2.85x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.79x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.346, Ratio=2.69x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.346, Ratio=2.83x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.76x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.87x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.71x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.86x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.342, Ratio=2.66x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.355, Ratio=2.74x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.70x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.355, Ratio=2.78x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.327, Ratio=2.61x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.331, Ratio=2.72x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-3.240
Batch 275/537: Loss=1.2025 (C:1.2025, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.347, Ratio=2.66x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.345, Ratio=2.68x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.370, Ratio=2.85x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.365, Ratio=2.83x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.380, Ratio=2.90x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.344, Ratio=2.70x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.363, Ratio=2.77x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.362, Ratio=2.91x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.353, Ratio=2.78x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.83x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.328, Ratio=2.70x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.378, Ratio=2.97x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.359, Ratio=2.87x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.363, Ratio=2.82x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.358, Ratio=2.81x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.74x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.373, Ratio=2.88x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.356, Ratio=2.74x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.69x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.357, Ratio=2.71x, Gap=-3.052
Batch 300/537: Loss=1.2280 (C:1.2280, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.376, Ratio=2.95x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.371, Ratio=2.87x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.80x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.356, Ratio=2.71x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.336, Ratio=2.66x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.76x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.59x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.79x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.315, Ratio=2.46x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.356, Ratio=2.85x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.316, Ratio=2.61x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.353, Ratio=2.80x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.361, Ratio=2.75x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.355, Ratio=2.77x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.350, Ratio=2.64x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.74x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.326, Ratio=2.59x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-3.148
Batch 325/537: Loss=1.1942 (C:1.1942, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.79x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.389, Ratio=2.99x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.376, Ratio=2.84x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.74x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.363, Ratio=2.83x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.334, Ratio=2.62x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.362, Ratio=2.86x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.355, Ratio=2.63x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.362, Ratio=2.76x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.376, Ratio=2.94x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.370, Ratio=2.86x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.355, Ratio=2.66x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.365, Ratio=2.82x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.358, Ratio=2.85x, Gap=-3.228
Batch 350/537: Loss=1.1959 (C:1.1959, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.365, Ratio=2.69x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.368, Ratio=2.87x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.91x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.341, Ratio=2.75x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.87x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.84x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.81x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.349, Ratio=2.74x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.352, Ratio=2.84x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.369, Ratio=2.93x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.69x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.362, Ratio=2.73x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.350, Ratio=2.61x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.375, Ratio=2.92x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.68x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.357, Ratio=2.78x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.363, Ratio=2.88x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.70x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.339, Ratio=2.70x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.370, Ratio=2.91x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.339, Ratio=2.65x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.74x, Gap=-2.994
Batch 375/537: Loss=1.2166 (C:1.2166, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.339, Ratio=2.65x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.337, Ratio=2.64x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.335, Ratio=2.69x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.351, Ratio=2.79x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.71x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.360, Ratio=2.80x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.348, Ratio=2.74x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.343, Ratio=2.64x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.372, Ratio=2.95x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.339, Ratio=2.66x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.82x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.359, Ratio=2.70x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.360, Ratio=2.70x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.87x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.357, Ratio=2.79x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-3.036
Batch 400/537: Loss=1.2123 (C:1.2123, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.347, Ratio=2.66x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.347, Ratio=2.73x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.341, Ratio=2.63x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.372, Ratio=2.86x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.356, Ratio=2.74x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.345, Ratio=2.65x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.360, Ratio=2.67x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.330, Ratio=2.74x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.361, Ratio=2.91x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.328, Ratio=2.61x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.357, Ratio=2.74x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.344, Ratio=2.65x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.77x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.355, Ratio=2.77x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.71x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.365, Ratio=2.96x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.73x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.350, Ratio=2.75x, Gap=-3.013
Batch 425/537: Loss=1.2184 (C:1.2184, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.344, Ratio=2.68x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.366, Ratio=2.83x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.87x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.59x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.364, Ratio=2.80x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.371, Ratio=2.96x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.367, Ratio=2.90x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.73x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.81x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.374, Ratio=2.87x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.74x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.353, Ratio=2.65x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.355, Ratio=2.71x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.349, Ratio=2.61x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.349, Ratio=2.69x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.347, Ratio=2.89x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.79x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.357, Ratio=2.74x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.360, Ratio=2.83x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.346, Ratio=2.73x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.351, Ratio=2.86x, Gap=-3.184
Batch 450/537: Loss=1.1971 (C:1.1971, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.68x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.360, Ratio=2.93x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.351, Ratio=2.70x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.378, Ratio=2.89x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.368, Ratio=2.84x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.358, Ratio=2.69x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.372, Ratio=2.82x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.354, Ratio=2.79x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.377, Ratio=2.90x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.356, Ratio=2.80x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.350, Ratio=2.60x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.366, Ratio=2.80x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.363, Ratio=2.77x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.364, Ratio=2.92x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.346, Ratio=2.65x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.365, Ratio=2.76x, Gap=-3.253
Batch 475/537: Loss=1.2096 (C:1.2096, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.374, Ratio=2.97x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.350, Ratio=2.80x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.347, Ratio=2.72x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.348, Ratio=2.72x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.360, Ratio=2.85x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.76x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.332, Ratio=2.74x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.354, Ratio=2.71x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.331, Ratio=2.53x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.369, Ratio=2.90x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.340, Ratio=2.65x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.70x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.76x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.57x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.345, Ratio=2.68x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.363, Ratio=2.73x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.88x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.372, Ratio=2.88x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.373, Ratio=2.96x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.355, Ratio=2.84x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.360, Ratio=2.85x, Gap=-3.186
Batch 500/537: Loss=1.1938 (C:1.1938, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.336, Ratio=2.71x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.360, Ratio=2.80x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.371, Ratio=2.90x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.336, Ratio=2.55x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.365, Ratio=2.87x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.345, Ratio=2.65x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.355, Ratio=2.74x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.368, Ratio=2.89x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.78x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.363, Ratio=2.90x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.366, Ratio=2.85x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.363, Ratio=2.76x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.372, Ratio=2.86x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.352, Ratio=2.71x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.350, Ratio=2.74x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.77x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.350, Ratio=2.72x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.360, Ratio=2.87x, Gap=-2.908
Batch 525/537: Loss=1.1910 (C:1.1910, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.368, Ratio=2.86x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.366, Ratio=2.90x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.346, Ratio=2.70x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.365, Ratio=2.80x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.363, Ratio=2.76x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.363, Ratio=2.78x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.71x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.356, Ratio=2.83x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.357, Ratio=2.70x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.342, Ratio=2.79x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.355, Ratio=3.03x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.350, Ratio=2.97x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.00x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.367, Ratio=3.04x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.354, Ratio=3.00x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.361, Ratio=3.10x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.353, Ratio=3.05x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.85x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.354, Ratio=2.98x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.90x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.337, Ratio=2.80x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.346, Ratio=2.84x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.380, Ratio=3.14x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.363, Ratio=3.03x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.83x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.333, Ratio=2.75x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.354, Ratio=3.04x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.353, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.343, Ratio=2.71x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.345, Ratio=2.85x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.88x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.351, Ratio=2.88x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.340, Ratio=2.89x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.346, Ratio=2.91x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.355, Ratio=2.99x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.373, Ratio=3.11x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.353, Ratio=2.92x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.350, Ratio=2.89x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.358, Ratio=2.96x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.359, Ratio=2.97x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.351, Ratio=2.94x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.349, Ratio=2.90x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.356, Ratio=3.06x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.350, Ratio=2.91x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.89x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.354, Ratio=2.85x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.359, Ratio=2.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.352, Ratio=3.01x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.355, Ratio=2.96x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.338, Ratio=2.87x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.367, Ratio=3.06x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.339, Ratio=2.80x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.339, Ratio=2.81x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.344, Ratio=2.89x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.342, Ratio=2.96x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.337, Ratio=2.85x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.98x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.378, Ratio=3.12x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.370, Ratio=3.08x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.343, Ratio=2.90x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.88x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.364, Ratio=3.04x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.335, Ratio=2.83x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.355, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.341, Ratio=2.93x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.337, Ratio=2.79x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.349, Ratio=2.96x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.361, Ratio=3.03x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.91x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.96x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.334, Ratio=2.79x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.372, Ratio=3.02x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.343, Ratio=2.80x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.353, Ratio=3.00x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.343, Ratio=2.86x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.377, Ratio=3.19x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.360, Ratio=2.93x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.360, Ratio=2.99x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.60x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.372, Ratio=3.12x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.80x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.345, Ratio=2.90x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.351, Ratio=2.89x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.93x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.352, Ratio=2.94x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.74x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.338, Ratio=3.05x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.323, Ratio=2.76x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.354, Ratio=3.01x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.366, Ratio=3.03x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.346, Ratio=2.92x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.369, Ratio=3.05x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.359, Ratio=2.87x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.348, Ratio=2.87x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.362, Ratio=3.06x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.353, Ratio=2.98x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.348, Ratio=2.96x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.349, Ratio=2.97x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.376, Ratio=3.05x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.88x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.339, Ratio=2.90x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.336, Ratio=2.79x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.347, Ratio=2.92x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.349, Ratio=2.87x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.373, Ratio=3.22x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.92x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.99x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.354, Ratio=2.82x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.356, Ratio=3.03x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.363, Ratio=3.07x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.98x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.362, Ratio=3.07x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.365, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.00x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.362, Ratio=3.05x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.355, Ratio=3.02x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.348, Ratio=2.91x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.338, Ratio=2.82x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.95x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.334, Ratio=2.91x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.369, Ratio=2.97x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.360, Ratio=3.01x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.354, Ratio=2.92x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.86x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.351, Ratio=2.94x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.89x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.358, Ratio=3.04x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.335, Ratio=2.77x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.362, Ratio=3.14x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.13x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.350, Ratio=3.00x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.364, Ratio=3.04x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.356, Ratio=2.99x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.351, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.356, Ratio=2.93x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.362, Ratio=3.10x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.339, Ratio=2.84x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.340, Ratio=2.91x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.350, Ratio=2.92x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.372, Ratio=3.05x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.366, Ratio=3.09x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.97x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.352, Ratio=2.96x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.355, Ratio=3.04x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.340, Ratio=2.90x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.87x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.349, Ratio=3.04x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.358, Ratio=3.06x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.88x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.348, Ratio=2.86x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.349, Ratio=2.90x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.366, Ratio=3.04x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.356, Ratio=3.09x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.360, Ratio=3.11x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.364, Ratio=2.92x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.341, Ratio=2.86x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.84x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.356, Ratio=3.00x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.353, Ratio=2.99x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.359, Ratio=3.02x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.368, Ratio=3.12x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.345, Ratio=2.92x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.88x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.350, Ratio=2.89x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.338, Ratio=2.77x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=2.99x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.351, Ratio=2.89x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.353, Ratio=2.91x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.377, Ratio=3.05x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.353, Ratio=2.95x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.368, Ratio=3.09x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.359, Ratio=3.04x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.345, Ratio=2.94x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.375, Ratio=3.09x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.359, Ratio=3.04x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.376, Ratio=3.11x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.92x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.374, Ratio=3.06x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.97x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.351, Ratio=2.99x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.352, Ratio=3.09x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.354, Ratio=2.90x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.387, Ratio=3.25x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.349, Ratio=2.95x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.361, Ratio=2.99x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.344, Ratio=2.83x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.355, Ratio=3.06x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.357, Ratio=2.98x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.346, Ratio=2.98x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.01x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.356, Ratio=3.09x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.346, Ratio=2.87x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.374, Ratio=3.00x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.378, Ratio=3.28x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.360, Ratio=3.05x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.345, Ratio=2.88x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.356, Ratio=2.99x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.368, Ratio=3.06x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.370, Ratio=3.11x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.353, Ratio=3.04x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.351, Ratio=3.01x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.348, Ratio=2.91x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.351, Ratio=2.94x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.361, Ratio=3.19x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.356, Ratio=3.11x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.87x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.350, Ratio=2.93x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.358, Ratio=3.00x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.346, Ratio=2.86x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.343, Ratio=2.82x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.363, Ratio=3.13x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.341, Ratio=2.86x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.338, Ratio=2.94x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.07x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.349, Ratio=2.98x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.355, Ratio=3.05x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.363, Ratio=3.12x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.350, Ratio=2.90x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.353, Ratio=2.95x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.360, Ratio=3.09x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.02x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.350, Ratio=2.88x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.352, Ratio=2.93x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.368, Ratio=3.14x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.352, Ratio=2.97x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.344, Ratio=2.84x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.341, Ratio=2.89x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.353, Ratio=2.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.346, Ratio=2.90x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.336, Ratio=2.82x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.354, Ratio=2.95x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.368, Ratio=2.93x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.359, Ratio=3.11x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.366, Ratio=3.00x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.98x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.353, Ratio=2.94x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.95x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.363, Ratio=3.15x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.332, Ratio=2.76x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.382, Ratio=3.22x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.357, Ratio=2.94x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.358, Ratio=2.98x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.350, Ratio=3.03x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.345, Ratio=2.94x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.354, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.83x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.350, Ratio=2.86x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.372, Ratio=2.96x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.356, Ratio=3.01x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.351, Ratio=2.85x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.335, Ratio=2.84x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.96x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.95x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.358, Ratio=3.03x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.365, Ratio=3.23x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.95x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.354, Ratio=2.83x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.378, Ratio=3.16x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.327, Ratio=2.84x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.349, Ratio=2.79x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.06x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.342, Ratio=2.88x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.347, Ratio=2.86x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.360, Ratio=3.04x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.361, Ratio=3.10x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.336, Ratio=2.86x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.358, Ratio=3.06x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.340, Ratio=2.79x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.75x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.370, Ratio=3.16x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.357, Ratio=2.99x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.74x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.379, Ratio=3.18x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.351, Ratio=3.07x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.364, Ratio=3.14x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.361, Ratio=3.00x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.355, Ratio=2.97x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.370, Ratio=3.07x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.98x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.373, Ratio=3.10x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.97x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.349, Ratio=2.92x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.357, Ratio=2.95x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.360, Ratio=2.89x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.366, Ratio=3.05x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.354, Ratio=3.02x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.350, Ratio=2.96x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.98x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.348, Ratio=2.99x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.85x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.355, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.83x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.352, Ratio=2.97x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.368, Ratio=3.07x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.95x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.356, Ratio=2.90x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.360, Ratio=2.95x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.341, Ratio=2.96x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.346, Ratio=2.98x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.367, Ratio=3.14x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.346, Ratio=2.82x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.365, Ratio=3.11x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.360, Ratio=3.04x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.353, Ratio=3.00x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.385, Ratio=3.18x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.349, Ratio=2.86x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.363, Ratio=3.07x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.365, Ratio=2.96x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.370, Ratio=3.08x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.350, Ratio=2.99x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.348, Ratio=2.93x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.10x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.355, Ratio=2.94x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.348, Ratio=2.86x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.10x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.357, Ratio=3.04x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.03x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.326, Ratio=2.81x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.349, Ratio=2.99x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.366, Ratio=2.94x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.356, Ratio=2.98x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.341, Ratio=2.91x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.346, Ratio=2.91x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.353, Ratio=3.04x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.330, Ratio=2.82x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.357, Ratio=2.99x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.350, Ratio=3.02x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.348, Ratio=2.91x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.343, Ratio=2.99x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.90x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.342, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.342, Ratio=2.88x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.372, Ratio=3.24x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.355, Ratio=2.88x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.362, Ratio=3.04x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.373, Ratio=3.11x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.358, Ratio=3.02x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.349, Ratio=2.92x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.356, Ratio=2.88x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.354, Ratio=2.96x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.343, Ratio=2.91x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.370, Ratio=3.12x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.351, Ratio=2.92x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.92x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.341, Ratio=2.80x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.90x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.351, Ratio=2.96x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.357, Ratio=2.96x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.360, Ratio=3.10x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.353, Ratio=3.00x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.01x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.341, Ratio=2.91x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.366, Ratio=3.02x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.366, Ratio=3.02x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.340, Ratio=2.87x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.99x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.337, Ratio=2.90x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.85x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.93x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.353, Ratio=2.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.352, Ratio=2.99x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.353, Ratio=2.97x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.371, Ratio=3.10x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.75x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.359, Ratio=2.94x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.345, Ratio=2.92x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.376, Ratio=3.21x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.359, Ratio=3.02x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.04x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.91x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.355, Ratio=3.16x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.341, Ratio=2.93x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.81x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.364, Ratio=3.23x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.92x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.348, Ratio=2.86x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.349, Ratio=2.97x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.343, Ratio=2.89x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.359, Ratio=3.10x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.384, Ratio=3.13x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.336, Ratio=2.80x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.355, Ratio=2.99x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.329, Ratio=2.77x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.355, Ratio=3.02x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.350, Ratio=2.89x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.359, Ratio=3.09x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.349, Ratio=2.96x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.363, Ratio=3.08x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.369, Ratio=3.21x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.367, Ratio=3.09x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.358, Ratio=2.88x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.349, Ratio=2.93x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.371, Ratio=2.97x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.348, Ratio=2.94x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.358, Ratio=2.97x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.328, Ratio=2.83x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.376, Ratio=3.09x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.373, Ratio=3.15x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.354, Ratio=3.02x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.353, Ratio=2.94x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.365, Ratio=2.92x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.346, Ratio=3.00x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.363, Ratio=3.00x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.349, Ratio=2.86x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.363, Ratio=3.15x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.362, Ratio=3.09x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.344, Ratio=2.87x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.91x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.00x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.347, Ratio=2.88x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.85x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.355, Ratio=2.95x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.336, Ratio=2.85x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.357, Ratio=2.90x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.85x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.341, Ratio=2.83x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.343, Ratio=2.94x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=2.99x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.356, Ratio=2.97x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.340, Ratio=2.90x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.362, Ratio=3.08x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.88x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.353, Ratio=2.90x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.367, Ratio=3.06x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.351, Ratio=2.87x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.351, Ratio=2.99x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.371, Ratio=3.03x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.351, Ratio=2.99x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.339, Ratio=2.88x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.339, Ratio=2.80x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.343, Ratio=2.85x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.347, Ratio=2.93x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.360, Ratio=3.02x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.85x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.352, Ratio=3.07x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.363, Ratio=2.99x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.355, Ratio=2.98x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.374, Ratio=3.16x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.351, Ratio=2.91x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.362, Ratio=3.01x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.365, Ratio=3.09x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.03x, Gap=-2.594

============================================================
Epoch 18/20 completed in 30.9s
Train: Loss=1.2131 (C:1.2131, R:0.0018) Ratio=2.74x
Val:   Loss=1.1800 (C:1.1800, R:0.0018) Ratio=3.19x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1800)
============================================================

🌍 Updating global dataset at epoch 19
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.417 ± 0.611
    Neg distances: 1.372 ± 0.870
    Separation ratio: 3.29x
    Gap: -2.799
    ✅ Excellent global separation!

Epoch 19 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.347, Ratio=3.09x, Gap=-3.318
Batch   0/537: Loss=1.1681 (C:1.1681, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.356, Ratio=2.96x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.359, Ratio=3.01x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.387, Ratio=3.21x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.370, Ratio=2.95x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.375, Ratio=2.91x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.392, Ratio=3.20x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.384, Ratio=3.14x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.377, Ratio=3.04x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.381, Ratio=3.10x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.387, Ratio=3.25x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.387, Ratio=3.27x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.380, Ratio=3.17x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.382, Ratio=3.05x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.369, Ratio=3.13x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.383, Ratio=3.08x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.380, Ratio=3.00x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.383, Ratio=3.09x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.82x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.372, Ratio=2.97x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.378, Ratio=3.03x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.376, Ratio=3.17x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-3.036
Batch  25/537: Loss=1.2065 (C:1.2065, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.350, Ratio=3.00x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.08x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.362, Ratio=3.07x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.363, Ratio=3.09x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.381, Ratio=3.16x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.373, Ratio=2.99x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.98x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.86x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.353, Ratio=2.94x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.369, Ratio=3.06x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.89x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.378, Ratio=3.20x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.375, Ratio=3.19x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.379, Ratio=3.06x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.374, Ratio=2.98x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.391, Ratio=3.29x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.10x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.391, Ratio=3.29x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.355, Ratio=3.07x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.88x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.370, Ratio=3.11x, Gap=-2.805
Batch  50/537: Loss=1.1511 (C:1.1511, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.04x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.371, Ratio=2.97x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.379, Ratio=3.14x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.360, Ratio=3.02x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.373, Ratio=3.14x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.374, Ratio=3.27x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.366, Ratio=2.90x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.03x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.366, Ratio=3.07x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.356, Ratio=2.99x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.357, Ratio=2.96x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.372, Ratio=3.08x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.389, Ratio=3.12x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.393, Ratio=3.24x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.378, Ratio=3.09x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.399, Ratio=3.44x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.02x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.356, Ratio=2.94x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.366, Ratio=3.03x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.388, Ratio=3.25x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.95x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.99x, Gap=-3.318
Batch  75/537: Loss=1.1749 (C:1.1749, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.374, Ratio=2.95x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.385, Ratio=3.09x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.376, Ratio=3.09x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.362, Ratio=3.09x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.385, Ratio=3.22x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.374, Ratio=3.07x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.375, Ratio=3.03x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.373, Ratio=3.10x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.387, Ratio=3.19x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.397, Ratio=3.20x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.381, Ratio=3.10x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.377, Ratio=3.07x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.370, Ratio=2.91x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.363, Ratio=3.06x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.381, Ratio=3.13x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.370, Ratio=3.04x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.369, Ratio=3.12x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.93x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.01x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.380, Ratio=3.06x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.356, Ratio=2.90x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.387, Ratio=3.06x, Gap=-3.070
Batch 100/537: Loss=1.1513 (C:1.1513, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.387, Ratio=3.16x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.368, Ratio=3.08x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.386, Ratio=3.15x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.376, Ratio=2.94x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.96x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.372, Ratio=3.06x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.364, Ratio=3.06x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.380, Ratio=3.17x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.363, Ratio=3.02x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.367, Ratio=2.92x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.98x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.364, Ratio=3.02x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.04x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.368, Ratio=2.93x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.380, Ratio=3.03x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.390, Ratio=3.11x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.386, Ratio=3.16x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.354, Ratio=3.03x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.362, Ratio=2.99x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-3.021
Batch 125/537: Loss=1.1613 (C:1.1613, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.362, Ratio=3.04x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.352, Ratio=2.92x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.96x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.377, Ratio=3.08x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.04x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.372, Ratio=2.96x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.385, Ratio=3.35x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.379, Ratio=3.17x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.371, Ratio=2.98x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.383, Ratio=3.03x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.341, Ratio=2.87x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.390, Ratio=3.18x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.362, Ratio=2.89x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.375, Ratio=2.98x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.382, Ratio=3.16x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.354, Ratio=2.97x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.370, Ratio=2.99x, Gap=-2.978
Batch 150/537: Loss=1.1731 (C:1.1731, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.371, Ratio=3.23x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.385, Ratio=3.02x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.347, Ratio=2.89x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.365, Ratio=2.94x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.87x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.377, Ratio=3.07x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.381, Ratio=3.06x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.362, Ratio=2.97x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.377, Ratio=3.03x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.378, Ratio=3.15x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.365, Ratio=2.89x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.373, Ratio=3.09x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.383, Ratio=3.04x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.03x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.394, Ratio=3.23x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.370, Ratio=3.01x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.372, Ratio=3.00x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.380, Ratio=3.01x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.366, Ratio=3.25x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.361, Ratio=3.00x, Gap=-2.853
Batch 175/537: Loss=1.1739 (C:1.1739, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.385, Ratio=3.11x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.395, Ratio=3.35x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.361, Ratio=3.03x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.376, Ratio=3.09x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.369, Ratio=2.96x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.374, Ratio=2.96x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.382, Ratio=3.04x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.04x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.385, Ratio=3.12x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.355, Ratio=2.94x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.86x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.353, Ratio=2.99x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.375, Ratio=3.14x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.363, Ratio=3.14x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.347, Ratio=2.91x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.393, Ratio=3.27x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.383, Ratio=3.19x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.385, Ratio=3.14x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.378, Ratio=3.15x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.391, Ratio=3.15x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.996
Batch 200/537: Loss=1.1839 (C:1.1839, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.98x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.348, Ratio=2.94x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.372, Ratio=3.19x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.360, Ratio=3.13x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.382, Ratio=3.18x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.364, Ratio=3.03x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.377, Ratio=3.10x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.96x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.375, Ratio=3.13x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.366, Ratio=3.09x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.370, Ratio=3.07x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.377, Ratio=3.03x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.369, Ratio=3.09x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.372, Ratio=3.14x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.08x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.392, Ratio=3.07x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.370, Ratio=2.97x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.364, Ratio=3.07x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.374, Ratio=3.15x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.376, Ratio=3.12x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.383, Ratio=3.10x, Gap=-2.922
Batch 225/537: Loss=1.1475 (C:1.1475, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.386, Ratio=3.12x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.96x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.378, Ratio=3.13x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.392, Ratio=3.13x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.379, Ratio=3.17x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.360, Ratio=3.06x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.353, Ratio=2.97x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.363, Ratio=3.05x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.384, Ratio=3.14x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.379, Ratio=3.13x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.382, Ratio=3.06x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.368, Ratio=3.04x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.379, Ratio=3.05x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.392, Ratio=3.28x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.10x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.359, Ratio=3.00x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.371, Ratio=3.08x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.360, Ratio=3.04x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.370, Ratio=3.10x, Gap=-2.832
Batch 250/537: Loss=1.1543 (C:1.1543, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.366, Ratio=3.08x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.365, Ratio=2.92x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.393, Ratio=3.11x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.366, Ratio=3.16x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.378, Ratio=3.14x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.06x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.375, Ratio=2.94x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.365, Ratio=3.12x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.374, Ratio=2.97x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.360, Ratio=3.03x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.348, Ratio=2.98x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.357, Ratio=2.99x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.360, Ratio=3.03x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.379, Ratio=3.09x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.383, Ratio=3.19x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.378, Ratio=3.18x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.363, Ratio=2.99x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.362, Ratio=3.02x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.379, Ratio=3.29x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.357, Ratio=2.93x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.774
Batch 275/537: Loss=1.1542 (C:1.1542, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.367, Ratio=3.06x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.379, Ratio=3.13x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.341, Ratio=2.88x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.379, Ratio=3.07x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.393, Ratio=3.18x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.352, Ratio=2.88x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.360, Ratio=3.03x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.380, Ratio=3.14x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.348, Ratio=2.86x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.361, Ratio=2.93x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.351, Ratio=2.96x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.96x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.380, Ratio=3.09x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.00x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.363, Ratio=2.98x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.368, Ratio=2.96x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.416, Ratio=3.41x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.367, Ratio=3.07x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.377, Ratio=3.19x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.372, Ratio=3.20x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.376, Ratio=3.22x, Gap=-2.811
Batch 300/537: Loss=1.1325 (C:1.1325, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.367, Ratio=3.10x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.00x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.376, Ratio=3.09x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.396, Ratio=3.14x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.388, Ratio=3.18x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.392, Ratio=3.23x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.373, Ratio=3.13x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.362, Ratio=2.86x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.347, Ratio=2.92x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.373, Ratio=2.90x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.369, Ratio=2.95x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.379, Ratio=3.02x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.370, Ratio=3.06x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.382, Ratio=3.08x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.379, Ratio=3.04x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.366, Ratio=3.08x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.359, Ratio=2.92x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.355, Ratio=2.94x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.374, Ratio=3.05x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.374, Ratio=3.08x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.383, Ratio=3.26x, Gap=-2.939
Batch 325/537: Loss=1.1221 (C:1.1221, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.358, Ratio=2.95x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.370, Ratio=3.08x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.97x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.372, Ratio=3.11x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.388, Ratio=3.08x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.390, Ratio=3.10x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.363, Ratio=2.95x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.379, Ratio=3.05x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.385, Ratio=3.19x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.358, Ratio=3.08x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.10x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.351, Ratio=3.06x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.379, Ratio=3.02x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.371, Ratio=3.19x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.381, Ratio=3.23x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.382, Ratio=3.13x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.380, Ratio=3.09x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.344, Ratio=2.93x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.394, Ratio=3.23x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.07x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.390, Ratio=3.30x, Gap=-2.894
Batch 350/537: Loss=1.1191 (C:1.1191, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.373, Ratio=2.99x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.356, Ratio=2.84x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.374, Ratio=3.12x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.363, Ratio=3.02x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.350, Ratio=2.89x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.384, Ratio=3.08x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.358, Ratio=2.96x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.373, Ratio=3.05x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.389, Ratio=3.09x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.376, Ratio=3.00x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.377, Ratio=2.99x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.01x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.413, Ratio=3.38x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.395, Ratio=3.22x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.350, Ratio=2.87x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.352, Ratio=2.93x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.16x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.378, Ratio=3.07x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.383, Ratio=3.20x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.367, Ratio=3.01x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.847
Batch 375/537: Loss=1.1904 (C:1.1904, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.363, Ratio=3.03x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.378, Ratio=3.19x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.383, Ratio=3.08x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.389, Ratio=3.24x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.387, Ratio=3.22x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.373, Ratio=3.00x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.365, Ratio=3.06x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.356, Ratio=2.85x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.370, Ratio=3.10x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.361, Ratio=3.07x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.367, Ratio=3.05x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=3.00x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.89x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.367, Ratio=2.99x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.372, Ratio=3.22x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.373, Ratio=2.97x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.386, Ratio=3.28x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.382, Ratio=3.03x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.375, Ratio=3.05x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.389, Ratio=3.17x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.932
Batch 400/537: Loss=1.1902 (C:1.1902, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.17x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.370, Ratio=2.99x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=3.00x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.362, Ratio=2.97x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.85x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.370, Ratio=3.06x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.367, Ratio=3.13x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.381, Ratio=3.17x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.379, Ratio=3.12x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.378, Ratio=2.99x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.357, Ratio=3.03x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.88x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.387, Ratio=3.14x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.382, Ratio=3.19x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.373, Ratio=3.08x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.09x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.05x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.365, Ratio=3.05x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.359, Ratio=3.07x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.886
Batch 425/537: Loss=1.1585 (C:1.1585, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.369, Ratio=3.05x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.98x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.377, Ratio=3.21x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.376, Ratio=3.22x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.360, Ratio=2.83x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.14x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.388, Ratio=3.22x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.372, Ratio=3.07x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.372, Ratio=2.98x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.375, Ratio=3.05x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.83x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.370, Ratio=3.05x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.380, Ratio=3.02x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.380, Ratio=3.15x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.379, Ratio=3.20x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.369, Ratio=3.14x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.372, Ratio=3.07x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.378, Ratio=3.14x, Gap=-2.854
Batch 450/537: Loss=1.1424 (C:1.1424, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.365, Ratio=2.94x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.387, Ratio=3.17x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.361, Ratio=3.05x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.380, Ratio=3.06x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.383, Ratio=3.22x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.381, Ratio=3.04x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.09x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.356, Ratio=2.91x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.380, Ratio=3.13x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.384, Ratio=3.17x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.376, Ratio=3.06x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.378, Ratio=3.09x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.389, Ratio=3.02x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.368, Ratio=2.93x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.375, Ratio=3.23x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.390, Ratio=3.18x, Gap=-3.567
Batch 475/537: Loss=1.1358 (C:1.1358, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.352, Ratio=2.98x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.376, Ratio=3.14x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.04x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.377, Ratio=2.98x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.97x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.371, Ratio=2.99x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.378, Ratio=3.03x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.363, Ratio=3.10x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.07x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.383, Ratio=3.10x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.357, Ratio=2.90x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.384, Ratio=3.20x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.380, Ratio=3.02x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.374, Ratio=3.03x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.382, Ratio=3.13x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.340, Ratio=2.86x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.386, Ratio=3.17x, Gap=-3.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.381, Ratio=3.08x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.374, Ratio=3.02x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.05x, Gap=-2.828
Batch 500/537: Loss=1.1633 (C:1.1633, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.373, Ratio=3.10x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.372, Ratio=3.15x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.376, Ratio=3.11x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.07x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.380, Ratio=2.99x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.13x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.363, Ratio=3.05x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.355, Ratio=2.82x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.394, Ratio=3.09x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.365, Ratio=2.92x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.358, Ratio=2.85x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.374, Ratio=3.17x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.370, Ratio=3.09x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.374, Ratio=3.03x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.371, Ratio=2.99x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.375, Ratio=3.08x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.367, Ratio=3.07x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.381, Ratio=3.04x, Gap=-3.218
Batch 525/537: Loss=1.1621 (C:1.1621, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.365, Ratio=2.89x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.375, Ratio=3.00x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.91x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.01x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.354, Ratio=2.99x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.351, Ratio=2.96x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.351, Ratio=2.94x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.357, Ratio=3.07x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.374, Ratio=3.14x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.386, Ratio=3.28x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.406, Ratio=3.51x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.382, Ratio=3.25x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.379, Ratio=3.27x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.359, Ratio=3.10x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.383, Ratio=3.28x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.374, Ratio=3.35x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.382, Ratio=3.29x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.402, Ratio=3.38x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.389, Ratio=3.40x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.355, Ratio=3.11x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.365, Ratio=3.09x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.384, Ratio=3.24x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.374, Ratio=3.12x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.16x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.399, Ratio=3.53x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.377, Ratio=3.39x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.380, Ratio=3.40x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.376, Ratio=3.17x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.371, Ratio=3.17x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.12x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.349, Ratio=2.97x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.359, Ratio=3.20x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.385, Ratio=3.27x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.377, Ratio=3.40x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.383, Ratio=3.35x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.369, Ratio=3.05x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.376, Ratio=3.36x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.378, Ratio=3.22x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.378, Ratio=3.40x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.377, Ratio=3.18x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.375, Ratio=3.26x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.373, Ratio=3.17x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.391, Ratio=3.46x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.393, Ratio=3.45x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.374, Ratio=3.26x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.380, Ratio=3.40x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.374, Ratio=3.27x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.369, Ratio=3.20x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.369, Ratio=3.15x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.361, Ratio=3.10x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.394, Ratio=3.31x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.378, Ratio=3.37x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.371, Ratio=3.22x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.393, Ratio=3.39x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.382, Ratio=3.11x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.377, Ratio=3.24x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.05x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.385, Ratio=3.36x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.373, Ratio=3.38x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.373, Ratio=3.08x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.378, Ratio=3.24x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.43x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.388, Ratio=3.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.381, Ratio=3.29x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.377, Ratio=3.25x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.382, Ratio=3.22x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.376, Ratio=3.24x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.387, Ratio=3.22x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.389, Ratio=3.39x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.376, Ratio=3.19x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.387, Ratio=3.34x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.370, Ratio=3.10x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.392, Ratio=3.41x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.371, Ratio=3.31x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.381, Ratio=3.27x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.379, Ratio=3.18x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.369, Ratio=3.22x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.378, Ratio=3.37x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.368, Ratio=3.19x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.377, Ratio=3.28x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.378, Ratio=3.12x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.13x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.392, Ratio=3.34x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.393, Ratio=3.26x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.376, Ratio=3.23x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.397, Ratio=3.29x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.361, Ratio=3.20x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.361, Ratio=3.09x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.358, Ratio=3.08x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.369, Ratio=3.31x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.390, Ratio=3.37x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.392, Ratio=3.27x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.380, Ratio=3.21x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.364, Ratio=3.15x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.374, Ratio=3.20x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.358, Ratio=3.02x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.385, Ratio=3.39x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.375, Ratio=3.34x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.363, Ratio=3.23x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.383, Ratio=3.28x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.366, Ratio=3.13x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.390, Ratio=3.40x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.376, Ratio=3.30x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.387, Ratio=3.25x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.382, Ratio=3.39x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.400, Ratio=3.37x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.386, Ratio=3.32x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.381, Ratio=3.34x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.384, Neg=1.399, Ratio=3.64x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.372, Ratio=3.16x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.376, Ratio=3.22x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.365, Ratio=3.25x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.376, Ratio=3.16x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.380, Ratio=3.13x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.391, Ratio=3.32x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.386, Ratio=3.34x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.398, Ratio=3.32x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.394, Ratio=3.39x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.371, Ratio=3.26x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.380, Ratio=3.52x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.374, Ratio=3.20x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.387, Ratio=3.23x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.377, Ratio=3.19x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.387, Ratio=3.35x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.385, Ratio=3.31x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.26x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.363, Ratio=3.19x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.371, Ratio=3.27x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.375, Ratio=3.15x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.383, Ratio=3.36x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.381, Ratio=3.29x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.377, Ratio=3.28x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.383, Ratio=3.26x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.372, Ratio=3.17x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.374, Ratio=3.28x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.389, Ratio=3.30x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.371, Ratio=3.16x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.378, Ratio=3.23x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.384, Ratio=3.28x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.382, Ratio=3.33x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.365, Ratio=3.11x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.383, Ratio=3.32x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.381, Ratio=3.31x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.378, Ratio=3.31x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.392, Ratio=3.33x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.388, Ratio=3.40x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.371, Ratio=3.25x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.391, Ratio=3.28x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.374, Ratio=3.30x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.367, Ratio=3.24x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.379, Ratio=3.23x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.380, Ratio=3.19x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.376, Ratio=3.25x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.384, Ratio=3.33x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.373, Ratio=3.15x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.384, Ratio=3.41x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.382, Ratio=3.23x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.382, Ratio=3.37x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.393, Ratio=3.24x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.383, Ratio=3.29x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.371, Ratio=3.27x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.377, Ratio=3.20x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.398, Ratio=3.37x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.378, Ratio=3.21x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.405, Ratio=3.57x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.377, Ratio=3.32x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.370, Ratio=3.27x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.390, Ratio=3.36x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.392, Ratio=3.48x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.376, Ratio=3.23x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.388, Ratio=3.30x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.373, Ratio=3.21x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.377, Ratio=3.21x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.375, Ratio=3.17x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.350, Ratio=3.24x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.392, Ratio=3.36x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.389, Ratio=3.56x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.373, Ratio=3.29x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.371, Ratio=3.28x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.365, Ratio=3.14x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.389, Ratio=3.33x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.350, Ratio=2.99x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.383, Ratio=3.28x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.377, Ratio=3.22x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.398, Ratio=3.47x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.381, Ratio=3.38x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.380, Ratio=3.36x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.373, Ratio=3.23x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.384, Ratio=3.17x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.390, Ratio=3.30x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.385, Ratio=3.37x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.396, Ratio=3.34x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.363, Ratio=3.06x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.382, Ratio=3.22x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.398, Ratio=3.39x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.399, Ratio=3.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.366, Ratio=3.15x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.391, Ratio=3.33x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.388, Ratio=3.43x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.356, Ratio=3.16x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.388, Ratio=3.28x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.380, Ratio=3.27x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.386, Ratio=3.38x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.355, Ratio=3.12x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.385, Ratio=3.19x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.373, Ratio=3.23x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.376, Ratio=3.19x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.366, Ratio=3.12x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.368, Ratio=3.14x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.381, Ratio=3.26x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.374, Ratio=3.17x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.371, Ratio=3.15x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.371, Ratio=3.26x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.357, Ratio=3.01x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.389, Ratio=3.41x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.368, Ratio=3.10x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.389, Ratio=3.45x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.363, Ratio=3.04x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.378, Ratio=3.14x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.371, Ratio=3.27x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.371, Ratio=3.18x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.366, Ratio=3.11x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.359, Ratio=2.95x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.375, Ratio=3.24x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.371, Ratio=3.12x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.364, Ratio=3.22x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.367, Ratio=3.15x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.362, Ratio=3.12x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.354, Ratio=2.99x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.398, Ratio=3.34x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.382, Ratio=3.19x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.383, Ratio=3.12x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.379, Ratio=3.24x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.390, Ratio=3.23x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.381, Ratio=3.39x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.387, Ratio=3.24x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.382, Ratio=3.23x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.391, Ratio=3.41x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.393, Ratio=3.58x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.381, Ratio=3.18x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.391, Ratio=3.37x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.366, Ratio=3.19x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.367, Ratio=3.06x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.369, Ratio=3.15x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.381, Ratio=3.29x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.40x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.369, Ratio=3.13x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.375, Ratio=3.18x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.370, Ratio=3.25x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.384, Ratio=3.29x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.373, Ratio=3.18x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.373, Ratio=3.15x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.367, Ratio=3.19x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.357, Ratio=3.17x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.375, Ratio=3.29x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.364, Ratio=3.22x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.388, Ratio=3.42x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.388, Ratio=3.25x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.395, Ratio=3.31x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.364, Ratio=3.14x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.386, Ratio=3.27x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.394, Ratio=3.39x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.383, Ratio=3.29x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.373, Ratio=3.25x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.369, Ratio=3.20x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.367, Ratio=3.20x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.363, Ratio=3.13x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.372, Ratio=3.24x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.396, Ratio=3.39x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.380, Ratio=3.31x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.392, Ratio=3.38x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.387, Ratio=3.24x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.395, Ratio=3.51x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.380, Ratio=3.29x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.384, Ratio=3.28x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.373, Ratio=3.24x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.386, Ratio=3.38x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.380, Ratio=3.16x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.379, Ratio=3.32x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.398, Ratio=3.41x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.371, Ratio=3.26x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.365, Ratio=3.13x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.389, Ratio=3.40x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.385, Ratio=3.26x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.369, Ratio=3.24x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.384, Ratio=3.23x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.382, Ratio=3.35x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.383, Ratio=3.30x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.376, Ratio=3.21x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.389, Ratio=3.46x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.385, Ratio=3.25x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.368, Ratio=3.20x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.382, Ratio=3.40x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.369, Ratio=3.15x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.382, Ratio=3.30x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.385, Ratio=3.46x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.388, Ratio=3.43x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.395, Ratio=3.49x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.388, Ratio=3.24x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.366, Ratio=3.33x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.384, Ratio=3.38x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.354, Ratio=3.05x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.365, Ratio=3.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.361, Ratio=3.07x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.364, Ratio=3.29x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.363, Ratio=3.29x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.377, Ratio=3.37x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.366, Ratio=3.11x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.396, Ratio=3.28x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.375, Ratio=3.24x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.382, Ratio=3.30x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.373, Ratio=3.20x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.376, Ratio=3.32x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.385, Ratio=3.42x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.393, Ratio=3.39x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.367, Ratio=3.15x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.358, Ratio=3.05x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.359, Ratio=3.17x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.375, Ratio=3.20x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.380, Ratio=3.27x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.382, Ratio=3.40x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.381, Ratio=3.31x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.389, Ratio=3.36x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.377, Ratio=3.18x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.381, Ratio=3.24x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.380, Ratio=3.12x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.377, Ratio=3.22x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.379, Ratio=3.33x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.398, Ratio=3.53x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.357, Ratio=3.00x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.385, Ratio=3.35x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.398, Ratio=3.28x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.365, Ratio=3.25x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.375, Ratio=3.26x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.397, Ratio=3.37x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.379, Ratio=3.13x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.377, Ratio=3.33x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.373, Ratio=3.20x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.385, Ratio=3.39x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.376, Ratio=3.28x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.396, Ratio=3.32x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.385, Ratio=3.30x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.375, Ratio=3.26x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.387, Ratio=3.37x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.360, Ratio=3.14x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.380, Ratio=3.33x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.375, Ratio=3.24x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.13x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.381, Ratio=3.27x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.382, Ratio=3.41x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.11x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.366, Ratio=3.13x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.357, Ratio=3.01x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.376, Ratio=3.23x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.366, Ratio=3.20x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.363, Ratio=3.15x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.387, Ratio=3.41x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.388, Ratio=3.37x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.395, Ratio=3.34x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.385, Ratio=3.30x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.365, Ratio=3.23x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.385, Ratio=3.40x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.401, Ratio=3.47x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.388, Ratio=3.24x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.372, Ratio=3.18x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.377, Ratio=3.21x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.380, Ratio=3.23x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.395, Ratio=3.42x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.43x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.382, Ratio=3.31x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.392, Ratio=3.30x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.385, Ratio=3.33x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.365, Ratio=3.10x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.368, Ratio=3.20x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.387, Ratio=3.33x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.366, Ratio=3.08x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.363, Ratio=3.04x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.365, Ratio=3.14x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.372, Ratio=3.26x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.391, Ratio=3.44x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.391, Ratio=3.25x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.379, Ratio=3.22x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.386, Ratio=3.36x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.377, Ratio=3.21x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.367, Ratio=3.25x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.386, Ratio=3.35x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.370, Ratio=3.14x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.366, Ratio=3.13x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.379, Ratio=3.33x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.371, Ratio=3.13x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.383, Ratio=3.35x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.376, Ratio=3.21x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.395, Ratio=3.33x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.370, Ratio=3.17x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.388, Ratio=3.47x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.394, Ratio=3.37x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.376, Ratio=3.23x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.394, Ratio=3.45x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.375, Ratio=3.23x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.396, Ratio=3.38x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.369, Ratio=3.30x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.364, Ratio=3.08x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.391, Ratio=3.41x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.394, Ratio=3.46x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.401, Ratio=3.38x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.370, Ratio=3.19x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.399, Ratio=3.50x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.378, Ratio=3.35x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.378, Ratio=3.37x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.374, Ratio=3.23x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.371, Ratio=3.19x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.392, Ratio=3.26x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.383, Ratio=3.33x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.381, Ratio=3.44x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.378, Ratio=3.21x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.361, Ratio=3.05x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.374, Ratio=3.18x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.373, Ratio=3.19x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.379, Ratio=3.18x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.375, Ratio=3.31x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.389, Ratio=3.35x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.375, Ratio=3.35x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.366, Ratio=3.21x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.407, Ratio=3.50x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.376, Ratio=3.31x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.401, Ratio=3.43x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.371, Ratio=3.23x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.374, Ratio=3.35x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.404, Ratio=3.45x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.387, Ratio=3.49x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.379, Ratio=3.27x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.388, Ratio=3.34x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.374, Ratio=3.27x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.372, Ratio=3.14x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.366, Ratio=3.19x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.367, Ratio=3.24x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.393, Ratio=3.42x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.387, Ratio=3.49x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.381, Ratio=3.20x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.393, Ratio=3.33x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.390, Ratio=3.38x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.379, Ratio=3.19x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.380, Ratio=3.20x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.371, Ratio=3.37x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.373, Ratio=3.23x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.372, Ratio=3.19x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.378, Ratio=3.23x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.386, Ratio=3.39x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.388, Ratio=3.45x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.384, Ratio=3.31x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.380, Ratio=3.28x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.17x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.373, Ratio=3.14x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.366, Ratio=3.23x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.360, Ratio=3.15x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.362, Ratio=3.19x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.365, Ratio=3.21x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.395, Ratio=3.36x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.356, Ratio=3.17x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.364, Ratio=2.99x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.389, Ratio=3.29x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.17x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.379, Ratio=3.20x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.374, Ratio=3.27x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.394, Ratio=3.29x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.378, Ratio=3.37x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.390, Ratio=3.49x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.387, Ratio=3.19x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.17x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.400, Ratio=3.49x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.377, Ratio=3.29x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.370, Ratio=3.28x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.367, Ratio=3.16x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.384, Ratio=3.27x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.404, Ratio=3.57x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.375, Ratio=3.35x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.403, Ratio=3.39x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.383, Ratio=3.26x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.377, Ratio=3.30x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.388, Ratio=3.29x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.395, Ratio=3.45x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.382, Ratio=3.39x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.406, Ratio=3.40x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.376, Ratio=3.24x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.376, Ratio=3.21x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.389, Ratio=3.42x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.375, Ratio=3.33x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.42x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.369, Ratio=3.35x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.389, Ratio=3.47x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.369, Ratio=3.18x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.382, Ratio=3.33x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.377, Ratio=3.25x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.413, Ratio=3.67x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.399, Ratio=3.45x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.381, Ratio=3.51x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.393, Ratio=3.49x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.377, Ratio=3.30x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.383, Ratio=3.29x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.373, Ratio=3.14x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.383, Ratio=3.23x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.394, Ratio=3.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.364, Ratio=3.15x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.376, Ratio=3.31x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.383, Ratio=3.30x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.376, Ratio=3.14x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.385, Ratio=3.32x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.387, Ratio=3.38x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.383, Ratio=3.30x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.391, Ratio=3.35x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.387, Ratio=3.29x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.394, Ratio=3.39x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.386, Ratio=3.35x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.382, Ratio=3.29x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.394, Ratio=3.51x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.372, Ratio=3.14x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.372, Ratio=3.12x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.378, Ratio=3.20x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.399, Ratio=3.36x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.373, Ratio=3.22x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.374, Ratio=3.19x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.400, Ratio=3.32x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.375, Neg=1.391, Ratio=3.71x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.378, Ratio=3.13x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.378, Ratio=3.24x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.388, Ratio=3.33x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.380, Ratio=3.23x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.384, Ratio=3.35x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.385, Ratio=3.19x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.364, Ratio=3.16x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.363, Ratio=3.08x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.385, Ratio=3.49x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.387, Ratio=3.31x, Gap=-2.607

============================================================
Epoch 19/20 completed in 35.9s
Train: Loss=1.1627 (C:1.1627, R:0.0018) Ratio=2.81x
Val:   Loss=1.1276 (C:1.1276, R:0.0018) Ratio=3.26x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1276)
============================================================

Epoch 20 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.988
Batch   0/537: Loss=1.1761 (C:1.1761, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.371, Ratio=3.07x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.371, Ratio=3.06x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.02x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.376, Ratio=3.11x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.371, Ratio=3.01x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.385, Ratio=3.22x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.378, Ratio=3.15x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.88x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.387, Ratio=3.06x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.357, Ratio=2.95x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.384, Ratio=3.04x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.384, Ratio=3.23x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.392, Ratio=3.20x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.369, Ratio=3.05x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.385, Ratio=3.07x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.381, Ratio=3.16x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.00x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.371, Ratio=3.30x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.381, Ratio=3.21x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.390, Ratio=3.19x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.396, Ratio=3.20x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.372, Ratio=2.94x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.815
Batch  25/537: Loss=1.1620 (C:1.1620, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.383, Ratio=3.15x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.389, Ratio=3.15x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.377, Ratio=3.12x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.386, Ratio=3.02x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.10x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.369, Ratio=3.12x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.372, Ratio=2.97x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.372, Ratio=2.91x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.382, Ratio=3.10x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.387, Ratio=3.21x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.380, Ratio=3.15x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.378, Ratio=3.16x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.366, Ratio=3.05x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.380, Ratio=3.06x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.365, Ratio=3.26x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.378, Ratio=3.21x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.382, Ratio=3.06x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.379, Ratio=3.14x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.363, Ratio=2.99x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.383, Ratio=3.16x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.358, Ratio=3.02x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.377, Ratio=3.10x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.369, Ratio=2.88x, Gap=-3.535
Batch  50/537: Loss=1.1931 (C:1.1931, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.03x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.365, Ratio=3.05x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.357, Ratio=3.09x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.374, Ratio=3.23x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.380, Ratio=3.20x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.358, Ratio=3.00x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.374, Ratio=3.16x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.373, Ratio=3.11x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.362, Ratio=2.99x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.379, Ratio=3.07x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.378, Ratio=3.20x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.381, Ratio=3.09x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.376, Ratio=3.05x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.388, Ratio=3.18x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.393, Ratio=3.25x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.09x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.376, Ratio=3.00x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.378, Ratio=3.03x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.368, Ratio=3.02x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.378, Ratio=3.29x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.04x, Gap=-3.051
Batch  75/537: Loss=1.1627 (C:1.1627, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.354, Ratio=3.00x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.382, Ratio=3.17x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.367, Ratio=3.02x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.356, Ratio=3.01x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.368, Ratio=2.94x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.364, Ratio=3.05x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.378, Ratio=3.26x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.359, Ratio=3.09x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.383, Ratio=3.12x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.380, Ratio=2.99x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.365, Ratio=2.96x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.379, Ratio=3.22x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.344, Ratio=2.84x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.379, Ratio=3.20x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.09x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.376, Ratio=3.04x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.09x, Gap=-2.810
Batch 100/537: Loss=1.1514 (C:1.1514, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.381, Ratio=3.08x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.381, Ratio=3.14x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.381, Ratio=3.09x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.391, Ratio=3.05x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.370, Ratio=3.00x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.377, Ratio=2.92x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.382, Ratio=3.06x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.373, Ratio=3.13x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.364, Ratio=2.99x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.384, Ratio=3.12x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.373, Ratio=3.00x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.359, Ratio=2.90x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.379, Ratio=3.11x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.357, Ratio=3.08x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.364, Ratio=3.10x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.99x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.02x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.20x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.371, Ratio=2.97x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.377, Ratio=2.91x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.380, Ratio=3.10x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.391, Ratio=3.25x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.375, Ratio=3.19x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.370, Ratio=3.14x, Gap=-3.108
Batch 125/537: Loss=1.1497 (C:1.1497, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.389, Ratio=3.14x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.387, Ratio=3.20x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.373, Ratio=3.12x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.369, Ratio=2.91x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.384, Ratio=3.29x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.346, Ratio=2.89x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.372, Ratio=2.94x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.385, Ratio=3.05x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.382, Ratio=3.15x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.01x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.373, Ratio=3.17x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.369, Ratio=2.95x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.363, Ratio=3.13x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.395, Ratio=3.25x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.378, Ratio=3.09x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.388, Ratio=3.23x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.382, Ratio=3.11x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.386, Ratio=3.16x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.01x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.386, Ratio=3.11x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.352, Ratio=2.87x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.375, Ratio=3.08x, Gap=-3.040
Batch 150/537: Loss=1.1580 (C:1.1580, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.89x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.384, Ratio=3.07x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.360, Ratio=3.01x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.361, Ratio=3.01x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.381, Ratio=3.08x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.349, Ratio=3.09x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.349, Ratio=2.82x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.358, Ratio=3.06x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.11x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.387, Ratio=3.00x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.16x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.397, Ratio=3.28x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.06x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.374, Ratio=3.22x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.366, Ratio=3.12x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.388, Ratio=3.29x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.380, Ratio=3.11x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.372, Ratio=2.95x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.04x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.384, Ratio=3.11x, Gap=-3.425
Batch 175/537: Loss=1.1490 (C:1.1490, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.367, Ratio=3.09x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.371, Ratio=3.11x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.89x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.372, Ratio=3.00x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.353, Ratio=2.84x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.378, Ratio=3.18x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.355, Ratio=2.93x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.381, Ratio=3.02x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.370, Ratio=3.09x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.383, Ratio=3.16x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.363, Ratio=2.99x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.366, Ratio=3.06x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.09x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.370, Ratio=2.93x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.377, Ratio=3.11x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.374, Ratio=3.09x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.394, Ratio=3.24x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.374, Ratio=3.12x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.365, Ratio=2.90x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.395, Ratio=3.19x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.93x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.385, Ratio=3.13x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.362, Ratio=3.05x, Gap=-3.067
Batch 200/537: Loss=1.1666 (C:1.1666, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.387, Ratio=3.33x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.360, Ratio=3.03x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.355, Ratio=2.97x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.367, Ratio=3.20x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.355, Ratio=3.07x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.392, Ratio=3.23x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.03x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.388, Ratio=3.13x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.380, Ratio=3.03x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.365, Ratio=2.96x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.373, Ratio=3.13x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.384, Ratio=3.18x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.358, Ratio=3.08x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.01x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.31x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.394, Ratio=3.18x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.348, Ratio=2.89x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.98x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-3.035
Batch 225/537: Loss=1.1580 (C:1.1580, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.381, Ratio=3.26x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.394, Ratio=3.29x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.385, Ratio=3.05x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.377, Ratio=3.06x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.382, Ratio=3.15x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.367, Ratio=3.01x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.385, Ratio=3.09x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.385, Ratio=3.03x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.387, Ratio=3.13x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.375, Ratio=3.08x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.393, Ratio=3.38x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.370, Ratio=3.06x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.365, Ratio=3.10x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.388, Ratio=3.20x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.373, Ratio=3.16x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.75x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.372, Ratio=3.00x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.392, Ratio=3.19x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.372, Ratio=2.97x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.382, Ratio=3.10x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.368, Ratio=3.10x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-3.264
Batch 250/537: Loss=1.1731 (C:1.1731, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.373, Ratio=3.12x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.376, Ratio=3.11x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.351, Ratio=3.09x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.09x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.354, Ratio=2.88x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.08x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.375, Ratio=3.09x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.375, Ratio=3.13x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.380, Ratio=3.19x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.360, Ratio=3.06x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.388, Ratio=3.21x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.376, Ratio=3.06x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.01x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.98x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.365, Ratio=3.09x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.378, Ratio=3.17x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.365, Ratio=3.05x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.376, Ratio=3.15x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.12x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.398, Ratio=3.32x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.382, Ratio=3.05x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.385, Ratio=3.09x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.382, Ratio=3.02x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.373, Ratio=2.98x, Gap=-3.138
Batch 275/537: Loss=1.1761 (C:1.1761, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.363, Ratio=3.10x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.379, Ratio=3.09x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.363, Ratio=3.08x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.366, Ratio=3.10x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.375, Ratio=3.13x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.356, Ratio=3.02x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.01x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.376, Ratio=3.04x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=3.00x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.370, Ratio=3.10x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.370, Ratio=2.95x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.362, Ratio=3.05x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.369, Ratio=2.93x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.374, Ratio=3.02x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.382, Ratio=3.25x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.376, Ratio=3.04x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.378, Ratio=2.98x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.383, Ratio=3.17x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.366, Ratio=3.18x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.97x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.381, Ratio=3.12x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.372, Ratio=3.05x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.945
Batch 300/537: Loss=1.1702 (C:1.1702, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.381, Ratio=3.22x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.377, Ratio=3.08x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.383, Ratio=3.03x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.370, Ratio=3.01x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.391, Ratio=3.21x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.364, Ratio=3.14x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.375, Ratio=3.13x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.357, Ratio=3.02x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.391, Ratio=3.33x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.389, Ratio=3.23x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.391, Ratio=3.21x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.387, Ratio=3.14x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.376, Ratio=3.18x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.381, Ratio=3.09x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.372, Ratio=3.08x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.389, Ratio=3.23x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.371, Ratio=3.09x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.93x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.359, Ratio=3.07x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.366, Ratio=2.94x, Gap=-3.238
Batch 325/537: Loss=1.1814 (C:1.1814, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.372, Ratio=3.16x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.369, Ratio=3.08x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.373, Ratio=2.98x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.379, Ratio=3.06x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.386, Ratio=3.08x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.368, Ratio=3.02x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.367, Ratio=3.13x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.03x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.380, Ratio=3.08x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.389, Ratio=3.17x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.20x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.330, Ratio=2.91x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.342, Ratio=2.89x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.98x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.372, Ratio=3.06x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.344, Ratio=2.92x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.374, Ratio=3.07x, Gap=-3.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.382, Ratio=3.10x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.369, Ratio=3.17x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.374, Ratio=3.00x, Gap=-2.856
Batch 350/537: Loss=1.1664 (C:1.1664, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.389, Ratio=3.18x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.392, Ratio=3.09x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.377, Ratio=3.11x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.385, Ratio=3.10x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.359, Ratio=3.00x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.361, Ratio=3.05x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.401, Ratio=3.25x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.362, Ratio=3.04x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.83x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.368, Ratio=3.02x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.389, Ratio=3.24x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.371, Ratio=3.10x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.385, Ratio=3.19x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.364, Ratio=3.06x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.381, Ratio=3.01x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.381, Ratio=3.14x, Gap=-3.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.380, Ratio=3.10x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.382, Ratio=3.21x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.376, Ratio=3.07x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.388, Ratio=3.16x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.354, Ratio=2.98x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.379, Ratio=3.04x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.369, Ratio=2.91x, Gap=-2.791
Batch 375/537: Loss=1.1808 (C:1.1808, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.369, Ratio=3.13x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.372, Ratio=3.11x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.359, Ratio=2.94x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.368, Ratio=3.13x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.377, Ratio=3.00x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.353, Ratio=2.99x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.358, Ratio=3.02x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.356, Ratio=2.83x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.371, Ratio=3.12x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.384, Ratio=3.13x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.384, Ratio=3.02x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.389, Ratio=3.03x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.350, Ratio=3.06x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.88x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.365, Ratio=3.09x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.384, Ratio=3.00x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.376, Ratio=2.99x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.345, Ratio=2.97x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.373, Ratio=3.15x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.377, Ratio=3.11x, Gap=-2.961
Batch 400/537: Loss=1.1482 (C:1.1482, R:0.0017)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.368, Ratio=3.07x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.385, Ratio=3.18x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.365, Ratio=2.88x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.379, Ratio=3.13x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.392, Ratio=3.09x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.387, Ratio=3.13x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.373, Ratio=3.13x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.363, Ratio=2.91x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.376, Ratio=3.10x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.372, Ratio=3.10x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.373, Ratio=3.11x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.382, Ratio=3.11x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.25x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.371, Ratio=3.09x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.376, Ratio=3.02x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.12x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.375, Ratio=3.16x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.372, Ratio=3.07x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.380, Ratio=3.08x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.372, Ratio=3.03x, Gap=-2.989
Batch 425/537: Loss=1.1676 (C:1.1676, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.367, Ratio=2.93x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.366, Ratio=3.05x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.380, Ratio=3.29x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.393, Ratio=3.04x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.394, Ratio=3.22x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.388, Ratio=3.10x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.336, Ratio=2.85x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.02x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.369, Ratio=3.07x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.05x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.372, Ratio=2.99x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.397, Ratio=3.23x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.374, Ratio=3.17x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.379, Ratio=3.04x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.372, Ratio=3.06x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.354, Ratio=2.98x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.370, Ratio=3.00x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.366, Ratio=3.08x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.372, Ratio=3.01x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.365, Ratio=2.84x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-3.108
Batch 450/537: Loss=1.1685 (C:1.1685, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.378, Ratio=3.00x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.387, Ratio=3.24x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.371, Ratio=3.01x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.362, Ratio=3.15x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.364, Ratio=3.12x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.373, Ratio=3.01x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.378, Ratio=3.14x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.347, Ratio=2.90x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.360, Ratio=2.99x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.394, Ratio=3.20x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.371, Ratio=2.98x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.353, Ratio=2.89x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.372, Ratio=3.05x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.380, Ratio=3.26x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.364, Ratio=2.89x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.376, Ratio=3.19x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.365, Ratio=3.09x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.380, Ratio=3.16x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.374, Ratio=2.99x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.394, Ratio=3.18x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.380, Ratio=3.17x, Gap=-3.474
Batch 475/537: Loss=1.1410 (C:1.1410, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.375, Ratio=3.08x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.373, Ratio=3.09x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.376, Ratio=3.00x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.347, Ratio=2.88x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.372, Ratio=2.95x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.395, Ratio=3.27x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.01x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.383, Ratio=3.19x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.03x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.20x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.379, Ratio=3.11x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.392, Ratio=3.25x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.392, Ratio=3.19x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.368, Ratio=3.07x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.357, Ratio=2.99x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.373, Ratio=3.11x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.371, Ratio=3.13x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.357, Ratio=2.95x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.379, Ratio=3.08x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.341, Ratio=2.78x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.364, Ratio=3.02x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.380, Ratio=3.10x, Gap=-2.726
Batch 500/537: Loss=1.1500 (C:1.1500, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.86x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.361, Ratio=2.93x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.371, Ratio=3.07x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.359, Ratio=3.14x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.370, Ratio=3.06x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.373, Ratio=3.04x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.04x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.392, Ratio=3.21x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.359, Ratio=2.95x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.389, Ratio=3.19x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.367, Ratio=3.14x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.355, Ratio=3.08x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.379, Ratio=3.25x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.379, Ratio=3.05x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.369, Ratio=3.03x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.379, Ratio=3.01x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.379, Ratio=3.08x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.367, Ratio=2.92x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.383, Ratio=3.02x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.371, Ratio=3.11x, Gap=-3.134
Batch 525/537: Loss=1.1518 (C:1.1518, R:0.0018)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.372, Ratio=3.10x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.359, Ratio=2.96x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.99x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.354, Ratio=2.96x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.380, Ratio=3.08x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.405, Ratio=3.30x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.382, Ratio=3.21x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.376, Ratio=3.04x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.351, Ratio=2.97x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.388, Ratio=3.13x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.365, Ratio=3.23x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.394, Ratio=3.58x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.380, Ratio=3.13x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.369, Ratio=3.28x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.376, Ratio=3.26x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.375, Ratio=3.27x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.359, Ratio=3.19x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.372, Ratio=3.27x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.379, Ratio=3.47x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.375, Ratio=3.38x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.386, Ratio=3.36x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.403, Ratio=3.59x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.395, Ratio=3.57x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.387, Ratio=3.37x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.381, Ratio=3.51x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.366, Ratio=3.15x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.365, Ratio=3.26x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.374, Ratio=3.29x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.375, Ratio=3.26x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.374, Ratio=3.37x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.388, Ratio=3.46x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.388, Ratio=3.41x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.382, Ratio=3.37x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.386, Ratio=3.40x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.369, Ratio=3.43x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.344, Ratio=3.14x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.378, Ratio=3.32x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.368, Ratio=3.39x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.379, Ratio=3.40x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.354, Ratio=3.19x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.380, Ratio=3.35x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.366, Ratio=3.29x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.368, Ratio=3.37x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.375, Ratio=3.38x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.356, Ratio=3.11x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.365, Ratio=3.31x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.391, Ratio=3.29x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.366, Ratio=3.37x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.373, Ratio=3.30x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.381, Ratio=3.24x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.380, Ratio=3.31x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.381, Ratio=3.35x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.391, Ratio=3.40x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.383, Ratio=3.44x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.369, Ratio=3.26x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.380, Ratio=3.23x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.381, Ratio=3.51x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.369, Ratio=3.23x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.400, Ratio=3.46x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.382, Ratio=3.42x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.390, Ratio=3.30x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.390, Ratio=3.43x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.372, Ratio=3.38x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.391, Ratio=3.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.388, Ratio=3.31x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.378, Ratio=3.22x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.381, Ratio=3.32x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.395, Ratio=3.56x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.387, Ratio=3.40x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.378, Ratio=3.33x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.379, Ratio=3.35x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.350, Ratio=3.23x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.378, Ratio=3.30x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.364, Ratio=3.27x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.386, Ratio=3.29x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.377, Ratio=3.33x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.368, Ratio=3.30x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.359, Ratio=3.09x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.391, Ratio=3.39x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.373, Ratio=3.33x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.376, Ratio=3.34x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.43x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.362, Ratio=3.16x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.397, Ratio=3.45x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.385, Ratio=3.37x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.373, Ratio=3.20x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.384, Neg=1.384, Ratio=3.60x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.374, Ratio=3.36x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.380, Ratio=3.54x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.351, Ratio=3.09x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.347, Ratio=3.18x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.381, Ratio=3.42x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.392, Ratio=3.56x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.367, Ratio=3.34x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.383, Ratio=3.48x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.368, Ratio=3.15x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.394, Ratio=3.43x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.368, Ratio=3.31x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.371, Ratio=3.30x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.385, Ratio=3.52x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.367, Ratio=3.20x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.386, Ratio=3.34x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.380, Ratio=3.31x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.379, Ratio=3.31x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.369, Ratio=3.41x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.386, Ratio=3.35x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.374, Ratio=3.46x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.359, Ratio=3.08x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.387, Ratio=3.53x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.366, Ratio=3.34x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.366, Ratio=3.43x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.380, Ratio=3.41x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.371, Ratio=3.19x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.377, Ratio=3.34x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.383, Ratio=3.34x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.371, Ratio=3.32x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.392, Ratio=3.50x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.386, Ratio=3.49x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.374, Ratio=3.23x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.382, Ratio=3.30x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.393, Ratio=3.43x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.387, Ratio=3.51x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.374, Ratio=3.33x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.360, Ratio=3.22x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.380, Ratio=3.46x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.376, Ratio=3.33x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.361, Ratio=3.16x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.374, Ratio=3.40x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.368, Ratio=3.15x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.387, Ratio=3.24x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.389, Ratio=3.50x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.373, Ratio=3.29x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.363, Ratio=3.24x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.386, Ratio=3.37x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.381, Ratio=3.38x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.377, Ratio=3.13x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.368, Ratio=3.41x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.383, Ratio=3.32x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.393, Ratio=3.43x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.386, Ratio=3.34x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.376, Ratio=3.28x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.360, Ratio=3.16x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.394, Ratio=3.41x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.367, Ratio=3.29x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.397, Ratio=3.48x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.381, Neg=1.405, Ratio=3.69x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.397, Ratio=3.38x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.383, Ratio=3.28x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.382, Ratio=3.36x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.398, Ratio=3.56x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.388, Ratio=3.52x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.378, Ratio=3.29x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.399, Ratio=3.64x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.366, Ratio=3.23x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.381, Ratio=3.44x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.359, Ratio=3.26x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.376, Ratio=3.26x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.383, Ratio=3.51x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.363, Ratio=3.22x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.375, Ratio=3.54x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.383, Ratio=3.31x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.382, Neg=1.387, Ratio=3.63x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.359, Ratio=3.01x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.365, Ratio=3.17x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.388, Ratio=3.47x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.348, Ratio=3.11x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.373, Ratio=3.28x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.373, Ratio=3.36x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.377, Ratio=3.39x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.378, Ratio=3.21x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.366, Ratio=3.27x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.364, Ratio=3.17x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.394, Ratio=3.47x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.382, Ratio=3.34x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.379, Ratio=3.42x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.374, Ratio=3.18x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.370, Ratio=3.22x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.371, Ratio=3.26x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.367, Ratio=3.30x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.372, Ratio=3.24x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.368, Ratio=3.34x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.382, Ratio=3.28x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.373, Ratio=3.27x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.391, Ratio=3.49x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.370, Ratio=3.34x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.370, Ratio=3.25x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.361, Ratio=3.21x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.375, Ratio=3.37x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.392, Ratio=3.40x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.383, Ratio=3.34x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.377, Ratio=3.19x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.375, Ratio=3.39x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.378, Ratio=3.29x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.385, Ratio=3.36x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.385, Ratio=3.30x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.372, Ratio=3.22x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.384, Ratio=3.38x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.376, Ratio=3.26x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.388, Ratio=3.50x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.384, Ratio=3.32x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.13x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.379, Ratio=3.44x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.349, Ratio=3.16x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.377, Ratio=3.25x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.377, Ratio=3.38x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.383, Ratio=3.43x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.368, Ratio=3.29x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.349, Ratio=3.11x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.384, Ratio=3.38x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.373, Ratio=3.45x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.08x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.387, Ratio=3.51x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.352, Ratio=3.11x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.368, Ratio=3.14x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.374, Ratio=3.40x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.385, Ratio=3.40x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.383, Ratio=3.56x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.378, Ratio=3.33x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.381, Ratio=3.34x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.391, Ratio=3.56x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.338, Ratio=3.08x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.368, Ratio=3.21x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.394, Ratio=3.48x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.367, Ratio=3.23x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.360, Ratio=3.25x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.365, Ratio=3.22x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.372, Ratio=3.37x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.361, Ratio=3.40x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.345, Ratio=3.03x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.371, Ratio=3.39x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.385, Ratio=3.40x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.379, Ratio=3.37x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.371, Ratio=3.35x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.353, Ratio=3.26x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.391, Ratio=3.52x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.374, Ratio=3.37x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.373, Ratio=3.14x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.370, Ratio=3.24x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.382, Ratio=3.47x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.389, Ratio=3.54x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.385, Ratio=3.39x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.356, Ratio=3.13x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.374, Ratio=3.20x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.366, Ratio=3.31x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.373, Ratio=3.19x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.387, Ratio=3.47x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.372, Ratio=3.33x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.369, Ratio=3.28x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.363, Ratio=3.15x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.366, Ratio=3.31x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.384, Ratio=3.48x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.388, Ratio=3.39x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.372, Ratio=3.17x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.362, Ratio=3.34x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.375, Ratio=3.32x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.375, Ratio=3.20x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.367, Ratio=3.23x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.368, Ratio=3.29x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.356, Ratio=3.33x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.370, Ratio=3.38x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.347, Ratio=3.07x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.362, Ratio=3.28x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.377, Ratio=3.33x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.386, Ratio=3.35x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.379, Ratio=3.40x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.364, Ratio=3.17x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.372, Ratio=3.35x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.374, Ratio=3.24x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.380, Ratio=3.34x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.379, Ratio=3.27x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.378, Ratio=3.28x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.359, Ratio=3.11x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.361, Ratio=3.28x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.383, Ratio=3.42x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.374, Ratio=3.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.370, Ratio=3.30x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.387, Ratio=3.43x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.396, Ratio=3.45x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.375, Ratio=3.40x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.365, Ratio=3.19x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.398, Ratio=3.58x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.376, Ratio=3.35x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.367, Ratio=3.31x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.380, Ratio=3.27x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.391, Ratio=3.59x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.369, Ratio=3.34x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.360, Ratio=3.18x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.399, Ratio=3.48x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.372, Ratio=3.33x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.386, Ratio=3.34x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.370, Ratio=3.30x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.350, Ratio=3.19x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.364, Ratio=3.22x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.350, Ratio=3.12x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.383, Neg=1.391, Ratio=3.63x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.364, Ratio=3.14x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.377, Ratio=3.40x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.380, Ratio=3.32x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.377, Ratio=3.38x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.358, Ratio=3.26x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.378, Ratio=3.46x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.367, Ratio=3.37x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.369, Ratio=3.25x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.367, Ratio=3.34x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.383, Ratio=3.26x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.376, Ratio=3.42x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.382, Ratio=3.33x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.390, Ratio=3.47x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.366, Ratio=3.13x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.369, Ratio=3.36x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.369, Ratio=3.32x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.379, Ratio=3.36x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.394, Ratio=3.40x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.398, Ratio=3.54x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.373, Ratio=3.37x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.42x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.392, Ratio=3.42x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.386, Ratio=3.37x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.365, Ratio=3.44x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.383, Ratio=3.40x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.380, Ratio=3.30x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.364, Ratio=3.21x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.364, Ratio=3.29x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.376, Ratio=3.39x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.388, Ratio=3.58x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.377, Ratio=3.28x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.386, Ratio=3.32x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.370, Ratio=3.22x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.371, Ratio=3.32x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.372, Ratio=3.30x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.379, Ratio=3.43x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.366, Ratio=3.26x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.384, Ratio=3.38x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.396, Ratio=3.37x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.371, Ratio=3.32x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.375, Ratio=3.15x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.367, Ratio=3.38x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.356, Ratio=3.14x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.377, Ratio=3.23x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.379, Ratio=3.32x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.369, Ratio=3.18x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.362, Ratio=3.19x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.386, Ratio=3.58x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.383, Ratio=3.31x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.373, Ratio=3.33x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.371, Ratio=3.11x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.359, Ratio=3.23x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.385, Ratio=3.33x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.391, Ratio=3.56x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.383, Ratio=3.32x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.373, Ratio=3.26x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.376, Ratio=3.47x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.383, Ratio=3.39x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.378, Ratio=3.24x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.373, Ratio=3.38x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.374, Ratio=3.33x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.355, Ratio=3.17x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.378, Ratio=3.21x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.370, Ratio=3.18x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.378, Ratio=3.40x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.385, Ratio=3.54x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.362, Ratio=3.30x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.376, Ratio=3.27x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.366, Ratio=3.22x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.367, Ratio=3.42x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.392, Ratio=3.31x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.372, Ratio=3.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.374, Ratio=3.28x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.380, Ratio=3.30x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.390, Ratio=3.42x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.365, Ratio=3.28x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.367, Ratio=3.27x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.381, Ratio=3.38x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.396, Ratio=3.45x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.361, Ratio=3.28x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.383, Ratio=3.40x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.381, Ratio=3.24x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.374, Ratio=3.24x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.374, Ratio=3.29x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.354, Ratio=3.05x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.384, Ratio=3.42x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.368, Ratio=3.21x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.383, Ratio=3.48x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.388, Ratio=3.42x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.379, Ratio=3.18x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.366, Ratio=3.30x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.383, Ratio=3.41x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.370, Ratio=3.30x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.387, Ratio=3.47x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.378, Ratio=3.30x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.376, Ratio=3.32x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.364, Ratio=3.30x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.375, Ratio=3.33x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.378, Ratio=3.36x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.368, Ratio=3.23x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.386, Ratio=3.37x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.378, Ratio=3.30x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.375, Ratio=3.33x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.377, Ratio=3.38x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.384, Ratio=3.31x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.386, Ratio=3.40x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.386, Ratio=3.60x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.370, Ratio=3.10x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.367, Ratio=3.13x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.376, Ratio=3.35x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.399, Ratio=3.46x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.388, Ratio=3.44x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.376, Ratio=3.28x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.369, Ratio=3.37x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.368, Ratio=3.22x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.377, Ratio=3.48x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.371, Ratio=3.23x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.379, Ratio=3.47x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.382, Ratio=3.33x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.381, Ratio=3.30x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.367, Ratio=3.23x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.373, Ratio=3.31x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.368, Ratio=3.36x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.369, Ratio=3.11x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.374, Ratio=3.31x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.373, Ratio=3.29x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.374, Ratio=3.25x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.361, Ratio=3.10x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.387, Ratio=3.35x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.381, Ratio=3.43x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.379, Ratio=3.39x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.384, Ratio=3.40x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.380, Ratio=3.41x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.384, Ratio=3.37x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.399, Ratio=3.37x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.371, Ratio=3.24x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.386, Ratio=3.40x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.373, Ratio=3.30x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.384, Ratio=3.24x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.388, Ratio=3.29x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.391, Ratio=3.50x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.388, Ratio=3.42x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.376, Ratio=3.32x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.377, Ratio=3.37x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.355, Ratio=3.22x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.377, Ratio=3.39x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.398, Ratio=3.54x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.372, Ratio=3.13x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.378, Ratio=3.40x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.370, Ratio=3.33x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.394, Ratio=3.34x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.395, Ratio=3.55x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.381, Neg=1.382, Ratio=3.63x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.366, Ratio=3.35x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.389, Ratio=3.47x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.355, Ratio=3.07x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.391, Ratio=3.34x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.387, Ratio=3.41x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.366, Ratio=3.38x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.369, Ratio=3.35x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.382, Ratio=3.35x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.387, Ratio=3.26x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.372, Ratio=3.32x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.369, Ratio=3.29x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.386, Ratio=3.37x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.376, Ratio=3.26x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.349, Ratio=3.07x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.375, Ratio=3.22x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.370, Ratio=3.25x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.363, Ratio=3.20x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.18x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.367, Ratio=3.11x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.378, Ratio=3.38x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.367, Ratio=3.28x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.361, Ratio=3.22x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.380, Ratio=3.41x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.396, Ratio=3.46x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.382, Ratio=3.30x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.373, Ratio=3.23x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.361, Ratio=3.32x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.364, Ratio=3.23x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.374, Ratio=3.35x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.374, Ratio=3.14x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.369, Ratio=3.27x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.383, Ratio=3.43x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.380, Ratio=3.24x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.390, Ratio=3.41x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.18x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.376, Ratio=3.47x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.369, Ratio=3.22x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.361, Ratio=3.18x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.362, Ratio=3.27x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.372, Ratio=3.37x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.374, Ratio=3.45x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.368, Ratio=3.37x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.380, Ratio=3.42x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.372, Ratio=3.45x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.364, Ratio=3.38x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.361, Ratio=3.17x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.378, Ratio=3.27x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.385, Ratio=3.19x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.369, Ratio=3.27x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.353, Ratio=3.29x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.380, Ratio=3.24x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.368, Ratio=3.27x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.378, Ratio=3.35x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.381, Ratio=3.36x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.385, Ratio=3.35x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.378, Ratio=3.23x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.376, Ratio=3.49x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.358, Ratio=3.14x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.377, Ratio=3.45x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.391, Ratio=3.43x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.352, Ratio=3.24x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.345, Ratio=3.13x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.378, Ratio=3.28x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.373, Ratio=3.42x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.384, Ratio=3.34x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.380, Ratio=3.53x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.379, Ratio=3.32x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.370, Ratio=3.34x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.356, Ratio=3.14x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.359, Ratio=3.25x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.382, Ratio=3.41x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.367, Ratio=3.22x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.383, Ratio=3.36x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.383, Ratio=3.33x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.376, Ratio=3.36x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.370, Ratio=3.28x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.371, Ratio=3.25x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.392, Ratio=3.41x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.379, Neg=1.409, Ratio=3.72x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.392, Ratio=3.51x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.379, Ratio=3.33x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.379, Ratio=3.18x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.378, Ratio=3.14x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.389, Ratio=3.57x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.387, Ratio=3.51x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.353, Ratio=3.08x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.367, Ratio=3.23x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.355, Ratio=3.14x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.381, Ratio=3.36x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.360, Ratio=3.13x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.369, Ratio=3.18x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.396, Ratio=3.46x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.363, Ratio=3.22x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.361, Ratio=3.09x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.372, Ratio=3.36x, Gap=-2.649

============================================================
Epoch 20/20 completed in 30.1s
Train: Loss=1.1598 (C:1.1598, R:0.0018) Ratio=2.78x
Val:   Loss=1.1225 (C:1.1225, R:0.0018) Ratio=3.37x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1225)
Checkpoint saved at epoch 20
============================================================

Global Dataset Training Completed!
Best epoch: 20
Best validation loss: 1.1225
Final separation ratios: Train=2.78x, Val=3.37x
Training completed!
Loading best model from experiments/global_lattice_test_20250712_125855/checkpoints/best_model.pt
Starting model evaluation...
========================================
GlobalContrastiveEvaluator initialized on cuda
Starting comprehensive evaluation...
============================================================
Extracting latent representations...
  Processed 1/539 batches
  Processed 51/539 batches
  Processed 101/539 batches
  Processed 151/539 batches
  Processed 201/539 batches
  Processed 251/539 batches
  Processed 301/539 batches
  Processed 351/539 batches
  Processed 401/539 batches
  Processed 451/539 batches
  Processed 501/539 batches
Extracted representations: torch.Size([549367, 75])
Evaluating clustering performance...
Subsampled to 50000 points for clustering evaluation
Clustering Results:
  Silhouette Score: 0.3224
  Adjusted Rand Score: 0.4257
  Clustering Accuracy: 0.7019
Evaluating classification performance...
  Extracting training representations...
Extracting latent representations...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
Extracted representations: torch.Size([547740, 75])
  Extracting validation representations...
Extracting latent representations...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
Extracted representations: torch.Size([547740, 75])
Subsampled training to 50000 samples
Subsampled validation to 10000 samples
  Training on 50000 samples, evaluating on 10000 samples
Classification Results:
  Accuracy: 0.7494
  Per-class F1: [0.0, 0.0, 0.0]
Evaluating reconstruction quality...
Reconstruction Results:
  Average MSE: 0.001759
Evaluating separation quality...

PIPELINE FAILED: [enforce fail at alloc_cpu.cpp:117] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 1207216402756 bytes. Error code 12 (Cannot allocate memory)

Analysis completed with exit code: 0
Time: Sat 12 Jul 13:11:02 BST 2025

=== ANALYSIS SUCCESSFUL ===
Autoencoder pipeline successful!


Job finished.
