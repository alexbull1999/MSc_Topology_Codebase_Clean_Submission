Starting Surface Distance Metric Analysis job...
Job ID: 181846
Node: gpuvm15
Time: Sat 12 Jul 12:00:04 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jul 12 12:00:06 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   33C    P8              9W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting AutoEncoder Pipeline...

GLOBAL DATASET CONTRASTIVE AUTOENCODER PIPELINE
============================================================
Start time: 2025-07-12 12:00:42.927223
Using device: cuda

Configuration:
  Embedding type: lattice
  Batch size: 1020
  Global update frequency: 3 epochs
  Training epochs: 20
Experiment setup completed:
  Experiment directory: experiments/global_lattice_test_20250712_120043
  Config saved to: experiments/global_lattice_test_20250712_120043/config.json
Loading data...
========================================
FlexibleEmbedder initialized with type: 'lattice'
Output dimension will be: 768
GlobalDataLoader initialized:
  Embedding type: lattice
  Output dimension: 768
  Sample size: All
Starting data loading pipeline...
============================================================
Loading training data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 training samples
Loading validation data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 validation samples
Loading test data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 test samples
Generating embeddings for training...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
Generating embeddings for validation...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
Generating embeddings for test...
Generating lattice embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated lattice embeddings: torch.Size([549367, 768])
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 768])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}

Data loading pipeline completed!
Output embedding dimension: 768
Updated model input_dim to: 768
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
DataLoaders created:
  Batch size: 1020
  Balanced sampling: True
  Train batches: 537
  Val batches: 537
  Test batches: 539
Data loading completed!
  Train: 549367 samples, 537 batches
  Val: 549367 samples, 537 batches
  Test: 549367 samples, 539 batches
Creating model and trainer...
========================================
ContrastiveAutoencoder initialized:
  Input dim: 768
  Latent dim: 75
  Hidden dims: [512, 256]
  Dropout rate: 0.2
  Total parameters: 1,089,355
Model created with 1,089,355 parameters
FullDatasetContrastiveLoss initialized:
  Margin: 2.0
  Update frequency: 3 epochs
  Max global samples: 3000
FullDatasetCombinedLoss initialized:
  Contrastive weight: 1.0
  Reconstruction weight: 0.0
Optimizer created (lr=0.0001)
GlobalDatasetTrainer initialized on device: cuda
Model parameters: 1,089,355
Starting training...
========================================
Starting Global Dataset Training...
============================================================

üåç Updating global dataset at epoch 1
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.038 ¬± 0.004
    Neg distances: 0.038 ¬± 0.005
    Separation ratio: 1.01x
    Gap: -0.049
    ‚ùå Poor global separation

Epoch 1 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.064, Neg=0.064, Ratio=1.01x, Gap=-0.118
Batch   0/537: Loss=1.9997 (C:1.9997, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.064, Neg=0.064, Ratio=1.01x, Gap=-0.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.065, Neg=0.065, Ratio=1.01x, Gap=-0.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.065, Neg=0.066, Ratio=1.01x, Gap=-0.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.066, Neg=0.067, Ratio=1.01x, Gap=-0.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.067, Neg=0.068, Ratio=1.01x, Gap=-0.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.068, Neg=0.069, Ratio=1.02x, Gap=-0.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.069, Neg=0.070, Ratio=1.02x, Gap=-0.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.071, Neg=0.072, Ratio=1.02x, Gap=-0.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.072, Neg=0.074, Ratio=1.03x, Gap=-0.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.074, Neg=0.075, Ratio=1.03x, Gap=-0.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.076, Neg=0.078, Ratio=1.02x, Gap=-0.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.079, Neg=0.081, Ratio=1.03x, Gap=-0.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.081, Neg=0.083, Ratio=1.03x, Gap=-0.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.082, Neg=0.085, Ratio=1.03x, Gap=-0.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.085, Neg=0.089, Ratio=1.04x, Gap=-0.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.090, Neg=0.093, Ratio=1.03x, Gap=-0.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.092, Neg=0.096, Ratio=1.04x, Gap=-0.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.097, Neg=0.101, Ratio=1.04x, Gap=-0.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.101, Neg=0.105, Ratio=1.04x, Gap=-0.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.105, Neg=0.110, Ratio=1.04x, Gap=-0.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.110, Neg=0.115, Ratio=1.05x, Gap=-0.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.116, Neg=0.123, Ratio=1.05x, Gap=-0.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.124, Neg=0.129, Ratio=1.04x, Gap=-0.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.128, Neg=0.132, Ratio=1.04x, Gap=-0.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.133, Neg=0.139, Ratio=1.05x, Gap=-0.525
Batch  25/537: Loss=1.9934 (C:1.9934, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.140, Neg=0.147, Ratio=1.05x, Gap=-0.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.147, Neg=0.153, Ratio=1.04x, Gap=-0.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.155, Neg=0.162, Ratio=1.05x, Gap=-0.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.161, Neg=0.170, Ratio=1.05x, Gap=-0.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.174, Neg=0.181, Ratio=1.04x, Gap=-0.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.181, Neg=0.193, Ratio=1.07x, Gap=-0.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.188, Neg=0.199, Ratio=1.06x, Gap=-0.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.197, Neg=0.208, Ratio=1.06x, Gap=-0.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.211, Neg=0.222, Ratio=1.05x, Gap=-0.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.216, Neg=0.233, Ratio=1.08x, Gap=-0.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.233, Neg=0.248, Ratio=1.06x, Gap=-0.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.243, Neg=0.258, Ratio=1.06x, Gap=-0.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.255, Neg=0.274, Ratio=1.08x, Gap=-1.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.272, Neg=0.288, Ratio=1.06x, Gap=-1.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.291, Neg=0.309, Ratio=1.06x, Gap=-1.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.308, Neg=0.325, Ratio=1.06x, Gap=-1.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.320, Neg=0.340, Ratio=1.06x, Gap=-1.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.342, Neg=0.362, Ratio=1.06x, Gap=-1.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.345, Neg=0.371, Ratio=1.07x, Gap=-1.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.378, Neg=0.407, Ratio=1.08x, Gap=-1.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=0.429, Ratio=1.07x, Gap=-1.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=0.452, Ratio=1.07x, Gap=-1.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=0.488, Ratio=1.06x, Gap=-2.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.499, Ratio=1.06x, Gap=-2.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.530, Ratio=1.09x, Gap=-2.170
Batch  50/537: Loss=1.9584 (C:1.9584, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.560, Ratio=1.07x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.592, Ratio=1.06x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.616, Ratio=1.07x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.655, Ratio=1.08x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.670, Ratio=1.09x, Gap=-3.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.659, Ratio=1.09x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.667, Ratio=1.08x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.666, Ratio=1.08x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.658, Ratio=1.07x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.633, Ratio=1.08x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.627, Ratio=1.07x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.589, Ratio=1.10x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.584, Ratio=1.09x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.546, Ratio=1.09x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.549, Ratio=1.08x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.556, Ratio=1.10x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.538, Ratio=1.09x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.541, Ratio=1.10x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=0.548, Ratio=1.10x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.562, Ratio=1.09x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.588, Ratio=1.10x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.604, Ratio=1.10x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.596, Ratio=1.10x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.613, Ratio=1.11x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.606, Ratio=1.11x, Gap=-3.026
Batch  75/537: Loss=1.9443 (C:1.9443, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.604, Ratio=1.09x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.607, Ratio=1.10x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.603, Ratio=1.11x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.616, Ratio=1.09x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.632, Ratio=1.10x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.599, Ratio=1.11x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.597, Ratio=1.09x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.583, Ratio=1.12x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.577, Ratio=1.12x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.562, Ratio=1.10x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.574, Ratio=1.12x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.556, Ratio=1.11x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.548, Ratio=1.11x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.553, Ratio=1.13x, Gap=-3.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.549, Ratio=1.11x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.556, Ratio=1.11x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.566, Ratio=1.12x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.568, Ratio=1.13x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.572, Ratio=1.11x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.590, Ratio=1.12x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.591, Ratio=1.12x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.610, Ratio=1.11x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.613, Ratio=1.12x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.619, Ratio=1.11x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.632, Ratio=1.12x, Gap=-3.135
Batch 100/537: Loss=1.9452 (C:1.9452, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.618, Ratio=1.13x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.620, Ratio=1.12x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.613, Ratio=1.14x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.622, Ratio=1.13x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.593, Ratio=1.12x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.596, Ratio=1.12x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.601, Ratio=1.13x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.586, Ratio=1.13x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.601, Ratio=1.13x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.602, Ratio=1.15x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.595, Ratio=1.13x, Gap=-3.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.609, Ratio=1.13x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.602, Ratio=1.13x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.610, Ratio=1.13x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.605, Ratio=1.14x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.610, Ratio=1.13x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.608, Ratio=1.14x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.612, Ratio=1.14x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.605, Ratio=1.13x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.599, Ratio=1.14x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.603, Ratio=1.14x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.603, Ratio=1.13x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.579, Ratio=1.12x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.588, Ratio=1.14x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.576, Ratio=1.12x, Gap=-3.372
Batch 125/537: Loss=1.9462 (C:1.9462, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.597, Ratio=1.15x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.572, Ratio=1.13x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.597, Ratio=1.15x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.628, Ratio=1.15x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.598, Ratio=1.13x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.609, Ratio=1.14x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.595, Ratio=1.14x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.623, Ratio=1.14x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.624, Ratio=1.14x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.627, Ratio=1.13x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.638, Ratio=1.13x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.655, Ratio=1.17x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.633, Ratio=1.14x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.627, Ratio=1.13x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.623, Ratio=1.15x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.642, Ratio=1.15x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.616, Ratio=1.13x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.604, Ratio=1.15x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.617, Ratio=1.14x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.627, Ratio=1.13x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.602, Ratio=1.13x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.627, Ratio=1.15x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.612, Ratio=1.15x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.607, Ratio=1.15x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.586, Ratio=1.14x, Gap=-3.547
Batch 150/537: Loss=1.9366 (C:1.9366, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.596, Ratio=1.15x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.596, Ratio=1.15x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.574, Ratio=1.14x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.583, Ratio=1.14x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.590, Ratio=1.14x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.593, Ratio=1.15x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.621, Ratio=1.15x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.616, Ratio=1.16x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.605, Ratio=1.15x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.646, Ratio=1.16x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.652, Ratio=1.16x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.648, Ratio=1.13x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.646, Ratio=1.14x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.631, Ratio=1.13x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.642, Ratio=1.15x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.627, Ratio=1.16x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.614, Ratio=1.15x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.613, Ratio=1.14x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.601, Ratio=1.15x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.588, Ratio=1.15x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.597, Ratio=1.14x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.579, Ratio=1.14x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.607, Ratio=1.16x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.599, Ratio=1.16x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.599, Ratio=1.15x, Gap=-3.353
Batch 175/537: Loss=1.9321 (C:1.9321, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.593, Ratio=1.14x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.617, Ratio=1.15x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.609, Ratio=1.15x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.645, Ratio=1.16x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.614, Ratio=1.13x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.16x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.641, Ratio=1.14x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.635, Ratio=1.15x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.645, Ratio=1.15x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.631, Ratio=1.16x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.638, Ratio=1.16x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.630, Ratio=1.14x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.618, Ratio=1.14x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.614, Ratio=1.15x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.610, Ratio=1.15x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.610, Ratio=1.15x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.597, Ratio=1.15x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.609, Ratio=1.16x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.586, Ratio=1.15x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.597, Ratio=1.15x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.605, Ratio=1.17x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.593, Ratio=1.13x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.598, Ratio=1.15x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.605, Ratio=1.17x, Gap=-3.566
Batch 200/537: Loss=1.9234 (C:1.9234, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.609, Ratio=1.14x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.615, Ratio=1.15x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.602, Ratio=1.15x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.630, Ratio=1.15x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.651, Ratio=1.17x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.645, Ratio=1.15x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.645, Ratio=1.14x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.644, Ratio=1.16x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.644, Ratio=1.15x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.629, Ratio=1.14x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.622, Ratio=1.16x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.625, Ratio=1.13x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.627, Ratio=1.16x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.607, Ratio=1.15x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.620, Ratio=1.15x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.595, Ratio=1.16x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.583, Ratio=1.15x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.594, Ratio=1.16x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.589, Ratio=1.14x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.592, Ratio=1.16x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.605, Ratio=1.17x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.599, Ratio=1.15x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.610, Ratio=1.15x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.609, Ratio=1.14x, Gap=-3.592
Batch 225/537: Loss=1.9367 (C:1.9367, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.637, Ratio=1.16x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.626, Ratio=1.18x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.638, Ratio=1.15x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.619, Ratio=1.15x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.629, Ratio=1.16x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.635, Ratio=1.15x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.614, Ratio=1.15x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.618, Ratio=1.15x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.620, Ratio=1.16x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.630, Ratio=1.16x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.593, Ratio=1.14x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.620, Ratio=1.15x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.614, Ratio=1.15x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.620, Ratio=1.16x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.611, Ratio=1.16x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.615, Ratio=1.16x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.631, Ratio=1.17x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.633, Ratio=1.16x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.606, Ratio=1.13x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.605, Ratio=1.14x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.623, Ratio=1.15x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.613, Ratio=1.15x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.598, Ratio=1.13x, Gap=-3.299
Batch 250/537: Loss=1.9406 (C:1.9406, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.610, Ratio=1.15x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.603, Ratio=1.16x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.596, Ratio=1.14x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.600, Ratio=1.14x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.608, Ratio=1.16x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.587, Ratio=1.16x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.602, Ratio=1.16x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.581, Ratio=1.14x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.597, Ratio=1.14x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.609, Ratio=1.14x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.595, Ratio=1.15x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.612, Ratio=1.17x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.614, Ratio=1.17x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.612, Ratio=1.14x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.621, Ratio=1.14x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.640, Ratio=1.17x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.633, Ratio=1.14x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.603, Ratio=1.16x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.617, Ratio=1.15x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.613, Ratio=1.16x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.632, Ratio=1.18x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.602, Ratio=1.15x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.624, Ratio=1.18x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.593, Ratio=1.15x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.613, Ratio=1.16x, Gap=-3.192
Batch 275/537: Loss=1.9271 (C:1.9271, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.609, Ratio=1.15x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=0.608, Ratio=1.16x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.608, Ratio=1.16x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.608, Ratio=1.14x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.615, Ratio=1.15x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.624, Ratio=1.15x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.627, Ratio=1.15x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.625, Ratio=1.17x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.620, Ratio=1.15x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.630, Ratio=1.15x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.623, Ratio=1.17x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.621, Ratio=1.17x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.626, Ratio=1.15x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.617, Ratio=1.16x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.636, Ratio=1.17x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.618, Ratio=1.15x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.593, Ratio=1.14x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.604, Ratio=1.16x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.599, Ratio=1.16x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.609, Ratio=1.16x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.596, Ratio=1.15x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.613, Ratio=1.15x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.593, Ratio=1.14x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.627, Ratio=1.15x, Gap=-3.264
Batch 300/537: Loss=1.9281 (C:1.9281, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.625, Ratio=1.15x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.15x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.626, Ratio=1.15x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.640, Ratio=1.17x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.635, Ratio=1.18x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.633, Ratio=1.15x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.617, Ratio=1.15x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.601, Ratio=1.14x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.623, Ratio=1.17x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.618, Ratio=1.16x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.607, Ratio=1.17x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.616, Ratio=1.16x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.603, Ratio=1.16x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.593, Ratio=1.16x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.605, Ratio=1.17x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.627, Ratio=1.16x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.624, Ratio=1.14x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.607, Ratio=1.16x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.608, Ratio=1.15x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.624, Ratio=1.16x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.610, Ratio=1.15x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.618, Ratio=1.15x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.618, Ratio=1.17x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.632, Ratio=1.16x, Gap=-3.075
Batch 325/537: Loss=1.9230 (C:1.9230, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.597, Ratio=1.15x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.615, Ratio=1.15x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.621, Ratio=1.17x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.619, Ratio=1.18x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.607, Ratio=1.16x, Gap=-3.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.609, Ratio=1.16x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.619, Ratio=1.15x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.615, Ratio=1.15x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.634, Ratio=1.15x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.628, Ratio=1.16x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.621, Ratio=1.14x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.622, Ratio=1.16x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.622, Ratio=1.16x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.621, Ratio=1.15x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.641, Ratio=1.16x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.626, Ratio=1.15x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.631, Ratio=1.16x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.618, Ratio=1.16x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.613, Ratio=1.15x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.623, Ratio=1.17x, Gap=-2.921
Batch 350/537: Loss=1.9189 (C:1.9189, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.624, Ratio=1.16x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.610, Ratio=1.15x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.614, Ratio=1.15x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.613, Ratio=1.17x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.596, Ratio=1.15x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.612, Ratio=1.17x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.603, Ratio=1.16x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.613, Ratio=1.15x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.615, Ratio=1.17x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.624, Ratio=1.14x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.620, Ratio=1.15x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.633, Ratio=1.17x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.623, Ratio=1.15x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.639, Ratio=1.18x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.626, Ratio=1.17x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.625, Ratio=1.16x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.628, Ratio=1.16x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.613, Ratio=1.15x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.616, Ratio=1.15x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.611, Ratio=1.16x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.615, Ratio=1.14x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.624, Ratio=1.16x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.638, Ratio=1.18x, Gap=-3.093
Batch 375/537: Loss=1.9125 (C:1.9125, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.623, Ratio=1.15x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.629, Ratio=1.16x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.633, Ratio=1.16x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.621, Ratio=1.15x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.624, Ratio=1.15x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.620, Ratio=1.17x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.626, Ratio=1.15x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.623, Ratio=1.16x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.615, Ratio=1.15x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.623, Ratio=1.16x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.628, Ratio=1.17x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.627, Ratio=1.17x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.635, Ratio=1.17x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.620, Ratio=1.16x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.632, Ratio=1.16x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.634, Ratio=1.16x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.643, Ratio=1.17x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.641, Ratio=1.17x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.633, Ratio=1.16x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.634, Ratio=1.15x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.642, Ratio=1.18x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.643, Ratio=1.16x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.620, Ratio=1.15x, Gap=-3.000
Batch 400/537: Loss=1.9279 (C:1.9279, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.628, Ratio=1.15x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.643, Ratio=1.15x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.642, Ratio=1.16x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.628, Ratio=1.16x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.618, Ratio=1.15x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.618, Ratio=1.16x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.604, Ratio=1.15x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.636, Ratio=1.18x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.627, Ratio=1.16x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.626, Ratio=1.15x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.632, Ratio=1.14x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.646, Ratio=1.17x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.649, Ratio=1.16x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.15x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.15x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.645, Ratio=1.16x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.646, Ratio=1.16x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.635, Ratio=1.16x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.634, Ratio=1.15x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.636, Ratio=1.15x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.640, Ratio=1.16x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.635, Ratio=1.16x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.640, Ratio=1.17x, Gap=-2.865
Batch 425/537: Loss=1.9177 (C:1.9177, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.623, Ratio=1.14x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.625, Ratio=1.16x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.629, Ratio=1.16x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.636, Ratio=1.16x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.630, Ratio=1.16x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.632, Ratio=1.16x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.644, Ratio=1.18x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.634, Ratio=1.15x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.637, Ratio=1.16x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.638, Ratio=1.16x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.641, Ratio=1.16x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.644, Ratio=1.17x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.649, Ratio=1.16x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.646, Ratio=1.15x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.655, Ratio=1.16x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.638, Ratio=1.15x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.637, Ratio=1.17x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.636, Ratio=1.17x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.626, Ratio=1.18x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.611, Ratio=1.15x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.637, Ratio=1.15x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.631, Ratio=1.14x, Gap=-2.895
Batch 450/537: Loss=1.9291 (C:1.9291, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.649, Ratio=1.17x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.658, Ratio=1.16x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.15x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.635, Ratio=1.15x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.629, Ratio=1.16x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.632, Ratio=1.16x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.633, Ratio=1.16x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.639, Ratio=1.17x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.626, Ratio=1.16x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.633, Ratio=1.16x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.644, Ratio=1.16x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.629, Ratio=1.14x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.634, Ratio=1.15x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.633, Ratio=1.17x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.611, Ratio=1.15x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.638, Ratio=1.16x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.633, Ratio=1.15x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.632, Ratio=1.15x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.631, Ratio=1.15x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-2.826
Batch 475/537: Loss=1.9231 (C:1.9231, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.636, Ratio=1.16x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.637, Ratio=1.16x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.622, Ratio=1.17x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.623, Ratio=1.16x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.629, Ratio=1.15x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.621, Ratio=1.14x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.633, Ratio=1.16x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.642, Ratio=1.18x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.642, Ratio=1.15x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.641, Ratio=1.17x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.649, Ratio=1.16x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.642, Ratio=1.17x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.644, Ratio=1.16x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.640, Ratio=1.16x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.617, Ratio=1.15x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.618, Ratio=1.14x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.622, Ratio=1.15x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.631, Ratio=1.16x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.623, Ratio=1.16x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.626, Ratio=1.16x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.633, Ratio=1.16x, Gap=-2.879
Batch 500/537: Loss=1.9209 (C:1.9209, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.643, Ratio=1.16x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.17x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.642, Ratio=1.16x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.646, Ratio=1.15x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.646, Ratio=1.15x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.635, Ratio=1.15x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.639, Ratio=1.17x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.643, Ratio=1.17x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.634, Ratio=1.14x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.640, Ratio=1.16x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.629, Ratio=1.16x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.633, Ratio=1.18x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.17x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.616, Ratio=1.16x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.642, Ratio=1.16x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.627, Ratio=1.17x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.630, Ratio=1.15x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.632, Ratio=1.15x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.645, Ratio=1.16x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.647, Ratio=1.15x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.656, Ratio=1.17x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.635, Ratio=1.15x, Gap=-2.742
Batch 525/537: Loss=1.9252 (C:1.9252, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.628, Ratio=1.16x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.627, Ratio=1.16x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.624, Ratio=1.15x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.621, Ratio=1.14x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.626, Ratio=1.15x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.651, Ratio=1.19x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.651, Ratio=1.16x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.635, Ratio=1.18x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.639, Ratio=1.18x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.639, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.637, Ratio=1.18x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.633, Ratio=1.16x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.647, Ratio=1.18x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.614, Ratio=1.17x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.639, Ratio=1.20x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.638, Ratio=1.20x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.637, Ratio=1.17x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.646, Ratio=1.19x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.627, Ratio=1.19x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.643, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.640, Ratio=1.19x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.650, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.634, Ratio=1.18x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.630, Ratio=1.16x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.644, Ratio=1.18x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.640, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.652, Ratio=1.21x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.631, Ratio=1.17x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.628, Ratio=1.16x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.632, Ratio=1.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.639, Ratio=1.16x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.638, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.637, Ratio=1.16x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.625, Ratio=1.15x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.638, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.631, Ratio=1.19x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.621, Ratio=1.15x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.633, Ratio=1.17x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.641, Ratio=1.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.634, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.645, Ratio=1.18x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.640, Ratio=1.19x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.647, Ratio=1.19x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.648, Ratio=1.19x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.637, Ratio=1.17x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.641, Ratio=1.18x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.631, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.634, Ratio=1.18x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.642, Ratio=1.19x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.620, Ratio=1.15x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.636, Ratio=1.18x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.637, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.642, Ratio=1.19x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.634, Ratio=1.16x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.636, Ratio=1.16x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.640, Ratio=1.17x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.632, Ratio=1.16x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.628, Ratio=1.16x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.646, Ratio=1.19x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.627, Ratio=1.17x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.641, Ratio=1.16x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.631, Ratio=1.18x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.641, Ratio=1.18x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.631, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.636, Ratio=1.16x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.631, Ratio=1.19x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.642, Ratio=1.19x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.641, Ratio=1.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.638, Ratio=1.17x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.638, Ratio=1.16x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.625, Ratio=1.17x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.627, Ratio=1.15x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.632, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.641, Ratio=1.19x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.18x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.625, Ratio=1.15x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.624, Ratio=1.18x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.641, Ratio=1.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.630, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.636, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.631, Ratio=1.19x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.638, Ratio=1.17x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.638, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.646, Ratio=1.19x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.633, Ratio=1.17x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.642, Ratio=1.17x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.643, Ratio=1.18x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.634, Ratio=1.18x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.636, Ratio=1.20x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.641, Ratio=1.18x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.643, Ratio=1.18x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.647, Ratio=1.18x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.642, Ratio=1.18x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.623, Ratio=1.17x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.631, Ratio=1.17x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.639, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.633, Ratio=1.19x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.633, Ratio=1.18x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.629, Ratio=1.16x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.635, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.635, Ratio=1.18x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.644, Ratio=1.19x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.633, Ratio=1.19x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.19x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.632, Ratio=1.17x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.628, Ratio=1.17x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.642, Ratio=1.17x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.623, Ratio=1.16x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.636, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.623, Ratio=1.16x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.623, Ratio=1.16x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.639, Ratio=1.18x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.627, Ratio=1.18x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.638, Ratio=1.18x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.621, Ratio=1.15x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.632, Ratio=1.18x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.625, Ratio=1.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.631, Ratio=1.17x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.649, Ratio=1.19x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.632, Ratio=1.17x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.624, Ratio=1.16x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.627, Ratio=1.18x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.645, Ratio=1.19x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.640, Ratio=1.19x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.639, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.634, Ratio=1.17x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.641, Ratio=1.19x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.631, Ratio=1.17x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.630, Ratio=1.16x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.625, Ratio=1.17x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.628, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.627, Ratio=1.17x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.641, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.635, Ratio=1.19x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.627, Ratio=1.16x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.633, Ratio=1.17x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.649, Ratio=1.19x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.633, Ratio=1.17x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.628, Ratio=1.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.632, Ratio=1.17x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.636, Ratio=1.18x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.642, Ratio=1.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.641, Ratio=1.19x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.648, Ratio=1.19x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.647, Ratio=1.19x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.637, Ratio=1.18x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.631, Ratio=1.19x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.646, Ratio=1.19x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.639, Ratio=1.20x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.635, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.638, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.645, Ratio=1.18x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.637, Ratio=1.18x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.641, Ratio=1.19x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.624, Ratio=1.15x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.642, Ratio=1.18x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.629, Ratio=1.16x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.632, Ratio=1.16x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.632, Ratio=1.18x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.641, Ratio=1.20x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.626, Ratio=1.17x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.645, Ratio=1.19x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.628, Ratio=1.18x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.639, Ratio=1.18x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.638, Ratio=1.16x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.632, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.643, Ratio=1.19x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.641, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.639, Ratio=1.18x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.631, Ratio=1.18x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.650, Ratio=1.19x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.645, Ratio=1.17x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.641, Ratio=1.17x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.634, Ratio=1.17x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.639, Ratio=1.18x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.638, Ratio=1.17x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.634, Ratio=1.16x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.625, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.636, Ratio=1.18x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.636, Ratio=1.17x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.619, Ratio=1.17x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.633, Ratio=1.17x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.635, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.636, Ratio=1.18x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.634, Ratio=1.17x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.644, Ratio=1.19x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.646, Ratio=1.19x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.636, Ratio=1.19x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.628, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.641, Ratio=1.16x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.637, Ratio=1.17x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.634, Ratio=1.17x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.639, Ratio=1.18x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.641, Ratio=1.18x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.632, Ratio=1.15x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.639, Ratio=1.18x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.636, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.631, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.623, Ratio=1.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.620, Ratio=1.16x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.634, Ratio=1.17x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.623, Ratio=1.17x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.617, Ratio=1.14x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.636, Ratio=1.16x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.628, Ratio=1.19x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.624, Ratio=1.15x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.17x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.639, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.624, Ratio=1.18x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.631, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.615, Ratio=1.15x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.642, Ratio=1.19x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.629, Ratio=1.19x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.627, Ratio=1.16x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.642, Ratio=1.19x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.638, Ratio=1.19x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.643, Ratio=1.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.638, Ratio=1.18x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.642, Ratio=1.21x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.630, Ratio=1.17x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.634, Ratio=1.17x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.644, Ratio=1.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.620, Ratio=1.16x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.633, Ratio=1.17x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.19x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.628, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.639, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.647, Ratio=1.20x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.649, Ratio=1.19x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.623, Ratio=1.17x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.633, Ratio=1.18x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.643, Ratio=1.20x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.629, Ratio=1.17x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.641, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.636, Ratio=1.18x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.640, Ratio=1.18x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.637, Ratio=1.17x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.642, Ratio=1.18x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.622, Ratio=1.15x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.638, Ratio=1.17x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.646, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.635, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.640, Ratio=1.19x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.624, Ratio=1.16x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.643, Ratio=1.20x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.645, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.630, Ratio=1.17x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.640, Ratio=1.19x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.647, Ratio=1.19x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.636, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.643, Ratio=1.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.631, Ratio=1.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.641, Ratio=1.19x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.619, Ratio=1.16x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.633, Ratio=1.15x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.628, Ratio=1.17x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.647, Ratio=1.18x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.634, Ratio=1.16x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.642, Ratio=1.18x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.644, Ratio=1.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.629, Ratio=1.18x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.640, Ratio=1.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.645, Ratio=1.18x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.640, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.645, Ratio=1.19x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.645, Ratio=1.18x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.625, Ratio=1.17x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.629, Ratio=1.16x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.631, Ratio=1.17x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.642, Ratio=1.18x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.631, Ratio=1.18x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.624, Ratio=1.17x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.632, Ratio=1.16x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.636, Ratio=1.18x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.634, Ratio=1.19x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.642, Ratio=1.19x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.639, Ratio=1.19x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.632, Ratio=1.16x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.633, Ratio=1.18x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.649, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.642, Ratio=1.21x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.643, Ratio=1.18x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.625, Ratio=1.18x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.641, Ratio=1.18x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.628, Ratio=1.17x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.637, Ratio=1.17x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.641, Ratio=1.20x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.630, Ratio=1.18x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.638, Ratio=1.19x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.630, Ratio=1.18x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.630, Ratio=1.16x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.618, Ratio=1.16x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.633, Ratio=1.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.643, Ratio=1.18x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.635, Ratio=1.19x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.626, Ratio=1.16x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.634, Ratio=1.17x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.634, Ratio=1.17x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.651, Ratio=1.20x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.634, Ratio=1.15x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.18x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.644, Ratio=1.19x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.646, Ratio=1.20x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.638, Ratio=1.20x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.632, Ratio=1.16x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.634, Ratio=1.18x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.649, Ratio=1.17x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.630, Ratio=1.18x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.642, Ratio=1.18x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.640, Ratio=1.19x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.635, Ratio=1.16x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.630, Ratio=1.18x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.629, Ratio=1.16x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.620, Ratio=1.16x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.631, Ratio=1.18x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.635, Ratio=1.20x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.642, Ratio=1.17x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.636, Ratio=1.17x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.630, Ratio=1.15x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.622, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.635, Ratio=1.17x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.633, Ratio=1.19x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.648, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.626, Ratio=1.18x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.636, Ratio=1.18x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.647, Ratio=1.19x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.637, Ratio=1.18x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.645, Ratio=1.18x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.641, Ratio=1.17x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.646, Ratio=1.20x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.634, Ratio=1.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.641, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.634, Ratio=1.17x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.638, Ratio=1.18x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.642, Ratio=1.16x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.622, Ratio=1.19x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.640, Ratio=1.17x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.642, Ratio=1.20x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.637, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.637, Ratio=1.16x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.643, Ratio=1.19x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.641, Ratio=1.17x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.637, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.628, Ratio=1.18x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.630, Ratio=1.16x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.642, Ratio=1.19x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.638, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.636, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.635, Ratio=1.18x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.644, Ratio=1.17x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.641, Ratio=1.19x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.628, Ratio=1.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.635, Ratio=1.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.644, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.651, Ratio=1.21x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.639, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.637, Ratio=1.19x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.632, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.633, Ratio=1.16x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.642, Ratio=1.19x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.629, Ratio=1.17x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.633, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.635, Ratio=1.18x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.632, Ratio=1.17x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.633, Ratio=1.18x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.644, Ratio=1.18x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.641, Ratio=1.19x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.634, Ratio=1.19x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.634, Ratio=1.17x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.640, Ratio=1.19x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.645, Ratio=1.20x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.629, Ratio=1.17x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.618, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.633, Ratio=1.18x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.640, Ratio=1.18x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.637, Ratio=1.16x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.626, Ratio=1.15x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.633, Ratio=1.18x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.642, Ratio=1.20x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.635, Ratio=1.17x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.638, Ratio=1.17x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.643, Ratio=1.19x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.623, Ratio=1.17x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.633, Ratio=1.18x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.634, Ratio=1.18x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.634, Ratio=1.18x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.645, Ratio=1.19x, Gap=-2.476

============================================================
Epoch 1/20 completed in 37.9s
Train: Loss=1.9352 (C:1.9352, R:0.0000) Ratio=1.59x
Val:   Loss=1.9126 (C:1.9126, R:0.0000) Ratio=1.89x
‚úÖ New best model saved (Val Loss: 1.9126)
============================================================

Epoch 2 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.638, Ratio=1.16x, Gap=-2.736
Batch   0/537: Loss=1.9209 (C:1.9209, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.643, Ratio=1.17x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.640, Ratio=1.15x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.634, Ratio=1.17x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.17x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.624, Ratio=1.17x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.641, Ratio=1.16x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.632, Ratio=1.16x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.642, Ratio=1.17x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.636, Ratio=1.17x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.639, Ratio=1.16x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.636, Ratio=1.18x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.639, Ratio=1.17x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.645, Ratio=1.16x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.650, Ratio=1.16x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.636, Ratio=1.16x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.650, Ratio=1.17x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.643, Ratio=1.16x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.636, Ratio=1.16x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.631, Ratio=1.15x, Gap=-2.943
Batch  25/537: Loss=1.9242 (C:1.9242, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.636, Ratio=1.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.633, Ratio=1.19x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.616, Ratio=1.15x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.638, Ratio=1.19x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.629, Ratio=1.17x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.634, Ratio=1.18x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.645, Ratio=1.17x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.652, Ratio=1.17x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.653, Ratio=1.16x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.665, Ratio=1.17x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.647, Ratio=1.16x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.637, Ratio=1.17x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.633, Ratio=1.17x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.631, Ratio=1.16x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.627, Ratio=1.16x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.638, Ratio=1.16x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.636, Ratio=1.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.624, Ratio=1.17x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.634, Ratio=1.15x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.640, Ratio=1.17x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.637, Ratio=1.16x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.641, Ratio=1.16x, Gap=-2.916
Batch  50/537: Loss=1.9187 (C:1.9187, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.652, Ratio=1.16x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.643, Ratio=1.16x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.638, Ratio=1.18x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.637, Ratio=1.16x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.630, Ratio=1.16x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.621, Ratio=1.17x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.614, Ratio=1.18x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.630, Ratio=1.17x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.630, Ratio=1.17x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.649, Ratio=1.18x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.636, Ratio=1.16x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.16x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.648, Ratio=1.15x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.663, Ratio=1.16x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.653, Ratio=1.16x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.662, Ratio=1.18x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.653, Ratio=1.15x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.640, Ratio=1.18x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.634, Ratio=1.16x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.626, Ratio=1.17x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.624, Ratio=1.16x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=0.610, Ratio=1.16x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.624, Ratio=1.16x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.628, Ratio=1.18x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.635, Ratio=1.17x, Gap=-2.860
Batch  75/537: Loss=1.9171 (C:1.9171, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.637, Ratio=1.17x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.645, Ratio=1.16x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.636, Ratio=1.15x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.657, Ratio=1.17x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.665, Ratio=1.18x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.655, Ratio=1.16x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.657, Ratio=1.17x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.655, Ratio=1.16x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.656, Ratio=1.18x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.651, Ratio=1.17x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.636, Ratio=1.16x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.644, Ratio=1.16x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.628, Ratio=1.17x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.620, Ratio=1.17x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.634, Ratio=1.17x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.619, Ratio=1.15x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.624, Ratio=1.16x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.639, Ratio=1.16x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.625, Ratio=1.16x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.16x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.667, Ratio=1.18x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.656, Ratio=1.16x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.16x, Gap=-2.904
Batch 100/537: Loss=1.9164 (C:1.9164, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.646, Ratio=1.18x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.629, Ratio=1.17x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.626, Ratio=1.17x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.625, Ratio=1.17x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.640, Ratio=1.17x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.624, Ratio=1.17x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.649, Ratio=1.17x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.631, Ratio=1.15x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.646, Ratio=1.18x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.17x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.639, Ratio=1.17x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.626, Ratio=1.17x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.636, Ratio=1.16x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.627, Ratio=1.17x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.625, Ratio=1.16x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.631, Ratio=1.16x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.628, Ratio=1.15x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.643, Ratio=1.17x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.648, Ratio=1.18x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.636, Ratio=1.15x, Gap=-2.918
Batch 125/537: Loss=1.9260 (C:1.9260, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.17x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.635, Ratio=1.16x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.645, Ratio=1.17x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.630, Ratio=1.15x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.652, Ratio=1.19x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.650, Ratio=1.18x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.640, Ratio=1.18x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.652, Ratio=1.18x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.647, Ratio=1.16x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.640, Ratio=1.18x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.637, Ratio=1.17x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.633, Ratio=1.16x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.646, Ratio=1.17x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.633, Ratio=1.16x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.648, Ratio=1.15x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.644, Ratio=1.17x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.645, Ratio=1.17x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.636, Ratio=1.16x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.650, Ratio=1.18x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.640, Ratio=1.16x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.643, Ratio=1.17x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.659, Ratio=1.18x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.643, Ratio=1.17x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.633, Ratio=1.15x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.643, Ratio=1.15x, Gap=-2.778
Batch 150/537: Loss=1.9257 (C:1.9257, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.652, Ratio=1.17x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.654, Ratio=1.17x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.655, Ratio=1.16x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.16x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.642, Ratio=1.16x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.640, Ratio=1.16x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.655, Ratio=1.16x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.630, Ratio=1.16x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.638, Ratio=1.18x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.635, Ratio=1.14x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.639, Ratio=1.16x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.653, Ratio=1.17x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.638, Ratio=1.16x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.656, Ratio=1.15x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.658, Ratio=1.16x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.647, Ratio=1.16x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.637, Ratio=1.15x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.647, Ratio=1.17x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.632, Ratio=1.18x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.636, Ratio=1.16x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.619, Ratio=1.15x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.643, Ratio=1.19x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.638, Ratio=1.15x, Gap=-2.779
Batch 175/537: Loss=1.9227 (C:1.9227, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.643, Ratio=1.16x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.18x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.659, Ratio=1.16x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.662, Ratio=1.16x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.661, Ratio=1.17x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.643, Ratio=1.15x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.645, Ratio=1.16x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.648, Ratio=1.15x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.650, Ratio=1.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.641, Ratio=1.18x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.628, Ratio=1.16x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.639, Ratio=1.17x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.637, Ratio=1.17x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.633, Ratio=1.17x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.640, Ratio=1.16x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.651, Ratio=1.16x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.645, Ratio=1.15x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.655, Ratio=1.16x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.653, Ratio=1.14x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.17x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.652, Ratio=1.18x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.640, Ratio=1.16x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.638, Ratio=1.15x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.651, Ratio=1.17x, Gap=-2.729
Batch 200/537: Loss=1.9118 (C:1.9118, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.656, Ratio=1.16x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.646, Ratio=1.15x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.16x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.658, Ratio=1.16x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.642, Ratio=1.16x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.655, Ratio=1.17x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.656, Ratio=1.17x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.646, Ratio=1.16x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.664, Ratio=1.18x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.664, Ratio=1.16x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.664, Ratio=1.16x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.669, Ratio=1.16x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.666, Ratio=1.17x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.661, Ratio=1.18x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.653, Ratio=1.15x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.643, Ratio=1.16x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.647, Ratio=1.17x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.647, Ratio=1.16x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.653, Ratio=1.18x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.655, Ratio=1.16x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.687, Ratio=1.17x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.685, Ratio=1.15x, Gap=-2.823
Batch 225/537: Loss=1.9200 (C:1.9200, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.674, Ratio=1.17x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.681, Ratio=1.17x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.666, Ratio=1.16x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.662, Ratio=1.17x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.663, Ratio=1.15x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.670, Ratio=1.16x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.663, Ratio=1.17x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.660, Ratio=1.16x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.665, Ratio=1.16x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.17x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.658, Ratio=1.15x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.665, Ratio=1.16x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.663, Ratio=1.16x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.652, Ratio=1.15x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.646, Ratio=1.15x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.652, Ratio=1.14x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.646, Ratio=1.15x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.657, Ratio=1.15x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.640, Ratio=1.18x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.653, Ratio=1.16x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.659, Ratio=1.16x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.644, Ratio=1.15x, Gap=-3.170
Batch 250/537: Loss=1.9236 (C:1.9236, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.660, Ratio=1.18x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.649, Ratio=1.15x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.664, Ratio=1.16x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.660, Ratio=1.16x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.667, Ratio=1.15x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.670, Ratio=1.17x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.660, Ratio=1.16x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.665, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.661, Ratio=1.17x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.656, Ratio=1.17x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.653, Ratio=1.15x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.652, Ratio=1.14x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.642, Ratio=1.14x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.644, Ratio=1.15x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.654, Ratio=1.17x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.650, Ratio=1.16x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.656, Ratio=1.16x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.656, Ratio=1.16x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.654, Ratio=1.17x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.659, Ratio=1.17x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.669, Ratio=1.16x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.658, Ratio=1.14x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.666, Ratio=1.17x, Gap=-2.703
Batch 275/537: Loss=1.9120 (C:1.9120, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.654, Ratio=1.18x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.664, Ratio=1.17x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.671, Ratio=1.16x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.659, Ratio=1.16x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.653, Ratio=1.18x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.654, Ratio=1.17x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.662, Ratio=1.16x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.678, Ratio=1.17x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.672, Ratio=1.15x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.678, Ratio=1.18x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.667, Ratio=1.14x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.673, Ratio=1.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.666, Ratio=1.16x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.662, Ratio=1.14x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.674, Ratio=1.17x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.670, Ratio=1.16x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.642, Ratio=1.15x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.650, Ratio=1.14x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.645, Ratio=1.16x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.646, Ratio=1.15x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.652, Ratio=1.16x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.641, Ratio=1.16x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.749
Batch 300/537: Loss=1.9144 (C:1.9144, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.643, Ratio=1.16x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.644, Ratio=1.16x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.656, Ratio=1.16x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.653, Ratio=1.15x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.658, Ratio=1.16x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.656, Ratio=1.17x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.657, Ratio=1.15x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.665, Ratio=1.19x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.657, Ratio=1.16x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.663, Ratio=1.16x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.675, Ratio=1.16x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.671, Ratio=1.15x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.667, Ratio=1.17x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.656, Ratio=1.16x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.660, Ratio=1.15x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.668, Ratio=1.16x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.659, Ratio=1.17x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.670, Ratio=1.17x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.660, Ratio=1.16x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.662, Ratio=1.16x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.661, Ratio=1.15x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.654, Ratio=1.16x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.664, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.658, Ratio=1.15x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.665, Ratio=1.17x, Gap=-2.788
Batch 325/537: Loss=1.9107 (C:1.9107, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.661, Ratio=1.19x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.649, Ratio=1.16x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.661, Ratio=1.17x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.667, Ratio=1.16x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.665, Ratio=1.17x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.656, Ratio=1.16x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.670, Ratio=1.17x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.659, Ratio=1.14x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.660, Ratio=1.16x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.655, Ratio=1.15x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.662, Ratio=1.15x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.647, Ratio=1.16x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.643, Ratio=1.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.635, Ratio=1.13x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.651, Ratio=1.18x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.637, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.642, Ratio=1.18x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.658, Ratio=1.18x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.667, Ratio=1.15x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.664, Ratio=1.15x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.682, Ratio=1.17x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.666, Ratio=1.16x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.676, Ratio=1.17x, Gap=-2.741
Batch 350/537: Loss=1.9134 (C:1.9134, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.658, Ratio=1.14x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.671, Ratio=1.16x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.651, Ratio=1.15x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.647, Ratio=1.15x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.634, Ratio=1.15x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.631, Ratio=1.16x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.643, Ratio=1.15x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.655, Ratio=1.17x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.649, Ratio=1.16x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.16x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.649, Ratio=1.17x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.656, Ratio=1.17x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.647, Ratio=1.16x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.652, Ratio=1.14x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.660, Ratio=1.16x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.671, Ratio=1.17x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.667, Ratio=1.17x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.655, Ratio=1.16x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.638, Ratio=1.15x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.650, Ratio=1.17x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.642, Ratio=1.17x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.653, Ratio=1.15x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.653, Ratio=1.15x, Gap=-2.655
Batch 375/537: Loss=1.9241 (C:1.9241, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.670, Ratio=1.17x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.667, Ratio=1.17x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.687, Ratio=1.18x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.676, Ratio=1.16x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.676, Ratio=1.15x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.662, Ratio=1.16x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.661, Ratio=1.17x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.654, Ratio=1.17x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.641, Ratio=1.15x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.653, Ratio=1.16x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.660, Ratio=1.18x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.661, Ratio=1.17x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.658, Ratio=1.16x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.656, Ratio=1.17x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.661, Ratio=1.16x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.648, Ratio=1.15x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.668, Ratio=1.17x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.663, Ratio=1.17x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.658, Ratio=1.17x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.649, Ratio=1.14x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.16x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.637, Ratio=1.16x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.640, Ratio=1.14x, Gap=-2.710
Batch 400/537: Loss=1.9266 (C:1.9266, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.646, Ratio=1.16x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.649, Ratio=1.17x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.17x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.657, Ratio=1.16x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.651, Ratio=1.17x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.645, Ratio=1.15x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.667, Ratio=1.16x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.664, Ratio=1.18x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.642, Ratio=1.14x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.659, Ratio=1.18x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.638, Ratio=1.14x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.635, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.632, Ratio=1.18x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.616, Ratio=1.17x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.629, Ratio=1.17x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.632, Ratio=1.16x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.656, Ratio=1.18x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.644, Ratio=1.16x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.659, Ratio=1.18x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.721
Batch 425/537: Loss=1.9152 (C:1.9152, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.648, Ratio=1.17x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.659, Ratio=1.15x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.659, Ratio=1.19x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.650, Ratio=1.17x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.645, Ratio=1.16x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.653, Ratio=1.16x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.639, Ratio=1.15x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.647, Ratio=1.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.641, Ratio=1.18x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.638, Ratio=1.17x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.648, Ratio=1.18x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.642, Ratio=1.16x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.638, Ratio=1.17x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.628, Ratio=1.16x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.642, Ratio=1.17x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.643, Ratio=1.17x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.651, Ratio=1.16x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.644, Ratio=1.15x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.660, Ratio=1.18x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.662, Ratio=1.17x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.661, Ratio=1.17x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.665, Ratio=1.16x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.675, Ratio=1.18x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.667, Ratio=1.16x, Gap=-2.807
Batch 450/537: Loss=1.9165 (C:1.9165, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.668, Ratio=1.16x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.672, Ratio=1.17x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.652, Ratio=1.17x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.654, Ratio=1.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.635, Ratio=1.16x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.637, Ratio=1.18x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.650, Ratio=1.17x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.636, Ratio=1.16x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.640, Ratio=1.16x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.659, Ratio=1.16x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.657, Ratio=1.17x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.672, Ratio=1.16x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.671, Ratio=1.16x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.674, Ratio=1.17x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.669, Ratio=1.16x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.678, Ratio=1.18x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.657, Ratio=1.16x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.676, Ratio=1.17x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.660, Ratio=1.16x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.660, Ratio=1.15x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.649, Ratio=1.16x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.642, Ratio=1.15x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.634, Ratio=1.15x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.658, Ratio=1.18x, Gap=-2.591
Batch 475/537: Loss=1.9057 (C:1.9057, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.649, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.653, Ratio=1.17x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.668, Ratio=1.17x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.676, Ratio=1.17x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.674, Ratio=1.15x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.665, Ratio=1.16x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.672, Ratio=1.18x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.671, Ratio=1.15x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.670, Ratio=1.16x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.646, Ratio=1.15x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.659, Ratio=1.17x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.644, Ratio=1.16x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.645, Ratio=1.16x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.661, Ratio=1.17x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.656, Ratio=1.17x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.659, Ratio=1.18x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.669, Ratio=1.14x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.661, Ratio=1.14x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.687, Ratio=1.18x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.678, Ratio=1.17x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.689, Ratio=1.18x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.679, Ratio=1.16x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.674, Ratio=1.15x, Gap=-2.680
Batch 500/537: Loss=1.9219 (C:1.9219, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.660, Ratio=1.15x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.668, Ratio=1.17x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.657, Ratio=1.15x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.644, Ratio=1.14x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.639, Ratio=1.15x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.636, Ratio=1.19x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.642, Ratio=1.18x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.629, Ratio=1.15x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.640, Ratio=1.15x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.658, Ratio=1.17x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.670, Ratio=1.19x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.676, Ratio=1.16x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.672, Ratio=1.15x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.662, Ratio=1.14x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.675, Ratio=1.17x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.661, Ratio=1.16x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.672, Ratio=1.17x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.670, Ratio=1.18x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.665, Ratio=1.16x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.666, Ratio=1.17x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.667, Ratio=1.14x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.668, Ratio=1.20x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.669, Ratio=1.16x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.672, Ratio=1.17x, Gap=-2.645
Batch 525/537: Loss=1.9106 (C:1.9106, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.656, Ratio=1.16x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.645, Ratio=1.18x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.663, Ratio=1.17x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.663, Ratio=1.16x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.663, Ratio=1.17x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.665, Ratio=1.17x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.666, Ratio=1.17x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.666, Ratio=1.15x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.666, Ratio=1.15x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.655, Ratio=1.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.664, Ratio=1.18x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.653, Ratio=1.18x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.648, Ratio=1.17x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.666, Ratio=1.18x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.659, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.649, Ratio=1.18x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.651, Ratio=1.15x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.664, Ratio=1.19x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.656, Ratio=1.19x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.656, Ratio=1.19x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.641, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.657, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.18x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.648, Ratio=1.16x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.660, Ratio=1.20x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.654, Ratio=1.17x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.667, Ratio=1.18x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.650, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.647, Ratio=1.18x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.658, Ratio=1.18x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.662, Ratio=1.19x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.654, Ratio=1.19x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.658, Ratio=1.18x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.652, Ratio=1.19x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.662, Ratio=1.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.654, Ratio=1.17x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.666, Ratio=1.19x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.650, Ratio=1.17x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.645, Ratio=1.17x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.659, Ratio=1.17x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.637, Ratio=1.17x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.658, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.660, Ratio=1.18x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.644, Ratio=1.17x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.663, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.647, Ratio=1.18x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.656, Ratio=1.19x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.657, Ratio=1.19x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.658, Ratio=1.19x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.655, Ratio=1.19x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.666, Ratio=1.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.650, Ratio=1.19x, Gap=-2.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.654, Ratio=1.17x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.655, Ratio=1.19x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.649, Ratio=1.17x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.17x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.16x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.651, Ratio=1.15x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.652, Ratio=1.17x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.662, Ratio=1.20x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.658, Ratio=1.18x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.642, Ratio=1.18x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.659, Ratio=1.17x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.656, Ratio=1.18x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.655, Ratio=1.19x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.654, Ratio=1.19x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.658, Ratio=1.18x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.658, Ratio=1.19x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.669, Ratio=1.20x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.654, Ratio=1.18x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.16x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.648, Ratio=1.16x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.663, Ratio=1.20x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.670, Ratio=1.17x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.659, Ratio=1.18x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.654, Ratio=1.18x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.651, Ratio=1.18x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.657, Ratio=1.16x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.647, Ratio=1.16x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.18x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.661, Ratio=1.18x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.649, Ratio=1.18x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.670, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.652, Ratio=1.17x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.662, Ratio=1.19x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.654, Ratio=1.17x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.670, Ratio=1.18x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.662, Ratio=1.19x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.649, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.653, Ratio=1.19x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.651, Ratio=1.17x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.660, Ratio=1.18x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.644, Ratio=1.18x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.657, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.659, Ratio=1.18x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.648, Ratio=1.17x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.657, Ratio=1.17x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.650, Ratio=1.20x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.648, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.663, Ratio=1.20x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.656, Ratio=1.17x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.649, Ratio=1.17x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.657, Ratio=1.20x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.645, Ratio=1.18x, Gap=-2.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.651, Ratio=1.15x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.651, Ratio=1.17x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.652, Ratio=1.17x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.656, Ratio=1.17x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.652, Ratio=1.17x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.654, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.648, Ratio=1.18x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.651, Ratio=1.18x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.654, Ratio=1.17x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.17x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.656, Ratio=1.17x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.664, Ratio=1.20x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.664, Ratio=1.20x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.648, Ratio=1.19x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.648, Ratio=1.16x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.651, Ratio=1.16x, Gap=-2.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.18x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.668, Ratio=1.19x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.654, Ratio=1.19x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.659, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.657, Ratio=1.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.657, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.646, Ratio=1.18x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.18x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.660, Ratio=1.17x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.662, Ratio=1.19x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.648, Ratio=1.18x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.658, Ratio=1.17x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.640, Ratio=1.15x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.656, Ratio=1.16x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.16x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.650, Ratio=1.17x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.665, Ratio=1.19x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.651, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.646, Ratio=1.18x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.658, Ratio=1.17x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.659, Ratio=1.17x, Gap=-2.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.644, Ratio=1.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.17x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.646, Ratio=1.15x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.649, Ratio=1.16x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.663, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.17x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.649, Ratio=1.17x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.649, Ratio=1.17x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.649, Ratio=1.17x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.653, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.643, Ratio=1.18x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.659, Ratio=1.19x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.663, Ratio=1.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.650, Ratio=1.16x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.652, Ratio=1.15x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.647, Ratio=1.16x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.660, Ratio=1.18x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.659, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.661, Ratio=1.17x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.656, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.664, Ratio=1.19x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.650, Ratio=1.18x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.656, Ratio=1.19x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.653, Ratio=1.19x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.637, Ratio=1.16x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.657, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.660, Ratio=1.17x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.651, Ratio=1.16x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.645, Ratio=1.17x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.657, Ratio=1.17x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.659, Ratio=1.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.658, Ratio=1.17x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.649, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.645, Ratio=1.17x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.644, Ratio=1.17x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.18x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.658, Ratio=1.18x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.656, Ratio=1.17x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.648, Ratio=1.19x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.658, Ratio=1.18x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.652, Ratio=1.19x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.657, Ratio=1.18x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.640, Ratio=1.15x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.662, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.658, Ratio=1.18x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.655, Ratio=1.17x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.656, Ratio=1.20x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.660, Ratio=1.18x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.659, Ratio=1.19x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.17x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.661, Ratio=1.18x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.648, Ratio=1.19x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.655, Ratio=1.19x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.648, Ratio=1.19x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.18x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.649, Ratio=1.18x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.656, Ratio=1.20x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.659, Ratio=1.18x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.648, Ratio=1.19x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.656, Ratio=1.16x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.655, Ratio=1.17x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.649, Ratio=1.16x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.657, Ratio=1.17x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.656, Ratio=1.17x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.662, Ratio=1.19x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.650, Ratio=1.18x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.661, Ratio=1.19x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.661, Ratio=1.18x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.641, Ratio=1.17x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.643, Ratio=1.16x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.17x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.649, Ratio=1.16x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.655, Ratio=1.19x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.662, Ratio=1.18x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.648, Ratio=1.15x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.659, Ratio=1.16x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.654, Ratio=1.18x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.659, Ratio=1.16x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.646, Ratio=1.17x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.645, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.663, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.653, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.655, Ratio=1.19x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.652, Ratio=1.18x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.654, Ratio=1.18x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.662, Ratio=1.19x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.651, Ratio=1.17x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.654, Ratio=1.18x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.650, Ratio=1.18x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.655, Ratio=1.18x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.642, Ratio=1.16x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.653, Ratio=1.17x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.663, Ratio=1.19x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.649, Ratio=1.15x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.645, Ratio=1.19x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.656, Ratio=1.18x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.646, Ratio=1.17x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.661, Ratio=1.21x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.665, Ratio=1.21x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.656, Ratio=1.18x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.655, Ratio=1.17x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.651, Ratio=1.16x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.648, Ratio=1.18x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.655, Ratio=1.20x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.648, Ratio=1.17x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.652, Ratio=1.17x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.652, Ratio=1.19x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.656, Ratio=1.17x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.668, Ratio=1.19x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.647, Ratio=1.17x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.657, Ratio=1.16x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.651, Ratio=1.19x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.659, Ratio=1.18x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.17x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.636, Ratio=1.15x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.663, Ratio=1.20x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.651, Ratio=1.19x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.652, Ratio=1.16x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.645, Ratio=1.17x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.650, Ratio=1.17x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.657, Ratio=1.19x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.659, Ratio=1.16x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.656, Ratio=1.19x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.649, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.661, Ratio=1.21x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-2.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.658, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.661, Ratio=1.18x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.651, Ratio=1.20x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.656, Ratio=1.18x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.652, Ratio=1.19x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.650, Ratio=1.15x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.651, Ratio=1.17x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.657, Ratio=1.19x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.656, Ratio=1.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.660, Ratio=1.18x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.650, Ratio=1.17x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.659, Ratio=1.21x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.17x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.17x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.660, Ratio=1.18x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.669, Ratio=1.21x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.656, Ratio=1.17x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.655, Ratio=1.18x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.17x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.644, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.18x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.661, Ratio=1.19x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.655, Ratio=1.16x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.653, Ratio=1.17x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.664, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.649, Ratio=1.19x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.653, Ratio=1.17x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.656, Ratio=1.17x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.639, Ratio=1.17x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.654, Ratio=1.16x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.658, Ratio=1.17x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.654, Ratio=1.19x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.650, Ratio=1.17x, Gap=-2.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.647, Ratio=1.18x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.656, Ratio=1.19x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.649, Ratio=1.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.653, Ratio=1.16x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.661, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.651, Ratio=1.16x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.654, Ratio=1.17x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.659, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.659, Ratio=1.19x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.662, Ratio=1.22x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.655, Ratio=1.17x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.661, Ratio=1.17x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.649, Ratio=1.16x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.651, Ratio=1.18x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.654, Ratio=1.19x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.649, Ratio=1.18x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.657, Ratio=1.19x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.656, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.662, Ratio=1.19x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.648, Ratio=1.14x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.653, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.649, Ratio=1.19x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.650, Ratio=1.18x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.652, Ratio=1.15x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.655, Ratio=1.17x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.656, Ratio=1.19x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.649, Ratio=1.16x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.657, Ratio=1.16x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.649, Ratio=1.17x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.655, Ratio=1.20x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.659, Ratio=1.17x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.655, Ratio=1.19x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.647, Ratio=1.18x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.666, Ratio=1.21x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.652, Ratio=1.16x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.658, Ratio=1.18x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.656, Ratio=1.18x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.650, Ratio=1.19x, Gap=-2.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.653, Ratio=1.18x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.653, Ratio=1.16x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.644, Ratio=1.18x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.658, Ratio=1.19x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.645, Ratio=1.17x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.654, Ratio=1.19x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.654, Ratio=1.16x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.658, Ratio=1.17x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.647, Ratio=1.15x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.657, Ratio=1.19x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.658, Ratio=1.16x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.659, Ratio=1.19x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.659, Ratio=1.20x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.654, Ratio=1.19x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.652, Ratio=1.19x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.647, Ratio=1.19x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.648, Ratio=1.17x, Gap=-2.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.660, Ratio=1.18x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.659, Ratio=1.18x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.650, Ratio=1.15x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.657, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.654, Ratio=1.15x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.661, Ratio=1.17x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.653, Ratio=1.18x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.654, Ratio=1.18x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.659, Ratio=1.20x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.646, Ratio=1.18x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.657, Ratio=1.16x, Gap=-2.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.659, Ratio=1.18x, Gap=-2.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.654, Ratio=1.18x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.667, Ratio=1.19x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.657, Ratio=1.18x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.657, Ratio=1.17x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.657, Ratio=1.20x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.649, Ratio=1.19x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.657, Ratio=1.19x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.647, Ratio=1.18x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.17x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.659, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.18x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.661, Ratio=1.19x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.655, Ratio=1.18x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.650, Ratio=1.18x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.652, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.651, Ratio=1.18x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.656, Ratio=1.20x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.652, Ratio=1.18x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.652, Ratio=1.18x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.663, Ratio=1.18x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.658, Ratio=1.19x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.648, Ratio=1.18x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.656, Ratio=1.16x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.17x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.663, Ratio=1.18x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.654, Ratio=1.18x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.641, Ratio=1.16x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.658, Ratio=1.18x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.651, Ratio=1.20x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.648, Ratio=1.16x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.649, Ratio=1.17x, Gap=-2.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.661, Ratio=1.18x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.660, Ratio=1.17x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.660, Ratio=1.19x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.647, Ratio=1.19x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.654, Ratio=1.17x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.651, Ratio=1.16x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.663, Ratio=1.18x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.654, Ratio=1.16x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.648, Ratio=1.18x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.655, Ratio=1.19x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.657, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.647, Ratio=1.18x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.664, Ratio=1.20x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.652, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.640, Ratio=1.15x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.655, Ratio=1.16x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.651, Ratio=1.17x, Gap=-2.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.657, Ratio=1.17x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.654, Ratio=1.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.657, Ratio=1.18x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.658, Ratio=1.17x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.658, Ratio=1.18x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.652, Ratio=1.17x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.653, Ratio=1.16x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.650, Ratio=1.18x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.649, Ratio=1.19x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.650, Ratio=1.16x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.665, Ratio=1.18x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.647, Ratio=1.18x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.664, Ratio=1.18x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.654, Ratio=1.20x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.650, Ratio=1.16x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.661, Ratio=1.19x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.662, Ratio=1.20x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.655, Ratio=1.18x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.656, Ratio=1.19x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.659, Ratio=1.17x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.643, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.658, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.659, Ratio=1.17x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.660, Ratio=1.18x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.660, Ratio=1.19x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.654, Ratio=1.18x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.662, Ratio=1.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.660, Ratio=1.18x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.656, Ratio=1.19x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.641, Ratio=1.18x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.661, Ratio=1.17x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.647, Ratio=1.16x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.646, Ratio=1.17x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.664, Ratio=1.19x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.658, Ratio=1.20x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.648, Ratio=1.16x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.662, Ratio=1.17x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.666, Ratio=1.18x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.650, Ratio=1.16x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.659, Ratio=1.18x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.648, Ratio=1.16x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.17x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.658, Ratio=1.17x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.654, Ratio=1.17x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.658, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.17x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.656, Ratio=1.17x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.655, Ratio=1.17x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.647, Ratio=1.16x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.662, Ratio=1.18x, Gap=-2.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.651, Ratio=1.19x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.658, Ratio=1.17x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.661, Ratio=1.18x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.649, Ratio=1.18x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.639, Ratio=1.15x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.660, Ratio=1.20x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.649, Ratio=1.19x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.651, Ratio=1.16x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.652, Ratio=1.17x, Gap=-2.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.666, Ratio=1.19x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.653, Ratio=1.18x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.650, Ratio=1.17x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.654, Ratio=1.17x, Gap=-2.470

============================================================
Epoch 2/20 completed in 29.1s
Train: Loss=1.9161 (C:1.9161, R:0.0000) Ratio=1.79x
Val:   Loss=1.9075 (C:1.9075, R:0.0000) Ratio=1.95x
‚úÖ New best model saved (Val Loss: 1.9075)
============================================================

Epoch 3 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.654, Ratio=1.16x, Gap=-2.762
Batch   0/537: Loss=1.9153 (C:1.9153, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.649, Ratio=1.15x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.658, Ratio=1.19x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.657, Ratio=1.15x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.653, Ratio=1.17x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.657, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.664, Ratio=1.19x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.661, Ratio=1.15x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.658, Ratio=1.16x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.656, Ratio=1.16x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.667, Ratio=1.17x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.662, Ratio=1.15x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.654, Ratio=1.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.661, Ratio=1.16x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.18x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.659, Ratio=1.16x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.646, Ratio=1.16x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.653, Ratio=1.17x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.646, Ratio=1.18x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.644, Ratio=1.17x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.653, Ratio=1.17x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.647, Ratio=1.17x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.652, Ratio=1.16x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.647, Ratio=1.16x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.658, Ratio=1.17x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.652, Ratio=1.17x, Gap=-2.721
Batch  25/537: Loss=1.9154 (C:1.9154, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.641, Ratio=1.16x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.657, Ratio=1.16x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.658, Ratio=1.18x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.651, Ratio=1.16x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.656, Ratio=1.18x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.646, Ratio=1.16x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.643, Ratio=1.15x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.655, Ratio=1.15x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.642, Ratio=1.16x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.649, Ratio=1.16x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.645, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.662, Ratio=1.18x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.652, Ratio=1.18x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.645, Ratio=1.15x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.661, Ratio=1.18x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.667, Ratio=1.18x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.689, Ratio=1.20x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.675, Ratio=1.15x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.695, Ratio=1.18x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.680, Ratio=1.18x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.671, Ratio=1.18x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.680, Ratio=1.17x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.676, Ratio=1.16x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.661, Ratio=1.18x, Gap=-2.716
Batch  50/537: Loss=1.9073 (C:1.9073, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.670, Ratio=1.17x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.658, Ratio=1.16x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.647, Ratio=1.18x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.671, Ratio=1.18x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.660, Ratio=1.16x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.673, Ratio=1.19x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.672, Ratio=1.17x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.681, Ratio=1.18x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.681, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.689, Ratio=1.16x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.693, Ratio=1.16x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.680, Ratio=1.17x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.663, Ratio=1.15x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.670, Ratio=1.17x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.660, Ratio=1.18x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.650, Ratio=1.15x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.670, Ratio=1.17x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.677, Ratio=1.18x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.663, Ratio=1.14x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.664, Ratio=1.15x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.671, Ratio=1.16x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.675, Ratio=1.18x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.681, Ratio=1.17x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.672, Ratio=1.16x, Gap=-2.702
Batch  75/537: Loss=1.9136 (C:1.9136, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.676, Ratio=1.17x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.678, Ratio=1.16x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.667, Ratio=1.17x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.668, Ratio=1.16x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.664, Ratio=1.16x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.653, Ratio=1.16x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.666, Ratio=1.17x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.668, Ratio=1.18x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.663, Ratio=1.17x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.665, Ratio=1.16x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.664, Ratio=1.16x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.666, Ratio=1.17x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.660, Ratio=1.16x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.669, Ratio=1.17x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.666, Ratio=1.17x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.652, Ratio=1.17x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.663, Ratio=1.15x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.659, Ratio=1.18x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.665, Ratio=1.16x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.681, Ratio=1.18x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.664, Ratio=1.18x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.670, Ratio=1.18x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.672, Ratio=1.17x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.669, Ratio=1.16x, Gap=-2.736
Batch 100/537: Loss=1.9169 (C:1.9169, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.663, Ratio=1.17x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.681, Ratio=1.18x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.665, Ratio=1.16x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.662, Ratio=1.17x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.664, Ratio=1.16x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.657, Ratio=1.16x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.663, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.652, Ratio=1.16x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.644, Ratio=1.16x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.643, Ratio=1.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.664, Ratio=1.16x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.658, Ratio=1.16x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.671, Ratio=1.17x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.670, Ratio=1.17x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.681, Ratio=1.18x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.673, Ratio=1.16x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.678, Ratio=1.18x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.673, Ratio=1.15x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.673, Ratio=1.17x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.659, Ratio=1.16x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.660, Ratio=1.18x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.16x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.643, Ratio=1.15x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-2.545
Batch 125/537: Loss=1.9054 (C:1.9054, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.658, Ratio=1.17x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.668, Ratio=1.18x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.672, Ratio=1.17x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.685, Ratio=1.18x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.695, Ratio=1.17x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.686, Ratio=1.17x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.680, Ratio=1.16x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.674, Ratio=1.17x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.673, Ratio=1.16x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.673, Ratio=1.18x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.657, Ratio=1.17x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.650, Ratio=1.17x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.652, Ratio=1.18x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.657, Ratio=1.16x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.660, Ratio=1.17x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.665, Ratio=1.16x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.677, Ratio=1.17x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.675, Ratio=1.17x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.685, Ratio=1.18x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.660, Ratio=1.15x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.660, Ratio=1.16x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.670, Ratio=1.18x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.670, Ratio=1.18x, Gap=-2.616
Batch 150/537: Loss=1.9044 (C:1.9044, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.662, Ratio=1.17x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.670, Ratio=1.16x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.667, Ratio=1.14x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.663, Ratio=1.16x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.662, Ratio=1.15x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.664, Ratio=1.18x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.661, Ratio=1.17x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.664, Ratio=1.16x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.664, Ratio=1.15x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.662, Ratio=1.15x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.674, Ratio=1.16x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.652, Ratio=1.16x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.668, Ratio=1.17x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.644, Ratio=1.15x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.669, Ratio=1.17x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.653, Ratio=1.18x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.660, Ratio=1.19x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.669, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.678, Ratio=1.18x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.685, Ratio=1.18x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.682, Ratio=1.18x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.670, Ratio=1.17x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.675, Ratio=1.16x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.669, Ratio=1.17x, Gap=-2.645
Batch 175/537: Loss=1.9121 (C:1.9121, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.673, Ratio=1.16x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.675, Ratio=1.18x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.668, Ratio=1.16x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.670, Ratio=1.17x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.655, Ratio=1.15x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.657, Ratio=1.16x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.670, Ratio=1.15x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.652, Ratio=1.16x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.671, Ratio=1.17x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.661, Ratio=1.17x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.689, Ratio=1.18x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.683, Ratio=1.15x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.687, Ratio=1.16x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.691, Ratio=1.17x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.696, Ratio=1.17x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.685, Ratio=1.17x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.685, Ratio=1.18x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.681, Ratio=1.17x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.672, Ratio=1.16x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.669, Ratio=1.15x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.667, Ratio=1.15x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.662, Ratio=1.17x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.655, Ratio=1.16x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.659, Ratio=1.15x, Gap=-2.864
Batch 200/537: Loss=1.9207 (C:1.9207, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.643, Ratio=1.16x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.664, Ratio=1.16x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.673, Ratio=1.18x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.670, Ratio=1.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.676, Ratio=1.15x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.679, Ratio=1.16x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.681, Ratio=1.15x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.693, Ratio=1.18x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.669, Ratio=1.17x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.671, Ratio=1.17x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.685, Ratio=1.18x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.685, Ratio=1.18x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.673, Ratio=1.16x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.672, Ratio=1.17x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.664, Ratio=1.18x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.671, Ratio=1.18x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.683, Ratio=1.15x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.673, Ratio=1.16x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.663, Ratio=1.16x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.678, Ratio=1.14x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.666, Ratio=1.16x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.678, Ratio=1.16x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.670, Ratio=1.15x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.677, Ratio=1.18x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.661, Ratio=1.17x, Gap=-2.692
Batch 225/537: Loss=1.9100 (C:1.9100, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.670, Ratio=1.16x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.674, Ratio=1.17x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.668, Ratio=1.16x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.666, Ratio=1.17x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.659, Ratio=1.17x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.664, Ratio=1.16x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.660, Ratio=1.16x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.655, Ratio=1.18x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.664, Ratio=1.17x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.666, Ratio=1.17x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.675, Ratio=1.19x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.686, Ratio=1.16x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.685, Ratio=1.17x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.695, Ratio=1.19x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.695, Ratio=1.16x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.693, Ratio=1.16x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.681, Ratio=1.19x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.675, Ratio=1.15x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.682, Ratio=1.16x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.681, Ratio=1.17x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.669, Ratio=1.17x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.665, Ratio=1.16x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.664, Ratio=1.17x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.664, Ratio=1.17x, Gap=-2.669
Batch 250/537: Loss=1.9103 (C:1.9103, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.671, Ratio=1.17x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.662, Ratio=1.16x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.679, Ratio=1.19x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.670, Ratio=1.16x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.673, Ratio=1.18x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.681, Ratio=1.17x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.679, Ratio=1.17x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.683, Ratio=1.17x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.684, Ratio=1.17x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.678, Ratio=1.16x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.680, Ratio=1.17x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.665, Ratio=1.17x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.667, Ratio=1.17x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.669, Ratio=1.18x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.671, Ratio=1.16x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.665, Ratio=1.16x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.667, Ratio=1.17x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.664, Ratio=1.16x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.662, Ratio=1.16x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.661, Ratio=1.18x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.684, Ratio=1.18x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.681, Ratio=1.16x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.682, Ratio=1.16x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.680, Ratio=1.16x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.683, Ratio=1.18x, Gap=-2.603
Batch 275/537: Loss=1.9028 (C:1.9028, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.677, Ratio=1.16x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.681, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.675, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.662, Ratio=1.17x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.673, Ratio=1.18x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.671, Ratio=1.17x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.675, Ratio=1.18x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.669, Ratio=1.18x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.675, Ratio=1.18x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.686, Ratio=1.18x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.678, Ratio=1.17x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.684, Ratio=1.16x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.701, Ratio=1.17x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.702, Ratio=1.16x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.704, Ratio=1.16x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.687, Ratio=1.15x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.699, Ratio=1.18x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.680, Ratio=1.18x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.683, Ratio=1.18x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.679, Ratio=1.16x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.687, Ratio=1.17x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.683, Ratio=1.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.692, Ratio=1.16x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.695, Ratio=1.15x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.683, Ratio=1.16x, Gap=-2.548
Batch 300/537: Loss=1.9105 (C:1.9105, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.679, Ratio=1.15x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.679, Ratio=1.18x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.682, Ratio=1.18x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.699, Ratio=1.17x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.708, Ratio=1.17x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.694, Ratio=1.15x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.697, Ratio=1.15x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.693, Ratio=1.18x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.689, Ratio=1.15x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.673, Ratio=1.17x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.669, Ratio=1.16x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.665, Ratio=1.16x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.666, Ratio=1.16x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.668, Ratio=1.17x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.668, Ratio=1.17x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.679, Ratio=1.15x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.679, Ratio=1.17x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.687, Ratio=1.18x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.680, Ratio=1.18x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.677, Ratio=1.16x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.675, Ratio=1.18x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.675, Ratio=1.18x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.684, Ratio=1.17x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.683, Ratio=1.17x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.679, Ratio=1.17x, Gap=-2.629
Batch 325/537: Loss=1.9112 (C:1.9112, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.686, Ratio=1.18x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.674, Ratio=1.17x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.665, Ratio=1.16x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.669, Ratio=1.17x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.668, Ratio=1.13x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.682, Ratio=1.16x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.674, Ratio=1.15x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.685, Ratio=1.15x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.670, Ratio=1.18x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.679, Ratio=1.18x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.671, Ratio=1.17x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.668, Ratio=1.16x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.691, Ratio=1.19x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.679, Ratio=1.19x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.680, Ratio=1.17x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.678, Ratio=1.18x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.693, Ratio=1.17x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.678, Ratio=1.16x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.683, Ratio=1.17x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.690, Ratio=1.18x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.678, Ratio=1.17x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.686, Ratio=1.14x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.678, Ratio=1.15x, Gap=-2.782
Batch 350/537: Loss=1.9168 (C:1.9168, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.690, Ratio=1.17x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.688, Ratio=1.17x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.691, Ratio=1.15x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.692, Ratio=1.17x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.687, Ratio=1.17x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.697, Ratio=1.17x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.691, Ratio=1.14x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.685, Ratio=1.18x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.690, Ratio=1.16x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.683, Ratio=1.18x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.682, Ratio=1.16x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.684, Ratio=1.19x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.703, Ratio=1.17x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.688, Ratio=1.17x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.703, Ratio=1.17x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.702, Ratio=1.17x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.700, Ratio=1.18x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.691, Ratio=1.16x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.689, Ratio=1.17x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.701, Ratio=1.17x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.686, Ratio=1.16x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.694, Ratio=1.17x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.686, Ratio=1.18x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.682, Ratio=1.17x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.691, Ratio=1.16x, Gap=-2.698
Batch 375/537: Loss=1.9113 (C:1.9113, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.696, Ratio=1.16x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.681, Ratio=1.13x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.702, Ratio=1.16x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.702, Ratio=1.15x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.696, Ratio=1.16x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.698, Ratio=1.17x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.688, Ratio=1.19x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.700, Ratio=1.16x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.701, Ratio=1.17x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.698, Ratio=1.17x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.693, Ratio=1.16x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.705, Ratio=1.18x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.701, Ratio=1.17x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.698, Ratio=1.18x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.705, Ratio=1.15x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.688, Ratio=1.14x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.689, Ratio=1.16x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.674, Ratio=1.15x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.670, Ratio=1.16x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.665, Ratio=1.17x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.667, Ratio=1.17x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.670, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.678, Ratio=1.17x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.686, Ratio=1.14x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.695, Ratio=1.16x, Gap=-2.755
Batch 400/537: Loss=1.9124 (C:1.9124, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.694, Ratio=1.17x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.688, Ratio=1.13x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.687, Ratio=1.15x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.689, Ratio=1.18x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.668, Ratio=1.16x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.676, Ratio=1.15x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.675, Ratio=1.17x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.668, Ratio=1.16x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.666, Ratio=1.18x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.665, Ratio=1.15x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.675, Ratio=1.18x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.676, Ratio=1.17x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.688, Ratio=1.17x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.686, Ratio=1.16x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.700, Ratio=1.16x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.682, Ratio=1.18x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.699, Ratio=1.18x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.685, Ratio=1.16x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.682, Ratio=1.17x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.677, Ratio=1.17x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.675, Ratio=1.17x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.673, Ratio=1.16x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.671, Ratio=1.17x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.653, Ratio=1.17x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.659, Ratio=1.15x, Gap=-2.572
Batch 425/537: Loss=1.9191 (C:1.9191, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.676, Ratio=1.18x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.667, Ratio=1.18x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.698, Ratio=1.18x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.686, Ratio=1.17x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.702, Ratio=1.18x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.683, Ratio=1.16x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.699, Ratio=1.18x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.705, Ratio=1.17x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.702, Ratio=1.17x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.702, Ratio=1.16x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.707, Ratio=1.16x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.697, Ratio=1.16x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.696, Ratio=1.17x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.702, Ratio=1.18x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.695, Ratio=1.16x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.698, Ratio=1.19x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.693, Ratio=1.16x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.701, Ratio=1.16x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.704, Ratio=1.16x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.706, Ratio=1.18x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.696, Ratio=1.18x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.705, Ratio=1.15x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.695, Ratio=1.17x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.697, Ratio=1.16x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.702, Ratio=1.16x, Gap=-3.041
Batch 450/537: Loss=1.9090 (C:1.9090, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.697, Ratio=1.18x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.696, Ratio=1.15x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.690, Ratio=1.16x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.706, Ratio=1.16x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.694, Ratio=1.16x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.693, Ratio=1.16x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.685, Ratio=1.16x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.694, Ratio=1.19x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.684, Ratio=1.17x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.681, Ratio=1.15x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.694, Ratio=1.16x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.682, Ratio=1.16x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.686, Ratio=1.17x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.683, Ratio=1.16x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.686, Ratio=1.18x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.690, Ratio=1.16x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.685, Ratio=1.17x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.692, Ratio=1.17x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.704, Ratio=1.14x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.687, Ratio=1.15x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.697, Ratio=1.17x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.697, Ratio=1.16x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.684, Ratio=1.15x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.684, Ratio=1.16x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.683, Ratio=1.17x, Gap=-2.660
Batch 475/537: Loss=1.9070 (C:1.9070, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.691, Ratio=1.15x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.669, Ratio=1.18x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.688, Ratio=1.18x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.697, Ratio=1.15x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.703, Ratio=1.15x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.706, Ratio=1.19x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.705, Ratio=1.16x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.704, Ratio=1.16x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.695, Ratio=1.17x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.684, Ratio=1.15x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.691, Ratio=1.17x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.694, Ratio=1.17x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.676, Ratio=1.16x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.692, Ratio=1.19x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.680, Ratio=1.16x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.699, Ratio=1.17x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.700, Ratio=1.15x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.691, Ratio=1.16x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.689, Ratio=1.16x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.703, Ratio=1.20x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.698, Ratio=1.17x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.693, Ratio=1.17x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.702, Ratio=1.16x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.705, Ratio=1.17x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.699, Ratio=1.17x, Gap=-2.601
Batch 500/537: Loss=1.9041 (C:1.9041, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.691, Ratio=1.15x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.695, Ratio=1.16x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.703, Ratio=1.17x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.697, Ratio=1.17x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.696, Ratio=1.16x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.692, Ratio=1.16x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.701, Ratio=1.17x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.686, Ratio=1.18x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.687, Ratio=1.18x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.698, Ratio=1.16x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.694, Ratio=1.17x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.697, Ratio=1.18x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.706, Ratio=1.17x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.702, Ratio=1.16x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.700, Ratio=1.15x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.703, Ratio=1.16x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.704, Ratio=1.16x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.691, Ratio=1.15x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.681, Ratio=1.14x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.690, Ratio=1.18x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.673, Ratio=1.15x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.669, Ratio=1.14x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.677, Ratio=1.15x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.682, Ratio=1.16x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.694, Ratio=1.18x, Gap=-2.552
Batch 525/537: Loss=1.9010 (C:1.9010, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.705, Ratio=1.21x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.702, Ratio=1.15x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.709, Ratio=1.17x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.707, Ratio=1.17x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.710, Ratio=1.18x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.721, Ratio=1.18x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.718, Ratio=1.18x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.719, Ratio=1.18x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.718, Ratio=1.17x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.725, Ratio=1.19x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.719, Ratio=1.16x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.706, Ratio=1.16x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.713, Ratio=1.19x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.716, Ratio=1.19x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.711, Ratio=1.17x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.711, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.705, Ratio=1.16x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.710, Ratio=1.16x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.709, Ratio=1.18x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.706, Ratio=1.17x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.714, Ratio=1.17x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.703, Ratio=1.16x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.720, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.700, Ratio=1.18x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.697, Ratio=1.18x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.713, Ratio=1.17x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.698, Ratio=1.15x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.713, Ratio=1.18x, Gap=-2.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.724, Ratio=1.19x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.706, Ratio=1.18x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.714, Ratio=1.18x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.699, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.710, Ratio=1.16x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.716, Ratio=1.16x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.714, Ratio=1.17x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.715, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.709, Ratio=1.16x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.710, Ratio=1.18x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.712, Ratio=1.19x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.712, Ratio=1.16x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.706, Ratio=1.16x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.714, Ratio=1.17x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.717, Ratio=1.19x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.708, Ratio=1.17x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.715, Ratio=1.17x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.714, Ratio=1.18x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.711, Ratio=1.17x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.721, Ratio=1.17x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.704, Ratio=1.16x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.715, Ratio=1.17x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.716, Ratio=1.18x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.703, Ratio=1.16x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.719, Ratio=1.19x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.720, Ratio=1.18x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.718, Ratio=1.17x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.726, Ratio=1.19x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.705, Ratio=1.18x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.717, Ratio=1.18x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.714, Ratio=1.17x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.708, Ratio=1.15x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.706, Ratio=1.16x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.711, Ratio=1.19x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.707, Ratio=1.15x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.703, Ratio=1.16x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.718, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.711, Ratio=1.18x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.720, Ratio=1.16x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.715, Ratio=1.18x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.711, Ratio=1.16x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.705, Ratio=1.17x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.707, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.708, Ratio=1.20x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.710, Ratio=1.16x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.715, Ratio=1.17x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.720, Ratio=1.18x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.717, Ratio=1.18x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.705, Ratio=1.18x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.705, Ratio=1.17x, Gap=-2.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.705, Ratio=1.19x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.702, Ratio=1.16x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.713, Ratio=1.18x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.700, Ratio=1.15x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.694, Ratio=1.15x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.709, Ratio=1.18x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.719, Ratio=1.16x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.712, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.719, Ratio=1.18x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.710, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.710, Ratio=1.17x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.704, Ratio=1.15x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.712, Ratio=1.17x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.707, Ratio=1.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.712, Ratio=1.17x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.704, Ratio=1.16x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.716, Ratio=1.16x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.716, Ratio=1.18x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.705, Ratio=1.17x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.711, Ratio=1.17x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.720, Ratio=1.19x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.707, Ratio=1.17x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.704, Ratio=1.16x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.716, Ratio=1.18x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.713, Ratio=1.17x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.709, Ratio=1.16x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.717, Ratio=1.15x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.716, Ratio=1.17x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.695, Ratio=1.16x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.704, Ratio=1.16x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.695, Ratio=1.16x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.717, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.709, Ratio=1.19x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.699, Ratio=1.17x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.709, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.714, Ratio=1.19x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.708, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.704, Ratio=1.16x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.716, Ratio=1.19x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.713, Ratio=1.19x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.708, Ratio=1.18x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.710, Ratio=1.16x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.707, Ratio=1.14x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.708, Ratio=1.17x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.703, Ratio=1.18x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.716, Ratio=1.17x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.711, Ratio=1.18x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.711, Ratio=1.16x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.721, Ratio=1.19x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.716, Ratio=1.19x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.714, Ratio=1.19x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.705, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.706, Ratio=1.18x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.713, Ratio=1.17x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.705, Ratio=1.17x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.715, Ratio=1.19x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.718, Ratio=1.16x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.711, Ratio=1.17x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.711, Ratio=1.16x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.716, Ratio=1.17x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.712, Ratio=1.15x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.706, Ratio=1.15x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.709, Ratio=1.18x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.709, Ratio=1.18x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.708, Ratio=1.16x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.709, Ratio=1.16x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.717, Ratio=1.17x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.715, Ratio=1.19x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.703, Ratio=1.16x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.710, Ratio=1.16x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.702, Ratio=1.18x, Gap=-2.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.713, Ratio=1.17x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.711, Ratio=1.16x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.714, Ratio=1.14x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.713, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.709, Ratio=1.17x, Gap=-2.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.702, Ratio=1.14x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.703, Ratio=1.19x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.716, Ratio=1.16x, Gap=-2.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.709, Ratio=1.16x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.692, Ratio=1.15x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.715, Ratio=1.16x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.708, Ratio=1.16x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.715, Ratio=1.18x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.715, Ratio=1.17x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.721, Ratio=1.19x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.707, Ratio=1.16x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.722, Ratio=1.16x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.720, Ratio=1.15x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.707, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.706, Ratio=1.19x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.702, Ratio=1.17x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.725, Ratio=1.18x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.718, Ratio=1.18x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.711, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.708, Ratio=1.16x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.715, Ratio=1.19x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.711, Ratio=1.17x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.715, Ratio=1.16x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.719, Ratio=1.18x, Gap=-2.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.712, Ratio=1.16x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.712, Ratio=1.16x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.719, Ratio=1.19x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.718, Ratio=1.16x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.715, Ratio=1.18x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.695, Ratio=1.15x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.711, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.712, Ratio=1.18x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.704, Ratio=1.18x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.707, Ratio=1.16x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.719, Ratio=1.20x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.702, Ratio=1.15x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.706, Ratio=1.16x, Gap=-2.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.711, Ratio=1.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.711, Ratio=1.18x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.720, Ratio=1.17x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.718, Ratio=1.18x, Gap=-2.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.706, Ratio=1.17x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.705, Ratio=1.17x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.720, Ratio=1.17x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.719, Ratio=1.17x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.704, Ratio=1.16x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.720, Ratio=1.18x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.710, Ratio=1.18x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.708, Ratio=1.16x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.722, Ratio=1.17x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.712, Ratio=1.15x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.700, Ratio=1.15x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.710, Ratio=1.19x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.713, Ratio=1.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.721, Ratio=1.16x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.722, Ratio=1.18x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.722, Ratio=1.19x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.715, Ratio=1.17x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.715, Ratio=1.17x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.706, Ratio=1.17x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.713, Ratio=1.18x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.705, Ratio=1.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.720, Ratio=1.17x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.714, Ratio=1.18x, Gap=-2.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.713, Ratio=1.18x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.707, Ratio=1.16x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.712, Ratio=1.18x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.711, Ratio=1.16x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.721, Ratio=1.16x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.721, Ratio=1.16x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.714, Ratio=1.18x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.724, Ratio=1.19x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.710, Ratio=1.15x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.710, Ratio=1.20x, Gap=-2.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.720, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.708, Ratio=1.16x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.710, Ratio=1.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.709, Ratio=1.16x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.705, Ratio=1.16x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.699, Ratio=1.18x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.700, Ratio=1.15x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.716, Ratio=1.17x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.706, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.721, Ratio=1.16x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.723, Ratio=1.20x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.702, Ratio=1.17x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.713, Ratio=1.18x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.705, Ratio=1.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.704, Ratio=1.16x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.713, Ratio=1.15x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.713, Ratio=1.16x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.725, Ratio=1.17x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.716, Ratio=1.18x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.714, Ratio=1.17x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.708, Ratio=1.19x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.706, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.715, Ratio=1.18x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.712, Ratio=1.16x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.721, Ratio=1.19x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.703, Ratio=1.15x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.717, Ratio=1.18x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.716, Ratio=1.17x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.713, Ratio=1.15x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.708, Ratio=1.17x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.708, Ratio=1.16x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.702, Ratio=1.15x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.718, Ratio=1.16x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.715, Ratio=1.16x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.708, Ratio=1.19x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.705, Ratio=1.16x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.711, Ratio=1.16x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.718, Ratio=1.18x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.720, Ratio=1.17x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.715, Ratio=1.19x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.724, Ratio=1.16x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.713, Ratio=1.19x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.712, Ratio=1.16x, Gap=-2.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.703, Ratio=1.18x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.718, Ratio=1.17x, Gap=-2.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.716, Ratio=1.19x, Gap=-2.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.717, Ratio=1.20x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.697, Ratio=1.16x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.711, Ratio=1.16x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.701, Ratio=1.15x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.713, Ratio=1.15x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.719, Ratio=1.18x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.710, Ratio=1.15x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.708, Ratio=1.17x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.708, Ratio=1.15x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.703, Ratio=1.15x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.717, Ratio=1.18x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.701, Ratio=1.15x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.707, Ratio=1.17x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.715, Ratio=1.19x, Gap=-2.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.714, Ratio=1.18x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.712, Ratio=1.16x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.704, Ratio=1.16x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.714, Ratio=1.18x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.698, Ratio=1.17x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.701, Ratio=1.15x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.707, Ratio=1.18x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.715, Ratio=1.15x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.711, Ratio=1.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.707, Ratio=1.17x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.710, Ratio=1.16x, Gap=-2.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.703, Ratio=1.16x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.713, Ratio=1.16x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.703, Ratio=1.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.715, Ratio=1.17x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.710, Ratio=1.19x, Gap=-2.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.710, Ratio=1.18x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.708, Ratio=1.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.713, Ratio=1.18x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.719, Ratio=1.19x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.714, Ratio=1.20x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.719, Ratio=1.16x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.708, Ratio=1.17x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.715, Ratio=1.16x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.699, Ratio=1.16x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.708, Ratio=1.16x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.714, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.715, Ratio=1.17x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.704, Ratio=1.15x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.709, Ratio=1.19x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.706, Ratio=1.16x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.710, Ratio=1.16x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.716, Ratio=1.19x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.724, Ratio=1.19x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.714, Ratio=1.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.712, Ratio=1.17x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.704, Ratio=1.17x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.722, Ratio=1.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.721, Ratio=1.20x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.705, Ratio=1.17x, Gap=-2.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.711, Ratio=1.18x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.719, Ratio=1.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.706, Ratio=1.18x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.704, Ratio=1.19x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.710, Ratio=1.17x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.719, Ratio=1.17x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.710, Ratio=1.18x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.714, Ratio=1.16x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.705, Ratio=1.16x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.715, Ratio=1.17x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.705, Ratio=1.16x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.698, Ratio=1.14x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.714, Ratio=1.17x, Gap=-2.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.720, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.710, Ratio=1.17x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.709, Ratio=1.17x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.716, Ratio=1.17x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.710, Ratio=1.15x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.700, Ratio=1.17x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.705, Ratio=1.18x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.703, Ratio=1.17x, Gap=-2.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.714, Ratio=1.17x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.713, Ratio=1.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.721, Ratio=1.17x, Gap=-2.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.717, Ratio=1.20x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.710, Ratio=1.16x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.723, Ratio=1.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.711, Ratio=1.14x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.722, Ratio=1.18x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.710, Ratio=1.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.704, Ratio=1.17x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.716, Ratio=1.17x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.706, Ratio=1.18x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.710, Ratio=1.18x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.716, Ratio=1.16x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.717, Ratio=1.19x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.708, Ratio=1.16x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.713, Ratio=1.16x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.721, Ratio=1.18x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.720, Ratio=1.17x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.703, Ratio=1.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.708, Ratio=1.17x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.710, Ratio=1.18x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.718, Ratio=1.15x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.712, Ratio=1.18x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.709, Ratio=1.13x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.713, Ratio=1.17x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.706, Ratio=1.17x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.722, Ratio=1.20x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.709, Ratio=1.17x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.716, Ratio=1.19x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.714, Ratio=1.17x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.712, Ratio=1.18x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.706, Ratio=1.16x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.702, Ratio=1.17x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.713, Ratio=1.15x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.725, Ratio=1.18x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.713, Ratio=1.16x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.710, Ratio=1.17x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.706, Ratio=1.19x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.701, Ratio=1.14x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.721, Ratio=1.21x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.721, Ratio=1.15x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.717, Ratio=1.20x, Gap=-2.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.715, Ratio=1.18x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.716, Ratio=1.19x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.712, Ratio=1.16x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.713, Ratio=1.16x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.698, Ratio=1.16x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.706, Ratio=1.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.713, Ratio=1.18x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.710, Ratio=1.18x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.721, Ratio=1.19x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.706, Ratio=1.16x, Gap=-2.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.712, Ratio=1.16x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.718, Ratio=1.16x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.713, Ratio=1.16x, Gap=-2.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.707, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.718, Ratio=1.17x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.719, Ratio=1.16x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.705, Ratio=1.18x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.703, Ratio=1.17x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.711, Ratio=1.16x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.703, Ratio=1.17x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.709, Ratio=1.14x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.712, Ratio=1.16x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.707, Ratio=1.17x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.705, Ratio=1.17x, Gap=-2.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.716, Ratio=1.20x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.711, Ratio=1.17x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.717, Ratio=1.18x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.712, Ratio=1.17x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.710, Ratio=1.16x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.707, Ratio=1.19x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.723, Ratio=1.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.708, Ratio=1.16x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.719, Ratio=1.17x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.716, Ratio=1.16x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.702, Ratio=1.17x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.716, Ratio=1.18x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.716, Ratio=1.17x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.721, Ratio=1.16x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.709, Ratio=1.17x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.707, Ratio=1.17x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.712, Ratio=1.17x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.715, Ratio=1.19x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.699, Ratio=1.14x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.709, Ratio=1.16x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.720, Ratio=1.17x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.705, Ratio=1.18x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.709, Ratio=1.16x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.706, Ratio=1.16x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.716, Ratio=1.18x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.712, Ratio=1.17x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.717, Ratio=1.20x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.719, Ratio=1.18x, Gap=-2.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.709, Ratio=1.17x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.714, Ratio=1.18x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.713, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.709, Ratio=1.16x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.708, Ratio=1.16x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.720, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.710, Ratio=1.21x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.708, Ratio=1.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.707, Ratio=1.16x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.719, Ratio=1.17x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.706, Ratio=1.16x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.700, Ratio=1.17x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.716, Ratio=1.16x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.706, Ratio=1.16x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.711, Ratio=1.16x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.718, Ratio=1.16x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.703, Ratio=1.15x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.711, Ratio=1.17x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.703, Ratio=1.16x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.709, Ratio=1.17x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.698, Ratio=1.16x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.711, Ratio=1.16x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.717, Ratio=1.19x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.711, Ratio=1.14x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.716, Ratio=1.17x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.703, Ratio=1.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.711, Ratio=1.19x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.713, Ratio=1.17x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.705, Ratio=1.19x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.708, Ratio=1.18x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.699, Ratio=1.18x, Gap=-2.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.721, Ratio=1.17x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.712, Ratio=1.16x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.715, Ratio=1.17x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.719, Ratio=1.17x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.713, Ratio=1.15x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.706, Ratio=1.16x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.714, Ratio=1.17x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.714, Ratio=1.17x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.713, Ratio=1.18x, Gap=-2.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.717, Ratio=1.17x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.702, Ratio=1.17x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.702, Ratio=1.17x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.719, Ratio=1.18x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.710, Ratio=1.18x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.700, Ratio=1.19x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.707, Ratio=1.16x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.707, Ratio=1.16x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.707, Ratio=1.16x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.702, Ratio=1.15x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.712, Ratio=1.18x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.711, Ratio=1.17x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.728, Ratio=1.17x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.709, Ratio=1.16x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.713, Ratio=1.17x, Gap=-2.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.701, Ratio=1.15x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.715, Ratio=1.17x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.715, Ratio=1.17x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.714, Ratio=1.17x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.696, Ratio=1.14x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.714, Ratio=1.19x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.717, Ratio=1.17x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.714, Ratio=1.17x, Gap=-2.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.715, Ratio=1.16x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.703, Ratio=1.16x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.704, Ratio=1.17x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.705, Ratio=1.15x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.720, Ratio=1.17x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.712, Ratio=1.18x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.712, Ratio=1.18x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.715, Ratio=1.17x, Gap=-2.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.718, Ratio=1.19x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.726, Ratio=1.19x, Gap=-2.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.719, Ratio=1.19x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.721, Ratio=1.17x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.722, Ratio=1.16x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.714, Ratio=1.16x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.699, Ratio=1.20x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.715, Ratio=1.15x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.706, Ratio=1.16x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.706, Ratio=1.15x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.715, Ratio=1.18x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.711, Ratio=1.19x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.710, Ratio=1.16x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.715, Ratio=1.19x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.720, Ratio=1.19x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.715, Ratio=1.16x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.707, Ratio=1.14x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.710, Ratio=1.20x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.708, Ratio=1.14x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.712, Ratio=1.17x, Gap=-2.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.714, Ratio=1.17x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.725, Ratio=1.18x, Gap=-2.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.712, Ratio=1.17x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.711, Ratio=1.16x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.725, Ratio=1.17x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.711, Ratio=1.17x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.709, Ratio=1.16x, Gap=-2.448

============================================================
Epoch 3/20 completed in 29.1s
Train: Loss=1.9106 (C:1.9106, R:0.0000) Ratio=1.88x
Val:   Loss=1.9033 (C:1.9033, R:0.0000) Ratio=2.02x
‚úÖ New best model saved (Val Loss: 1.9033)
============================================================

üåç Updating global dataset at epoch 4
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.630 ¬± 0.719
    Neg distances: 1.225 ¬± 0.839
    Separation ratio: 1.94x
    Gap: -2.459
    ‚ö†Ô∏è  Moderate global separation

Epoch 4 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.607
Batch   0/537: Loss=1.4452 (C:1.4452, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.04x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.223, Ratio=1.87x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.230, Ratio=1.99x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.232, Ratio=1.98x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.215, Ratio=1.88x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.233, Ratio=1.96x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.227, Ratio=1.93x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.226, Ratio=1.93x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.229, Ratio=1.96x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.225, Ratio=1.98x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.223, Ratio=1.95x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.214, Ratio=1.91x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.236, Ratio=1.95x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.234, Ratio=1.96x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.232, Ratio=1.88x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.235, Ratio=1.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.228, Ratio=1.94x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.657, Neg=1.207, Ratio=1.84x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.230, Ratio=1.99x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.242, Ratio=2.00x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.228, Ratio=1.93x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.242, Ratio=1.99x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.246, Ratio=1.93x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.215, Ratio=1.87x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.226, Ratio=1.94x, Gap=-2.639
Batch  25/537: Loss=1.4473 (C:1.4473, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.212, Ratio=1.90x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.232, Ratio=1.99x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.212, Ratio=1.92x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.240, Ratio=1.98x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.234, Ratio=1.95x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.662, Neg=1.216, Ratio=1.84x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.223, Ratio=1.88x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.221, Ratio=1.93x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.220, Ratio=1.91x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.213, Ratio=1.87x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.225, Ratio=1.94x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.233, Ratio=1.96x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.212, Ratio=1.88x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.236, Ratio=1.92x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.656, Neg=1.214, Ratio=1.85x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.235, Ratio=1.93x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.226, Ratio=1.87x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.234, Ratio=1.97x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.240, Ratio=2.07x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.227, Ratio=1.91x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.249, Ratio=2.02x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.242, Ratio=1.93x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.237, Ratio=1.94x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.228, Ratio=1.90x, Gap=-2.560
Batch  50/537: Loss=1.4606 (C:1.4606, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.233, Ratio=1.97x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.225, Ratio=1.91x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.236, Ratio=1.97x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.221, Ratio=1.87x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.229, Ratio=1.92x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.236, Ratio=1.98x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.232, Ratio=1.96x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.228, Ratio=1.95x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.215, Ratio=1.88x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.229, Ratio=1.92x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.247, Ratio=2.01x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.656, Neg=1.236, Ratio=1.88x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.236, Ratio=1.93x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.221, Ratio=1.91x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.232, Ratio=1.96x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.224, Ratio=1.88x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.233, Ratio=1.99x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.223, Ratio=1.92x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.224, Ratio=1.92x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.231, Ratio=1.95x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.238, Ratio=1.95x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.657, Neg=1.230, Ratio=1.87x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.241, Ratio=1.96x, Gap=-2.621
Batch  75/537: Loss=1.4364 (C:1.4364, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.242, Ratio=1.96x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.220, Ratio=1.95x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.217, Ratio=1.86x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.218, Ratio=1.91x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.231, Ratio=2.00x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.234, Ratio=1.94x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.232, Ratio=1.95x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.246, Ratio=1.98x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.227, Ratio=1.93x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.229, Ratio=1.93x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.213, Ratio=1.86x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.230, Ratio=1.97x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.233, Ratio=1.96x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.228, Ratio=1.91x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.239, Ratio=1.92x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.231, Ratio=1.91x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.656, Neg=1.229, Ratio=1.87x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.237, Ratio=1.95x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.226, Ratio=1.93x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.209, Ratio=1.89x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.219, Ratio=1.91x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.223, Ratio=1.95x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.229, Ratio=1.88x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.244, Ratio=2.03x, Gap=-2.705
Batch 100/537: Loss=1.4157 (C:1.4157, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.212, Ratio=1.89x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.250, Ratio=2.00x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.230, Ratio=1.96x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.216, Ratio=1.90x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.214, Ratio=1.88x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.242, Ratio=2.01x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.224, Ratio=1.91x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.220, Ratio=1.87x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.216, Ratio=1.93x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.242, Ratio=1.98x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.246, Ratio=1.96x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.656, Neg=1.215, Ratio=1.85x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.226, Ratio=1.92x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.239, Ratio=1.98x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.222, Ratio=1.95x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.211, Ratio=1.87x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.222, Ratio=1.89x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.235, Ratio=1.97x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.213, Ratio=1.87x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.244, Ratio=2.01x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.227, Ratio=1.91x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.227, Ratio=1.93x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.231, Ratio=1.95x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.217, Ratio=1.93x, Gap=-2.625
Batch 125/537: Loss=1.4556 (C:1.4556, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.227, Ratio=1.94x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.224, Ratio=1.89x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.226, Ratio=1.96x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.235, Ratio=1.90x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.236, Ratio=1.91x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.212, Ratio=1.87x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.224, Ratio=1.97x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.226, Ratio=1.95x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.239, Ratio=1.99x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.251, Ratio=2.00x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.237, Ratio=1.92x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.244, Ratio=2.00x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.226, Ratio=1.92x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.236, Ratio=1.95x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.232, Ratio=1.93x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.217, Ratio=1.91x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.251, Ratio=2.05x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.225, Ratio=1.93x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.248, Ratio=2.00x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.240, Ratio=2.00x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.239, Ratio=1.99x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.662, Neg=1.221, Ratio=1.84x, Gap=-2.533
Batch 150/537: Loss=1.4876 (C:1.4876, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.242, Ratio=1.97x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.236, Ratio=1.96x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.222, Ratio=1.92x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.229, Ratio=1.96x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.241, Ratio=1.98x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.237, Ratio=1.96x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.246, Ratio=1.98x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.237, Ratio=1.95x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.249, Ratio=1.98x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.225, Ratio=1.93x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.238, Ratio=2.00x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.227, Ratio=1.95x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.208, Ratio=1.88x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.220, Ratio=1.92x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.231, Ratio=1.94x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.249, Ratio=2.04x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.234, Ratio=1.89x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.242, Ratio=1.93x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.232, Ratio=1.90x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.236, Ratio=1.98x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.219, Ratio=1.91x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.228, Ratio=1.95x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.222, Ratio=1.93x, Gap=-2.529
Batch 175/537: Loss=1.4495 (C:1.4495, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.217, Ratio=1.91x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.254, Ratio=2.04x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.229, Ratio=1.91x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.248, Ratio=1.99x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.240, Ratio=1.99x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.229, Ratio=1.94x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.226, Ratio=1.94x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.214, Ratio=1.91x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.212, Ratio=1.90x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.207, Ratio=1.87x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.218, Ratio=1.91x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.224, Ratio=1.89x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.225, Ratio=1.87x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.242, Ratio=1.97x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.241, Ratio=1.98x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.224, Ratio=1.90x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.246, Ratio=1.99x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.239, Ratio=2.00x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.227, Ratio=1.97x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.233, Ratio=1.97x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.220, Ratio=1.98x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.222, Ratio=1.93x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.237, Ratio=1.99x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.658, Neg=1.219, Ratio=1.85x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.236, Ratio=1.93x, Gap=-2.602
Batch 200/537: Loss=1.4509 (C:1.4509, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.233, Ratio=1.96x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.227, Ratio=1.93x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.228, Ratio=1.93x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.207, Ratio=1.86x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.208, Ratio=1.91x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.225, Ratio=1.94x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.218, Ratio=1.92x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.242, Ratio=1.99x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.251, Ratio=2.06x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.228, Ratio=1.90x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.226, Ratio=1.87x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.04x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.249, Ratio=2.08x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.209, Ratio=1.85x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.230, Ratio=1.99x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.220, Ratio=1.94x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.228, Ratio=1.99x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=2.00x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.238, Ratio=1.97x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.235, Ratio=1.95x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.219, Ratio=1.88x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.253, Ratio=2.03x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.231, Ratio=1.91x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.222, Ratio=1.89x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.224, Ratio=1.90x, Gap=-2.693
Batch 225/537: Loss=1.4603 (C:1.4603, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.249, Ratio=2.03x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.238, Ratio=1.95x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.237, Ratio=2.04x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.213, Ratio=1.91x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.226, Ratio=1.92x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.245, Ratio=2.09x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.228, Ratio=1.97x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.212, Ratio=1.89x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.215, Ratio=1.91x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.216, Ratio=1.91x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.01x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.220, Ratio=1.90x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.240, Ratio=2.01x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.227, Ratio=1.91x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.226, Ratio=1.89x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.239, Ratio=1.93x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.224, Ratio=1.90x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.237, Ratio=1.95x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.233, Ratio=1.94x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.241, Ratio=1.95x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.224, Ratio=1.95x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.229, Ratio=1.98x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.241, Ratio=2.01x, Gap=-2.597
Batch 250/537: Loss=1.4178 (C:1.4178, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.225, Ratio=1.94x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.226, Ratio=1.94x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.247, Ratio=1.99x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.213, Ratio=1.87x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.223, Ratio=1.93x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.229, Ratio=1.98x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.223, Ratio=1.91x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.241, Ratio=1.93x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.236, Ratio=1.98x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.232, Ratio=1.92x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.257, Ratio=2.02x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.226, Ratio=1.91x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.238, Ratio=1.99x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.225, Ratio=1.90x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.235, Ratio=1.94x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.216, Ratio=1.91x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.214, Ratio=1.88x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.210, Ratio=1.91x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.218, Ratio=1.91x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.213, Ratio=1.89x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.233, Ratio=1.96x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.233, Ratio=1.95x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.233, Ratio=1.92x, Gap=-2.553
Batch 275/537: Loss=1.4547 (C:1.4547, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.239, Ratio=1.92x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.662, Neg=1.223, Ratio=1.85x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.259, Ratio=2.05x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.225, Ratio=1.90x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.207, Ratio=1.86x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.221, Ratio=1.98x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.219, Ratio=1.96x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.223, Ratio=1.93x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.227, Ratio=1.94x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.224, Ratio=1.99x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.238, Ratio=1.95x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.255, Ratio=2.04x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.248, Ratio=1.98x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.252, Ratio=2.07x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.223, Ratio=1.88x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.244, Ratio=1.98x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.230, Ratio=1.93x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.232, Ratio=2.02x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.238, Ratio=1.98x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.239, Ratio=2.06x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.233, Ratio=1.96x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.239, Ratio=1.99x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.224, Ratio=1.89x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.231, Ratio=1.94x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.230, Ratio=1.92x, Gap=-2.605
Batch 300/537: Loss=1.4541 (C:1.4541, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.224, Ratio=1.90x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.233, Ratio=1.99x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.220, Ratio=1.95x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.226, Ratio=1.91x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.224, Ratio=1.91x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.231, Ratio=1.93x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.219, Ratio=1.90x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.235, Ratio=1.94x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.215, Ratio=1.88x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.244, Ratio=1.98x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.235, Ratio=1.99x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.214, Ratio=1.89x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.215, Ratio=1.92x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.220, Ratio=1.93x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.225, Ratio=1.91x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.237, Ratio=1.95x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.254, Ratio=2.00x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.232, Ratio=1.89x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.237, Ratio=1.95x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.240, Ratio=1.96x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.233, Ratio=1.93x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.241, Ratio=1.99x, Gap=-2.545
Batch 325/537: Loss=1.4283 (C:1.4283, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.227, Ratio=1.93x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.224, Ratio=1.97x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.227, Ratio=1.96x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.237, Ratio=2.01x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.239, Ratio=1.93x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.244, Ratio=2.00x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.243, Ratio=1.99x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.225, Ratio=1.92x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.250, Ratio=2.04x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.238, Ratio=1.94x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.227, Ratio=1.93x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.237, Ratio=2.00x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.230, Ratio=1.94x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.247, Ratio=2.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.223, Ratio=1.91x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.228, Ratio=1.91x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.223, Ratio=1.88x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.234, Ratio=1.98x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.244, Ratio=1.97x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.245, Ratio=2.02x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.248, Ratio=2.02x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.240, Ratio=1.94x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.229, Ratio=1.90x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.234, Ratio=1.94x, Gap=-2.791
Batch 350/537: Loss=1.4423 (C:1.4423, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.229, Ratio=1.93x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.226, Ratio=1.97x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.249, Ratio=1.99x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.235, Ratio=1.94x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.234, Ratio=1.96x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.251, Ratio=2.03x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.240, Ratio=2.00x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.221, Ratio=1.88x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.214, Ratio=1.93x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.219, Ratio=1.89x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.231, Ratio=1.94x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.237, Ratio=2.02x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.231, Ratio=1.94x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.235, Ratio=1.96x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.236, Ratio=1.98x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.228, Ratio=1.93x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.238, Ratio=1.94x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.232, Ratio=1.96x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.237, Ratio=1.96x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.224, Ratio=1.90x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.251, Ratio=2.07x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.225, Ratio=1.91x, Gap=-2.470
Batch 375/537: Loss=1.4570 (C:1.4570, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.224, Ratio=1.96x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.220, Ratio=1.90x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.219, Ratio=1.93x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.235, Ratio=1.98x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.243, Ratio=2.01x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.221, Ratio=1.85x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.214, Ratio=1.89x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.01x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.241, Ratio=1.98x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.220, Ratio=1.94x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.232, Ratio=1.95x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.231, Ratio=1.97x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.246, Ratio=1.99x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.228, Ratio=1.89x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.236, Ratio=1.97x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.256, Ratio=2.07x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.233, Ratio=1.93x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.232, Ratio=1.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.236, Ratio=1.96x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.218, Ratio=1.87x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.221, Ratio=1.91x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.227, Ratio=1.99x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.241, Ratio=2.06x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.222, Ratio=1.88x, Gap=-2.558
Batch 400/537: Loss=1.4704 (C:1.4704, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.241, Ratio=1.94x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.250, Ratio=2.05x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.263, Ratio=2.08x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.257, Ratio=2.06x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.231, Ratio=1.98x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.236, Ratio=1.96x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.230, Ratio=2.00x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.240, Ratio=2.02x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.217, Ratio=1.93x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.224, Ratio=1.91x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.240, Ratio=1.95x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.244, Ratio=1.96x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.240, Ratio=1.98x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.210, Ratio=1.86x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.218, Ratio=1.89x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.225, Ratio=1.97x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.238, Ratio=2.01x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.234, Ratio=2.00x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.233, Ratio=1.97x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.237, Ratio=2.05x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.220, Ratio=1.88x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.228, Ratio=1.92x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.232, Ratio=1.96x, Gap=-2.631
Batch 425/537: Loss=1.4393 (C:1.4393, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.249, Ratio=2.03x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.234, Ratio=1.94x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.236, Ratio=2.00x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.253, Ratio=1.99x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.216, Ratio=1.90x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.218, Ratio=1.92x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.213, Ratio=1.87x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.232, Ratio=2.00x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.218, Ratio=1.93x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.235, Ratio=1.96x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.236, Ratio=2.01x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.216, Ratio=1.88x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.231, Ratio=1.93x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.230, Ratio=1.94x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.247, Ratio=2.01x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.234, Ratio=2.00x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.215, Ratio=1.91x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.221, Ratio=1.92x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.243, Ratio=2.04x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.224, Ratio=1.93x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.240, Ratio=1.99x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.245, Ratio=2.02x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.216, Ratio=1.91x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.231, Ratio=1.92x, Gap=-2.738
Batch 450/537: Loss=1.4536 (C:1.4536, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.231, Ratio=1.92x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.243, Ratio=2.05x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.213, Ratio=1.91x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.245, Ratio=1.99x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.238, Ratio=2.03x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.233, Ratio=1.93x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.216, Ratio=1.90x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.206, Ratio=1.89x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.239, Ratio=1.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.240, Ratio=1.99x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.240, Ratio=1.99x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.249, Ratio=2.00x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.242, Ratio=1.96x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.230, Ratio=1.90x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.246, Ratio=1.99x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.229, Ratio=1.94x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.240, Ratio=2.01x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.224, Ratio=1.97x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.230, Ratio=1.96x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.230, Ratio=2.00x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.01x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.234, Ratio=1.95x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.216, Ratio=1.87x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.244, Ratio=1.99x, Gap=-2.624
Batch 475/537: Loss=1.4268 (C:1.4268, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.220, Ratio=1.92x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.244, Ratio=2.04x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=2.00x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.229, Ratio=1.99x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.232, Ratio=1.94x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.233, Ratio=1.95x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.225, Ratio=1.96x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.236, Ratio=2.00x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.224, Ratio=1.90x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.217, Ratio=1.89x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.229, Ratio=1.94x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.227, Ratio=1.94x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.230, Ratio=1.98x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.231, Ratio=1.94x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.239, Ratio=1.95x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.229, Ratio=1.96x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.234, Ratio=2.09x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.237, Ratio=1.96x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.226, Ratio=1.90x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.228, Ratio=1.94x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.233, Ratio=1.95x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.244, Ratio=2.03x, Gap=-2.552
Batch 500/537: Loss=1.4120 (C:1.4120, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.229, Ratio=1.93x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.231, Ratio=1.96x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.661, Neg=1.224, Ratio=1.85x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.222, Ratio=1.91x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.243, Ratio=1.98x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.242, Ratio=1.95x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.246, Ratio=2.03x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.231, Ratio=1.97x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.225, Ratio=1.94x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.219, Ratio=1.93x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.232, Ratio=2.01x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.248, Ratio=2.05x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.237, Ratio=2.03x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.253, Ratio=2.04x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.250, Ratio=2.02x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.238, Ratio=1.97x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.241, Ratio=1.95x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.226, Ratio=1.95x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.215, Ratio=1.97x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.219, Ratio=1.89x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.232, Ratio=2.02x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.233, Ratio=1.96x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.215, Ratio=1.88x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.234, Ratio=1.89x, Gap=-2.763
Batch 525/537: Loss=1.4666 (C:1.4666, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.234, Ratio=1.94x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.251, Ratio=2.07x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.247, Ratio=2.00x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.234, Ratio=1.96x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.237, Ratio=1.98x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.235, Ratio=2.03x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.238, Ratio=2.03x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.250, Ratio=2.06x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.249, Ratio=2.03x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.252, Ratio=2.03x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.232, Ratio=1.95x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.235, Ratio=2.06x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.223, Ratio=1.99x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.253, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.224, Ratio=1.91x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.227, Ratio=1.93x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.220, Ratio=1.93x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.232, Ratio=1.99x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.252, Ratio=2.07x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.231, Ratio=1.98x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.234, Ratio=1.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.255, Ratio=2.12x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.227, Ratio=1.97x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.244, Ratio=2.02x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.224, Ratio=1.96x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.226, Ratio=1.99x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.232, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.222, Ratio=1.99x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.244, Ratio=2.09x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.225, Ratio=1.95x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.228, Ratio=2.00x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.231, Ratio=2.03x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.242, Ratio=1.98x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.237, Ratio=2.00x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.222, Ratio=1.92x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.243, Ratio=2.06x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.226, Ratio=1.93x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.240, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.239, Ratio=1.97x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.232, Ratio=2.00x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.249, Ratio=2.07x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.224, Ratio=1.96x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.236, Ratio=2.02x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.235, Ratio=2.01x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.230, Ratio=2.01x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.242, Ratio=2.02x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.244, Ratio=2.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.241, Ratio=2.04x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.231, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.255, Ratio=2.16x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.239, Ratio=2.02x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.226, Ratio=1.99x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.240, Ratio=2.07x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.226, Ratio=1.96x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.236, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.242, Ratio=2.05x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.01x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.235, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.224, Ratio=1.94x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.98x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.231, Ratio=1.97x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.218, Ratio=1.93x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.223, Ratio=1.97x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.217, Ratio=1.96x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.252, Ratio=2.13x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.223, Ratio=1.96x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.237, Ratio=2.08x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.219, Ratio=1.92x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.243, Ratio=2.09x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.221, Ratio=1.95x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.256, Ratio=2.19x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.244, Ratio=2.04x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.255, Ratio=2.12x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.234, Ratio=1.94x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.221, Ratio=1.95x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.227, Ratio=2.00x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.231, Ratio=1.95x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.228, Ratio=1.97x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.236, Ratio=1.97x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.250, Ratio=2.12x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.223, Ratio=1.96x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.246, Ratio=2.02x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.227, Ratio=1.96x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.239, Ratio=1.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.221, Ratio=1.97x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.219, Ratio=1.91x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.225, Ratio=1.98x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.225, Ratio=1.94x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.235, Ratio=1.97x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.238, Ratio=2.00x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.231, Ratio=2.01x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.231, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.241, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.236, Ratio=1.99x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.245, Ratio=2.07x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.226, Ratio=2.00x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.01x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.222, Ratio=1.94x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.236, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.218, Ratio=1.91x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.234, Ratio=1.96x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.222, Ratio=1.98x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.224, Ratio=1.94x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.237, Ratio=2.00x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.249, Ratio=2.08x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.253, Ratio=2.09x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.255, Ratio=2.05x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.234, Ratio=2.00x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.232, Ratio=2.01x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.229, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.06x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.225, Ratio=1.98x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.219, Ratio=1.94x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.229, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.232, Ratio=1.98x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.220, Ratio=1.95x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.241, Ratio=2.05x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.224, Ratio=1.93x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.250, Ratio=2.09x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.228, Ratio=2.00x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.236, Ratio=2.01x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.244, Ratio=2.08x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.233, Ratio=2.04x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.227, Ratio=1.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.237, Ratio=2.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.233, Ratio=2.03x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.247, Ratio=2.06x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.230, Ratio=1.99x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.232, Ratio=2.00x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.06x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.231, Ratio=2.01x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.236, Ratio=2.00x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.229, Ratio=1.99x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.236, Ratio=2.03x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.234, Ratio=2.00x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.229, Ratio=1.98x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.245, Ratio=2.08x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.242, Ratio=1.98x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.243, Ratio=2.06x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.253, Ratio=2.07x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.218, Ratio=1.96x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.219, Ratio=1.94x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.235, Ratio=2.03x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.228, Ratio=2.00x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.233, Ratio=1.96x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.217, Ratio=1.98x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.246, Ratio=2.03x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.242, Ratio=2.03x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.241, Ratio=2.04x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.237, Ratio=2.02x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.234, Ratio=1.99x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.241, Ratio=2.07x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.235, Ratio=2.00x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.249, Ratio=2.09x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.229, Ratio=1.94x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.249, Ratio=2.10x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.226, Ratio=1.96x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.222, Ratio=1.91x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.234, Ratio=2.07x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.222, Ratio=1.95x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.233, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.242, Ratio=1.99x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.226, Ratio=1.95x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.235, Ratio=2.00x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.239, Ratio=1.92x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.220, Ratio=1.98x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.249, Ratio=2.09x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.232, Ratio=1.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.239, Ratio=2.06x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.228, Ratio=1.95x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.224, Ratio=2.00x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.236, Ratio=1.98x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.241, Ratio=2.04x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.233, Ratio=1.97x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.232, Ratio=1.96x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.238, Ratio=2.03x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.234, Ratio=1.98x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.228, Ratio=1.97x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.220, Ratio=1.96x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.243, Ratio=2.07x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.220, Ratio=1.89x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.244, Ratio=2.04x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.245, Ratio=2.05x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.220, Ratio=1.93x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.228, Ratio=2.00x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.238, Ratio=2.03x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.220, Ratio=1.89x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.223, Ratio=1.93x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.256, Ratio=2.07x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.234, Ratio=2.01x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.227, Ratio=1.97x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.242, Ratio=1.99x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.230, Ratio=1.96x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.240, Ratio=1.97x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.246, Ratio=2.03x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.237, Ratio=2.04x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.231, Ratio=1.97x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.231, Ratio=1.96x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.253, Ratio=2.13x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.225, Ratio=1.98x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.02x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.243, Ratio=2.06x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.229, Ratio=1.92x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.253, Ratio=2.06x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.245, Ratio=2.06x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.224, Ratio=1.92x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.244, Ratio=2.10x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.228, Ratio=1.96x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.224, Ratio=1.95x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.242, Ratio=2.04x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.239, Ratio=1.96x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.248, Ratio=2.12x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.238, Ratio=2.01x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.233, Ratio=1.97x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.233, Ratio=2.01x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.233, Ratio=1.98x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.246, Ratio=2.09x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.246, Ratio=2.05x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.240, Ratio=2.08x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.231, Ratio=1.94x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.238, Ratio=2.05x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.225, Ratio=1.96x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.229, Ratio=1.98x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.256, Ratio=2.10x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.242, Ratio=2.05x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.243, Ratio=2.03x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.244, Ratio=2.06x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.227, Ratio=1.95x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.228, Ratio=1.95x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.243, Ratio=2.07x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.227, Ratio=1.91x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.239, Ratio=1.94x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.227, Ratio=1.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.232, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.235, Ratio=2.08x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.242, Ratio=2.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.228, Ratio=1.98x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.222, Ratio=1.91x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.243, Ratio=2.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.232, Ratio=1.99x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.245, Ratio=2.10x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.233, Ratio=1.95x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.219, Ratio=1.90x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.06x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.232, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.241, Ratio=2.02x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.249, Ratio=2.05x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.220, Ratio=1.95x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.224, Ratio=1.97x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.223, Ratio=1.92x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.239, Ratio=2.00x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.234, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.230, Ratio=2.01x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.235, Ratio=2.05x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.231, Ratio=1.97x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.217, Ratio=1.92x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.240, Ratio=2.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.239, Ratio=2.06x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.235, Ratio=2.00x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.226, Ratio=1.94x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.248, Ratio=2.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.236, Ratio=2.04x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.226, Ratio=1.95x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.217, Ratio=1.96x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.240, Ratio=2.05x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.237, Ratio=2.08x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.236, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.233, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.222, Ratio=1.93x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.238, Ratio=2.02x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.225, Ratio=1.93x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.220, Ratio=1.94x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.239, Ratio=2.02x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.232, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.232, Ratio=2.02x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.227, Ratio=1.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.242, Ratio=2.02x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.246, Ratio=2.02x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.229, Ratio=1.96x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.245, Ratio=2.05x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.238, Ratio=1.96x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.00x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.243, Ratio=2.08x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.249, Ratio=2.08x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.235, Ratio=2.04x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.236, Ratio=2.01x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.244, Ratio=2.05x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.235, Ratio=2.03x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.234, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.243, Ratio=2.03x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.00x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.242, Ratio=1.98x, Gap=-2.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.246, Ratio=2.06x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.232, Ratio=1.94x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.239, Ratio=2.01x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.237, Ratio=2.03x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.230, Ratio=1.95x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.222, Ratio=1.94x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.234, Ratio=2.04x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.226, Ratio=1.94x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.218, Ratio=1.91x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.243, Ratio=1.98x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.222, Ratio=1.95x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.234, Ratio=2.03x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.230, Ratio=2.04x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.250, Ratio=2.07x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.227, Ratio=1.96x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.239, Ratio=2.04x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.224, Ratio=1.98x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.220, Ratio=1.91x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.236, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.244, Ratio=2.09x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.249, Ratio=2.10x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.221, Ratio=1.93x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.231, Ratio=1.98x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.230, Ratio=2.01x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.217, Ratio=1.94x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.248, Ratio=2.12x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.253, Ratio=2.12x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.239, Ratio=1.98x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.232, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.242, Ratio=2.05x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.237, Ratio=1.98x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.222, Ratio=1.89x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.226, Ratio=1.92x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.238, Ratio=2.05x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.225, Ratio=2.00x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.234, Ratio=1.96x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.217, Ratio=1.92x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.235, Ratio=1.99x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.242, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.241, Ratio=2.06x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.234, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.231, Ratio=2.02x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.246, Ratio=2.09x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.233, Ratio=2.00x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.220, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.224, Ratio=1.98x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.229, Ratio=2.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.251, Ratio=2.06x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.235, Ratio=1.99x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.228, Ratio=1.95x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.249, Ratio=2.05x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.244, Ratio=2.08x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.228, Ratio=1.95x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.251, Ratio=2.09x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.215, Ratio=1.84x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.238, Ratio=2.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.223, Ratio=1.93x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.229, Ratio=1.94x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.229, Ratio=1.99x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.237, Ratio=2.03x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.216, Ratio=1.90x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.254, Ratio=2.11x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.236, Ratio=2.03x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.225, Ratio=1.98x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.242, Ratio=1.99x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.235, Ratio=2.02x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.231, Ratio=2.00x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.223, Ratio=1.93x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.248, Ratio=2.10x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.228, Ratio=1.92x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.241, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.241, Ratio=2.02x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.235, Ratio=1.97x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.238, Ratio=2.03x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.232, Ratio=2.04x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.227, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.247, Ratio=2.07x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.235, Ratio=2.01x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.00x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.246, Ratio=2.05x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.248, Ratio=2.05x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.226, Ratio=2.01x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.246, Ratio=2.04x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.228, Ratio=2.03x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.233, Ratio=1.98x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.237, Ratio=1.97x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.227, Ratio=1.98x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.239, Ratio=2.05x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.241, Ratio=2.06x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.250, Ratio=2.09x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.217, Ratio=1.89x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.232, Ratio=2.01x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.220, Ratio=1.91x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.229, Ratio=1.96x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.254, Ratio=2.11x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.239, Ratio=1.98x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.224, Ratio=1.92x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.231, Ratio=2.01x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.242, Ratio=2.09x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.241, Ratio=2.03x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.228, Ratio=2.03x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.227, Ratio=1.98x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.237, Ratio=2.04x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.238, Ratio=2.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.224, Ratio=1.97x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.236, Ratio=2.07x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.243, Ratio=2.07x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.220, Ratio=1.95x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.240, Ratio=2.05x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.221, Ratio=1.91x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.258, Ratio=2.10x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.04x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.229, Ratio=1.93x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.227, Ratio=1.96x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.237, Ratio=2.06x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.231, Ratio=1.98x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.251, Ratio=2.11x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.246, Ratio=2.06x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.219, Ratio=1.98x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.249, Ratio=2.08x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.235, Ratio=2.04x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.238, Ratio=2.00x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.232, Ratio=1.97x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.237, Ratio=2.03x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.254, Ratio=2.03x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.246, Ratio=2.07x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.233, Ratio=1.95x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.223, Ratio=1.95x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.235, Ratio=1.97x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.225, Ratio=1.96x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.214, Ratio=1.95x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.246, Ratio=2.01x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.234, Ratio=1.97x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.223, Ratio=1.95x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.232, Ratio=1.96x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.226, Ratio=1.96x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.220, Ratio=1.92x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.223, Ratio=1.99x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.251, Ratio=2.06x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.228, Ratio=1.96x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.239, Ratio=1.99x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.255, Ratio=2.12x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.253, Ratio=2.12x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.219, Ratio=1.94x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.236, Ratio=1.99x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.234, Ratio=2.04x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.228, Ratio=1.94x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.233, Ratio=2.01x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.228, Ratio=1.99x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.238, Ratio=2.02x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.244, Ratio=2.02x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.247, Ratio=2.08x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.226, Ratio=1.98x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.238, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.247, Ratio=2.07x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.241, Ratio=2.03x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.223, Ratio=1.92x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.236, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.227, Ratio=1.96x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.243, Ratio=2.02x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.231, Ratio=1.93x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.225, Ratio=1.95x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.253, Ratio=2.11x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.244, Ratio=2.05x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.225, Ratio=1.96x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.231, Ratio=1.99x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.239, Ratio=2.01x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.234, Ratio=1.99x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.237, Ratio=1.98x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.235, Ratio=1.96x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.230, Ratio=2.00x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.225, Ratio=1.96x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.228, Ratio=1.95x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.222, Ratio=1.91x, Gap=-2.463

============================================================
Epoch 4/20 completed in 34.3s
Train: Loss=1.4429 (C:1.4429, R:0.0000) Ratio=1.97x
Val:   Loss=1.4254 (C:1.4254, R:0.0000) Ratio=2.11x
‚úÖ New best model saved (Val Loss: 1.4254)
============================================================

Epoch 5 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.254, Ratio=2.06x, Gap=-2.615
Batch   0/537: Loss=1.4031 (C:1.4031, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.234, Ratio=1.99x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.228, Ratio=1.93x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.223, Ratio=1.93x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.237, Ratio=2.02x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.243, Ratio=2.00x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.224, Ratio=1.95x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.97x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.232, Ratio=1.94x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.242, Ratio=2.02x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.223, Ratio=1.91x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.222, Ratio=1.87x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.228, Ratio=2.01x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.230, Ratio=1.99x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.239, Ratio=2.00x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.236, Ratio=1.94x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.237, Ratio=1.93x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.260, Ratio=2.09x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.230, Ratio=1.93x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.228, Ratio=1.95x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.234, Ratio=1.93x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.229, Ratio=2.02x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.218, Ratio=1.90x, Gap=-2.559
Batch  25/537: Loss=1.4632 (C:1.4632, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.240, Ratio=2.04x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.240, Ratio=1.98x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.235, Ratio=1.99x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.242, Ratio=1.99x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.239, Ratio=1.96x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.248, Ratio=2.06x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.234, Ratio=1.96x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.246, Ratio=2.02x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.243, Ratio=2.03x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.248, Ratio=2.01x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.01x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.250, Ratio=1.98x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.262, Ratio=2.07x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.225, Ratio=1.94x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.246, Ratio=1.99x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.232, Ratio=1.94x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.232, Ratio=1.99x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.232, Ratio=2.00x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.234, Ratio=2.06x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.254, Ratio=2.04x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.239, Ratio=2.00x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.252, Ratio=2.02x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.235, Ratio=1.97x, Gap=-2.633
Batch  50/537: Loss=1.4382 (C:1.4382, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.253, Ratio=2.07x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.219, Ratio=1.95x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.219, Ratio=1.97x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.238, Ratio=2.04x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.230, Ratio=1.95x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.239, Ratio=2.04x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.235, Ratio=1.95x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.233, Ratio=1.96x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.241, Ratio=2.02x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.244, Ratio=2.01x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.229, Ratio=1.95x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.243, Ratio=2.03x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.241, Ratio=1.95x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.254, Ratio=2.09x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.236, Ratio=2.04x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=1.99x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.235, Ratio=2.01x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.230, Ratio=1.93x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.246, Ratio=2.04x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.236, Ratio=2.04x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.98x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.231, Ratio=1.97x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.257, Ratio=2.06x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.220, Ratio=1.98x, Gap=-2.661
Batch  75/537: Loss=1.4404 (C:1.4404, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.236, Ratio=2.05x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.231, Ratio=1.95x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.230, Ratio=1.97x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.242, Ratio=2.00x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.230, Ratio=1.99x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.235, Ratio=1.94x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.228, Ratio=1.94x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.222, Ratio=1.93x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.250, Ratio=2.08x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.254, Ratio=2.08x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.239, Ratio=1.98x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.248, Ratio=2.00x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.250, Ratio=2.04x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.249, Ratio=2.00x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.234, Ratio=1.89x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.243, Ratio=1.97x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.231, Ratio=1.94x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.249, Ratio=2.04x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.229, Ratio=1.89x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.233, Ratio=1.99x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.239, Ratio=2.01x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.233, Ratio=1.97x, Gap=-2.547
Batch 100/537: Loss=1.4315 (C:1.4315, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.215, Ratio=1.92x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.225, Ratio=1.94x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.245, Ratio=2.00x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.244, Ratio=1.96x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.228, Ratio=1.94x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.246, Ratio=1.98x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.239, Ratio=1.95x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.248, Ratio=2.05x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.242, Ratio=1.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.227, Ratio=1.94x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.229, Ratio=1.99x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.229, Ratio=1.94x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.241, Ratio=2.05x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.241, Ratio=2.06x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.217, Ratio=1.90x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.251, Ratio=2.03x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.232, Ratio=1.91x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.235, Ratio=1.98x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.239, Ratio=2.00x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.228, Ratio=2.03x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.226, Ratio=1.98x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.241, Ratio=2.02x, Gap=-2.474
Batch 125/537: Loss=1.4156 (C:1.4156, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.218, Ratio=1.87x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.246, Ratio=2.03x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.250, Ratio=2.04x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.243, Ratio=1.95x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.255, Ratio=2.09x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.233, Ratio=1.95x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.229, Ratio=1.93x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.00x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.242, Ratio=1.98x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.224, Ratio=1.90x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.248, Ratio=2.01x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.237, Ratio=1.92x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.247, Ratio=2.05x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.241, Ratio=1.95x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.243, Ratio=1.99x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.238, Ratio=1.99x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.237, Ratio=1.98x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.247, Ratio=1.99x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.246, Ratio=2.03x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.97x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.243, Ratio=2.02x, Gap=-2.478
Batch 150/537: Loss=1.4168 (C:1.4168, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.242, Ratio=2.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.233, Ratio=1.97x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.235, Ratio=2.00x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.240, Ratio=1.99x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.224, Ratio=1.98x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.242, Ratio=2.04x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.243, Ratio=2.01x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.225, Ratio=1.96x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.228, Ratio=1.96x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.244, Ratio=2.02x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.239, Ratio=2.02x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.244, Ratio=2.06x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.248, Ratio=2.00x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.245, Ratio=2.02x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.234, Ratio=1.96x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.255, Ratio=2.08x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.236, Ratio=1.95x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.243, Ratio=1.97x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.236, Ratio=1.96x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.245, Ratio=2.00x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.213, Ratio=1.93x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.205, Ratio=1.89x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.227, Ratio=1.93x, Gap=-2.486
Batch 175/537: Loss=1.4495 (C:1.4495, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.235, Ratio=1.93x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.235, Ratio=1.98x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.255, Ratio=2.08x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.231, Ratio=1.97x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.232, Ratio=2.00x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.237, Ratio=1.98x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.233, Ratio=1.94x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.219, Ratio=1.92x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.228, Ratio=1.93x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.230, Ratio=1.96x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.237, Ratio=1.99x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.229, Ratio=1.96x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.244, Ratio=1.98x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.237, Ratio=1.96x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.234, Ratio=1.95x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.244, Ratio=1.98x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.232, Ratio=1.94x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.236, Ratio=2.01x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.224, Ratio=1.91x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.231, Ratio=1.97x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.226, Ratio=1.95x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.229, Ratio=1.98x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.232, Ratio=1.93x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.251, Ratio=2.05x, Gap=-2.627
Batch 200/537: Loss=1.4044 (C:1.4044, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.229, Ratio=1.94x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.226, Ratio=1.92x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.265, Ratio=2.07x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.236, Ratio=1.94x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.213, Ratio=1.90x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.257, Ratio=2.09x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=1.99x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.243, Ratio=2.00x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.243, Ratio=1.93x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.247, Ratio=2.04x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.249, Ratio=2.02x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.242, Ratio=2.03x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.243, Ratio=1.96x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.226, Ratio=1.91x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.248, Ratio=2.07x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.225, Ratio=1.96x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.226, Ratio=1.94x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.223, Ratio=1.99x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.223, Ratio=1.95x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.249, Ratio=2.03x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.241, Ratio=1.98x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.247, Ratio=2.03x, Gap=-2.560
Batch 225/537: Loss=1.4143 (C:1.4143, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.229, Ratio=1.92x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.244, Ratio=2.01x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.218, Ratio=1.89x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.224, Ratio=1.91x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.232, Ratio=2.03x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.235, Ratio=1.99x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.228, Ratio=1.91x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.242, Ratio=2.04x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.225, Ratio=1.93x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.248, Ratio=2.04x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.230, Ratio=1.94x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.243, Ratio=2.02x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.222, Ratio=1.94x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.231, Ratio=2.01x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.233, Ratio=1.99x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.253, Ratio=2.03x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.242, Ratio=2.03x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=2.00x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.230, Ratio=1.94x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.218, Ratio=1.92x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.235, Ratio=1.95x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.250, Ratio=2.05x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.217, Ratio=1.98x, Gap=-2.600
Batch 250/537: Loss=1.4386 (C:1.4386, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.235, Ratio=1.97x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.246, Ratio=2.02x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.225, Ratio=1.97x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.229, Ratio=1.97x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.223, Ratio=1.90x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.224, Ratio=1.90x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.237, Ratio=1.96x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.225, Ratio=1.91x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.235, Ratio=1.95x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.228, Ratio=1.94x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.240, Ratio=1.97x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.247, Ratio=2.11x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.218, Ratio=1.89x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.225, Ratio=1.93x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.243, Ratio=2.07x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.231, Ratio=1.99x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.242, Ratio=2.02x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.235, Ratio=2.04x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.230, Ratio=1.94x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.233, Ratio=1.91x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.239, Ratio=1.92x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.234, Ratio=1.95x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.240, Ratio=2.02x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.232, Ratio=1.99x, Gap=-2.477
Batch 275/537: Loss=1.4308 (C:1.4308, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.223, Ratio=1.92x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.231, Ratio=1.99x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.228, Ratio=2.00x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.266, Ratio=2.12x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.235, Ratio=1.92x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.224, Ratio=1.91x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.237, Ratio=1.92x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.244, Ratio=2.03x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.234, Ratio=1.95x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.221, Ratio=1.91x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.252, Ratio=2.12x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.224, Ratio=1.93x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.239, Ratio=2.02x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.235, Ratio=1.95x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.233, Ratio=1.91x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.231, Ratio=1.95x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.260, Ratio=2.11x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.243, Ratio=2.07x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.238, Ratio=1.96x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.239, Ratio=2.00x, Gap=-2.666
Batch 300/537: Loss=1.4269 (C:1.4269, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.230, Ratio=1.97x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.242, Ratio=2.00x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.235, Ratio=1.96x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.240, Ratio=1.99x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.228, Ratio=1.94x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.238, Ratio=1.90x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.249, Ratio=2.00x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.231, Ratio=1.98x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.222, Ratio=1.93x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.229, Ratio=1.97x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.220, Ratio=1.95x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.228, Ratio=1.94x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.235, Ratio=1.99x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.236, Ratio=1.97x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.254, Ratio=2.03x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.245, Ratio=2.03x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.247, Ratio=2.02x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.233, Ratio=1.97x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.234, Ratio=1.94x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.240, Ratio=1.99x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.227, Ratio=1.91x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.249, Ratio=2.00x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.247, Ratio=2.01x, Gap=-2.706
Batch 325/537: Loss=1.4188 (C:1.4188, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.242, Ratio=1.98x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.232, Ratio=1.94x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.225, Ratio=1.89x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.226, Ratio=1.95x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.250, Ratio=2.09x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.234, Ratio=2.00x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.224, Ratio=1.94x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.225, Ratio=1.93x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.236, Ratio=2.02x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.243, Ratio=1.98x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.247, Ratio=1.99x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.225, Ratio=1.91x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.223, Ratio=1.89x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.234, Ratio=1.97x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.240, Ratio=2.03x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.218, Ratio=1.93x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.242, Ratio=2.03x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.232, Ratio=1.93x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.243, Ratio=1.99x, Gap=-2.592
Batch 350/537: Loss=1.4270 (C:1.4270, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.249, Ratio=2.03x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.216, Ratio=1.89x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.230, Ratio=1.93x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.201, Ratio=1.85x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.238, Ratio=2.02x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.247, Ratio=2.04x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.233, Ratio=1.99x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.249, Ratio=2.04x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.232, Ratio=1.99x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.256, Ratio=2.09x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.246, Ratio=2.02x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.249, Ratio=2.01x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.249, Ratio=2.03x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.237, Ratio=2.02x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.248, Ratio=2.09x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.228, Ratio=1.97x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.237, Ratio=2.00x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.238, Ratio=1.97x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.247, Ratio=2.03x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.245, Ratio=2.00x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.238, Ratio=1.95x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.245, Ratio=2.00x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.243, Ratio=2.00x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.226, Ratio=1.93x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.249, Ratio=2.06x, Gap=-2.806
Batch 375/537: Loss=1.4021 (C:1.4021, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.227, Ratio=1.92x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.225, Ratio=1.93x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.235, Ratio=2.00x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.234, Ratio=2.03x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.223, Ratio=1.96x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.229, Ratio=1.95x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.245, Ratio=2.03x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.245, Ratio=2.05x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.249, Ratio=2.05x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.231, Ratio=1.95x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.237, Ratio=1.98x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.218, Ratio=1.89x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.258, Ratio=2.06x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.235, Ratio=1.96x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.237, Ratio=1.98x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.236, Ratio=2.02x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.229, Ratio=2.02x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.233, Ratio=1.99x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.238, Ratio=1.97x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.225, Ratio=1.99x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.241, Ratio=1.99x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.230, Ratio=1.92x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.643
Batch 400/537: Loss=1.4068 (C:1.4068, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.231, Ratio=1.93x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.227, Ratio=1.93x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.241, Ratio=2.05x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.235, Ratio=2.00x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.230, Ratio=1.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.236, Ratio=2.03x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.242, Ratio=1.99x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.250, Ratio=2.05x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.253, Ratio=2.08x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.242, Ratio=1.97x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.253, Ratio=2.04x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.240, Ratio=1.97x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.233, Ratio=2.03x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.229, Ratio=2.01x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.238, Ratio=2.02x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.243, Ratio=2.04x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.222, Ratio=1.89x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.244, Ratio=2.03x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.240, Ratio=2.01x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.235, Ratio=1.98x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.233, Ratio=1.94x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.224, Ratio=1.88x, Gap=-2.651
Batch 425/537: Loss=1.4712 (C:1.4712, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.236, Ratio=1.97x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.227, Ratio=1.99x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.230, Ratio=2.07x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.224, Ratio=1.90x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.220, Ratio=1.89x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.230, Ratio=1.98x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.251, Ratio=2.03x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.234, Ratio=1.93x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.230, Ratio=1.95x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.252, Ratio=2.04x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.220, Ratio=1.93x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.228, Ratio=1.99x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.220, Ratio=1.92x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.230, Ratio=1.99x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.240, Ratio=2.03x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.230, Ratio=1.98x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.246, Ratio=2.03x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.238, Ratio=1.97x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.215, Ratio=1.84x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.243, Ratio=2.01x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.235, Ratio=1.96x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.237, Ratio=1.96x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.243, Ratio=1.99x, Gap=-2.581
Batch 450/537: Loss=1.4256 (C:1.4256, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.223, Ratio=1.93x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.245, Ratio=2.04x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.228, Ratio=1.97x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.220, Ratio=1.92x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.03x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.239, Ratio=1.97x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.248, Ratio=2.06x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.244, Ratio=1.97x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.228, Ratio=1.92x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.246, Ratio=2.05x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.245, Ratio=2.02x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.242, Ratio=1.99x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.237, Ratio=1.99x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.228, Ratio=1.95x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.237, Ratio=1.98x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.234, Ratio=1.98x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.245, Ratio=2.03x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.253, Ratio=2.09x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.265, Ratio=2.17x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.252, Ratio=2.02x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.251, Ratio=2.10x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.229, Ratio=1.96x, Gap=-2.562
Batch 475/537: Loss=1.4403 (C:1.4403, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.252, Ratio=2.10x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.227, Ratio=1.95x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.232, Ratio=1.97x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.249, Ratio=2.11x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.234, Ratio=1.99x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.230, Ratio=1.93x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.252, Ratio=2.03x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.223, Ratio=1.96x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.254, Ratio=2.08x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.238, Ratio=1.97x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.246, Ratio=2.01x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.236, Ratio=1.96x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.240, Ratio=1.96x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.240, Ratio=1.95x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.237, Ratio=1.98x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.227, Ratio=1.93x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.238, Ratio=1.96x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.238, Ratio=1.99x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.231, Ratio=1.97x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.219, Ratio=1.96x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.228, Ratio=2.03x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.237, Ratio=1.96x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.242, Ratio=2.07x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.243, Ratio=2.06x, Gap=-2.545
Batch 500/537: Loss=1.4045 (C:1.4045, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.242, Ratio=2.04x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.243, Ratio=2.00x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.250, Ratio=2.04x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.231, Ratio=1.93x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.256, Ratio=2.07x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.244, Ratio=2.02x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.248, Ratio=2.04x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.230, Ratio=1.98x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.223, Ratio=1.95x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.220, Ratio=1.97x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.242, Ratio=2.00x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.232, Ratio=1.98x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.251, Ratio=2.06x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.226, Ratio=1.95x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.238, Ratio=1.99x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.237, Ratio=1.95x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.267, Ratio=2.09x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.237, Ratio=1.96x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.251, Ratio=2.02x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.233, Ratio=1.94x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.225, Ratio=2.01x, Gap=-2.524
Batch 525/537: Loss=1.4260 (C:1.4260, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.233, Ratio=1.95x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.228, Ratio=1.99x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.244, Ratio=2.01x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.04x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.238, Ratio=1.96x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.226, Ratio=1.91x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.247, Ratio=2.01x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.237, Ratio=1.94x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.244, Ratio=1.99x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.221, Ratio=1.94x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.243, Ratio=2.02x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.235, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.253, Ratio=2.09x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.247, Ratio=2.11x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.230, Ratio=2.01x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.224, Ratio=2.01x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.216, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.222, Ratio=1.95x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.232, Ratio=2.07x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.233, Ratio=1.98x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.238, Ratio=2.08x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.242, Ratio=2.05x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.232, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.223, Ratio=1.97x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.231, Ratio=1.99x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.237, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.230, Ratio=1.99x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.241, Ratio=2.06x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.228, Ratio=1.96x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.238, Ratio=2.07x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.236, Ratio=2.03x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.247, Ratio=2.12x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.214, Ratio=1.94x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.222, Ratio=1.95x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.228, Ratio=1.99x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.240, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.241, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.236, Ratio=2.06x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.243, Ratio=2.09x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.04x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.224, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.229, Ratio=2.00x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.228, Ratio=2.00x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.225, Ratio=1.96x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.229, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.229, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.01x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.245, Ratio=2.07x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.223, Ratio=1.96x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.228, Ratio=1.96x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.246, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.227, Ratio=1.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.237, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.223, Ratio=1.97x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.218, Ratio=1.95x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.244, Ratio=2.07x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.218, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.224, Ratio=1.97x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.243, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.245, Ratio=2.09x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.244, Ratio=2.06x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.220, Ratio=1.92x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.231, Ratio=2.06x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.226, Ratio=2.00x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.243, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.225, Ratio=2.00x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.224, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.225, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.230, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.256, Ratio=2.15x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.231, Ratio=1.98x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.227, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.239, Ratio=2.08x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.235, Ratio=2.06x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.232, Ratio=2.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.261, Ratio=2.14x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.250, Ratio=2.12x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.233, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.229, Ratio=2.03x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.253, Ratio=2.16x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.237, Ratio=2.00x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.232, Ratio=2.03x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.220, Ratio=1.95x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.240, Ratio=2.05x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.223, Ratio=1.94x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.244, Ratio=2.09x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.229, Ratio=2.01x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.232, Ratio=2.03x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.227, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.239, Ratio=2.08x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.241, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.235, Ratio=2.04x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.248, Ratio=2.13x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.257, Ratio=2.16x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.254, Ratio=2.18x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.240, Ratio=2.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.246, Ratio=2.08x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.237, Ratio=2.07x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.243, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.242, Ratio=2.11x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.230, Ratio=2.01x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.217, Ratio=1.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.242, Ratio=2.09x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.229, Ratio=2.04x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.242, Ratio=2.06x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.228, Ratio=1.99x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.242, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.238, Ratio=2.00x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.247, Ratio=2.06x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.248, Ratio=2.06x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.236, Ratio=2.07x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.234, Ratio=2.05x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.219, Ratio=1.95x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.227, Ratio=2.05x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.245, Ratio=2.10x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.256, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.249, Ratio=2.13x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.233, Ratio=2.00x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.235, Ratio=2.02x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.223, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.237, Ratio=2.01x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.223, Ratio=1.93x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.238, Ratio=2.05x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.244, Ratio=2.06x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.238, Ratio=2.04x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.238, Ratio=1.96x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.224, Ratio=2.04x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.223, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.246, Ratio=2.12x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.242, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.233, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.232, Ratio=2.01x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.241, Ratio=2.00x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.221, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.254, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.233, Ratio=2.05x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.241, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.232, Ratio=2.02x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.228, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.235, Ratio=2.07x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.227, Ratio=2.01x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.242, Ratio=2.10x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.245, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.245, Ratio=2.08x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.235, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.222, Ratio=1.99x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.234, Ratio=2.01x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.253, Ratio=2.07x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.230, Ratio=1.98x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.224, Ratio=1.96x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.229, Ratio=2.00x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.255, Ratio=2.14x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.224, Ratio=1.98x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.244, Ratio=2.09x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.234, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.230, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.241, Ratio=2.03x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.245, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.230, Ratio=1.97x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.216, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.226, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.245, Ratio=2.09x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.238, Ratio=2.05x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.229, Ratio=2.00x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.241, Ratio=2.10x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.248, Ratio=2.12x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.226, Ratio=1.96x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.247, Ratio=2.11x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.249, Ratio=2.11x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.244, Ratio=2.16x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.225, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.240, Ratio=2.05x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.220, Ratio=1.98x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.234, Ratio=2.07x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.251, Ratio=2.08x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.250, Ratio=2.06x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.238, Ratio=2.08x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.239, Ratio=2.05x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.236, Ratio=2.05x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.230, Ratio=1.97x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.229, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.225, Ratio=2.00x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.237, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.03x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.247, Ratio=2.07x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.224, Ratio=1.98x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.241, Ratio=2.05x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.232, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.240, Ratio=2.09x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.241, Ratio=2.09x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.215, Ratio=1.94x, Gap=-2.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.243, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.242, Ratio=2.09x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.236, Ratio=2.00x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.217, Ratio=1.94x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.214, Ratio=1.97x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.235, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.229, Ratio=1.94x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.218, Ratio=1.98x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.237, Ratio=2.08x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.241, Ratio=2.01x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.227, Ratio=1.96x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.237, Ratio=2.07x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.232, Ratio=2.03x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.231, Ratio=2.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.240, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.237, Ratio=2.06x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.229, Ratio=1.98x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.234, Ratio=2.04x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.247, Ratio=2.16x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.241, Ratio=2.09x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.243, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.265, Ratio=2.24x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.244, Ratio=2.07x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.226, Ratio=1.98x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.231, Ratio=2.00x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.247, Ratio=2.11x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.226, Ratio=1.98x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.249, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.231, Ratio=1.97x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.239, Ratio=2.06x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.236, Ratio=2.03x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.229, Ratio=2.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.245, Ratio=2.08x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.235, Ratio=2.04x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.234, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.254, Ratio=2.13x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.231, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.253, Ratio=2.11x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.243, Ratio=2.05x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.223, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.242, Ratio=2.03x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.223, Ratio=1.96x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.241, Ratio=2.00x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.231, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.224, Ratio=1.96x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.240, Ratio=2.05x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.234, Ratio=2.05x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.224, Ratio=1.97x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.234, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.242, Ratio=2.07x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.222, Ratio=1.98x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.243, Ratio=2.09x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.236, Ratio=2.09x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.234, Ratio=1.98x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.233, Ratio=1.99x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.229, Ratio=2.01x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.217, Ratio=1.93x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.235, Ratio=2.02x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.239, Ratio=2.02x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.229, Ratio=2.04x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.232, Ratio=2.00x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.229, Ratio=1.97x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.238, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.245, Ratio=2.07x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.229, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.235, Ratio=2.02x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.237, Ratio=2.07x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.239, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.230, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.231, Ratio=2.01x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.226, Ratio=2.01x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.239, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.246, Ratio=2.10x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.247, Ratio=2.11x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.229, Ratio=1.95x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.240, Ratio=2.14x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.226, Ratio=1.98x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.241, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.234, Ratio=2.06x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.235, Ratio=2.03x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.229, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.246, Ratio=2.12x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.250, Ratio=2.15x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.229, Ratio=2.05x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.243, Ratio=2.05x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.229, Ratio=2.00x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.237, Ratio=2.07x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.234, Ratio=2.04x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.242, Ratio=2.07x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.229, Ratio=2.01x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.228, Ratio=1.99x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.224, Ratio=1.99x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.254, Ratio=2.16x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.236, Ratio=2.08x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.224, Ratio=1.94x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.244, Ratio=2.07x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.238, Ratio=2.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.236, Ratio=1.97x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.242, Ratio=2.07x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.250, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.223, Ratio=1.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.230, Ratio=1.99x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.232, Ratio=2.01x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.240, Ratio=2.04x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.249, Ratio=2.13x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.230, Ratio=2.07x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.248, Ratio=2.12x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.234, Ratio=2.01x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.230, Ratio=2.02x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.216, Ratio=1.93x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.237, Ratio=2.02x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.229, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.240, Ratio=2.06x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.231, Ratio=2.02x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.232, Ratio=1.98x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.244, Ratio=2.11x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.252, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.223, Ratio=1.97x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.232, Ratio=1.98x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.229, Ratio=2.01x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.238, Ratio=2.05x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.232, Ratio=2.05x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.222, Ratio=1.96x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.242, Ratio=2.09x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.247, Ratio=2.10x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.240, Ratio=2.06x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.226, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.234, Ratio=2.04x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.255, Ratio=2.11x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.243, Ratio=2.10x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.232, Ratio=1.97x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.226, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.228, Ratio=2.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.228, Ratio=2.02x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.225, Ratio=1.98x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.227, Ratio=1.99x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.230, Ratio=2.04x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.232, Ratio=1.96x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.216, Ratio=1.91x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.238, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.236, Ratio=2.00x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.230, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=2.00x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.233, Ratio=2.01x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.244, Ratio=2.13x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.228, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.248, Ratio=2.11x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.239, Ratio=2.05x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.242, Ratio=2.11x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.236, Ratio=2.03x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.239, Ratio=2.09x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.239, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.236, Ratio=2.04x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.221, Ratio=1.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.231, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.241, Ratio=2.02x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.224, Ratio=1.96x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.239, Ratio=2.11x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.245, Ratio=2.13x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.243, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.240, Ratio=2.05x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.226, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.219, Ratio=1.90x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.236, Ratio=2.09x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.245, Ratio=2.12x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.249, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.222, Ratio=1.96x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.217, Ratio=1.96x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.231, Ratio=1.99x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.235, Ratio=2.01x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.223, Ratio=1.92x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.236, Ratio=2.09x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.244, Ratio=2.08x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.253, Ratio=2.18x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.230, Ratio=2.00x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.236, Ratio=2.04x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.256, Ratio=2.10x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.237, Ratio=2.05x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.227, Ratio=1.95x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.230, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.235, Ratio=2.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.243, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.239, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.234, Ratio=2.01x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.238, Ratio=2.04x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.229, Ratio=1.96x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.230, Ratio=1.97x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.242, Ratio=2.06x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.227, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.231, Ratio=2.00x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.242, Ratio=2.09x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.224, Ratio=2.01x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.238, Ratio=2.04x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.223, Ratio=1.97x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.250, Ratio=2.09x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.241, Ratio=2.04x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.235, Ratio=2.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.229, Ratio=1.96x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.239, Ratio=2.05x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.237, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.236, Ratio=2.02x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.230, Ratio=2.00x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.243, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.235, Ratio=2.06x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.224, Ratio=1.91x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.231, Ratio=2.02x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.223, Ratio=1.94x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.216, Ratio=1.95x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.238, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.242, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.238, Ratio=2.08x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.246, Ratio=2.04x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.229, Ratio=1.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.253, Ratio=2.17x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.230, Ratio=1.96x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.235, Ratio=2.06x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.233, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.253, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.227, Ratio=2.03x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.244, Ratio=2.11x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.240, Ratio=2.05x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.247, Ratio=2.07x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.229, Ratio=2.00x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.236, Ratio=2.06x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.243, Ratio=2.11x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.246, Ratio=2.06x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.244, Ratio=2.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.242, Ratio=2.05x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.242, Ratio=2.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.207, Ratio=1.92x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.241, Ratio=2.07x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.238, Ratio=2.04x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.235, Ratio=1.98x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.228, Ratio=2.02x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.241, Ratio=2.08x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.249, Ratio=2.08x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.231, Ratio=2.02x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.220, Ratio=1.92x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.224, Ratio=1.98x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.245, Ratio=2.09x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.242, Ratio=2.00x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.03x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.233, Ratio=2.00x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.227, Ratio=2.05x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.225, Ratio=2.00x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.228, Ratio=1.98x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.228, Ratio=2.04x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.236, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.249, Ratio=2.07x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.229, Ratio=1.95x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.231, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.243, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.243, Ratio=2.07x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.230, Ratio=1.99x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.254, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.242, Ratio=2.11x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.01x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.232, Ratio=2.00x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.229, Ratio=2.05x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.248, Ratio=2.11x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.236, Ratio=2.02x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.246, Ratio=2.12x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.246, Ratio=2.06x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.231, Ratio=2.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.230, Ratio=2.02x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.246, Ratio=2.12x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.248, Ratio=2.07x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.237, Ratio=2.04x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.240, Ratio=2.04x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.237, Ratio=2.04x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.229, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.236, Ratio=2.05x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.235, Ratio=2.00x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.223, Ratio=1.92x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.235, Ratio=2.06x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.233, Ratio=2.01x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.239, Ratio=2.09x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.233, Ratio=1.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.245, Ratio=2.10x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.268, Ratio=2.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.244, Ratio=2.09x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.239, Ratio=2.08x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.235, Ratio=1.99x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.224, Ratio=1.99x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.218, Ratio=1.92x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.235, Ratio=2.02x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.230, Ratio=2.05x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.243, Ratio=2.07x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.234, Ratio=2.03x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.246, Ratio=2.09x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.246, Ratio=2.09x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.225, Ratio=1.94x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.246, Ratio=2.11x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.228, Ratio=2.00x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.238, Ratio=2.04x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.251, Ratio=2.09x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.237, Ratio=2.01x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.226, Ratio=2.01x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.236, Ratio=2.07x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.231, Ratio=1.99x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.216, Ratio=1.95x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.227, Ratio=1.97x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.234, Ratio=2.03x, Gap=-2.464

============================================================
Epoch 5/20 completed in 29.1s
Train: Loss=1.4299 (C:1.4299, R:0.0000) Ratio=2.07x
Val:   Loss=1.4138 (C:1.4138, R:0.0000) Ratio=2.19x
‚úÖ New best model saved (Val Loss: 1.4138)
Checkpoint saved at epoch 5
============================================================

Epoch 6 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.240, Ratio=1.97x, Gap=-2.591
Batch   0/537: Loss=1.4332 (C:1.4332, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.235, Ratio=1.97x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.252, Ratio=2.08x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.230, Ratio=1.99x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.237, Ratio=1.97x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.249, Ratio=2.05x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.248, Ratio=2.07x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.246, Ratio=2.01x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.241, Ratio=2.00x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.236, Ratio=2.00x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.233, Ratio=1.97x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.226, Ratio=1.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.247, Ratio=2.06x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.223, Ratio=1.96x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.233, Ratio=2.01x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.232, Ratio=1.98x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.263, Ratio=2.11x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.242, Ratio=1.97x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.243, Ratio=2.03x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.229, Ratio=1.95x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.235, Ratio=1.99x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.255, Ratio=2.07x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.223, Ratio=1.94x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=1.99x, Gap=-2.639
Batch  25/537: Loss=1.4297 (C:1.4297, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.241, Ratio=2.04x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.236, Ratio=2.01x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.244, Ratio=2.00x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.241, Ratio=1.99x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.234, Ratio=2.04x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.236, Ratio=2.02x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.248, Ratio=2.03x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.248, Ratio=2.07x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.242, Ratio=2.02x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.252, Ratio=2.07x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.229, Ratio=1.94x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.252, Ratio=2.04x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.246, Ratio=2.04x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.246, Ratio=2.08x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.226, Ratio=1.90x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.252, Ratio=2.06x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.248, Ratio=2.06x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.228, Ratio=1.96x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.228, Ratio=1.90x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.240, Ratio=2.04x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.225, Ratio=1.96x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.628
Batch  50/537: Loss=1.4151 (C:1.4151, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.224, Ratio=1.95x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.240, Ratio=2.05x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.231, Ratio=2.00x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.248, Ratio=2.08x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.243, Ratio=1.97x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.235, Ratio=1.96x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.245, Ratio=2.08x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.238, Ratio=1.98x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.242, Ratio=2.05x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.220, Ratio=1.94x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.223, Ratio=1.93x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.242, Ratio=1.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.242, Ratio=2.03x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.222, Ratio=1.92x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.242, Ratio=1.99x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.261, Ratio=2.07x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.257, Ratio=2.05x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.235, Ratio=1.99x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.220, Ratio=1.92x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.249, Ratio=2.05x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.04x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.234, Ratio=1.99x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.250, Ratio=2.07x, Gap=-2.555
Batch  75/537: Loss=1.4000 (C:1.4000, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.248, Ratio=2.07x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.219, Ratio=1.91x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.248, Ratio=2.04x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.244, Ratio=2.02x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.240, Ratio=2.02x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.244, Ratio=2.02x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.255, Ratio=2.07x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.248, Ratio=2.04x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.246, Ratio=2.04x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.252, Ratio=2.01x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.243, Ratio=2.00x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.239, Ratio=2.06x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.244, Ratio=2.03x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.237, Ratio=2.01x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.240, Ratio=1.99x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.232, Ratio=1.96x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.249, Ratio=2.09x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.239, Ratio=2.00x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.00x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.246, Ratio=2.00x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.247, Ratio=2.05x, Gap=-2.601
Batch 100/537: Loss=1.4081 (C:1.4081, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.236, Ratio=2.04x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.240, Ratio=1.96x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.227, Ratio=1.97x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.240, Ratio=2.06x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.246, Ratio=2.03x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.250, Ratio=2.07x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.225, Ratio=1.91x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.240, Ratio=1.94x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.243, Ratio=2.08x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.246, Ratio=1.99x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.242, Ratio=1.95x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.249, Ratio=2.06x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.242, Ratio=2.01x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.237, Ratio=2.02x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.249, Ratio=2.06x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.240, Ratio=1.95x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.234, Ratio=1.96x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.242, Ratio=1.99x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.236, Ratio=2.00x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.246, Ratio=2.04x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.234, Ratio=1.98x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.228, Ratio=2.00x, Gap=-2.679
Batch 125/537: Loss=1.4288 (C:1.4288, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.249, Ratio=2.07x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.253, Ratio=2.06x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.256, Ratio=2.13x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.248, Ratio=2.03x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.253, Ratio=2.01x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.237, Ratio=2.00x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.237, Ratio=1.95x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.241, Ratio=1.98x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.255, Ratio=2.05x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.234, Ratio=2.00x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.232, Ratio=1.97x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.250, Ratio=2.09x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.232, Ratio=2.05x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.256, Ratio=2.06x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.244, Ratio=1.95x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.228, Ratio=1.93x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.245, Ratio=2.09x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.225, Ratio=1.96x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.230, Ratio=1.97x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.253, Ratio=2.04x, Gap=-2.610
Batch 150/537: Loss=1.4061 (C:1.4061, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.248, Ratio=2.00x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.250, Ratio=1.99x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.254, Ratio=2.05x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.249, Ratio=2.03x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.247, Ratio=2.04x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.249, Ratio=2.02x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.237, Ratio=1.99x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.240, Ratio=2.01x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.232, Ratio=1.95x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.234, Ratio=1.93x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.228, Ratio=1.95x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.230, Ratio=1.92x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.227, Ratio=1.95x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.235, Ratio=1.97x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.251, Ratio=2.07x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.220, Ratio=1.93x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.250, Ratio=2.04x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.253, Ratio=2.05x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.255, Ratio=2.04x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.252, Ratio=2.06x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.244, Ratio=2.03x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.242, Ratio=1.95x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.246, Ratio=2.03x, Gap=-2.668
Batch 175/537: Loss=1.4113 (C:1.4113, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.226, Ratio=1.99x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.229, Ratio=1.96x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.03x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.227, Ratio=1.92x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.249, Ratio=1.99x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.238, Ratio=2.01x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.249, Ratio=2.04x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=2.00x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.248, Ratio=2.02x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.231, Ratio=1.99x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.250, Ratio=2.04x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.244, Ratio=2.01x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.253, Ratio=2.08x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.242, Ratio=2.00x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.216, Ratio=1.93x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.249, Ratio=2.00x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.255, Ratio=2.04x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.258, Ratio=2.04x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.256, Ratio=2.08x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.245, Ratio=1.99x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.254, Ratio=2.04x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.243, Ratio=2.01x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.242, Ratio=2.04x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.232, Ratio=2.03x, Gap=-2.476
Batch 200/537: Loss=1.4189 (C:1.4189, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.237, Ratio=2.02x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.240, Ratio=2.00x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.239, Ratio=2.01x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.228, Ratio=1.95x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.227, Ratio=1.98x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.238, Ratio=2.02x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.253, Ratio=2.02x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.235, Ratio=1.99x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.225, Ratio=1.97x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.258, Ratio=2.10x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.242, Ratio=1.98x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.253, Ratio=2.09x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.248, Ratio=2.04x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.245, Ratio=2.00x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.220, Ratio=1.91x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.233, Ratio=2.00x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.240, Ratio=1.96x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.247, Ratio=2.04x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.243, Ratio=2.01x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.246, Ratio=2.04x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.225, Ratio=1.94x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.234, Ratio=1.94x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.234, Ratio=1.96x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.251, Ratio=2.02x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.256, Ratio=2.02x, Gap=-2.913
Batch 225/537: Loss=1.4134 (C:1.4134, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.221, Ratio=1.96x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.254, Ratio=2.05x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.231, Ratio=2.02x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.234, Ratio=1.97x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.233, Ratio=1.98x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.03x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.238, Ratio=2.00x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.245, Ratio=2.02x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.235, Ratio=1.97x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.249, Ratio=2.07x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.259, Ratio=2.09x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.234, Ratio=1.95x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.260, Ratio=2.05x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.251, Ratio=2.00x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.245, Ratio=1.99x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.226, Ratio=1.98x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.215, Ratio=1.93x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.221, Ratio=1.92x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.232, Ratio=2.03x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.235, Ratio=1.96x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.231, Ratio=1.89x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.227, Ratio=1.91x, Gap=-2.596
Batch 250/537: Loss=1.4574 (C:1.4574, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.250, Ratio=2.01x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.262, Ratio=2.10x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.249, Ratio=2.02x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.257, Ratio=2.09x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.242, Ratio=1.95x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.256, Ratio=2.05x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.241, Ratio=1.95x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.225, Ratio=1.96x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.254, Ratio=2.12x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.227, Ratio=2.03x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.241, Ratio=1.96x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.242, Ratio=2.02x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.237, Ratio=2.03x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.232, Ratio=1.96x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.237, Ratio=2.03x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.251, Ratio=2.04x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.224, Ratio=1.94x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.263, Ratio=2.08x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.240, Ratio=2.01x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.245, Ratio=1.98x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.252, Ratio=2.04x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.255, Ratio=2.09x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.224, Ratio=1.93x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.232, Ratio=1.95x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.247, Ratio=2.04x, Gap=-2.598
Batch 275/537: Loss=1.4095 (C:1.4095, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.243, Ratio=2.01x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.254, Ratio=2.09x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.239, Ratio=1.98x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.236, Ratio=1.95x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.243, Ratio=2.06x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.231, Ratio=1.94x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.244, Ratio=2.02x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.249, Ratio=2.00x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.245, Ratio=2.01x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.241, Ratio=2.00x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.246, Ratio=2.05x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.241, Ratio=2.01x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.240, Ratio=1.98x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.238, Ratio=2.07x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.232, Ratio=1.98x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.242, Ratio=1.98x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.248, Ratio=2.06x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.239, Ratio=1.99x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.238, Ratio=1.96x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.228, Ratio=1.93x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.241, Ratio=2.02x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.245, Ratio=2.04x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.236, Ratio=1.97x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.237, Ratio=2.02x, Gap=-2.671
Batch 300/537: Loss=1.4176 (C:1.4176, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.228, Ratio=2.02x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.234, Ratio=2.02x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.226, Ratio=1.96x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.237, Ratio=1.97x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.247, Ratio=2.03x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.250, Ratio=2.07x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.249, Ratio=2.04x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.252, Ratio=2.08x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.232, Ratio=2.00x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.222, Ratio=1.89x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.228, Ratio=2.02x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.227, Ratio=2.01x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.226, Ratio=1.99x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.228, Ratio=2.00x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.222, Ratio=1.96x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.224, Ratio=2.00x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.239, Ratio=2.00x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.253, Ratio=2.08x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.246, Ratio=2.03x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.268, Ratio=2.13x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.231, Ratio=1.95x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.235, Ratio=1.94x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.246, Ratio=2.01x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.219, Ratio=1.91x, Gap=-2.528
Batch 325/537: Loss=1.4595 (C:1.4595, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.221, Ratio=1.95x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.242, Ratio=2.07x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.230, Ratio=2.03x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.244, Ratio=2.02x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.259, Ratio=2.09x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.258, Ratio=2.05x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.250, Ratio=2.06x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.254, Ratio=2.06x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.243, Ratio=2.00x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.246, Ratio=2.04x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.239, Ratio=2.00x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.243, Ratio=2.03x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.255, Ratio=2.07x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.238, Ratio=1.97x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.258, Ratio=2.08x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.252, Ratio=2.03x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.240, Ratio=2.03x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.235, Ratio=2.04x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.234, Ratio=2.03x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.248, Ratio=2.04x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.238, Ratio=1.97x, Gap=-2.535
Batch 350/537: Loss=1.4331 (C:1.4331, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.219, Ratio=1.87x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.249, Ratio=2.10x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.245, Ratio=2.01x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.252, Ratio=2.11x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.226, Ratio=1.96x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.258, Ratio=2.08x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.258, Ratio=2.08x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.239, Ratio=1.99x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.224, Ratio=1.92x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.225, Ratio=1.97x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.225, Ratio=1.95x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.221, Ratio=1.94x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.01x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.225, Ratio=1.94x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.231, Ratio=2.00x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.232, Ratio=2.01x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.256, Ratio=2.06x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.251, Ratio=2.05x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.251, Ratio=2.03x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.251, Ratio=2.01x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.269, Ratio=2.11x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.245, Ratio=2.03x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.239, Ratio=2.03x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.230, Ratio=2.00x, Gap=-2.542
Batch 375/537: Loss=1.4262 (C:1.4262, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=2.00x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.241, Ratio=2.02x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.232, Ratio=1.94x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.254, Ratio=2.00x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.254, Ratio=2.06x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.246, Ratio=2.00x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.243, Ratio=2.08x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.240, Ratio=2.02x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.244, Ratio=2.04x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.242, Ratio=2.00x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.242, Ratio=2.02x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.233, Ratio=2.01x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.237, Ratio=2.01x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.229, Ratio=1.92x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.244, Ratio=1.99x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.251, Ratio=2.03x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.244, Ratio=2.03x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.237, Ratio=2.01x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.233, Ratio=1.94x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.240, Ratio=1.99x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.252, Ratio=2.01x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.260, Ratio=2.12x, Gap=-2.532
Batch 400/537: Loss=1.3804 (C:1.3804, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.256, Ratio=2.01x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.245, Ratio=2.04x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.252, Ratio=2.06x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.243, Ratio=2.00x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.249, Ratio=2.02x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.243, Ratio=2.00x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.248, Ratio=2.05x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.257, Ratio=2.05x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.232, Ratio=1.94x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.250, Ratio=2.01x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.234, Ratio=2.01x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.239, Ratio=2.02x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.265, Ratio=2.15x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.241, Ratio=2.01x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.252, Ratio=2.01x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.253, Ratio=2.06x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.234, Ratio=1.99x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.240, Ratio=1.97x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.236, Ratio=1.96x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.238, Ratio=1.97x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.237, Ratio=1.98x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.257, Ratio=2.11x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.242, Ratio=1.99x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.239, Ratio=2.04x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.241, Ratio=2.00x, Gap=-2.785
Batch 425/537: Loss=1.4249 (C:1.4249, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.04x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.224, Ratio=1.94x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.253, Ratio=2.08x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.240, Ratio=2.01x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.248, Ratio=2.02x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.237, Ratio=2.01x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.249, Ratio=2.04x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.244, Ratio=2.01x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.263, Ratio=2.09x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.251, Ratio=2.06x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.230, Ratio=1.90x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.232, Ratio=1.92x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.247, Ratio=2.04x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.233, Ratio=1.97x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.226, Ratio=1.91x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.241, Ratio=2.01x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.247, Ratio=2.02x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.244, Ratio=2.01x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.231, Ratio=1.97x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.233, Ratio=1.97x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.261, Ratio=2.09x, Gap=-2.650
Batch 450/537: Loss=1.3884 (C:1.3884, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.225, Ratio=1.92x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.232, Ratio=1.99x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.246, Ratio=2.03x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.245, Ratio=2.02x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.246, Ratio=2.09x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.235, Ratio=1.98x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.247, Ratio=2.05x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.243, Ratio=2.00x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.254, Ratio=2.03x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.247, Ratio=2.02x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.250, Ratio=2.04x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.242, Ratio=1.98x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.252, Ratio=2.02x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.239, Ratio=2.00x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.233, Ratio=1.98x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.248, Ratio=2.04x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.241, Ratio=2.05x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.233, Ratio=1.98x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.233, Ratio=1.99x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.235, Ratio=1.98x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.246, Ratio=2.01x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.229, Ratio=1.97x, Gap=-2.559
Batch 475/537: Loss=1.4361 (C:1.4361, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.244, Ratio=2.05x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.250, Ratio=2.02x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.245, Ratio=2.04x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.237, Ratio=1.95x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.259, Ratio=2.07x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.236, Ratio=2.03x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.244, Ratio=2.00x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.248, Ratio=2.03x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.230, Ratio=1.93x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.04x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.246, Ratio=2.01x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.226, Ratio=2.00x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.238, Ratio=2.01x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.233, Ratio=2.01x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.249, Ratio=2.03x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.239, Ratio=2.03x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.263, Ratio=2.12x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.249, Ratio=1.98x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.243, Ratio=1.96x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.248, Ratio=1.99x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.238, Ratio=1.99x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.226, Ratio=1.92x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.240, Ratio=1.97x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.242, Ratio=2.01x, Gap=-2.671
Batch 500/537: Loss=1.4210 (C:1.4210, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.247, Ratio=2.08x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.250, Ratio=2.07x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.239, Ratio=1.97x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.247, Ratio=2.07x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.239, Ratio=1.98x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.244, Ratio=2.04x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.227, Ratio=1.90x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.253, Ratio=2.06x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.221, Ratio=1.90x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.240, Ratio=1.98x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.226, Ratio=1.96x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.221, Ratio=1.95x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.244, Ratio=1.99x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.240, Ratio=2.02x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.250, Ratio=2.06x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.252, Ratio=2.01x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.250, Ratio=2.07x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.225, Ratio=1.93x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.239, Ratio=1.98x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.01x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.227, Ratio=1.92x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.235, Ratio=1.96x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.243, Ratio=2.05x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.231, Ratio=2.00x, Gap=-2.533
Batch 525/537: Loss=1.4258 (C:1.4258, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.249, Ratio=2.10x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.223, Ratio=1.93x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.217, Ratio=1.93x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.235, Ratio=1.97x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.244, Ratio=2.05x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.246, Ratio=2.02x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.245, Ratio=2.00x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.258, Ratio=2.04x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.232, Ratio=1.97x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.245, Ratio=2.03x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.252, Ratio=2.07x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.252, Ratio=2.13x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.239, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.235, Ratio=2.02x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.262, Ratio=2.17x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.252, Ratio=2.13x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.246, Ratio=2.05x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.243, Ratio=2.07x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.259, Ratio=2.14x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.241, Ratio=2.04x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.242, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.251, Ratio=2.10x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.247, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.248, Ratio=2.10x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.254, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.247, Ratio=2.03x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.254, Ratio=2.16x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.255, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.237, Ratio=2.04x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.237, Ratio=2.05x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.238, Ratio=1.98x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.251, Ratio=2.09x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.236, Ratio=2.04x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.257, Ratio=2.14x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.250, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.239, Ratio=2.04x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.242, Ratio=2.03x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.227, Ratio=2.02x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.242, Ratio=2.08x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.230, Ratio=1.99x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.246, Ratio=2.07x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.239, Ratio=2.01x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.237, Ratio=2.02x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.243, Ratio=2.09x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.243, Ratio=2.03x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.248, Ratio=2.07x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.253, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.244, Ratio=2.10x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.231, Ratio=1.99x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.250, Ratio=2.08x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.242, Ratio=2.06x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.259, Ratio=2.13x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.243, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.260, Ratio=2.12x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.226, Ratio=2.00x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.253, Ratio=2.06x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.257, Ratio=2.19x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.245, Ratio=2.03x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.243, Ratio=2.04x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.255, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.241, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.228, Ratio=2.01x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.249, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.264, Ratio=2.18x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.248, Ratio=2.09x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.242, Ratio=2.01x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.254, Ratio=2.13x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.243, Ratio=2.05x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.253, Ratio=2.12x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.238, Ratio=2.07x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.262, Ratio=2.14x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.237, Ratio=2.05x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.253, Ratio=2.11x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.225, Ratio=1.95x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.241, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.253, Ratio=2.12x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.243, Ratio=2.08x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.247, Ratio=2.07x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.02x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.227, Ratio=2.00x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.248, Ratio=2.06x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.255, Ratio=2.14x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.233, Ratio=1.98x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.258, Ratio=2.13x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.238, Ratio=2.03x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.247, Ratio=2.09x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.239, Ratio=2.01x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.238, Ratio=2.01x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.243, Ratio=2.05x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.261, Ratio=2.13x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.253, Ratio=2.11x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.253, Ratio=2.09x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.270, Ratio=2.15x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.256, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.251, Ratio=2.03x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.244, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.238, Ratio=2.01x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.236, Ratio=2.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.247, Ratio=2.05x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.257, Ratio=2.12x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.248, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.252, Ratio=2.10x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.260, Ratio=2.16x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.240, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.247, Ratio=2.08x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.233, Ratio=1.98x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.256, Ratio=2.15x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.234, Ratio=2.00x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.253, Ratio=2.10x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.253, Ratio=2.09x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.241, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.255, Ratio=2.15x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.253, Ratio=2.13x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.251, Ratio=2.07x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.252, Ratio=2.11x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.250, Ratio=2.06x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.246, Ratio=2.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.222, Ratio=1.98x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.235, Ratio=2.02x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.249, Ratio=2.11x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.247, Ratio=2.07x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.238, Ratio=1.99x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.250, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.239, Ratio=2.05x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.249, Ratio=2.05x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.247, Ratio=2.06x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.236, Ratio=2.01x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.251, Ratio=2.07x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.237, Ratio=2.02x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.243, Ratio=2.01x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.235, Ratio=2.00x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.250, Ratio=2.07x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.253, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.267, Ratio=2.21x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.245, Ratio=2.03x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.240, Ratio=2.02x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.256, Ratio=2.06x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.226, Ratio=1.98x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.234, Ratio=1.96x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.236, Ratio=2.02x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.254, Ratio=2.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.249, Ratio=2.08x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.244, Ratio=2.06x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.241, Ratio=2.10x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.249, Ratio=2.13x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.243, Ratio=2.07x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.239, Ratio=2.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.262, Ratio=2.15x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.238, Ratio=2.04x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.231, Ratio=2.07x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.244, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.251, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.239, Ratio=2.09x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.242, Ratio=2.11x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.237, Ratio=2.02x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.240, Ratio=2.09x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.233, Ratio=2.03x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.246, Ratio=2.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.233, Ratio=2.02x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.249, Ratio=2.09x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.245, Ratio=2.02x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.248, Ratio=2.07x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.232, Ratio=2.02x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.245, Ratio=2.05x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.256, Ratio=2.16x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.236, Ratio=2.05x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.237, Ratio=1.98x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.253, Ratio=2.09x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.243, Ratio=2.07x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.246, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.222, Ratio=1.95x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.215, Ratio=1.90x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.239, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.248, Ratio=2.04x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.245, Ratio=2.03x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.240, Ratio=2.01x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.242, Ratio=2.08x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.251, Ratio=2.14x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.253, Ratio=2.10x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.254, Ratio=2.13x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.257, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.247, Ratio=2.09x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.242, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.244, Ratio=2.04x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.234, Ratio=2.02x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.251, Ratio=2.15x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.03x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.249, Ratio=2.13x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.248, Ratio=2.10x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.249, Ratio=2.07x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.250, Ratio=2.06x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.254, Ratio=2.12x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.243, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.251, Ratio=2.13x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.231, Ratio=1.95x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.234, Ratio=2.02x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.252, Ratio=2.15x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.242, Ratio=2.02x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.239, Ratio=2.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.256, Ratio=2.11x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.234, Ratio=2.05x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.238, Ratio=2.06x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.251, Ratio=2.12x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.251, Ratio=2.10x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.04x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.239, Ratio=2.07x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.235, Ratio=2.01x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.245, Ratio=2.07x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.242, Ratio=2.02x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.249, Ratio=2.11x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.250, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.241, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.240, Ratio=2.09x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.245, Ratio=2.05x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.252, Ratio=2.13x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.241, Ratio=2.05x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.250, Ratio=2.10x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.260, Ratio=2.14x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.04x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.243, Ratio=2.06x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.239, Ratio=2.07x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.251, Ratio=2.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.235, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.252, Ratio=2.13x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.241, Ratio=2.08x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.241, Ratio=2.10x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.241, Ratio=2.03x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.247, Ratio=2.08x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.221, Ratio=1.95x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.242, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.239, Ratio=2.05x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.237, Ratio=1.98x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.241, Ratio=2.05x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.246, Ratio=2.08x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.222, Ratio=1.95x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.246, Ratio=2.06x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.241, Ratio=2.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.249, Ratio=2.06x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.258, Ratio=2.10x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.246, Ratio=2.06x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.258, Ratio=2.15x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.237, Ratio=2.06x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.239, Ratio=2.00x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.03x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.254, Ratio=2.14x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.256, Ratio=2.12x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.221, Ratio=1.95x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.230, Ratio=2.05x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.247, Ratio=2.06x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.262, Ratio=2.16x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.234, Ratio=2.02x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.231, Ratio=1.98x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.251, Ratio=2.06x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.05x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.252, Ratio=2.11x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.233, Ratio=2.02x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.258, Ratio=2.17x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.230, Ratio=1.96x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.246, Ratio=2.07x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.255, Ratio=2.11x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.256, Ratio=2.11x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.256, Ratio=2.09x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.246, Ratio=2.04x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.232, Ratio=2.00x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.238, Ratio=2.05x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.251, Ratio=2.15x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.235, Ratio=1.99x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.227, Ratio=1.96x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.242, Ratio=2.07x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.232, Ratio=2.01x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.242, Ratio=2.05x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.243, Ratio=2.09x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.239, Ratio=2.05x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.256, Ratio=2.14x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.264, Ratio=2.19x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.240, Ratio=2.05x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.245, Ratio=2.06x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.231, Ratio=2.03x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.249, Ratio=2.11x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.226, Ratio=1.97x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.251, Ratio=2.12x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.252, Ratio=2.13x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.219, Ratio=1.92x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.240, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.248, Ratio=2.07x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.253, Ratio=2.12x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.235, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.245, Ratio=2.06x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.236, Ratio=1.98x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.249, Ratio=2.06x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.241, Ratio=2.02x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.251, Ratio=2.05x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.252, Ratio=2.16x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.240, Ratio=2.08x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.242, Ratio=2.03x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.245, Ratio=2.06x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.236, Ratio=1.99x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.244, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.245, Ratio=2.06x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.260, Ratio=2.14x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.243, Ratio=2.05x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.244, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.237, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.248, Ratio=2.07x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.255, Ratio=2.09x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.232, Ratio=2.06x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.247, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.246, Ratio=2.08x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.236, Ratio=2.06x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.247, Ratio=2.04x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.248, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.232, Ratio=2.01x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.247, Ratio=2.06x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.257, Ratio=2.10x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.235, Ratio=2.07x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.260, Ratio=2.18x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.245, Ratio=2.05x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.235, Ratio=2.01x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.05x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.240, Ratio=2.05x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.232, Ratio=1.97x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.247, Ratio=2.10x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.250, Ratio=2.16x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.250, Ratio=2.14x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.226, Ratio=1.97x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.239, Ratio=2.01x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.243, Ratio=2.06x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.238, Ratio=2.05x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.248, Ratio=2.10x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.257, Ratio=2.19x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.245, Ratio=2.05x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.228, Ratio=1.99x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.233, Ratio=2.00x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.234, Ratio=2.02x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.230, Ratio=2.00x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.241, Ratio=2.08x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.246, Ratio=2.04x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.238, Ratio=2.02x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.243, Ratio=2.08x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.243, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.247, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.236, Ratio=2.01x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.256, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.244, Ratio=2.00x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.239, Ratio=2.05x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.237, Ratio=2.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.245, Ratio=2.06x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.243, Ratio=2.05x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.247, Ratio=2.08x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.249, Ratio=2.06x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.229, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.235, Ratio=2.03x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.241, Ratio=2.05x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.230, Ratio=2.02x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.244, Ratio=2.10x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.236, Ratio=2.04x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.248, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.250, Ratio=2.09x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.267, Ratio=2.17x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.253, Ratio=2.07x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.237, Ratio=2.03x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.254, Ratio=2.17x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.244, Ratio=2.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.238, Ratio=2.02x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.241, Ratio=1.99x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.248, Ratio=2.08x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.231, Ratio=1.98x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.254, Ratio=2.08x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.251, Ratio=2.06x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.257, Ratio=2.14x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.247, Ratio=2.06x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.236, Ratio=1.99x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.235, Ratio=2.00x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.247, Ratio=2.07x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.239, Ratio=2.01x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.252, Ratio=2.09x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.249, Ratio=2.07x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.241, Ratio=2.03x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.246, Ratio=2.11x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.247, Ratio=2.12x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.240, Ratio=2.03x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.246, Ratio=2.05x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.256, Ratio=2.11x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.249, Ratio=2.16x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.253, Ratio=2.10x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.252, Ratio=2.10x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.243, Ratio=2.06x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.253, Ratio=2.15x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.245, Ratio=2.00x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.247, Ratio=2.08x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.222, Ratio=1.98x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.250, Ratio=2.16x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.253, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.253, Ratio=2.12x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.246, Ratio=2.04x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.05x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.250, Ratio=2.08x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.253, Ratio=2.06x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.248, Ratio=2.05x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.235, Ratio=2.03x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.242, Ratio=2.08x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.01x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.259, Ratio=2.16x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.246, Ratio=2.11x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.250, Ratio=2.08x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.228, Ratio=2.03x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.246, Ratio=2.13x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.252, Ratio=2.06x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.246, Ratio=2.02x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.243, Ratio=2.04x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.258, Ratio=2.13x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.262, Ratio=2.14x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.254, Ratio=2.09x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.238, Ratio=2.01x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.247, Ratio=2.03x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.254, Ratio=2.08x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.247, Ratio=2.13x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.239, Ratio=2.04x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.249, Ratio=2.13x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.253, Ratio=2.07x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.245, Ratio=2.04x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.253, Ratio=2.06x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.244, Ratio=2.02x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.240, Ratio=2.00x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.238, Ratio=2.00x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.242, Ratio=2.06x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.241, Ratio=2.06x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.239, Ratio=2.03x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.249, Ratio=2.08x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.253, Ratio=2.12x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.250, Ratio=2.08x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.225, Ratio=1.95x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.243, Ratio=2.10x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.225, Ratio=1.99x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.226, Ratio=1.96x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.246, Ratio=2.10x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.243, Ratio=2.00x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.251, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.231, Ratio=2.05x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.231, Ratio=2.03x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.244, Ratio=2.08x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.241, Ratio=2.02x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.242, Ratio=2.04x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.246, Ratio=2.06x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.228, Ratio=2.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.234, Ratio=2.03x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.248, Ratio=2.08x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.233, Ratio=2.03x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.250, Ratio=2.12x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.237, Ratio=2.00x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.246, Ratio=2.14x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.238, Ratio=1.97x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.221, Ratio=1.99x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.241, Ratio=1.97x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.240, Ratio=2.03x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.260, Ratio=2.12x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.247, Ratio=2.08x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.220, Ratio=1.98x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.232, Ratio=1.95x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.246, Ratio=2.08x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.258, Ratio=2.13x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.254, Ratio=2.16x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.237, Ratio=2.07x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.241, Ratio=2.04x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.06x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.233, Ratio=1.96x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.246, Ratio=2.10x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.242, Ratio=2.04x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.226, Ratio=2.03x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.256, Ratio=2.13x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.240, Ratio=2.04x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.239, Ratio=2.03x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.245, Ratio=2.10x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.243, Ratio=2.05x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.244, Ratio=2.07x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.233, Ratio=2.01x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.249, Ratio=2.10x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.244, Ratio=2.02x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.244, Ratio=2.04x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.247, Ratio=2.13x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.248, Ratio=2.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.239, Ratio=2.02x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.239, Ratio=2.08x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.236, Ratio=2.03x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.250, Ratio=2.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.246, Ratio=2.08x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.236, Ratio=2.02x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.242, Ratio=2.02x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.249, Ratio=2.07x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.249, Ratio=2.06x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.273, Ratio=2.19x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.248, Ratio=2.07x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.252, Ratio=2.06x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.256, Ratio=2.09x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.243, Ratio=2.05x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.238, Ratio=2.05x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.247, Ratio=2.12x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.240, Ratio=2.00x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.240, Ratio=2.01x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.266, Ratio=2.20x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.259, Ratio=2.18x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.243, Ratio=2.08x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.239, Ratio=2.01x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.250, Ratio=2.08x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.258, Ratio=2.13x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.235, Ratio=2.01x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.247, Ratio=2.08x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.240, Ratio=2.09x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.235, Ratio=1.98x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.231, Ratio=2.02x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.254, Ratio=2.11x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.266, Ratio=2.19x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.229, Ratio=2.03x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.248, Ratio=2.05x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.247, Ratio=2.07x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.240, Ratio=2.04x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.245, Ratio=2.09x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.240, Ratio=2.02x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.259, Ratio=2.15x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.235, Ratio=2.06x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.253, Ratio=2.08x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.248, Ratio=2.07x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.247, Ratio=2.05x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.237, Ratio=2.05x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.242, Ratio=2.06x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.231, Ratio=2.00x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.229, Ratio=2.02x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.237, Ratio=1.99x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.254, Ratio=2.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.261, Ratio=2.14x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.249, Ratio=2.09x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.241, Ratio=2.05x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.240, Ratio=2.06x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.248, Ratio=2.09x, Gap=-2.482

============================================================
Epoch 6/20 completed in 28.6s
Train: Loss=1.4217 (C:1.4217, R:0.0000) Ratio=2.10x
Val:   Loss=1.4050 (C:1.4050, R:0.0000) Ratio=2.28x
‚úÖ New best model saved (Val Loss: 1.4050)
============================================================

üåç Updating global dataset at epoch 7
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.560 ¬± 0.709
    Neg distances: 1.281 ¬± 0.856
    Separation ratio: 2.29x
    Gap: -2.465
    ‚úÖ Good global separation

Epoch 7 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.274, Ratio=2.23x, Gap=-2.706
Batch   0/537: Loss=1.3474 (C:1.3474, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.272, Ratio=2.20x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.268, Ratio=2.12x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.273, Ratio=2.23x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.270, Ratio=2.17x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.281, Ratio=2.23x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.275, Ratio=2.15x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.280, Ratio=2.21x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.266, Ratio=2.19x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.291, Ratio=2.24x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.273, Ratio=2.22x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.275, Ratio=2.21x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.274, Ratio=2.26x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.277, Ratio=2.26x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.273, Ratio=2.18x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.273, Ratio=2.19x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.298, Ratio=2.30x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.274, Ratio=2.14x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.292, Ratio=2.24x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.281, Ratio=2.19x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.292, Ratio=2.35x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.282, Ratio=2.29x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.280, Ratio=2.29x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.270, Ratio=2.18x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.294, Ratio=2.31x, Gap=-2.647
Batch  25/537: Loss=1.3176 (C:1.3176, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.285, Ratio=2.26x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.292, Ratio=2.31x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.270, Ratio=2.15x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.278, Ratio=2.16x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.290, Ratio=2.27x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.279, Ratio=2.20x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.273, Ratio=2.16x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.279, Ratio=2.22x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.274, Ratio=2.23x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.273, Ratio=2.18x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.280, Ratio=2.28x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.286, Ratio=2.27x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.274, Ratio=2.26x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.292, Ratio=2.28x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.287, Ratio=2.27x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.279, Ratio=2.18x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.283, Ratio=2.19x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.276, Ratio=2.25x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.275, Ratio=2.20x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.289, Ratio=2.31x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.272, Ratio=2.19x, Gap=-2.539
Batch  50/537: Loss=1.3594 (C:1.3594, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.282, Ratio=2.20x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.285, Ratio=2.24x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.298, Ratio=2.28x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.274, Ratio=2.18x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.284, Ratio=2.27x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.285, Ratio=2.29x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.258, Ratio=2.13x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.265, Ratio=2.17x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.294, Ratio=2.32x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.278, Ratio=2.24x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.289, Ratio=2.26x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.277, Ratio=2.29x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.276, Ratio=2.22x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.286, Ratio=2.30x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.274, Ratio=2.24x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.285, Ratio=2.26x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.279, Ratio=2.26x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.281, Ratio=2.22x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.282, Ratio=2.19x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.277, Ratio=2.20x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.287, Ratio=2.26x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.279, Ratio=2.18x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.259, Ratio=2.16x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.271, Ratio=2.21x, Gap=-2.667
Batch  75/537: Loss=1.3493 (C:1.3493, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.278, Ratio=2.18x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.278, Ratio=2.21x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.283, Ratio=2.26x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.300, Ratio=2.35x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.265, Ratio=2.12x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.286, Ratio=2.21x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.266, Ratio=2.20x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.291, Ratio=2.30x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.34x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.263, Ratio=2.25x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.299, Ratio=2.41x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.302, Ratio=2.35x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.287, Ratio=2.22x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.280, Ratio=2.31x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.262, Ratio=2.12x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.283, Ratio=2.26x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.273, Ratio=2.21x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.266, Ratio=2.18x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.273, Ratio=2.20x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.283, Ratio=2.20x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.276, Ratio=2.18x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.280, Ratio=2.30x, Gap=-2.735
Batch 100/537: Loss=1.3291 (C:1.3291, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.278, Ratio=2.23x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.284, Ratio=2.26x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.289, Ratio=2.28x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.270, Ratio=2.17x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.275, Ratio=2.20x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.269, Ratio=2.26x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.284, Ratio=2.38x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.270, Ratio=2.20x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.288, Ratio=2.24x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.286, Ratio=2.31x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.289, Ratio=2.27x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.270, Ratio=2.16x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.285, Ratio=2.25x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.23x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.269, Ratio=2.16x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.259, Ratio=2.18x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.253, Ratio=2.15x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.258, Ratio=2.13x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.256, Ratio=2.13x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.262, Ratio=2.10x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.262, Ratio=2.19x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.270, Ratio=2.17x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.271, Ratio=2.12x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.292, Ratio=2.35x, Gap=-2.547
Batch 125/537: Loss=1.3110 (C:1.3110, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.296, Ratio=2.37x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.278, Ratio=2.17x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.284, Ratio=2.32x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.286, Ratio=2.21x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.273, Ratio=2.22x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.279, Ratio=2.31x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.273, Ratio=2.23x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.266, Ratio=2.20x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.259, Ratio=2.16x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.269, Ratio=2.17x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.262, Ratio=2.15x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.301, Ratio=2.33x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.299, Ratio=2.34x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.267, Ratio=2.16x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.288, Ratio=2.25x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.271, Ratio=2.18x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.260, Ratio=2.15x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.261, Ratio=2.18x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.258, Ratio=2.12x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.266, Ratio=2.13x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.292, Ratio=2.30x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.272, Ratio=2.20x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.286, Ratio=2.26x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.288, Ratio=2.28x, Gap=-2.652
Batch 150/537: Loss=1.3327 (C:1.3327, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.275, Ratio=2.17x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.278, Ratio=2.18x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.293, Ratio=2.26x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.287, Ratio=2.24x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.265, Ratio=2.17x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.273, Ratio=2.21x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.281, Ratio=2.26x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.282, Ratio=2.30x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.285, Ratio=2.28x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.281, Ratio=2.19x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.282, Ratio=2.22x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.295, Ratio=2.30x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.291, Ratio=2.20x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.291, Ratio=2.25x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.274, Ratio=2.18x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.276, Ratio=2.24x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.255, Ratio=2.09x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.283, Ratio=2.30x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.286, Ratio=2.27x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.284, Ratio=2.28x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.293, Ratio=2.30x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.279, Ratio=2.24x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.278, Ratio=2.19x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.290, Ratio=2.25x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.273, Ratio=2.18x, Gap=-2.582
Batch 175/537: Loss=1.3603 (C:1.3603, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.280, Ratio=2.18x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.268, Ratio=2.07x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.289, Ratio=2.29x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.282, Ratio=2.30x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.278, Ratio=2.25x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.265, Ratio=2.21x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.268, Ratio=2.20x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.274, Ratio=2.28x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.280, Ratio=2.30x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.273, Ratio=2.22x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.278, Ratio=2.19x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.293, Ratio=2.31x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.275, Ratio=2.19x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.286, Ratio=2.26x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.293, Ratio=2.24x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.281, Ratio=2.30x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.283, Ratio=2.20x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.282, Ratio=2.28x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.271, Ratio=2.22x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.274, Ratio=2.20x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.282, Ratio=2.22x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.279, Ratio=2.21x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.276, Ratio=2.17x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.277, Ratio=2.24x, Gap=-2.593
Batch 200/537: Loss=1.3433 (C:1.3433, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.289, Ratio=2.24x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.266, Ratio=2.13x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.293, Ratio=2.36x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.289, Ratio=2.26x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.270, Ratio=2.13x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.282, Ratio=2.24x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.266, Ratio=2.12x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.288, Ratio=2.28x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.257, Ratio=2.18x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.268, Ratio=2.26x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.280, Ratio=2.27x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.282, Ratio=2.25x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.286, Ratio=2.26x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.295, Ratio=2.29x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.291, Ratio=2.28x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.278, Ratio=2.19x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.285, Ratio=2.23x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.289, Ratio=2.35x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.285, Ratio=2.23x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.274, Ratio=2.20x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.275, Ratio=2.30x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.577
Batch 225/537: Loss=1.3309 (C:1.3309, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.287, Ratio=2.35x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.298, Ratio=2.32x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.302, Ratio=2.30x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.283, Ratio=2.21x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.289, Ratio=2.26x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.295, Ratio=2.30x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.279, Ratio=2.17x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.294, Ratio=2.28x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.268, Ratio=2.25x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.270, Ratio=2.17x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.287, Ratio=2.28x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.271, Ratio=2.19x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.281, Ratio=2.19x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.283, Ratio=2.34x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.282, Ratio=2.18x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.293, Ratio=2.32x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.288, Ratio=2.25x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.294, Ratio=2.26x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.282, Ratio=2.23x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.274, Ratio=2.23x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.278, Ratio=2.24x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.295, Ratio=2.31x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.262, Ratio=2.18x, Gap=-2.693
Batch 250/537: Loss=1.3643 (C:1.3643, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.35x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.298, Ratio=2.34x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.289, Ratio=2.26x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.284, Ratio=2.27x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.277, Ratio=2.25x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.288, Ratio=2.25x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.283, Ratio=2.34x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.282, Ratio=2.33x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.272, Ratio=2.27x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.272, Ratio=2.21x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.291, Ratio=2.28x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.297, Ratio=2.29x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.281, Ratio=2.30x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.284, Ratio=2.25x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.293, Ratio=2.26x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.265, Ratio=2.15x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.284, Ratio=2.28x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.297, Ratio=2.33x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.261, Ratio=2.18x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.271, Ratio=2.26x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.269, Ratio=2.23x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.271, Ratio=2.11x, Gap=-2.656
Batch 275/537: Loss=1.3804 (C:1.3804, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.274, Ratio=2.15x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.282, Ratio=2.25x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.279, Ratio=2.22x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.278, Ratio=2.26x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.283, Ratio=2.25x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.275, Ratio=2.16x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.282, Ratio=2.25x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.273, Ratio=2.20x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.295, Ratio=2.32x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.281, Ratio=2.19x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.291, Ratio=2.28x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.275, Ratio=2.18x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.270, Ratio=2.20x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.264, Ratio=2.19x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.274, Ratio=2.15x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.298, Ratio=2.38x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.270, Ratio=2.13x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.261, Ratio=2.16x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.276, Ratio=2.14x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.267, Ratio=2.09x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.271, Ratio=2.23x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.267, Ratio=2.15x, Gap=-2.650
Batch 300/537: Loss=1.3738 (C:1.3738, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.286, Ratio=2.24x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.274, Ratio=2.25x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.289, Ratio=2.29x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.287, Ratio=2.30x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.289, Ratio=2.30x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.271, Ratio=2.20x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.297, Ratio=2.33x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.276, Ratio=2.20x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.277, Ratio=2.25x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.278, Ratio=2.27x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.288, Ratio=2.27x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.288, Ratio=2.23x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.285, Ratio=2.31x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.272, Ratio=2.22x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.279, Ratio=2.21x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.268, Ratio=2.13x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.276, Ratio=2.26x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.291, Ratio=2.29x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.272, Ratio=2.15x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.257, Ratio=2.10x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.272, Ratio=2.19x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.296, Ratio=2.30x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.275, Ratio=2.19x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.295, Ratio=2.30x, Gap=-2.608
Batch 325/537: Loss=1.3218 (C:1.3218, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.274, Ratio=2.15x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.278, Ratio=2.15x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.277, Ratio=2.25x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.287, Ratio=2.25x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.263, Ratio=2.17x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.278, Ratio=2.27x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.272, Ratio=2.17x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.277, Ratio=2.21x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.271, Ratio=2.21x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.271, Ratio=2.19x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.288, Ratio=2.35x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.305, Ratio=2.39x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.292, Ratio=2.28x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.280, Ratio=2.20x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.273, Ratio=2.17x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.287, Ratio=2.34x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.268, Ratio=2.25x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.295, Ratio=2.33x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.261, Ratio=2.08x, Gap=-2.610
Batch 350/537: Loss=1.3957 (C:1.3957, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.287, Ratio=2.24x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.271, Ratio=2.17x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.282, Ratio=2.20x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.284, Ratio=2.22x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.282, Ratio=2.24x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.274, Ratio=2.17x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.282, Ratio=2.26x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.279, Ratio=2.23x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.281, Ratio=2.25x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.276, Ratio=2.25x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.276, Ratio=2.25x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.270, Ratio=2.17x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.278, Ratio=2.20x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.27x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.289, Ratio=2.25x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.275, Ratio=2.16x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.272, Ratio=2.23x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.295, Ratio=2.34x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.266, Ratio=2.20x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.272, Ratio=2.16x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.277, Ratio=2.24x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.296, Ratio=2.32x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.283, Ratio=2.26x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.275, Ratio=2.20x, Gap=-2.748
Batch 375/537: Loss=1.3540 (C:1.3540, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.264, Ratio=2.05x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.286, Ratio=2.25x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.294, Ratio=2.37x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.271, Ratio=2.26x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.272, Ratio=2.24x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.286, Ratio=2.35x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.266, Ratio=2.22x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.278, Ratio=2.22x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.292, Ratio=2.24x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.29x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.268, Ratio=2.17x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.278, Ratio=2.23x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.302, Ratio=2.31x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.292, Ratio=2.31x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.283, Ratio=2.21x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.282, Ratio=2.20x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.267, Ratio=2.17x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.296, Ratio=2.37x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.270, Ratio=2.20x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.291, Ratio=2.29x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.24x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.288, Ratio=2.30x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.281, Ratio=2.22x, Gap=-2.930
Batch 400/537: Loss=1.3491 (C:1.3491, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.269, Ratio=2.10x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.276, Ratio=2.23x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.299, Ratio=2.32x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.265, Ratio=2.22x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.289, Ratio=2.28x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.275, Ratio=2.20x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.273, Ratio=2.20x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.282, Ratio=2.23x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.296, Ratio=2.28x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.304, Ratio=2.37x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.285, Ratio=2.24x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.292, Ratio=2.27x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.289, Ratio=2.31x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.30x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.294, Ratio=2.34x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.281, Ratio=2.24x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.25x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.285, Ratio=2.26x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.259, Ratio=2.16x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.279, Ratio=2.18x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.274, Ratio=2.21x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.300, Ratio=2.35x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.293, Ratio=2.26x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.277, Ratio=2.26x, Gap=-2.656
Batch 425/537: Loss=1.3356 (C:1.3356, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.295, Ratio=2.29x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.291, Ratio=2.33x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.278, Ratio=2.13x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.285, Ratio=2.20x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.272, Ratio=2.20x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.271, Ratio=2.18x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.42x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.287, Ratio=2.31x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.269, Ratio=2.16x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.277, Ratio=2.28x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.281, Ratio=2.20x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.295, Ratio=2.37x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.278, Ratio=2.19x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.269, Ratio=2.20x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.276, Ratio=2.20x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.280, Ratio=2.27x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.275, Ratio=2.21x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.281, Ratio=2.25x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.275, Ratio=2.19x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.292, Ratio=2.39x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.266, Ratio=2.19x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.296, Ratio=2.34x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.299, Ratio=2.31x, Gap=-2.604
Batch 450/537: Loss=1.3177 (C:1.3177, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.301, Ratio=2.29x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.25x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.271, Ratio=2.22x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.288, Ratio=2.23x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.293, Ratio=2.30x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.273, Ratio=2.19x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.283, Ratio=2.30x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.264, Ratio=2.14x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.265, Ratio=2.23x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.284, Ratio=2.30x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.276, Ratio=2.22x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.287, Ratio=2.29x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.297, Ratio=2.27x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.308, Ratio=2.31x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.281, Ratio=2.27x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.273, Ratio=2.18x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.278, Ratio=2.19x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.266, Ratio=2.16x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.285, Ratio=2.23x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.273, Ratio=2.23x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.272, Ratio=2.15x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.283, Ratio=2.27x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.301, Ratio=2.31x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.299, Ratio=2.31x, Gap=-2.752
Batch 475/537: Loss=1.3204 (C:1.3204, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.280, Ratio=2.18x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.278, Ratio=2.20x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.281, Ratio=2.31x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.283, Ratio=2.27x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.281, Ratio=2.27x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.275, Ratio=2.23x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.279, Ratio=2.29x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.279, Ratio=2.19x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.282, Ratio=2.27x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.274, Ratio=2.15x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.273, Ratio=2.19x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.282, Ratio=2.26x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.299, Ratio=2.33x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.279, Ratio=2.17x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.287, Ratio=2.27x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.266, Ratio=2.14x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.281, Ratio=2.25x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.259, Ratio=2.14x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.279, Ratio=2.18x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.266, Ratio=2.22x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.274, Ratio=2.18x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.277, Ratio=2.19x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.733
Batch 500/537: Loss=1.3474 (C:1.3474, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.281, Ratio=2.22x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.281, Ratio=2.24x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.293, Ratio=2.33x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.276, Ratio=2.17x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.284, Ratio=2.28x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.287, Ratio=2.28x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.270, Ratio=2.26x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.280, Ratio=2.27x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.301, Ratio=2.41x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.34x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.262, Ratio=2.13x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.273, Ratio=2.18x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.276, Ratio=2.23x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.281, Ratio=2.27x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.288, Ratio=2.29x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.286, Ratio=2.27x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.288, Ratio=2.29x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.293, Ratio=2.29x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.279, Ratio=2.21x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.287, Ratio=2.24x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.271, Ratio=2.16x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.293, Ratio=2.33x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.275, Ratio=2.23x, Gap=-2.586
Batch 525/537: Loss=1.3470 (C:1.3470, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.271, Ratio=2.16x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.35x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.279, Ratio=2.24x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.291, Ratio=2.31x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.295, Ratio=2.36x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.269, Ratio=2.19x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.263, Ratio=2.13x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.285, Ratio=2.30x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.272, Ratio=2.21x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.285, Ratio=2.24x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.273, Ratio=2.13x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.279, Ratio=2.26x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.42x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.33x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.295, Ratio=2.39x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.283, Ratio=2.37x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.278, Ratio=2.28x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.279, Ratio=2.28x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.286, Ratio=2.29x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.283, Ratio=2.28x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.274, Ratio=2.20x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.283, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.281, Ratio=2.22x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.266, Ratio=2.17x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.282, Ratio=2.35x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.286, Ratio=2.34x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.284, Ratio=2.30x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.298, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.298, Ratio=2.39x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.293, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.281, Ratio=2.26x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.297, Ratio=2.35x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.287, Ratio=2.29x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.277, Ratio=2.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.288, Ratio=2.26x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.277, Ratio=2.22x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.300, Ratio=2.39x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.294, Ratio=2.30x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.286, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.293, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.30x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.292, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.293, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.290, Ratio=2.35x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.293, Ratio=2.38x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.26x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.304, Ratio=2.47x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.278, Ratio=2.22x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.276, Ratio=2.22x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.289, Ratio=2.30x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.281, Ratio=2.24x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.274, Ratio=2.23x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.269, Ratio=2.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.284, Ratio=2.31x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.294, Ratio=2.39x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.282, Ratio=2.25x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.287, Ratio=2.36x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.269, Ratio=2.23x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.271, Ratio=2.23x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.297, Ratio=2.40x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.33x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.301, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.34x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.280, Ratio=2.27x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.267, Ratio=2.20x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.282, Ratio=2.29x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.287, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.277, Ratio=2.33x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.286, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.285, Ratio=2.30x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.279, Ratio=2.30x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.298, Ratio=2.36x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.284, Ratio=2.25x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.288, Ratio=2.33x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.289, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.294, Ratio=2.29x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.287, Ratio=2.31x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.273, Ratio=2.24x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.283, Ratio=2.34x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.284, Ratio=2.34x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.36x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.288, Ratio=2.36x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.286, Ratio=2.37x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.275, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.273, Ratio=2.23x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.298, Ratio=2.39x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.272, Ratio=2.18x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.286, Ratio=2.32x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.276, Ratio=2.24x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.285, Ratio=2.30x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.273, Ratio=2.27x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.293, Ratio=2.35x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.277, Ratio=2.25x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.294, Ratio=2.40x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.284, Ratio=2.29x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.279, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.292, Ratio=2.39x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.290, Ratio=2.29x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.282, Ratio=2.28x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.287, Ratio=2.31x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.288, Ratio=2.32x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.277, Ratio=2.22x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.294, Ratio=2.38x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.296, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.282, Ratio=2.29x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.273, Ratio=2.19x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.286, Ratio=2.31x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.275, Ratio=2.21x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.282, Ratio=2.23x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.294, Ratio=2.35x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.294, Ratio=2.33x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.272, Ratio=2.24x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.274, Ratio=2.19x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.282, Ratio=2.25x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.296, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.295, Ratio=2.37x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.275, Ratio=2.28x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.278, Ratio=2.25x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.287, Ratio=2.33x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.276, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.286, Ratio=2.27x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.282, Ratio=2.24x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.281, Ratio=2.31x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.282, Ratio=2.28x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.280, Ratio=2.24x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.282, Ratio=2.29x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.290, Ratio=2.24x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.288, Ratio=2.34x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.278, Ratio=2.25x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.278, Ratio=2.23x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.30x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.295, Ratio=2.36x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.293, Ratio=2.31x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.287, Ratio=2.27x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.298, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.279, Ratio=2.25x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.291, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.272, Ratio=2.19x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.286, Ratio=2.33x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.302, Ratio=2.42x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.282, Ratio=2.25x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.33x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.281, Ratio=2.25x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.277, Ratio=2.28x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.24x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.295, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.292, Ratio=2.36x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.285, Ratio=2.28x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.291, Ratio=2.31x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.292, Ratio=2.44x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.275, Ratio=2.24x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.273, Ratio=2.24x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.301, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.286, Ratio=2.30x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.303, Ratio=2.46x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.275, Ratio=2.10x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.283, Ratio=2.27x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.287, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.275, Ratio=2.28x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.24x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.285, Ratio=2.27x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.306, Ratio=2.45x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.279, Ratio=2.22x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.282, Ratio=2.27x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.287, Ratio=2.35x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.279, Ratio=2.30x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.283, Ratio=2.21x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.281, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.298, Ratio=2.38x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.34x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.263, Ratio=2.18x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.269, Ratio=2.21x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.292, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.286, Ratio=2.35x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.291, Ratio=2.32x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.298, Ratio=2.41x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.280, Ratio=2.24x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.281, Ratio=2.22x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.291, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.292, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.292, Ratio=2.36x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.286, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.299, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.289, Ratio=2.29x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.287, Ratio=2.30x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.282, Ratio=2.26x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.282, Ratio=2.30x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.294, Ratio=2.39x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.291, Ratio=2.39x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.283, Ratio=2.26x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.268, Ratio=2.16x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.279, Ratio=2.28x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.282, Ratio=2.25x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.277, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.37x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.279, Ratio=2.26x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.292, Ratio=2.32x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.276, Ratio=2.24x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.271, Ratio=2.25x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.290, Ratio=2.33x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.295, Ratio=2.40x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.266, Ratio=2.26x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.26x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.285, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.285, Ratio=2.31x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.286, Ratio=2.31x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.290, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.289, Ratio=2.29x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.292, Ratio=2.34x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.283, Ratio=2.30x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.302, Ratio=2.42x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.284, Ratio=2.34x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.291, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.267, Ratio=2.20x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.287, Ratio=2.30x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.280, Ratio=2.29x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.309, Ratio=2.45x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.296, Ratio=2.38x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.304, Ratio=2.42x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.283, Ratio=2.26x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.280, Ratio=2.27x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.284, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.288, Ratio=2.35x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.304, Ratio=2.45x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.283, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.279, Ratio=2.21x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.271, Ratio=2.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.284, Ratio=2.27x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.284, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.306, Ratio=2.50x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.293, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.286, Ratio=2.36x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.29x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.294, Ratio=2.38x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.28x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.281, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.289, Ratio=2.28x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.276, Ratio=2.23x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.286, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.276, Ratio=2.23x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.272, Ratio=2.30x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.300, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.285, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.279, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.276, Ratio=2.23x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.293, Ratio=2.34x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.281, Ratio=2.21x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.279, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.289, Ratio=2.40x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.299, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.293, Ratio=2.33x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.291, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.277, Ratio=2.30x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.285, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.294, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.279, Ratio=2.29x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.275, Ratio=2.26x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.291, Ratio=2.29x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.292, Ratio=2.37x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.289, Ratio=2.37x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.289, Ratio=2.38x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.286, Ratio=2.32x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.291, Ratio=2.38x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.278, Ratio=2.31x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.281, Ratio=2.25x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.285, Ratio=2.28x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.297, Ratio=2.36x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.285, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.281, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.297, Ratio=2.35x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.272, Ratio=2.26x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.274, Ratio=2.24x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.277, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.276, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.285, Ratio=2.28x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.276, Ratio=2.25x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.293, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.288, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.26x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.287, Ratio=2.26x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.34x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.278, Ratio=2.32x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.283, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.286, Ratio=2.24x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.295, Ratio=2.37x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.282, Ratio=2.31x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.280, Ratio=2.28x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.271, Ratio=2.20x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.273, Ratio=2.24x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.290, Ratio=2.37x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.279, Ratio=2.21x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.295, Ratio=2.39x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.282, Ratio=2.33x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.30x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.275, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.282, Ratio=2.23x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.268, Ratio=2.22x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.287, Ratio=2.34x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.27x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.277, Ratio=2.25x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.271, Ratio=2.24x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.287, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.270, Ratio=2.20x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.283, Ratio=2.30x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.285, Ratio=2.29x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.280, Ratio=2.27x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.288, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.289, Ratio=2.30x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.275, Ratio=2.24x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.288, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.273, Ratio=2.23x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.282, Ratio=2.27x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.286, Ratio=2.31x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.280, Ratio=2.25x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.285, Ratio=2.25x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.293, Ratio=2.33x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.271, Ratio=2.16x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.292, Ratio=2.29x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.275, Ratio=2.26x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.276, Ratio=2.29x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.279, Ratio=2.27x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.267, Ratio=2.20x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.299, Ratio=2.42x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.269, Ratio=2.17x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.271, Ratio=2.19x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.292, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.281, Ratio=2.28x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.275, Ratio=2.26x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.294, Ratio=2.35x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.24x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.283, Ratio=2.29x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.286, Ratio=2.29x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.275, Ratio=2.23x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.272, Ratio=2.20x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.281, Ratio=2.23x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.268, Ratio=2.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.281, Ratio=2.31x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.296, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.304, Ratio=2.42x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.287, Ratio=2.29x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.297, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.284, Ratio=2.25x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.291, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.29x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.282, Ratio=2.21x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.278, Ratio=2.23x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.277, Ratio=2.25x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.296, Ratio=2.33x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.299, Ratio=2.37x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.282, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.297, Ratio=2.35x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.266, Ratio=2.23x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.295, Ratio=2.31x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.278, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.298, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.291, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.275, Ratio=2.27x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.267, Ratio=2.23x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.294, Ratio=2.38x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.286, Ratio=2.23x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.29x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.282, Ratio=2.29x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.279, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.293, Ratio=2.40x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.274, Ratio=2.20x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.274, Ratio=2.17x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.282, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.266, Ratio=2.21x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.291, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.286, Ratio=2.32x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.271, Ratio=2.22x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.267, Ratio=2.17x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.280, Ratio=2.24x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.275, Ratio=2.23x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.277, Ratio=2.28x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.306, Ratio=2.42x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.279, Ratio=2.31x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.286, Ratio=2.33x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.288, Ratio=2.34x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.30x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.280, Ratio=2.24x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.281, Ratio=2.30x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.277, Ratio=2.25x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.284, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.284, Ratio=2.28x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.36x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.283, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.280, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.291, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.294, Ratio=2.39x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.305, Ratio=2.49x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.281, Ratio=2.32x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.293, Ratio=2.37x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.283, Ratio=2.30x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.277, Ratio=2.26x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.289, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.34x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.284, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.279, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.35x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.282, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.297, Ratio=2.40x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.282, Ratio=2.28x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.286, Ratio=2.27x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.30x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.28x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.274, Ratio=2.28x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.307, Ratio=2.45x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.268, Ratio=2.16x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.278, Ratio=2.28x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.277, Ratio=2.26x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.298, Ratio=2.44x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.292, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.287, Ratio=2.36x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.292, Ratio=2.32x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.302, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.279, Ratio=2.22x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.298, Ratio=2.37x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.296, Ratio=2.38x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.282, Ratio=2.31x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.299, Ratio=2.39x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.277, Ratio=2.23x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.287, Ratio=2.29x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.297, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.294, Ratio=2.41x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.292, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.292, Ratio=2.31x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.291, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.274, Ratio=2.24x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.278, Ratio=2.26x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.275, Ratio=2.20x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.298, Ratio=2.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.285, Ratio=2.37x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.295, Ratio=2.41x, Gap=-2.453

============================================================
Epoch 7/20 completed in 33.9s
Train: Loss=1.3420 (C:1.3420, R:0.0000) Ratio=2.18x
Val:   Loss=1.3227 (C:1.3227, R:0.0000) Ratio=2.34x
‚úÖ New best model saved (Val Loss: 1.3227)
============================================================

Epoch 8 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.286, Ratio=2.26x, Gap=-2.514
Batch   0/537: Loss=1.3335 (C:1.3335, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.273, Ratio=2.15x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.299, Ratio=2.32x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.280, Ratio=2.15x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.302, Ratio=2.39x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.278, Ratio=2.26x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.280, Ratio=2.30x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.269, Ratio=2.16x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.280, Ratio=2.28x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.267, Ratio=2.21x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.300, Ratio=2.38x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.292, Ratio=2.36x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.298, Ratio=2.40x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.273, Ratio=2.22x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.297, Ratio=2.34x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.275, Ratio=2.16x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.293, Ratio=2.30x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.289, Ratio=2.28x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.288, Ratio=2.28x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.267, Ratio=2.20x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.297, Ratio=2.40x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.273, Ratio=2.17x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.290, Ratio=2.27x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.283, Ratio=2.35x, Gap=-2.611
Batch  25/537: Loss=1.3115 (C:1.3115, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.267, Ratio=2.15x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.278, Ratio=2.23x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.274, Ratio=2.19x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.285, Ratio=2.30x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.272, Ratio=2.22x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.272, Ratio=2.21x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.291, Ratio=2.26x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.289, Ratio=2.24x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.285, Ratio=2.27x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.288, Ratio=2.30x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.275, Ratio=2.23x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.265, Ratio=2.16x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.264, Ratio=2.19x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.278, Ratio=2.29x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.284, Ratio=2.31x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.293, Ratio=2.31x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.278, Ratio=2.18x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.289, Ratio=2.31x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.292, Ratio=2.27x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.290, Ratio=2.20x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.289, Ratio=2.27x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.290, Ratio=2.32x, Gap=-2.678
Batch  50/537: Loss=1.3213 (C:1.3213, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.272, Ratio=2.25x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.281, Ratio=2.29x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.273, Ratio=2.20x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.269, Ratio=2.17x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.288, Ratio=2.26x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.287, Ratio=2.27x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.278, Ratio=2.23x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.284, Ratio=2.23x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.273, Ratio=2.08x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.290, Ratio=2.18x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.303, Ratio=2.36x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.300, Ratio=2.34x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.296, Ratio=2.33x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.281, Ratio=2.30x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.270, Ratio=2.22x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.260, Ratio=2.19x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.285, Ratio=2.28x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.297, Ratio=2.46x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.292, Ratio=2.33x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.27x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.299, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.278, Ratio=2.28x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.283, Ratio=2.23x, Gap=-2.528
Batch  75/537: Loss=1.3443 (C:1.3443, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.284, Ratio=2.19x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.285, Ratio=2.28x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.290, Ratio=2.31x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.281, Ratio=2.31x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.39x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.279, Ratio=2.17x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.302, Ratio=2.40x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.285, Ratio=2.27x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.302, Ratio=2.35x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.283, Ratio=2.20x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.286, Ratio=2.25x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.301, Ratio=2.35x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.281, Ratio=2.23x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.28x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.278, Ratio=2.25x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.282, Ratio=2.33x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.275, Ratio=2.19x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.305, Ratio=2.36x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.303, Ratio=2.35x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.293, Ratio=2.27x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.281, Ratio=2.18x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.301, Ratio=2.38x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.270, Ratio=2.15x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.274, Ratio=2.21x, Gap=-2.652
Batch 100/537: Loss=1.3528 (C:1.3528, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.277, Ratio=2.24x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.277, Ratio=2.29x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.279, Ratio=2.26x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.282, Ratio=2.30x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.270, Ratio=2.14x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.284, Ratio=2.23x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.28x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.296, Ratio=2.27x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.303, Ratio=2.33x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.289, Ratio=2.25x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.287, Ratio=2.23x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.289, Ratio=2.38x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.260, Ratio=2.20x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.279, Ratio=2.25x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.272, Ratio=2.21x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.284, Ratio=2.33x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.294, Ratio=2.34x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.284, Ratio=2.30x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.282, Ratio=2.20x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.295, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.282, Ratio=2.30x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.293, Ratio=2.31x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.29x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.298, Ratio=2.34x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.276, Ratio=2.16x, Gap=-2.672
Batch 125/537: Loss=1.3642 (C:1.3642, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.28x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.285, Ratio=2.26x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.286, Ratio=2.31x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.295, Ratio=2.33x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.277, Ratio=2.23x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.277, Ratio=2.29x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.294, Ratio=2.29x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.277, Ratio=2.21x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.269, Ratio=2.20x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.266, Ratio=2.20x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.280, Ratio=2.25x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.282, Ratio=2.30x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.299, Ratio=2.36x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.293, Ratio=2.31x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.295, Ratio=2.27x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.292, Ratio=2.30x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.284, Ratio=2.22x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.286, Ratio=2.29x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.305, Ratio=2.42x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.263, Ratio=2.11x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.287, Ratio=2.38x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.276, Ratio=2.22x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.276, Ratio=2.32x, Gap=-2.791
Batch 150/537: Loss=1.3227 (C:1.3227, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.273, Ratio=2.23x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.263, Ratio=2.18x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.285, Ratio=2.27x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.30x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.273, Ratio=2.21x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.313, Ratio=2.42x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.288, Ratio=2.27x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.263, Ratio=2.15x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.285, Ratio=2.28x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.27x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.293, Ratio=2.35x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.284, Ratio=2.29x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.267, Ratio=2.22x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.291, Ratio=2.30x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.274, Ratio=2.18x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.26x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.273, Ratio=2.19x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.273, Ratio=2.22x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.298, Ratio=2.31x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.274, Ratio=2.16x, Gap=-2.693
Batch 175/537: Loss=1.3668 (C:1.3668, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.280, Ratio=2.20x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.297, Ratio=2.31x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.281, Ratio=2.25x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.289, Ratio=2.30x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.285, Ratio=2.32x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.302, Ratio=2.38x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.266, Ratio=2.12x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.287, Ratio=2.32x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.30x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.303, Ratio=2.41x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.298, Ratio=2.34x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.298, Ratio=2.30x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.304, Ratio=2.42x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.300, Ratio=2.35x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.294, Ratio=2.25x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.278, Ratio=2.28x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.280, Ratio=2.30x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.279, Ratio=2.23x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.32x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.273, Ratio=2.24x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.277, Ratio=2.19x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.735
Batch 200/537: Loss=1.3157 (C:1.3157, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.280, Ratio=2.28x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.313, Ratio=2.38x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.280, Ratio=2.21x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.293, Ratio=2.29x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.294, Ratio=2.30x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.297, Ratio=2.33x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.280, Ratio=2.26x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.299, Ratio=2.35x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.286, Ratio=2.34x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.274, Ratio=2.22x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.288, Ratio=2.35x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.283, Ratio=2.30x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.278, Ratio=2.36x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.284, Ratio=2.24x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.280, Ratio=2.21x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.281, Ratio=2.32x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.301, Ratio=2.38x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.294, Ratio=2.29x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.281, Ratio=2.21x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.278, Ratio=2.25x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.279, Ratio=2.21x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.287, Ratio=2.26x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.287, Ratio=2.28x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.289, Ratio=2.25x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.635
Batch 225/537: Loss=1.3135 (C:1.3135, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.291, Ratio=2.37x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.308, Ratio=2.43x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.292, Ratio=2.28x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.279, Ratio=2.19x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.285, Ratio=2.24x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.289, Ratio=2.27x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.270, Ratio=2.19x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.29x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.270, Ratio=2.14x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.285, Ratio=2.26x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.281, Ratio=2.24x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.272, Ratio=2.20x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.285, Ratio=2.22x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.277, Ratio=2.19x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.290, Ratio=2.25x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.278, Ratio=2.27x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.268, Ratio=2.16x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.271, Ratio=2.19x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.299, Ratio=2.36x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.287, Ratio=2.26x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.285, Ratio=2.32x, Gap=-2.779
Batch 250/537: Loss=1.3197 (C:1.3197, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.285, Ratio=2.28x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.288, Ratio=2.25x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.287, Ratio=2.26x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.293, Ratio=2.23x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.290, Ratio=2.33x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.266, Ratio=2.14x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.272, Ratio=2.23x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.274, Ratio=2.15x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.283, Ratio=2.24x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.285, Ratio=2.29x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.293, Ratio=2.28x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.272, Ratio=2.22x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.286, Ratio=2.22x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.278, Ratio=2.22x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.296, Ratio=2.34x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.292, Ratio=2.34x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.275, Ratio=2.22x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.295, Ratio=2.37x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.299, Ratio=2.36x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.276, Ratio=2.24x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.269, Ratio=2.19x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.278, Ratio=2.23x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.284, Ratio=2.29x, Gap=-3.112
Batch 275/537: Loss=1.3272 (C:1.3272, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.284, Ratio=2.22x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.279, Ratio=2.22x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.286, Ratio=2.26x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.283, Ratio=2.31x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.287, Ratio=2.22x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.291, Ratio=2.28x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.293, Ratio=2.32x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.274, Ratio=2.20x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.278, Ratio=2.29x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.284, Ratio=2.25x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.271, Ratio=2.21x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.266, Ratio=2.23x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.279, Ratio=2.23x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.301, Ratio=2.32x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.281, Ratio=2.19x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.274, Ratio=2.18x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.295, Ratio=2.32x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.287, Ratio=2.29x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.287, Ratio=2.24x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.282, Ratio=2.22x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.294, Ratio=2.25x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.277, Ratio=2.25x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.284, Ratio=2.28x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.280, Ratio=2.19x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.768
Batch 300/537: Loss=1.3452 (C:1.3452, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.282, Ratio=2.20x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.280, Ratio=2.21x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.35x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.278, Ratio=2.25x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.285, Ratio=2.35x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.284, Ratio=2.26x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.293, Ratio=2.34x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.292, Ratio=2.29x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.294, Ratio=2.29x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.282, Ratio=2.23x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.304, Ratio=2.38x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.292, Ratio=2.29x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.280, Ratio=2.26x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.281, Ratio=2.24x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.275, Ratio=2.17x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.27x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.284, Ratio=2.25x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.272, Ratio=2.20x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.275, Ratio=2.18x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.290, Ratio=2.26x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.279, Ratio=2.17x, Gap=-2.550
Batch 325/537: Loss=1.3649 (C:1.3649, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.275, Ratio=2.24x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.269, Ratio=2.19x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.293, Ratio=2.36x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.27x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.280, Ratio=2.27x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.271, Ratio=2.21x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.288, Ratio=2.30x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.261, Ratio=2.10x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.298, Ratio=2.30x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.292, Ratio=2.30x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.292, Ratio=2.24x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.289, Ratio=2.24x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.286, Ratio=2.30x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.286, Ratio=2.22x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.283, Ratio=2.26x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.295, Ratio=2.30x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.289, Ratio=2.20x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.271, Ratio=2.19x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.287, Ratio=2.25x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.282, Ratio=2.24x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.25x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.296, Ratio=2.32x, Gap=-2.779
Batch 350/537: Loss=1.3168 (C:1.3168, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.260, Ratio=2.14x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.274, Ratio=2.26x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.260, Ratio=2.19x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.285, Ratio=2.25x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.296, Ratio=2.27x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.278, Ratio=2.26x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.273, Ratio=2.17x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.307, Ratio=2.39x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.289, Ratio=2.26x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.296, Ratio=2.31x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.286, Ratio=2.19x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.289, Ratio=2.26x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.276, Ratio=2.10x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.286, Ratio=2.27x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.273, Ratio=2.25x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.263, Ratio=2.13x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.282, Ratio=2.29x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.283, Ratio=2.29x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.281, Ratio=2.25x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.276, Ratio=2.24x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.288, Ratio=2.24x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.300, Ratio=2.38x, Gap=-2.660
Batch 375/537: Loss=1.3005 (C:1.3005, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.293, Ratio=2.32x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.297, Ratio=2.34x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.284, Ratio=2.24x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.299, Ratio=2.31x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.284, Ratio=2.23x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.285, Ratio=2.29x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.271, Ratio=2.19x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.301, Ratio=2.38x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.270, Ratio=2.22x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.280, Ratio=2.30x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.305, Ratio=2.42x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.307, Ratio=2.42x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.292, Ratio=2.27x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.287, Ratio=2.30x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.283, Ratio=2.20x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.278, Ratio=2.27x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.287, Ratio=2.26x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.284, Ratio=2.33x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.275, Ratio=2.17x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.278, Ratio=2.28x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.265, Ratio=2.19x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.267, Ratio=2.18x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.296, Ratio=2.36x, Gap=-2.659
Batch 400/537: Loss=1.3019 (C:1.3019, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.283, Ratio=2.27x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.275, Ratio=2.17x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.289, Ratio=2.26x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.286, Ratio=2.22x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.305, Ratio=2.38x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.285, Ratio=2.28x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.289, Ratio=2.28x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.289, Ratio=2.26x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.276, Ratio=2.29x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.273, Ratio=2.18x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.290, Ratio=2.22x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.304, Ratio=2.35x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.288, Ratio=2.32x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.277, Ratio=2.19x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.281, Ratio=2.23x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.282, Ratio=2.37x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.282, Ratio=2.27x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.273, Ratio=2.23x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.30x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.281, Ratio=2.23x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.276, Ratio=2.25x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.291, Ratio=2.32x, Gap=-2.634
Batch 425/537: Loss=1.3165 (C:1.3165, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.271, Ratio=2.20x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.282, Ratio=2.28x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.295, Ratio=2.33x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.292, Ratio=2.29x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.293, Ratio=2.25x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.280, Ratio=2.18x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.284, Ratio=2.27x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.266, Ratio=2.19x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.284, Ratio=2.25x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.273, Ratio=2.22x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.281, Ratio=2.26x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.272, Ratio=2.21x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.282, Ratio=2.25x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.277, Ratio=2.19x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.276, Ratio=2.19x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.300, Ratio=2.34x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.291, Ratio=2.30x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.293, Ratio=2.22x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.285, Ratio=2.20x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.302, Ratio=2.38x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.275, Ratio=2.19x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.282, Ratio=2.18x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.290, Ratio=2.31x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.278, Ratio=2.25x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.289, Ratio=2.28x, Gap=-2.875
Batch 450/537: Loss=1.3277 (C:1.3277, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.273, Ratio=2.23x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.285, Ratio=2.25x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.275, Ratio=2.20x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.289, Ratio=2.28x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.291, Ratio=2.27x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.288, Ratio=2.26x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.310, Ratio=2.39x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.283, Ratio=2.21x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.294, Ratio=2.25x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.294, Ratio=2.38x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.288, Ratio=2.24x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.293, Ratio=2.34x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.285, Ratio=2.38x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.263, Ratio=2.20x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.273, Ratio=2.17x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.281, Ratio=2.25x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.272, Ratio=2.24x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.296, Ratio=2.37x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.270, Ratio=2.13x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.295, Ratio=2.22x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.286, Ratio=2.27x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.297, Ratio=2.25x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.283, Ratio=2.22x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.285, Ratio=2.23x, Gap=-2.756
Batch 475/537: Loss=1.3461 (C:1.3461, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.285, Ratio=2.24x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.300, Ratio=2.35x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.287, Ratio=2.30x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.271, Ratio=2.26x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.282, Ratio=2.30x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.293, Ratio=2.31x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.275, Ratio=2.21x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.293, Ratio=2.31x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.290, Ratio=2.32x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.293, Ratio=2.31x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.285, Ratio=2.24x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.291, Ratio=2.26x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.291, Ratio=2.30x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.281, Ratio=2.23x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.278, Ratio=2.22x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.294, Ratio=2.32x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.290, Ratio=2.29x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.277, Ratio=2.21x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.296, Ratio=2.35x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.264, Ratio=2.23x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.285, Ratio=2.32x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.281, Ratio=2.24x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.283, Ratio=2.30x, Gap=-2.596
Batch 500/537: Loss=1.3244 (C:1.3244, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.285, Ratio=2.25x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.292, Ratio=2.22x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.297, Ratio=2.26x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.281, Ratio=2.23x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.280, Ratio=2.26x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.270, Ratio=2.20x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.268, Ratio=2.17x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.285, Ratio=2.36x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.282, Ratio=2.29x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.275, Ratio=2.19x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.280, Ratio=2.20x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.284, Ratio=2.23x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.283, Ratio=2.21x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.277, Ratio=2.17x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.276, Ratio=2.17x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.303, Ratio=2.36x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.284, Ratio=2.26x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.279, Ratio=2.26x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.25x, Gap=-2.828
Batch 525/537: Loss=1.3363 (C:1.3363, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.279, Ratio=2.22x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.278, Ratio=2.25x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.271, Ratio=2.21x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.300, Ratio=2.35x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.302, Ratio=2.30x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.284, Ratio=2.24x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.297, Ratio=2.34x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.299, Ratio=2.35x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.309, Ratio=2.36x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.290, Ratio=2.29x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.292, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.292, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.300, Ratio=2.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.283, Ratio=2.25x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.296, Ratio=2.40x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.309, Ratio=2.51x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.285, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.288, Ratio=2.37x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.279, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.275, Ratio=2.27x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.298, Ratio=2.37x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.298, Ratio=2.42x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.288, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.279, Ratio=2.22x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.277, Ratio=2.31x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.272, Ratio=2.27x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.298, Ratio=2.39x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.295, Ratio=2.40x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.300, Ratio=2.34x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.271, Ratio=2.22x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.276, Ratio=2.28x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.289, Ratio=2.39x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.291, Ratio=2.45x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.282, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.280, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.287, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.293, Ratio=2.34x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.279, Ratio=2.23x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.286, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.305, Ratio=2.51x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.297, Ratio=2.38x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.299, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.276, Ratio=2.27x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.300, Ratio=2.41x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.39x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.39x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.289, Ratio=2.40x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.269, Ratio=2.27x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.281, Ratio=2.32x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.303, Ratio=2.40x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.302, Ratio=2.42x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.290, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.285, Ratio=2.33x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.287, Ratio=2.38x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.301, Ratio=2.44x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.293, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.277, Ratio=2.24x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.291, Ratio=2.40x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.291, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.283, Ratio=2.31x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.308, Ratio=2.48x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.287, Ratio=2.40x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.292, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.308, Ratio=2.47x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.304, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.285, Ratio=2.36x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.300, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.43x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.286, Ratio=2.30x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.291, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.294, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.300, Ratio=2.43x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.299, Ratio=2.50x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.292, Ratio=2.38x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.279, Ratio=2.28x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.293, Ratio=2.44x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.282, Ratio=2.29x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.291, Ratio=2.42x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.296, Ratio=2.40x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.287, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.287, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.292, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.287, Ratio=2.35x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.286, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.282, Ratio=2.39x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.274, Ratio=2.31x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.294, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.282, Ratio=2.28x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.291, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.277, Ratio=2.25x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.283, Ratio=2.32x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.313, Ratio=2.50x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.307, Ratio=2.49x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.278, Ratio=2.35x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.289, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.284, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.302, Ratio=2.42x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.298, Ratio=2.43x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.266, Ratio=2.26x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.294, Ratio=2.39x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.279, Ratio=2.30x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.306, Ratio=2.39x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.302, Ratio=2.49x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.278, Ratio=2.27x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.285, Ratio=2.31x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.277, Ratio=2.28x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.299, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.301, Ratio=2.44x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.293, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.281, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.291, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.28x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.280, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.288, Ratio=2.39x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.302, Ratio=2.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.288, Ratio=2.34x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.283, Ratio=2.28x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.281, Ratio=2.33x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.41x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.284, Ratio=2.26x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.287, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.298, Ratio=2.46x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.293, Ratio=2.37x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.294, Ratio=2.42x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.283, Ratio=2.33x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.279, Ratio=2.30x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.293, Ratio=2.40x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.294, Ratio=2.45x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.310, Ratio=2.47x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.288, Ratio=2.31x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.292, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.280, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.293, Ratio=2.38x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.277, Ratio=2.29x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.300, Ratio=2.37x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.282, Ratio=2.27x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.274, Ratio=2.26x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.299, Ratio=2.36x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.278, Ratio=2.29x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.296, Ratio=2.51x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.296, Ratio=2.42x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.273, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.303, Ratio=2.50x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.303, Ratio=2.46x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.25x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.294, Ratio=2.36x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.295, Ratio=2.45x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.273, Ratio=2.27x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.292, Ratio=2.36x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.286, Ratio=2.30x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.276, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.296, Ratio=2.42x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.282, Ratio=2.26x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.305, Ratio=2.44x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.271, Ratio=2.27x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.290, Ratio=2.36x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.288, Ratio=2.35x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.299, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.290, Ratio=2.38x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.291, Ratio=2.32x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.289, Ratio=2.36x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.292, Ratio=2.40x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.283, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.291, Ratio=2.32x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.298, Ratio=2.40x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.293, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.293, Ratio=2.35x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.295, Ratio=2.46x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.277, Ratio=2.28x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.283, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.291, Ratio=2.38x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.278, Ratio=2.38x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.287, Ratio=2.38x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.286, Ratio=2.30x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.298, Ratio=2.40x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.289, Ratio=2.31x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.279, Ratio=2.29x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.288, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.296, Ratio=2.39x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.297, Ratio=2.43x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.294, Ratio=2.48x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.286, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.264, Ratio=2.19x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.286, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.290, Ratio=2.38x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.292, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.297, Ratio=2.43x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.274, Ratio=2.26x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.288, Ratio=2.32x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.288, Ratio=2.37x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.291, Ratio=2.33x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.292, Ratio=2.41x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.290, Ratio=2.36x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.275, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.287, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.298, Ratio=2.35x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.287, Ratio=2.34x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.283, Ratio=2.27x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.288, Ratio=2.37x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.286, Ratio=2.33x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.34x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.296, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.294, Ratio=2.40x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.283, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.277, Ratio=2.31x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.284, Ratio=2.33x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.275, Ratio=2.30x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.297, Ratio=2.38x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.287, Ratio=2.29x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.300, Ratio=2.48x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.300, Ratio=2.46x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.294, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.285, Ratio=2.33x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.293, Ratio=2.35x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.263, Ratio=2.21x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.300, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.273, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.288, Ratio=2.31x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.297, Ratio=2.45x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.284, Ratio=2.32x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.287, Ratio=2.37x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.282, Ratio=2.28x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.301, Ratio=2.46x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.284, Ratio=2.33x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.308, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.295, Ratio=2.44x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.284, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.285, Ratio=2.36x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.282, Ratio=2.27x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.36x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.278, Ratio=2.24x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.298, Ratio=2.38x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.287, Ratio=2.27x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.309, Ratio=2.54x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.291, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.303, Ratio=2.42x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.286, Ratio=2.33x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.305, Ratio=2.49x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.286, Ratio=2.36x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.285, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.283, Ratio=2.33x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.280, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.294, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.280, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.297, Ratio=2.38x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.290, Ratio=2.41x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.301, Ratio=2.46x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.300, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.277, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.295, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.281, Ratio=2.26x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.280, Ratio=2.31x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.281, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.280, Ratio=2.31x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.293, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.281, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.294, Ratio=2.47x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.286, Ratio=2.37x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.298, Ratio=2.37x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.297, Ratio=2.31x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.283, Ratio=2.34x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.287, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.301, Ratio=2.46x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.284, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.277, Ratio=2.29x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.287, Ratio=2.41x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.288, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.288, Ratio=2.33x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.305, Ratio=2.45x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.285, Ratio=2.41x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.284, Ratio=2.26x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.294, Ratio=2.35x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.284, Ratio=2.28x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.288, Ratio=2.35x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.286, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.299, Ratio=2.44x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.288, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.287, Ratio=2.38x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.281, Ratio=2.26x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.290, Ratio=2.32x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.36x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.42x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.272, Ratio=2.24x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.299, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.286, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.290, Ratio=2.40x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.306, Ratio=2.42x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.278, Ratio=2.24x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.273, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.302, Ratio=2.45x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.277, Ratio=2.26x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.293, Ratio=2.34x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.283, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.285, Ratio=2.26x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.283, Ratio=2.34x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.283, Ratio=2.30x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.290, Ratio=2.40x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.287, Ratio=2.39x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.296, Ratio=2.38x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.300, Ratio=2.46x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.290, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.280, Ratio=2.30x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.298, Ratio=2.44x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.281, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.266, Ratio=2.24x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.293, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.296, Ratio=2.41x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.293, Ratio=2.42x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.289, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.291, Ratio=2.39x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.283, Ratio=2.28x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.292, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.287, Ratio=2.28x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.283, Ratio=2.31x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.282, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.290, Ratio=2.30x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.280, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.294, Ratio=2.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.278, Ratio=2.33x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.38x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.292, Ratio=2.35x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.298, Ratio=2.50x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.285, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.287, Ratio=2.37x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.284, Ratio=2.33x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.305, Ratio=2.47x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.295, Ratio=2.37x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.295, Ratio=2.51x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.292, Ratio=2.35x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.293, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.300, Ratio=2.41x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.287, Ratio=2.38x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.287, Ratio=2.36x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.291, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.287, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.31x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.293, Ratio=2.42x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.280, Ratio=2.27x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.276, Ratio=2.25x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.285, Ratio=2.34x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.269, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.294, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.285, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.286, Ratio=2.34x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.300, Ratio=2.47x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.287, Ratio=2.33x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.281, Ratio=2.30x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.276, Ratio=2.38x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.288, Ratio=2.35x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.285, Ratio=2.34x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.277, Ratio=2.25x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.292, Ratio=2.42x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.298, Ratio=2.40x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.285, Ratio=2.31x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.285, Ratio=2.30x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.271, Ratio=2.29x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.276, Ratio=2.28x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.283, Ratio=2.33x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.280, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.281, Ratio=2.33x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.287, Ratio=2.35x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.281, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.283, Ratio=2.29x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.277, Ratio=2.24x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.283, Ratio=2.32x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.295, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.279, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.280, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.272, Ratio=2.21x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.294, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.291, Ratio=2.40x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.268, Ratio=2.24x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.280, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.291, Ratio=2.40x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.286, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.285, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.294, Ratio=2.38x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.290, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.284, Ratio=2.32x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.297, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.47x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.286, Ratio=2.41x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.298, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.306, Ratio=2.50x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.25x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.272, Ratio=2.24x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.315, Ratio=2.50x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.287, Ratio=2.36x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.289, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.294, Ratio=2.35x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.292, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.41x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.269, Ratio=2.21x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.293, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.292, Ratio=2.38x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.289, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.283, Ratio=2.28x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.289, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.270, Ratio=2.25x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.294, Ratio=2.39x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.288, Ratio=2.29x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.31x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.269, Ratio=2.23x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.285, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.285, Ratio=2.34x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.270, Ratio=2.28x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.314, Ratio=2.56x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.279, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.295, Ratio=2.40x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.292, Ratio=2.39x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.270, Ratio=2.19x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.291, Ratio=2.34x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.290, Ratio=2.33x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.272, Ratio=2.26x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.293, Ratio=2.44x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.298, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.286, Ratio=2.33x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.263, Ratio=2.25x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.304, Ratio=2.46x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.286, Ratio=2.38x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.283, Ratio=2.35x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.285, Ratio=2.32x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.282, Ratio=2.32x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.301, Ratio=2.49x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.287, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.279, Ratio=2.23x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.29x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.282, Ratio=2.33x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.310, Ratio=2.50x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.281, Ratio=2.28x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.277, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.296, Ratio=2.44x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.289, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.301, Ratio=2.42x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.272, Ratio=2.27x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.288, Ratio=2.30x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.31x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.37x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.293, Ratio=2.32x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.318, Ratio=2.62x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.291, Ratio=2.34x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.289, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.272, Ratio=2.28x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.30x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.278, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.288, Ratio=2.36x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.290, Ratio=2.43x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.276, Ratio=2.24x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.283, Ratio=2.34x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.283, Ratio=2.27x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.298, Ratio=2.41x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.278, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.280, Ratio=2.34x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.289, Ratio=2.36x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.286, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.281, Ratio=2.38x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.289, Ratio=2.32x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.271, Ratio=2.25x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.297, Ratio=2.38x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.289, Ratio=2.36x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.278, Ratio=2.29x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.283, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.281, Ratio=2.31x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.297, Ratio=2.39x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.279, Ratio=2.25x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.303, Ratio=2.43x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.281, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-2.465

============================================================
Epoch 8/20 completed in 28.7s
Train: Loss=1.3338 (C:1.3338, R:0.0000) Ratio=2.25x
Val:   Loss=1.3100 (C:1.3100, R:0.0000) Ratio=2.45x
‚úÖ New best model saved (Val Loss: 1.3100)
============================================================

Epoch 9 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.268, Ratio=2.17x, Gap=-2.631
Batch   0/537: Loss=1.3660 (C:1.3660, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.295, Ratio=2.36x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.280, Ratio=2.21x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.33x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.24x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.280, Ratio=2.24x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.306, Ratio=2.48x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.287, Ratio=2.26x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.279, Ratio=2.23x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.300, Ratio=2.32x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.294, Ratio=2.26x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.302, Ratio=2.40x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.284, Ratio=2.22x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.287, Ratio=2.33x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.283, Ratio=2.32x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.298, Ratio=2.36x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.282, Ratio=2.35x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.27x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.297, Ratio=2.26x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.31x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.288, Ratio=2.27x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.292, Ratio=2.26x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.295, Ratio=2.26x, Gap=-2.741
Batch  25/537: Loss=1.3302 (C:1.3302, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.281, Ratio=2.28x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.289, Ratio=2.30x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.276, Ratio=2.23x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.300, Ratio=2.35x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.280, Ratio=2.15x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.278, Ratio=2.23x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.287, Ratio=2.27x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.285, Ratio=2.31x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.283, Ratio=2.26x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.291, Ratio=2.28x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.292, Ratio=2.29x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.297, Ratio=2.32x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.277, Ratio=2.22x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.278, Ratio=2.20x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.291, Ratio=2.33x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.29x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.302, Ratio=2.43x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.301, Ratio=2.39x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.283, Ratio=2.24x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.285, Ratio=2.29x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.293, Ratio=2.28x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.285, Ratio=2.16x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.290, Ratio=2.35x, Gap=-2.700
Batch  50/537: Loss=1.3102 (C:1.3102, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.300, Ratio=2.34x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.276, Ratio=2.20x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.297, Ratio=2.33x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.283, Ratio=2.24x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.285, Ratio=2.24x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.305, Ratio=2.41x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.292, Ratio=2.26x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.274, Ratio=2.24x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.283, Ratio=2.27x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.308, Ratio=2.52x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.276, Ratio=2.21x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.294, Ratio=2.37x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.302, Ratio=2.34x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.291, Ratio=2.34x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.290, Ratio=2.25x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.289, Ratio=2.28x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.310, Ratio=2.47x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.281, Ratio=2.24x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.282, Ratio=2.26x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.280, Ratio=2.19x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.290, Ratio=2.37x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.291, Ratio=2.30x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.291, Ratio=2.30x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.281, Ratio=2.23x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.294, Ratio=2.30x, Gap=-2.649
Batch  75/537: Loss=1.3194 (C:1.3194, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.282, Ratio=2.23x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.303, Ratio=2.40x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.290, Ratio=2.26x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.283, Ratio=2.24x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.283, Ratio=2.24x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.304, Ratio=2.34x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.296, Ratio=2.30x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.293, Ratio=2.31x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.279, Ratio=2.22x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.274, Ratio=2.25x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.271, Ratio=2.22x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.284, Ratio=2.36x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.271, Ratio=2.19x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.288, Ratio=2.38x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.286, Ratio=2.23x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.272, Ratio=2.17x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.286, Ratio=2.25x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.296, Ratio=2.32x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.287, Ratio=2.24x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.294, Ratio=2.32x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.286, Ratio=2.31x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.283, Ratio=2.23x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.29x, Gap=-2.723
Batch 100/537: Loss=1.3245 (C:1.3245, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.274, Ratio=2.28x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.295, Ratio=2.36x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.271, Ratio=2.23x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.278, Ratio=2.25x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.278, Ratio=2.23x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.259, Ratio=2.11x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.296, Ratio=2.34x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.276, Ratio=2.21x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.275, Ratio=2.18x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.289, Ratio=2.33x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.289, Ratio=2.27x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.296, Ratio=2.30x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.275, Ratio=2.22x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.33x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.291, Ratio=2.31x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.287, Ratio=2.30x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.36x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.279, Ratio=2.23x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.293, Ratio=2.27x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.265, Ratio=2.12x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.294, Ratio=2.34x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.303, Ratio=2.38x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.301, Ratio=2.33x, Gap=-2.831
Batch 125/537: Loss=1.3114 (C:1.3114, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.277, Ratio=2.21x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.29x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.300, Ratio=2.36x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.292, Ratio=2.31x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.282, Ratio=2.29x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.273, Ratio=2.24x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.294, Ratio=2.35x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.275, Ratio=2.22x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.282, Ratio=2.24x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.275, Ratio=2.25x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.297, Ratio=2.34x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.285, Ratio=2.25x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.29x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.284, Ratio=2.22x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.30x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.298, Ratio=2.31x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.268, Ratio=2.18x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.294, Ratio=2.28x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.298, Ratio=2.36x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.282, Ratio=2.28x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.289, Ratio=2.30x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.684
Batch 150/537: Loss=1.3047 (C:1.3047, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.292, Ratio=2.32x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.47x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.292, Ratio=2.28x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.34x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.296, Ratio=2.41x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.294, Ratio=2.27x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.282, Ratio=2.29x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.286, Ratio=2.27x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.37x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.300, Ratio=2.30x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.291, Ratio=2.29x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.276, Ratio=2.19x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.296, Ratio=2.30x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.291, Ratio=2.26x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.294, Ratio=2.30x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.291, Ratio=2.35x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.295, Ratio=2.29x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.281, Ratio=2.22x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.273, Ratio=2.20x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.290, Ratio=2.26x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.294, Ratio=2.24x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.290, Ratio=2.28x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.285, Ratio=2.26x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.285, Ratio=2.37x, Gap=-2.577
Batch 175/537: Loss=1.3096 (C:1.3096, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.282, Ratio=2.21x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.297, Ratio=2.37x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.268, Ratio=2.14x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.296, Ratio=2.35x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.290, Ratio=2.24x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.275, Ratio=2.25x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.294, Ratio=2.36x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.277, Ratio=2.27x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.294, Ratio=2.32x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.299, Ratio=2.33x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.288, Ratio=2.29x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.281, Ratio=2.32x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.305, Ratio=2.44x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.286, Ratio=2.32x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.299, Ratio=2.33x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.294, Ratio=2.33x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.301, Ratio=2.35x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.289, Ratio=2.28x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.299, Ratio=2.41x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.301, Ratio=2.35x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.285, Ratio=2.23x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.280, Ratio=2.22x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.287, Ratio=2.24x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.290, Ratio=2.25x, Gap=-2.725
Batch 200/537: Loss=1.3353 (C:1.3353, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.290, Ratio=2.27x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.296, Ratio=2.40x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.280, Ratio=2.32x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.303, Ratio=2.35x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.286, Ratio=2.29x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.287, Ratio=2.29x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.284, Ratio=2.22x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.299, Ratio=2.33x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.308, Ratio=2.38x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.310, Ratio=2.39x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.296, Ratio=2.27x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.298, Ratio=2.26x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.281, Ratio=2.20x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.277, Ratio=2.20x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.285, Ratio=2.31x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.272, Ratio=2.23x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.275, Ratio=2.25x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.290, Ratio=2.36x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.273, Ratio=2.25x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.305, Ratio=2.29x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.308, Ratio=2.36x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.312, Ratio=2.47x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.307, Ratio=2.39x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.286, Ratio=2.24x, Gap=-2.754
Batch 225/537: Loss=1.3409 (C:1.3409, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.303, Ratio=2.37x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.295, Ratio=2.31x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.295, Ratio=2.40x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.276, Ratio=2.25x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.275, Ratio=2.25x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.287, Ratio=2.33x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.262, Ratio=2.19x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.287, Ratio=2.23x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.288, Ratio=2.28x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.310, Ratio=2.30x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.319, Ratio=2.48x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.294, Ratio=2.28x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.293, Ratio=2.22x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.277, Ratio=2.31x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.306, Ratio=2.36x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.261, Ratio=2.19x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.267, Ratio=2.25x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.290, Ratio=2.38x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.31x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.281, Ratio=2.27x, Gap=-2.693
Batch 250/537: Loss=1.3324 (C:1.3324, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.286, Ratio=2.21x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.298, Ratio=2.31x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.287, Ratio=2.23x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.285, Ratio=2.28x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.281, Ratio=2.17x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.291, Ratio=2.30x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.282, Ratio=2.23x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.294, Ratio=2.30x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.280, Ratio=2.25x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.284, Ratio=2.31x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.270, Ratio=2.29x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.270, Ratio=2.22x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.280, Ratio=2.25x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.302, Ratio=2.40x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.279, Ratio=2.27x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.282, Ratio=2.28x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.288, Ratio=2.27x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.291, Ratio=2.29x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.316, Ratio=2.48x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.292, Ratio=2.32x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.303, Ratio=2.40x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.279, Ratio=2.14x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.302, Ratio=2.38x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.319, Ratio=2.46x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.285, Ratio=2.26x, Gap=-2.757
Batch 275/537: Loss=1.3352 (C:1.3352, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.278, Ratio=2.21x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.284, Ratio=2.28x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.294, Ratio=2.35x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.282, Ratio=2.19x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.292, Ratio=2.33x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.296, Ratio=2.30x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.295, Ratio=2.32x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.295, Ratio=2.22x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.294, Ratio=2.34x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.285, Ratio=2.26x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.289, Ratio=2.31x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.293, Ratio=2.34x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.282, Ratio=2.27x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.283, Ratio=2.20x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.286, Ratio=2.25x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.288, Ratio=2.37x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.293, Ratio=2.31x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.278, Ratio=2.15x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.306, Ratio=2.43x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.290, Ratio=2.26x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.288, Ratio=2.28x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.275, Ratio=2.23x, Gap=-2.623
Batch 300/537: Loss=1.3457 (C:1.3457, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.292, Ratio=2.30x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.292, Ratio=2.33x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.293, Ratio=2.24x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.33x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.289, Ratio=2.28x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.303, Ratio=2.43x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.278, Ratio=2.22x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.277, Ratio=2.24x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.286, Ratio=2.29x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.24x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.286, Ratio=2.32x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.295, Ratio=2.32x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.303, Ratio=2.35x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.282, Ratio=2.27x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.297, Ratio=2.32x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.301, Ratio=2.35x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.301, Ratio=2.34x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.35x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.283, Ratio=2.23x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.291, Ratio=2.24x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.284, Ratio=2.26x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.279, Ratio=2.29x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.294, Ratio=2.32x, Gap=-2.628
Batch 325/537: Loss=1.3160 (C:1.3160, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.294, Ratio=2.29x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.284, Ratio=2.26x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.298, Ratio=2.33x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.284, Ratio=2.31x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.286, Ratio=2.23x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.291, Ratio=2.30x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.295, Ratio=2.33x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.296, Ratio=2.33x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.292, Ratio=2.28x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.297, Ratio=2.35x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.295, Ratio=2.34x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.292, Ratio=2.38x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.295, Ratio=2.30x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.306, Ratio=2.37x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.285, Ratio=2.25x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.286, Ratio=2.30x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.288, Ratio=2.22x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.290, Ratio=2.27x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.278, Ratio=2.27x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.28x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.286, Ratio=2.29x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.287, Ratio=2.34x, Gap=-2.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.30x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.291, Ratio=2.28x, Gap=-2.849
Batch 350/537: Loss=1.3280 (C:1.3280, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.305, Ratio=2.35x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.301, Ratio=2.38x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.294, Ratio=2.29x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.290, Ratio=2.28x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.304, Ratio=2.37x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.289, Ratio=2.27x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.285, Ratio=2.27x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.277, Ratio=2.21x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.294, Ratio=2.31x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.267, Ratio=2.19x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.295, Ratio=2.38x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.285, Ratio=2.26x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.279, Ratio=2.18x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.285, Ratio=2.25x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.283, Ratio=2.28x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.281, Ratio=2.23x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.307, Ratio=2.45x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.274, Ratio=2.24x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.277, Ratio=2.18x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.299, Ratio=2.32x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.30x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.287, Ratio=2.28x, Gap=-2.677
Batch 375/537: Loss=1.3295 (C:1.3295, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.287, Ratio=2.27x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.289, Ratio=2.26x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.280, Ratio=2.20x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.289, Ratio=2.28x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.285, Ratio=2.26x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.30x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.272, Ratio=2.21x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.278, Ratio=2.26x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.287, Ratio=2.35x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.280, Ratio=2.23x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.292, Ratio=2.30x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.300, Ratio=2.38x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.273, Ratio=2.20x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.278, Ratio=2.30x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.291, Ratio=2.29x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.286, Ratio=2.28x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.292, Ratio=2.28x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.288, Ratio=2.24x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.280, Ratio=2.28x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.289, Ratio=2.33x, Gap=-2.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.305, Ratio=2.45x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.285, Ratio=2.33x, Gap=-2.612
Batch 400/537: Loss=1.3171 (C:1.3171, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.29x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.293, Ratio=2.30x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.294, Ratio=2.27x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.298, Ratio=2.31x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.293, Ratio=2.29x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.300, Ratio=2.37x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.277, Ratio=2.26x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.276, Ratio=2.24x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.284, Ratio=2.26x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.276, Ratio=2.23x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.287, Ratio=2.28x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.283, Ratio=2.25x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.299, Ratio=2.36x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.272, Ratio=2.21x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.280, Ratio=2.22x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.280, Ratio=2.24x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.294, Ratio=2.30x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.300, Ratio=2.34x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.304, Ratio=2.35x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.289, Ratio=2.23x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.292, Ratio=2.26x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.312, Ratio=2.39x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.288, Ratio=2.28x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.274, Ratio=2.20x, Gap=-2.571
Batch 425/537: Loss=1.3562 (C:1.3562, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.281, Ratio=2.33x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.280, Ratio=2.26x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.285, Ratio=2.23x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.300, Ratio=2.36x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.297, Ratio=2.33x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.292, Ratio=2.29x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.296, Ratio=2.28x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.289, Ratio=2.27x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.296, Ratio=2.33x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.293, Ratio=2.33x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.275, Ratio=2.22x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.286, Ratio=2.26x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.289, Ratio=2.33x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.289, Ratio=2.27x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.292, Ratio=2.32x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.283, Ratio=2.25x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.282, Ratio=2.22x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.291, Ratio=2.30x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.299, Ratio=2.33x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.303, Ratio=2.31x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.294, Ratio=2.23x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.303, Ratio=2.29x, Gap=-2.766
Batch 450/537: Loss=1.3240 (C:1.3240, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.291, Ratio=2.27x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.287, Ratio=2.25x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.293, Ratio=2.29x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.299, Ratio=2.36x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.283, Ratio=2.31x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.286, Ratio=2.30x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.283, Ratio=2.25x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.283, Ratio=2.32x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.293, Ratio=2.32x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.289, Ratio=2.26x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.299, Ratio=2.33x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.316, Ratio=2.43x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.279, Ratio=2.25x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.282, Ratio=2.24x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.289, Ratio=2.23x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.292, Ratio=2.29x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.302, Ratio=2.33x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.30x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.30x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.306, Ratio=2.40x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.297, Ratio=2.37x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.290, Ratio=2.31x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.298, Ratio=2.31x, Gap=-2.721
Batch 475/537: Loss=1.3194 (C:1.3194, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.295, Ratio=2.27x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.294, Ratio=2.28x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.277, Ratio=2.23x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.279, Ratio=2.26x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.297, Ratio=2.32x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.284, Ratio=2.24x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.294, Ratio=2.33x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.267, Ratio=2.19x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.282, Ratio=2.25x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.278, Ratio=2.24x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.281, Ratio=2.28x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.296, Ratio=2.27x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.291, Ratio=2.32x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.276, Ratio=2.21x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.286, Ratio=2.26x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.290, Ratio=2.31x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.280, Ratio=2.28x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.296, Ratio=2.31x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.297, Ratio=2.37x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.288, Ratio=2.28x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.284, Ratio=2.27x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.288, Ratio=2.34x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.293, Ratio=2.35x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.279, Ratio=2.21x, Gap=-2.617
Batch 500/537: Loss=1.3485 (C:1.3485, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.300, Ratio=2.39x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.280, Ratio=2.24x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.284, Ratio=2.26x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.278, Ratio=2.19x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.282, Ratio=2.26x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.288, Ratio=2.21x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.291, Ratio=2.32x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.283, Ratio=2.30x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.284, Ratio=2.23x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.277, Ratio=2.26x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.286, Ratio=2.24x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.297, Ratio=2.38x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.287, Ratio=2.25x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.293, Ratio=2.34x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.288, Ratio=2.33x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.280, Ratio=2.18x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.288, Ratio=2.27x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.285, Ratio=2.17x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.299, Ratio=2.30x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.289, Ratio=2.29x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.278, Ratio=2.22x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.272, Ratio=2.19x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.279, Ratio=2.24x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.295, Ratio=2.32x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.274, Ratio=2.24x, Gap=-2.755
Batch 525/537: Loss=1.3475 (C:1.3475, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.287, Ratio=2.35x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.277, Ratio=2.21x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.282, Ratio=2.23x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.302, Ratio=2.40x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.295, Ratio=2.32x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.275, Ratio=2.26x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.280, Ratio=2.18x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.291, Ratio=2.35x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.286, Ratio=2.28x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.293, Ratio=2.29x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.278, Ratio=2.28x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.288, Ratio=2.37x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.313, Ratio=2.60x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.285, Ratio=2.32x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.288, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.282, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.290, Ratio=2.33x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.282, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.287, Ratio=2.31x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.287, Ratio=2.30x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.282, Ratio=2.32x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.296, Ratio=2.42x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.286, Ratio=2.32x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.304, Ratio=2.47x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.284, Ratio=2.29x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.291, Ratio=2.37x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.283, Ratio=2.33x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.291, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.291, Ratio=2.37x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.285, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.287, Ratio=2.28x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.288, Ratio=2.39x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.283, Ratio=2.34x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.292, Ratio=2.43x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.305, Ratio=2.51x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.300, Ratio=2.42x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.305, Ratio=2.53x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.296, Ratio=2.40x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.295, Ratio=2.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.299, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.282, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.294, Ratio=2.42x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.286, Ratio=2.37x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.306, Ratio=2.47x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.294, Ratio=2.38x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.291, Ratio=2.36x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.289, Ratio=2.33x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.305, Ratio=2.47x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.293, Ratio=2.36x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.297, Ratio=2.45x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.284, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.297, Ratio=2.38x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.309, Ratio=2.56x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.278, Ratio=2.28x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.310, Ratio=2.54x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.38x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.297, Ratio=2.42x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.293, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.302, Ratio=2.44x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.286, Ratio=2.33x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.282, Ratio=2.33x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.299, Ratio=2.39x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.274, Ratio=2.34x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.295, Ratio=2.34x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.304, Ratio=2.49x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.303, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.283, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.34x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.291, Ratio=2.38x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.286, Ratio=2.29x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.303, Ratio=2.41x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.300, Ratio=2.48x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.291, Ratio=2.35x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.300, Ratio=2.42x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.299, Ratio=2.44x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.287, Ratio=2.32x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.289, Ratio=2.34x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.294, Ratio=2.39x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.305, Ratio=2.44x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.296, Ratio=2.40x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.299, Ratio=2.43x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.295, Ratio=2.38x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.282, Ratio=2.32x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.289, Ratio=2.38x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.290, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.283, Ratio=2.26x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.292, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.295, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.296, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.297, Ratio=2.41x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.290, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.276, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.278, Ratio=2.28x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.295, Ratio=2.44x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.293, Ratio=2.39x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.293, Ratio=2.43x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.299, Ratio=2.41x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.276, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.301, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.312, Ratio=2.45x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.295, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.270, Ratio=2.27x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.294, Ratio=2.44x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.47x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.289, Ratio=2.31x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.294, Ratio=2.36x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.281, Ratio=2.32x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.294, Ratio=2.39x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.284, Ratio=2.33x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.301, Ratio=2.51x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.288, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.301, Ratio=2.35x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.298, Ratio=2.35x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.300, Ratio=2.43x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.292, Ratio=2.33x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.298, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.292, Ratio=2.44x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.274, Ratio=2.25x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.297, Ratio=2.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.281, Ratio=2.28x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.304, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.281, Ratio=2.26x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.297, Ratio=2.40x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.302, Ratio=2.44x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.274, Ratio=2.26x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.295, Ratio=2.38x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.303, Ratio=2.53x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.291, Ratio=2.34x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.295, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.282, Ratio=2.34x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.289, Ratio=2.33x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.291, Ratio=2.45x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.295, Ratio=2.47x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.285, Ratio=2.29x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.297, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.294, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.278, Ratio=2.35x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.288, Ratio=2.34x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.285, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.50x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.306, Ratio=2.50x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.43x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.302, Ratio=2.44x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.289, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.301, Ratio=2.44x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.290, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.302, Ratio=2.43x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.305, Ratio=2.43x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.302, Ratio=2.43x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.297, Ratio=2.45x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.293, Ratio=2.37x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.291, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.290, Ratio=2.33x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.275, Ratio=2.26x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.277, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.291, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.291, Ratio=2.41x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.279, Ratio=2.28x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.291, Ratio=2.38x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.298, Ratio=2.36x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.291, Ratio=2.39x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.284, Ratio=2.33x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.290, Ratio=2.37x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.287, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.282, Ratio=2.33x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.287, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.42x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.273, Ratio=2.33x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.274, Ratio=2.32x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.303, Ratio=2.44x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.289, Ratio=2.39x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.294, Ratio=2.45x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.286, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.302, Ratio=2.45x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.294, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.292, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.298, Ratio=2.44x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.295, Ratio=2.39x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.288, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.283, Ratio=2.26x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.299, Ratio=2.40x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.292, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.298, Ratio=2.48x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.306, Ratio=2.50x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.294, Ratio=2.40x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.290, Ratio=2.36x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.275, Ratio=2.29x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.299, Ratio=2.43x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.294, Ratio=2.39x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.33x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.305, Ratio=2.55x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.281, Ratio=2.32x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.305, Ratio=2.55x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.281, Ratio=2.45x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.274, Ratio=2.35x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.290, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.288, Ratio=2.31x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.49x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.288, Ratio=2.32x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.295, Ratio=2.41x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.294, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.287, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.285, Ratio=2.37x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.279, Ratio=2.30x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.298, Ratio=2.41x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.283, Ratio=2.34x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.294, Ratio=2.44x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.300, Ratio=2.44x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.285, Ratio=2.29x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.277, Ratio=2.30x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.290, Ratio=2.48x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.284, Ratio=2.31x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.284, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.293, Ratio=2.36x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.286, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.302, Ratio=2.52x, Gap=-2.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.304, Ratio=2.48x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.288, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.305, Ratio=2.48x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.281, Ratio=2.38x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.293, Ratio=2.32x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.280, Ratio=2.26x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.283, Ratio=2.33x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.294, Ratio=2.41x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.296, Ratio=2.40x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.290, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.41x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.290, Ratio=2.39x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.296, Ratio=2.50x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.279, Ratio=2.24x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.277, Ratio=2.26x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.302, Ratio=2.43x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.285, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.297, Ratio=2.42x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.284, Ratio=2.28x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.290, Ratio=2.35x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.296, Ratio=2.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.292, Ratio=2.40x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.288, Ratio=2.37x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.283, Ratio=2.31x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.303, Ratio=2.44x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.301, Ratio=2.45x, Gap=-2.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.297, Ratio=2.44x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.297, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.290, Ratio=2.41x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.291, Ratio=2.44x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.274, Ratio=2.21x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.301, Ratio=2.50x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.295, Ratio=2.45x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.299, Ratio=2.51x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.293, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.288, Ratio=2.37x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.288, Ratio=2.33x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.294, Ratio=2.42x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.289, Ratio=2.30x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.289, Ratio=2.42x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.294, Ratio=2.45x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.296, Ratio=2.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.302, Ratio=2.43x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.308, Ratio=2.50x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.301, Ratio=2.49x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.291, Ratio=2.32x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.288, Ratio=2.32x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.297, Ratio=2.41x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.287, Ratio=2.39x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.287, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.275, Ratio=2.27x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.284, Ratio=2.32x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.308, Ratio=2.45x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.307, Ratio=2.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.281, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.300, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.300, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.291, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.291, Ratio=2.34x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.312, Ratio=2.46x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.273, Ratio=2.38x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.292, Ratio=2.41x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.277, Ratio=2.30x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.291, Ratio=2.39x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.298, Ratio=2.41x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.310, Ratio=2.53x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.286, Ratio=2.36x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.290, Ratio=2.30x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.288, Ratio=2.41x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.294, Ratio=2.43x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.54x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.291, Ratio=2.43x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.43x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.287, Ratio=2.41x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.294, Ratio=2.39x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.300, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.289, Ratio=2.39x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.292, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.289, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.290, Ratio=2.41x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.284, Ratio=2.35x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.274, Ratio=2.29x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.286, Ratio=2.35x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.300, Ratio=2.45x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.280, Ratio=2.29x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.301, Ratio=2.43x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.283, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.296, Ratio=2.38x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.276, Ratio=2.28x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.297, Ratio=2.51x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.282, Ratio=2.32x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.285, Ratio=2.35x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.297, Ratio=2.32x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.308, Ratio=2.51x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.284, Ratio=2.29x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.295, Ratio=2.35x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.294, Ratio=2.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.292, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.293, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.286, Ratio=2.30x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.297, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.281, Ratio=2.36x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.305, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.288, Ratio=2.43x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.289, Ratio=2.30x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.291, Ratio=2.42x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.312, Ratio=2.50x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.284, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.289, Ratio=2.30x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.291, Ratio=2.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.300, Ratio=2.44x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.276, Ratio=2.27x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.307, Ratio=2.49x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.280, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.300, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.287, Ratio=2.34x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.307, Ratio=2.46x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.306, Ratio=2.46x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.294, Ratio=2.36x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.285, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.288, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.286, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.297, Ratio=2.42x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.280, Ratio=2.30x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.298, Ratio=2.46x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.288, Ratio=2.35x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.290, Ratio=2.40x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.296, Ratio=2.45x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.297, Ratio=2.42x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.294, Ratio=2.39x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.40x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.299, Ratio=2.46x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.291, Ratio=2.42x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.301, Ratio=2.46x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.299, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.289, Ratio=2.34x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.41x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.284, Ratio=2.33x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.297, Ratio=2.35x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.314, Ratio=2.51x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.310, Ratio=2.50x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.279, Ratio=2.31x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.292, Ratio=2.43x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.290, Ratio=2.41x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.285, Ratio=2.31x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.303, Ratio=2.50x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.290, Ratio=2.34x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.286, Ratio=2.36x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.295, Ratio=2.40x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.292, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.309, Ratio=2.48x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.299, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.282, Ratio=2.35x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.283, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.314, Ratio=2.50x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.293, Ratio=2.37x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.298, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.52x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.294, Ratio=2.39x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.297, Ratio=2.47x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.287, Ratio=2.45x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.297, Ratio=2.48x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.304, Ratio=2.52x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.296, Ratio=2.48x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.278, Ratio=2.28x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.293, Ratio=2.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.295, Ratio=2.43x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.292, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.292, Ratio=2.36x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.286, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.288, Ratio=2.30x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.302, Ratio=2.44x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.301, Ratio=2.48x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.302, Ratio=2.48x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.298, Ratio=2.35x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.276, Ratio=2.30x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.307, Ratio=2.44x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.280, Ratio=2.34x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.303, Ratio=2.48x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.293, Ratio=2.33x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.302, Ratio=2.43x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.294, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.301, Ratio=2.40x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.300, Ratio=2.51x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.296, Ratio=2.38x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.289, Ratio=2.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.300, Ratio=2.42x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.290, Ratio=2.35x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.296, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.289, Ratio=2.36x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.299, Ratio=2.49x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.286, Ratio=2.36x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.297, Ratio=2.33x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.295, Ratio=2.42x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.295, Ratio=2.36x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.299, Ratio=2.39x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.287, Ratio=2.37x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.313, Ratio=2.58x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.307, Ratio=2.47x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.300, Ratio=2.36x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.292, Ratio=2.33x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.273, Ratio=2.28x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.290, Ratio=2.42x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.287, Ratio=2.32x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.295, Ratio=2.32x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.301, Ratio=2.46x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.303, Ratio=2.48x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.297, Ratio=2.37x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.283, Ratio=2.36x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.302, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.292, Ratio=2.31x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.292, Ratio=2.35x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.280, Ratio=2.36x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.284, Ratio=2.40x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.280, Ratio=2.29x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.294, Ratio=2.41x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.280, Ratio=2.36x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.281, Ratio=2.29x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.274, Ratio=2.30x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.41x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.285, Ratio=2.37x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.295, Ratio=2.40x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.290, Ratio=2.37x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.304, Ratio=2.42x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.299, Ratio=2.43x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.304, Ratio=2.48x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.290, Ratio=2.34x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.306, Ratio=2.50x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.297, Ratio=2.39x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.308, Ratio=2.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.297, Ratio=2.37x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.293, Ratio=2.38x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.305, Ratio=2.46x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.291, Ratio=2.42x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.303, Ratio=2.45x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.295, Ratio=2.37x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.295, Ratio=2.41x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.308, Ratio=2.55x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.303, Ratio=2.48x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.283, Ratio=2.29x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.298, Ratio=2.42x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.289, Ratio=2.35x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.281, Ratio=2.24x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.300, Ratio=2.39x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.292, Ratio=2.31x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.305, Ratio=2.46x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.275, Ratio=2.36x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.291, Ratio=2.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.287, Ratio=2.32x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.280, Ratio=2.34x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.284, Ratio=2.37x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.293, Ratio=2.41x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.300, Ratio=2.45x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.289, Ratio=2.32x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.296, Ratio=2.42x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.288, Ratio=2.34x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.301, Ratio=2.40x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.289, Ratio=2.30x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.281, Ratio=2.29x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.297, Ratio=2.46x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.289, Ratio=2.39x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.34x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.299, Ratio=2.38x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.282, Ratio=2.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.305, Ratio=2.51x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.280, Ratio=2.34x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.278, Ratio=2.34x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.292, Ratio=2.44x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.301, Ratio=2.47x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.296, Ratio=2.38x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.302, Ratio=2.44x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.278, Ratio=2.32x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.291, Ratio=2.33x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.306, Ratio=2.42x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.296, Ratio=2.39x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.292, Ratio=2.42x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.298, Ratio=2.40x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.292, Ratio=2.40x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.293, Ratio=2.39x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.303, Ratio=2.44x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.294, Ratio=2.38x, Gap=-2.425

============================================================
Epoch 9/20 completed in 28.5s
Train: Loss=1.3262 (C:1.3262, R:0.0000) Ratio=2.30x
Val:   Loss=1.3015 (C:1.3015, R:0.0000) Ratio=2.55x
‚úÖ New best model saved (Val Loss: 1.3015)
============================================================

üåç Updating global dataset at epoch 10
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.523 ¬± 0.688
    Neg distances: 1.307 ¬± 0.857
    Separation ratio: 2.50x
    Gap: -2.608
    ‚úÖ Good global separation

Epoch 10 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.299, Ratio=2.40x, Gap=-2.609
Batch   0/537: Loss=1.2968 (C:1.2968, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.318, Ratio=2.45x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.59x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.324, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.319, Ratio=2.50x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.302, Ratio=2.37x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.297, Ratio=2.33x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.307, Ratio=2.47x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.312, Ratio=2.45x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.295, Ratio=2.36x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.304, Ratio=2.34x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.316, Ratio=2.44x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.310, Ratio=2.38x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.300, Ratio=2.36x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.307, Ratio=2.38x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.292, Ratio=2.36x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.295, Ratio=2.36x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.309, Ratio=2.40x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.315, Ratio=2.48x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.306, Ratio=2.39x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.319, Ratio=2.41x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.298, Ratio=2.36x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.323, Ratio=2.46x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.302, Ratio=2.31x, Gap=-2.669
Batch  25/537: Loss=1.3198 (C:1.3198, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.305, Ratio=2.41x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.326, Ratio=2.54x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.45x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.300, Ratio=2.43x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.302, Ratio=2.39x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.307, Ratio=2.42x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.327, Ratio=2.50x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.285, Ratio=2.33x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.314, Ratio=2.45x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.313, Ratio=2.52x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.306, Ratio=2.41x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.302, Ratio=2.40x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.312, Ratio=2.44x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.308, Ratio=2.35x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.44x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.324, Ratio=2.51x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.311, Ratio=2.53x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.314, Ratio=2.55x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.320, Ratio=2.57x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.306, Ratio=2.46x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.283, Ratio=2.28x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.317, Ratio=2.43x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-2.902
Batch  50/537: Loss=1.2629 (C:1.2629, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.319, Ratio=2.54x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.305, Ratio=2.38x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.327, Ratio=2.55x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.299, Ratio=2.30x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.315, Ratio=2.40x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.321, Ratio=2.37x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.308, Ratio=2.37x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.317, Ratio=2.42x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.308, Ratio=2.43x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.310, Ratio=2.43x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.311, Ratio=2.47x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.330, Ratio=2.60x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.316, Ratio=2.56x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.47x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.291, Ratio=2.30x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.317, Ratio=2.42x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.330, Ratio=2.60x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.319, Ratio=2.44x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.308, Ratio=2.43x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.300, Ratio=2.35x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.296, Ratio=2.39x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.327, Ratio=2.55x, Gap=-2.696
Batch  75/537: Loss=1.2570 (C:1.2570, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.323, Ratio=2.46x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.309, Ratio=2.43x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.304, Ratio=2.40x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.310, Ratio=2.50x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.304, Ratio=2.43x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.306, Ratio=2.38x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.315, Ratio=2.46x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.327, Ratio=2.51x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.328, Ratio=2.56x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.313, Ratio=2.43x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.301, Ratio=2.39x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.328, Ratio=2.53x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.304, Ratio=2.39x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.320, Ratio=2.50x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.302, Ratio=2.33x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.314, Ratio=2.51x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.304, Ratio=2.44x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.308, Ratio=2.42x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.301, Ratio=2.38x, Gap=-2.632
Batch 100/537: Loss=1.3026 (C:1.3026, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.313, Ratio=2.48x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.334, Ratio=2.58x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.316, Ratio=2.49x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.301, Ratio=2.35x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.317, Ratio=2.39x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.313, Ratio=2.44x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.315, Ratio=2.43x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.318, Ratio=2.51x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.318, Ratio=2.46x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.313, Ratio=2.50x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.302, Ratio=2.36x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.324, Ratio=2.55x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.309, Ratio=2.39x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.319, Ratio=2.42x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.317, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.302, Ratio=2.39x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.63x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.303, Ratio=2.38x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.306, Ratio=2.40x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.303, Ratio=2.37x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.317, Ratio=2.44x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.318, Ratio=2.45x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.307, Ratio=2.44x, Gap=-2.699
Batch 125/537: Loss=1.2869 (C:1.2869, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.314, Ratio=2.45x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.321, Ratio=2.45x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.306, Ratio=2.41x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.303, Ratio=2.38x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.302, Ratio=2.41x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.302, Ratio=2.38x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.320, Ratio=2.55x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.309, Ratio=2.31x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.318, Ratio=2.45x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.310, Ratio=2.47x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.321, Ratio=2.41x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.321, Ratio=2.50x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.307, Ratio=2.42x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.307, Ratio=2.39x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.306, Ratio=2.42x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.313, Ratio=2.44x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.316, Ratio=2.46x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.312, Ratio=2.50x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.299, Ratio=2.41x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.317, Ratio=2.49x, Gap=-2.811
Batch 150/537: Loss=1.2714 (C:1.2714, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.304, Ratio=2.39x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.308, Ratio=2.43x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.307, Ratio=2.39x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.305, Ratio=2.41x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.54x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.314, Ratio=2.46x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.306, Ratio=2.41x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.296, Ratio=2.35x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.300, Ratio=2.40x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.303, Ratio=2.44x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.308, Ratio=2.36x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.294, Ratio=2.34x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.305, Ratio=2.36x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.297, Ratio=2.44x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.306, Ratio=2.35x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.332, Ratio=2.55x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.305, Ratio=2.38x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.324, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.304, Ratio=2.30x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.326, Ratio=2.52x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.306, Ratio=2.39x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.313, Ratio=2.48x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.312, Ratio=2.42x, Gap=-2.741
Batch 175/537: Loss=1.2909 (C:1.2909, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.303, Ratio=2.37x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.295, Ratio=2.34x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.319, Ratio=2.49x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.303, Ratio=2.39x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.300, Ratio=2.28x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.315, Ratio=2.44x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.302, Ratio=2.33x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.338, Ratio=2.58x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.315, Ratio=2.45x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.317, Ratio=2.47x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.313, Ratio=2.45x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.313, Ratio=2.51x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.304, Ratio=2.41x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.46x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.299, Ratio=2.36x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.318, Ratio=2.52x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.307, Ratio=2.36x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.307, Ratio=2.38x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.304, Ratio=2.48x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.296, Ratio=2.37x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.684
Batch 200/537: Loss=1.2872 (C:1.2872, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.292, Ratio=2.36x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.318, Ratio=2.41x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.311, Ratio=2.44x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.310, Ratio=2.42x, Gap=-3.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.309, Ratio=2.37x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.326, Ratio=2.54x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.311, Ratio=2.45x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.310, Ratio=2.51x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.304, Ratio=2.39x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.306, Ratio=2.45x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.301, Ratio=2.43x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.310, Ratio=2.45x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.300, Ratio=2.36x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.320, Ratio=2.54x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.305, Ratio=2.40x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.303, Ratio=2.47x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.310, Ratio=2.43x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.46x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.309, Ratio=2.38x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.317, Ratio=2.51x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.320, Ratio=2.50x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.991
Batch 225/537: Loss=1.3116 (C:1.3116, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.301, Ratio=2.38x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.326, Ratio=2.54x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.314, Ratio=2.46x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.309, Ratio=2.37x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.303, Ratio=2.36x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.298, Ratio=2.33x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.308, Ratio=2.43x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.308, Ratio=2.41x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.313, Ratio=2.49x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.309, Ratio=2.33x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.301, Ratio=2.33x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.307, Ratio=2.43x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.310, Ratio=2.40x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.300, Ratio=2.38x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.309, Ratio=2.42x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.293, Ratio=2.30x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.299, Ratio=2.34x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.54x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.319, Ratio=2.47x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.310, Ratio=2.43x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.306, Ratio=2.39x, Gap=-2.691
Batch 250/537: Loss=1.2994 (C:1.2994, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.301, Ratio=2.38x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.304, Ratio=2.37x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.306, Ratio=2.45x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.324, Ratio=2.50x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.305, Ratio=2.39x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.280, Ratio=2.25x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.317, Ratio=2.44x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.308, Ratio=2.47x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.294, Ratio=2.34x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.300, Ratio=2.38x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.316, Ratio=2.37x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.299, Ratio=2.37x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.288, Ratio=2.26x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.311, Ratio=2.44x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.306, Ratio=2.44x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.312, Ratio=2.44x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.321, Ratio=2.49x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.290, Ratio=2.29x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.316, Ratio=2.46x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.314, Ratio=2.42x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.308, Ratio=2.46x, Gap=-2.606
Batch 275/537: Loss=1.2799 (C:1.2799, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.305, Ratio=2.43x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.310, Ratio=2.42x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.294, Ratio=2.33x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.309, Ratio=2.40x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.312, Ratio=2.43x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.313, Ratio=2.44x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.313, Ratio=2.46x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.311, Ratio=2.44x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.310, Ratio=2.46x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.313, Ratio=2.41x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.310, Ratio=2.49x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.306, Ratio=2.47x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.320, Ratio=2.42x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.305, Ratio=2.41x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.305, Ratio=2.44x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.328, Ratio=2.52x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.302, Ratio=2.42x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.294, Ratio=2.35x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.313, Ratio=2.46x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.308, Ratio=2.46x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.302, Ratio=2.37x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.303, Ratio=2.38x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.314, Ratio=2.52x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.306, Ratio=2.34x, Gap=-2.720
Batch 300/537: Loss=1.3123 (C:1.3123, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.309, Ratio=2.43x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.307, Ratio=2.34x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.323, Ratio=2.53x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.305, Ratio=2.48x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.302, Ratio=2.41x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.309, Ratio=2.46x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.310, Ratio=2.44x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.313, Ratio=2.51x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.314, Ratio=2.44x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.311, Ratio=2.40x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.315, Ratio=2.41x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.309, Ratio=2.43x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.326, Ratio=2.52x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.316, Ratio=2.45x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.289, Ratio=2.35x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.307, Ratio=2.37x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.306, Ratio=2.42x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.306, Ratio=2.45x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.288, Ratio=2.25x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.293, Ratio=2.46x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.309, Ratio=2.41x, Gap=-2.696
Batch 325/537: Loss=1.2939 (C:1.2939, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.304, Ratio=2.33x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.317, Ratio=2.51x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.312, Ratio=2.45x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.310, Ratio=2.44x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.310, Ratio=2.48x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.301, Ratio=2.40x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.304, Ratio=2.40x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.312, Ratio=2.48x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.325, Ratio=2.53x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.309, Ratio=2.49x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.310, Ratio=2.47x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.320, Ratio=2.38x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.296, Ratio=2.37x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.332, Ratio=2.49x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.312, Ratio=2.41x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.302, Ratio=2.45x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.313, Ratio=2.52x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.302, Ratio=2.44x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.315, Ratio=2.51x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.314, Ratio=2.44x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.306, Ratio=2.50x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.306, Ratio=2.45x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.686
Batch 350/537: Loss=1.2579 (C:1.2579, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.305, Ratio=2.40x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.290, Ratio=2.32x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.326, Ratio=2.50x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.310, Ratio=2.44x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.305, Ratio=2.36x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.330, Ratio=2.48x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.305, Ratio=2.40x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.311, Ratio=2.41x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.331, Ratio=2.55x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.46x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.297, Ratio=2.32x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.311, Ratio=2.45x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.315, Ratio=2.49x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.308, Ratio=2.49x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.307, Ratio=2.38x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.309, Ratio=2.47x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.304, Ratio=2.36x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.305, Ratio=2.42x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.314, Ratio=2.37x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.311, Ratio=2.46x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.305, Ratio=2.38x, Gap=-2.763
Batch 375/537: Loss=1.3014 (C:1.3014, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.300, Ratio=2.43x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.312, Ratio=2.43x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.298, Ratio=2.40x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.310, Ratio=2.44x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.43x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.50x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.306, Ratio=2.37x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.299, Ratio=2.43x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.305, Ratio=2.45x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.308, Ratio=2.41x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.305, Ratio=2.44x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.314, Ratio=2.36x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.321, Ratio=2.49x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.325, Ratio=2.49x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.319, Ratio=2.50x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.308, Ratio=2.34x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.302, Ratio=2.35x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.313, Ratio=2.45x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.300, Ratio=2.36x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.291, Ratio=2.25x, Gap=-2.673
Batch 400/537: Loss=1.3387 (C:1.3387, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.329, Ratio=2.59x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.315, Ratio=2.40x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.305, Ratio=2.32x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.316, Ratio=2.44x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.300, Ratio=2.38x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.309, Ratio=2.42x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.313, Ratio=2.32x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.320, Ratio=2.43x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.303, Ratio=2.34x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.321, Ratio=2.49x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.314, Ratio=2.43x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.308, Ratio=2.46x, Gap=-2.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.306, Ratio=2.44x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.318, Ratio=2.46x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.306, Ratio=2.37x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.311, Ratio=2.40x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.320, Ratio=2.46x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.311, Ratio=2.41x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.310, Ratio=2.39x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.313, Ratio=2.42x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.302, Ratio=2.34x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.311, Ratio=2.44x, Gap=-2.677
Batch 425/537: Loss=1.2856 (C:1.2856, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.300, Ratio=2.36x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.311, Ratio=2.48x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.300, Ratio=2.35x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.290, Ratio=2.33x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.293, Ratio=2.36x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.303, Ratio=2.37x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.310, Ratio=2.46x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.303, Ratio=2.43x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.309, Ratio=2.44x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.294, Ratio=2.36x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.302, Ratio=2.34x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.304, Ratio=2.33x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.319, Ratio=2.54x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.313, Ratio=2.45x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.310, Ratio=2.37x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.317, Ratio=2.40x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.308, Ratio=2.37x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.311, Ratio=2.48x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.313, Ratio=2.50x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.311, Ratio=2.33x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.302, Ratio=2.41x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.305, Ratio=2.34x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.301, Ratio=2.38x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.317, Ratio=2.48x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.327, Ratio=2.51x, Gap=-2.877
Batch 450/537: Loss=1.2654 (C:1.2654, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.314, Ratio=2.42x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.309, Ratio=2.43x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.297, Ratio=2.36x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.311, Ratio=2.45x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.313, Ratio=2.38x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.318, Ratio=2.55x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.321, Ratio=2.45x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.329, Ratio=2.48x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.44x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.315, Ratio=2.46x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.292, Ratio=2.33x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.301, Ratio=2.35x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.60x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.306, Ratio=2.46x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.305, Ratio=2.43x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.314, Ratio=2.44x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.326, Ratio=2.47x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.303, Ratio=2.33x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.295, Ratio=2.28x, Gap=-2.748
Batch 475/537: Loss=1.3318 (C:1.3318, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.297, Ratio=2.33x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.332, Ratio=2.57x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.312, Ratio=2.38x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.309, Ratio=2.47x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.316, Ratio=2.43x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.311, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.302, Ratio=2.42x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.294, Ratio=2.38x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.47x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.302, Ratio=2.37x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.302, Ratio=2.40x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.323, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.307, Ratio=2.41x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.310, Ratio=2.41x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.322, Ratio=2.43x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.328, Ratio=2.58x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.327, Ratio=2.50x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.308, Ratio=2.48x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.301, Ratio=2.40x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.321, Ratio=2.50x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.297, Ratio=2.38x, Gap=-2.920
Batch 500/537: Loss=1.3054 (C:1.3054, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.318, Ratio=2.41x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.320, Ratio=2.45x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.296, Ratio=2.29x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.301, Ratio=2.40x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.320, Ratio=2.49x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.316, Ratio=2.48x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.316, Ratio=2.57x, Gap=-2.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.304, Ratio=2.37x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.306, Ratio=2.36x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.312, Ratio=2.42x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.330, Ratio=2.53x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.306, Ratio=2.37x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.312, Ratio=2.43x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.319, Ratio=2.49x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.305, Ratio=2.44x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.328, Ratio=2.52x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.314, Ratio=2.43x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.322, Ratio=2.57x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.324, Ratio=2.57x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.319, Ratio=2.46x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.304, Ratio=2.36x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.47x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.309, Ratio=2.38x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.320, Ratio=2.47x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.301, Ratio=2.32x, Gap=-2.824
Batch 525/537: Loss=1.3183 (C:1.3183, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.284, Ratio=2.30x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.297, Ratio=2.36x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.308, Ratio=2.40x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.323, Ratio=2.51x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.303, Ratio=2.38x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.310, Ratio=2.43x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.308, Ratio=2.41x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.317, Ratio=2.43x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.329, Ratio=2.54x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.295, Ratio=2.37x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.315, Ratio=2.60x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.321, Ratio=2.57x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.323, Ratio=2.62x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.309, Ratio=2.53x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.312, Ratio=2.57x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.319, Ratio=2.62x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.311, Ratio=2.56x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.327, Ratio=2.58x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.320, Ratio=2.55x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.320, Ratio=2.49x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.321, Ratio=2.53x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.59x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.316, Ratio=2.44x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.322, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.333, Ratio=2.68x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.340, Ratio=2.77x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.47x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.328, Ratio=2.71x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.305, Ratio=2.44x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.315, Ratio=2.55x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.316, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.322, Ratio=2.54x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.296, Ratio=2.32x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.52x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.308, Ratio=2.40x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.330, Ratio=2.60x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.327, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.323, Ratio=2.60x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.321, Ratio=2.55x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.312, Ratio=2.56x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.307, Ratio=2.47x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.303, Ratio=2.49x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.320, Ratio=2.51x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.311, Ratio=2.46x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.305, Ratio=2.41x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.62x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.53x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.312, Ratio=2.49x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.299, Ratio=2.46x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.318, Ratio=2.50x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.312, Ratio=2.43x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.307, Ratio=2.48x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.323, Ratio=2.59x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.307, Ratio=2.51x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.313, Ratio=2.48x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.310, Ratio=2.53x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.312, Ratio=2.49x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.309, Ratio=2.50x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.64x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.307, Ratio=2.49x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.318, Ratio=2.68x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.309, Ratio=2.46x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.325, Ratio=2.57x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.48x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.300, Ratio=2.40x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.329, Ratio=2.63x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.315, Ratio=2.55x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.300, Ratio=2.41x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.312, Ratio=2.45x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.315, Ratio=2.48x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.313, Ratio=2.58x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.317, Ratio=2.63x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.323, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.323, Ratio=2.56x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.316, Ratio=2.53x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.334, Ratio=2.63x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.307, Ratio=2.43x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.311, Ratio=2.49x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.322, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.307, Ratio=2.44x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.314, Ratio=2.47x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.313, Ratio=2.58x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.314, Ratio=2.52x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.315, Ratio=2.50x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.305, Ratio=2.49x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.304, Ratio=2.48x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.311, Ratio=2.54x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.332, Ratio=2.62x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.321, Ratio=2.53x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.316, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.317, Ratio=2.46x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.335, Ratio=2.70x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.313, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.301, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.70x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.312, Ratio=2.47x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.319, Ratio=2.53x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.301, Ratio=2.49x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.327, Ratio=2.68x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.320, Ratio=2.55x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.315, Ratio=2.53x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.302, Ratio=2.49x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.311, Ratio=2.50x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.319, Ratio=2.57x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.310, Ratio=2.49x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.307, Ratio=2.50x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.312, Ratio=2.54x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.59x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.308, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.317, Ratio=2.48x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.299, Ratio=2.38x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.312, Ratio=2.47x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.334, Ratio=2.74x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.323, Ratio=2.57x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.322, Ratio=2.52x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.332, Ratio=2.67x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.321, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.59x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.313, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.318, Ratio=2.55x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.316, Ratio=2.55x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.312, Ratio=2.50x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.305, Ratio=2.43x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.323, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.319, Ratio=2.63x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.310, Ratio=2.56x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.312, Ratio=2.44x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.305, Ratio=2.51x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.323, Ratio=2.51x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.302, Ratio=2.43x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.309, Ratio=2.45x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.325, Ratio=2.69x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.328, Ratio=2.56x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.311, Ratio=2.49x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.317, Ratio=2.57x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.304, Ratio=2.44x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.310, Ratio=2.47x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.318, Ratio=2.49x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.311, Ratio=2.50x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.306, Ratio=2.46x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.328, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.307, Ratio=2.42x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.316, Ratio=2.43x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.318, Ratio=2.53x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.325, Ratio=2.54x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.47x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.322, Ratio=2.65x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.46x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.55x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.315, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.329, Ratio=2.59x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.319, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.325, Ratio=2.54x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.320, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.313, Ratio=2.45x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.340, Ratio=2.68x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.315, Ratio=2.50x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.321, Ratio=2.58x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.329, Ratio=2.62x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.312, Ratio=2.51x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.316, Ratio=2.50x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.307, Ratio=2.47x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.314, Ratio=2.50x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.308, Ratio=2.48x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.311, Ratio=2.48x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.316, Ratio=2.53x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.313, Ratio=2.50x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.51x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.318, Ratio=2.51x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.309, Ratio=2.46x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.313, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.326, Ratio=2.58x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.65x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.325, Ratio=2.56x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.316, Ratio=2.56x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.56x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.308, Ratio=2.49x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.50x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.322, Ratio=2.54x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.310, Ratio=2.43x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.320, Ratio=2.48x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.329, Ratio=2.70x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.304, Ratio=2.42x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.314, Ratio=2.53x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.310, Ratio=2.45x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.314, Ratio=2.57x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.310, Ratio=2.47x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.321, Ratio=2.61x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.326, Ratio=2.69x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.319, Ratio=2.47x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.306, Ratio=2.43x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.57x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.323, Ratio=2.58x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.323, Ratio=2.64x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.330, Ratio=2.59x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.66x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.307, Ratio=2.46x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.336, Ratio=2.78x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.315, Ratio=2.53x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.324, Ratio=2.50x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.317, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.319, Ratio=2.47x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.309, Ratio=2.52x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.312, Ratio=2.44x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.320, Ratio=2.53x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.316, Ratio=2.52x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.322, Ratio=2.65x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.315, Ratio=2.53x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.313, Ratio=2.50x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.300, Ratio=2.48x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.321, Ratio=2.54x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.317, Ratio=2.62x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.320, Ratio=2.60x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.323, Ratio=2.55x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.320, Ratio=2.55x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.319, Ratio=2.54x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.301, Ratio=2.41x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.331, Ratio=2.66x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.311, Ratio=2.47x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.323, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.334, Ratio=2.64x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.328, Ratio=2.56x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.321, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.306, Ratio=2.42x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.316, Ratio=2.48x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.314, Ratio=2.48x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.314, Ratio=2.57x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.316, Ratio=2.64x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.316, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.302, Ratio=2.42x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.310, Ratio=2.46x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.308, Ratio=2.44x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.316, Ratio=2.54x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.314, Ratio=2.51x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.298, Ratio=2.43x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.303, Ratio=2.44x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.315, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.313, Ratio=2.54x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.57x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.314, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.313, Ratio=2.46x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.304, Ratio=2.45x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.318, Ratio=2.63x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.50x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.59x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.316, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.297, Ratio=2.35x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.314, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.318, Ratio=2.52x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.324, Ratio=2.54x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.307, Ratio=2.45x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.317, Ratio=2.61x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.330, Ratio=2.66x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.321, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.315, Ratio=2.53x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.322, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.302, Ratio=2.39x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.309, Ratio=2.38x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.306, Ratio=2.43x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.321, Ratio=2.55x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.309, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.316, Ratio=2.53x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.320, Ratio=2.51x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.333, Ratio=2.58x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.328, Ratio=2.59x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.316, Ratio=2.49x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.69x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.318, Ratio=2.51x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.319, Ratio=2.54x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.314, Ratio=2.45x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.322, Ratio=2.58x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.317, Ratio=2.60x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.318, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.307, Ratio=2.40x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.296, Ratio=2.38x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.320, Ratio=2.56x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.309, Ratio=2.48x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.317, Ratio=2.56x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.323, Ratio=2.57x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.320, Ratio=2.62x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.326, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.313, Ratio=2.48x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.61x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.308, Ratio=2.48x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.319, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.299, Ratio=2.41x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.316, Ratio=2.61x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.326, Ratio=2.59x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.315, Ratio=2.47x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.303, Ratio=2.46x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.309, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.312, Ratio=2.51x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.326, Ratio=2.57x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.293, Ratio=2.39x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.328, Ratio=2.54x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.303, Ratio=2.41x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.318, Ratio=2.52x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.50x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.325, Ratio=2.63x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.47x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.302, Ratio=2.40x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.318, Ratio=2.54x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.303, Ratio=2.48x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.307, Ratio=2.49x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.314, Ratio=2.50x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.329, Ratio=2.62x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.47x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.324, Ratio=2.54x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.304, Ratio=2.39x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.310, Ratio=2.41x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.319, Ratio=2.54x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.315, Ratio=2.54x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.320, Ratio=2.57x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.320, Ratio=2.49x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.52x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.45x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.326, Ratio=2.55x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.47x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.319, Ratio=2.58x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.317, Ratio=2.50x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.46x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.323, Ratio=2.64x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.308, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.322, Ratio=2.57x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.317, Ratio=2.55x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.309, Ratio=2.49x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.304, Ratio=2.44x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.310, Ratio=2.53x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.321, Ratio=2.52x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.317, Ratio=2.58x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.324, Ratio=2.65x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.320, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.67x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.305, Ratio=2.44x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.55x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.331, Ratio=2.69x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.309, Ratio=2.49x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.311, Ratio=2.49x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.310, Ratio=2.51x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.312, Ratio=2.47x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.319, Ratio=2.49x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.317, Ratio=2.56x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.326, Ratio=2.56x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.327, Ratio=2.57x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.301, Ratio=2.48x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.316, Ratio=2.50x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.314, Ratio=2.45x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.311, Ratio=2.44x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.312, Ratio=2.42x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.306, Ratio=2.45x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.343, Ratio=2.79x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.306, Ratio=2.43x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.308, Ratio=2.56x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.298, Ratio=2.45x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.318, Ratio=2.51x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.322, Ratio=2.62x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.59x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.307, Ratio=2.48x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.317, Ratio=2.54x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.321, Ratio=2.57x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.304, Ratio=2.46x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.314, Ratio=2.61x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.314, Ratio=2.53x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.312, Ratio=2.55x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.300, Ratio=2.42x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.319, Ratio=2.54x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.317, Ratio=2.53x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.319, Ratio=2.54x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.317, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.319, Ratio=2.56x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.314, Ratio=2.59x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.320, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.303, Ratio=2.40x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.66x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.309, Ratio=2.47x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.63x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.317, Ratio=2.51x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.328, Ratio=2.68x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.326, Ratio=2.59x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.312, Ratio=2.53x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.53x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.317, Ratio=2.49x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.322, Ratio=2.61x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.324, Ratio=2.58x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.60x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.55x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.332, Ratio=2.68x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.316, Ratio=2.48x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.315, Ratio=2.56x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.327, Ratio=2.57x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.309, Ratio=2.51x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.317, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.304, Ratio=2.51x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.318, Ratio=2.55x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.46x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.319, Ratio=2.54x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.313, Ratio=2.55x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.315, Ratio=2.55x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.58x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.328, Ratio=2.64x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.315, Ratio=2.53x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.312, Ratio=2.52x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.61x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.308, Ratio=2.48x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.308, Ratio=2.45x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.322, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.329, Ratio=2.58x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.329, Ratio=2.69x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.336, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.309, Ratio=2.55x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.312, Ratio=2.53x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.340, Ratio=2.76x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.329, Ratio=2.61x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.314, Ratio=2.55x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.308, Ratio=2.49x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.62x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.318, Ratio=2.55x, Gap=-2.410

============================================================
Epoch 10/20 completed in 33.9s
Train: Loss=1.2860 (C:1.2860, R:0.0000) Ratio=2.33x
Val:   Loss=1.2617 (C:1.2617, R:0.0000) Ratio=2.62x
‚úÖ New best model saved (Val Loss: 1.2617)
Checkpoint saved at epoch 10
============================================================

Epoch 11 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.824
Batch   0/537: Loss=1.2840 (C:1.2840, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.317, Ratio=2.43x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.327, Ratio=2.44x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.308, Ratio=2.34x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.319, Ratio=2.44x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.322, Ratio=2.44x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.315, Ratio=2.45x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.313, Ratio=2.50x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.295, Ratio=2.40x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.296, Ratio=2.38x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.309, Ratio=2.42x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.314, Ratio=2.50x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.310, Ratio=2.48x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.327, Ratio=2.53x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.322, Ratio=2.49x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.325, Ratio=2.51x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.60x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.321, Ratio=2.47x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.318, Ratio=2.49x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.310, Ratio=2.42x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.304, Ratio=2.45x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.321, Ratio=2.50x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.315, Ratio=2.45x, Gap=-2.603
Batch  25/537: Loss=1.2802 (C:1.2802, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.306, Ratio=2.41x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.316, Ratio=2.55x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.322, Ratio=2.49x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.309, Ratio=2.42x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.310, Ratio=2.45x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.311, Ratio=2.47x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.311, Ratio=2.58x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.323, Ratio=2.55x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.324, Ratio=2.46x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.300, Ratio=2.33x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.319, Ratio=2.50x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.318, Ratio=2.44x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.325, Ratio=2.51x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.324, Ratio=2.47x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.328, Ratio=2.53x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.309, Ratio=2.40x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.311, Ratio=2.38x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.311, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.308, Ratio=2.39x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.315, Ratio=2.49x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.313, Ratio=2.44x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.329, Ratio=2.63x, Gap=-2.682
Batch  50/537: Loss=1.2361 (C:1.2361, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.307, Ratio=2.38x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.296, Ratio=2.37x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.318, Ratio=2.43x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.332, Ratio=2.57x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.301, Ratio=2.39x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.325, Ratio=2.48x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.317, Ratio=2.51x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.322, Ratio=2.50x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.333, Ratio=2.60x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.313, Ratio=2.45x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.308, Ratio=2.38x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.313, Ratio=2.46x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.325, Ratio=2.51x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.48x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.316, Ratio=2.43x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.305, Ratio=2.46x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.327, Ratio=2.57x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.317, Ratio=2.49x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.323, Ratio=2.51x, Gap=-2.615
Batch  75/537: Loss=1.2662 (C:1.2662, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.315, Ratio=2.50x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.46x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.313, Ratio=2.45x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.303, Ratio=2.44x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.290, Ratio=2.31x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.313, Ratio=2.44x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.325, Ratio=2.53x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.309, Ratio=2.42x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.316, Ratio=2.46x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.336, Ratio=2.48x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.327, Ratio=2.46x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.316, Ratio=2.45x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.318, Ratio=2.47x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.309, Ratio=2.41x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.304, Ratio=2.34x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.304, Ratio=2.46x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.297, Ratio=2.40x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.311, Ratio=2.48x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.324, Ratio=2.47x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.321, Ratio=2.50x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.314, Ratio=2.55x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.309, Ratio=2.39x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.321, Ratio=2.52x, Gap=-2.682
Batch 100/537: Loss=1.2652 (C:1.2652, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.313, Ratio=2.46x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.319, Ratio=2.48x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.319, Ratio=2.48x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.326, Ratio=2.55x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.318, Ratio=2.50x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.307, Ratio=2.36x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.296, Ratio=2.44x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.327, Ratio=2.61x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.317, Ratio=2.49x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.329, Ratio=2.50x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.308, Ratio=2.47x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.55x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.325, Ratio=2.47x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.309, Ratio=2.50x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.304, Ratio=2.39x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.332, Ratio=2.52x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.319, Ratio=2.48x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.324, Ratio=2.51x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.301, Ratio=2.39x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.300, Ratio=2.42x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.308, Ratio=2.34x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.311, Ratio=2.41x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.314, Ratio=2.45x, Gap=-2.724
Batch 125/537: Loss=1.2801 (C:1.2801, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.303, Ratio=2.37x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.337, Ratio=2.61x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.319, Ratio=2.43x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.314, Ratio=2.44x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.308, Ratio=2.44x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.314, Ratio=2.34x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.304, Ratio=2.41x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.44x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.286, Ratio=2.28x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.311, Ratio=2.50x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.298, Ratio=2.35x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.313, Ratio=2.43x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.312, Ratio=2.47x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.329, Ratio=2.60x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.322, Ratio=2.50x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.299, Ratio=2.32x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.47x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.317, Ratio=2.50x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.314, Ratio=2.39x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.323, Ratio=2.58x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.314, Ratio=2.41x, Gap=-2.829
Batch 150/537: Loss=1.2942 (C:1.2942, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.321, Ratio=2.48x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.321, Ratio=2.46x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.313, Ratio=2.34x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.308, Ratio=2.44x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.310, Ratio=2.50x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.306, Ratio=2.39x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.324, Ratio=2.53x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.314, Ratio=2.48x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.309, Ratio=2.43x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.315, Ratio=2.46x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.305, Ratio=2.36x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.305, Ratio=2.34x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.320, Ratio=2.48x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.315, Ratio=2.48x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.314, Ratio=2.47x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.304, Ratio=2.37x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.298, Ratio=2.37x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.307, Ratio=2.47x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.300, Ratio=2.43x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.325, Ratio=2.54x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.311, Ratio=2.45x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.307, Ratio=2.43x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.303, Ratio=2.38x, Gap=-2.697
Batch 175/537: Loss=1.3048 (C:1.3048, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.310, Ratio=2.37x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.327, Ratio=2.53x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.312, Ratio=2.43x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.292, Ratio=2.41x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.293, Ratio=2.35x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.299, Ratio=2.40x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.306, Ratio=2.35x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.319, Ratio=2.52x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.316, Ratio=2.49x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.314, Ratio=2.44x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.333, Ratio=2.56x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.309, Ratio=2.42x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.325, Ratio=2.50x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.59x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.304, Ratio=2.39x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.314, Ratio=2.50x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.314, Ratio=2.51x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.319, Ratio=2.55x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.323, Ratio=2.62x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.298, Ratio=2.38x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.313, Ratio=2.45x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.326, Ratio=2.47x, Gap=-2.733
Batch 200/537: Loss=1.2741 (C:1.2741, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.331, Ratio=2.59x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.333, Ratio=2.50x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.315, Ratio=2.44x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.321, Ratio=2.49x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.312, Ratio=2.40x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.309, Ratio=2.40x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.305, Ratio=2.31x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.322, Ratio=2.49x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.316, Ratio=2.44x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.312, Ratio=2.47x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.308, Ratio=2.52x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.306, Ratio=2.44x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.303, Ratio=2.46x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.315, Ratio=2.47x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.304, Ratio=2.41x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.319, Ratio=2.40x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.317, Ratio=2.50x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.291, Ratio=2.36x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.308, Ratio=2.45x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.298, Ratio=2.34x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.300, Ratio=2.42x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.304, Ratio=2.40x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.321, Ratio=2.45x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.312, Ratio=2.38x, Gap=-2.620
Batch 225/537: Loss=1.2984 (C:1.2984, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.313, Ratio=2.42x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.312, Ratio=2.41x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.313, Ratio=2.42x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.296, Ratio=2.44x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.331, Ratio=2.50x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.324, Ratio=2.52x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.288, Ratio=2.37x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.332, Ratio=2.56x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.309, Ratio=2.42x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.296, Ratio=2.32x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.320, Ratio=2.44x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.337, Ratio=2.62x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.317, Ratio=2.44x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.328, Ratio=2.53x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.316, Ratio=2.43x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.308, Ratio=2.39x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.299, Ratio=2.40x, Gap=-2.777
Batch 250/537: Loss=1.3001 (C:1.3001, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.325, Ratio=2.52x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.314, Ratio=2.43x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.299, Ratio=2.39x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.304, Ratio=2.45x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.297, Ratio=2.29x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.300, Ratio=2.37x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.320, Ratio=2.43x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.291, Ratio=2.27x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.327, Ratio=2.48x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.318, Ratio=2.42x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.327, Ratio=2.54x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.303, Ratio=2.40x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.316, Ratio=2.54x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.303, Ratio=2.50x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.298, Ratio=2.36x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.314, Ratio=2.48x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.315, Ratio=2.46x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.316, Ratio=2.46x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.316, Ratio=2.39x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.318, Ratio=2.47x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.327, Ratio=2.44x, Gap=-2.727
Batch 275/537: Loss=1.2818 (C:1.2818, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.310, Ratio=2.38x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.342, Ratio=2.63x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.338, Ratio=2.62x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.317, Ratio=2.57x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.303, Ratio=2.38x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.310, Ratio=2.46x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.305, Ratio=2.44x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.297, Ratio=2.38x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.315, Ratio=2.52x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.307, Ratio=2.41x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.325, Ratio=2.50x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.320, Ratio=2.42x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.308, Ratio=2.44x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.323, Ratio=2.42x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.316, Ratio=2.38x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.307, Ratio=2.47x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.312, Ratio=2.44x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.306, Ratio=2.45x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.325, Ratio=2.55x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.315, Ratio=2.42x, Gap=-2.799
Batch 300/537: Loss=1.2875 (C:1.2875, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.303, Ratio=2.38x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.297, Ratio=2.38x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.296, Ratio=2.33x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.320, Ratio=2.48x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.296, Ratio=2.32x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.313, Ratio=2.44x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.321, Ratio=2.46x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.312, Ratio=2.48x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.309, Ratio=2.45x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.312, Ratio=2.48x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.324, Ratio=2.49x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.320, Ratio=2.46x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.320, Ratio=2.46x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.307, Ratio=2.38x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.315, Ratio=2.41x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.313, Ratio=2.43x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.304, Ratio=2.41x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.312, Ratio=2.49x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.312, Ratio=2.45x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.321, Ratio=2.44x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.314, Ratio=2.43x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.318, Ratio=2.42x, Gap=-2.620
Batch 325/537: Loss=1.2874 (C:1.2874, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.312, Ratio=2.49x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.311, Ratio=2.40x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.326, Ratio=2.47x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.311, Ratio=2.50x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.299, Ratio=2.43x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.301, Ratio=2.38x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.298, Ratio=2.30x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.310, Ratio=2.37x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.292, Ratio=2.26x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.303, Ratio=2.42x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.321, Ratio=2.48x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.306, Ratio=2.38x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.316, Ratio=2.48x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.303, Ratio=2.40x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.322, Ratio=2.47x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.45x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.306, Ratio=2.47x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.305, Ratio=2.42x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.308, Ratio=2.40x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.316, Ratio=2.41x, Gap=-2.864
Batch 350/537: Loss=1.2899 (C:1.2899, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.325, Ratio=2.45x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.308, Ratio=2.44x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.318, Ratio=2.51x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.310, Ratio=2.47x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.314, Ratio=2.48x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.298, Ratio=2.34x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.309, Ratio=2.38x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.313, Ratio=2.53x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.334, Ratio=2.60x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.313, Ratio=2.38x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.319, Ratio=2.52x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.329, Ratio=2.41x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.319, Ratio=2.37x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.308, Ratio=2.38x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.308, Ratio=2.37x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.308, Ratio=2.43x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.321, Ratio=2.50x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.309, Ratio=2.40x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.323, Ratio=2.53x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.307, Ratio=2.41x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.319, Ratio=2.44x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.305, Ratio=2.36x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.311, Ratio=2.43x, Gap=-2.702
Batch 375/537: Loss=1.2869 (C:1.2869, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.313, Ratio=2.40x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.318, Ratio=2.39x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.318, Ratio=2.40x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.306, Ratio=2.39x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.307, Ratio=2.41x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.303, Ratio=2.42x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.326, Ratio=2.54x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.323, Ratio=2.53x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.304, Ratio=2.39x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.326, Ratio=2.48x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.319, Ratio=2.46x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.316, Ratio=2.39x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.308, Ratio=2.37x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.324, Ratio=2.60x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.326, Ratio=2.50x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.326, Ratio=2.58x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.325, Ratio=2.59x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.316, Ratio=2.59x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.310, Ratio=2.41x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.325, Ratio=2.49x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.316, Ratio=2.48x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.300, Ratio=2.39x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.315, Ratio=2.33x, Gap=-2.726
Batch 400/537: Loss=1.3149 (C:1.3149, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.331, Ratio=2.56x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.341, Ratio=2.50x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.315, Ratio=2.38x, Gap=-2.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.316, Ratio=2.43x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.307, Ratio=2.40x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.313, Ratio=2.47x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.306, Ratio=2.45x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.317, Ratio=2.52x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.316, Ratio=2.45x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.312, Ratio=2.54x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.298, Ratio=2.41x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.313, Ratio=2.44x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.50x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.319, Ratio=2.45x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.331, Ratio=2.55x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.310, Ratio=2.41x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.308, Ratio=2.40x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.56x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.327, Ratio=2.52x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.331, Ratio=2.59x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.320, Ratio=2.50x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.304, Ratio=2.44x, Gap=-2.721
Batch 425/537: Loss=1.2871 (C:1.2871, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.303, Ratio=2.43x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.288, Ratio=2.38x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.327, Ratio=2.67x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.306, Ratio=2.39x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.45x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.337, Ratio=2.60x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.327, Ratio=2.53x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.320, Ratio=2.45x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.322, Ratio=2.49x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.298, Ratio=2.43x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.305, Ratio=2.43x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.312, Ratio=2.61x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.297, Ratio=2.37x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.310, Ratio=2.44x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.317, Ratio=2.44x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.306, Ratio=2.49x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.310, Ratio=2.37x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.303, Ratio=2.36x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.310, Ratio=2.40x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.304, Ratio=2.41x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.318, Ratio=2.40x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.315, Ratio=2.40x, Gap=-2.801
Batch 450/537: Loss=1.2951 (C:1.2951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.311, Ratio=2.47x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.299, Ratio=2.37x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.298, Ratio=2.37x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.310, Ratio=2.41x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.295, Ratio=2.41x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.322, Ratio=2.53x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.322, Ratio=2.48x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.323, Ratio=2.43x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.319, Ratio=2.44x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.319, Ratio=2.42x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.302, Ratio=2.34x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.314, Ratio=2.41x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.308, Ratio=2.46x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.315, Ratio=2.50x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.311, Ratio=2.47x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.315, Ratio=2.47x, Gap=-2.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.314, Ratio=2.42x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.319, Ratio=2.46x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.62x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.292, Ratio=2.33x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.324, Ratio=2.50x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.318, Ratio=2.41x, Gap=-2.776
Batch 475/537: Loss=1.2909 (C:1.2909, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.345, Ratio=2.61x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.316, Ratio=2.46x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.335, Ratio=2.54x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.317, Ratio=2.46x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.309, Ratio=2.45x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.305, Ratio=2.49x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.304, Ratio=2.40x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.313, Ratio=2.45x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.317, Ratio=2.55x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.319, Ratio=2.44x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.321, Ratio=2.51x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.315, Ratio=2.52x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.316, Ratio=2.46x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.322, Ratio=2.44x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.315, Ratio=2.40x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.312, Ratio=2.44x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.316, Ratio=2.49x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.311, Ratio=2.43x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.316, Ratio=2.47x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.307, Ratio=2.44x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.618
Batch 500/537: Loss=1.2770 (C:1.2770, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.324, Ratio=2.45x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.321, Ratio=2.46x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.302, Ratio=2.36x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.319, Ratio=2.54x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.310, Ratio=2.45x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.311, Ratio=2.49x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.304, Ratio=2.37x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.310, Ratio=2.42x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.318, Ratio=2.39x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.304, Ratio=2.40x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.318, Ratio=2.50x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.43x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.307, Ratio=2.40x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.309, Ratio=2.39x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.312, Ratio=2.47x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.313, Ratio=2.43x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.327, Ratio=2.50x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.306, Ratio=2.39x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.320, Ratio=2.46x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.324, Ratio=2.60x, Gap=-2.708
Batch 525/537: Loss=1.2448 (C:1.2448, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.320, Ratio=2.55x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.307, Ratio=2.41x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.309, Ratio=2.49x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.298, Ratio=2.38x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.307, Ratio=2.43x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.296, Ratio=2.31x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.331, Ratio=2.52x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.323, Ratio=2.46x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.319, Ratio=2.46x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.319, Ratio=2.48x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.303, Ratio=2.43x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.334, Ratio=2.61x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.326, Ratio=2.57x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.50x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.70x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.334, Ratio=2.60x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.326, Ratio=2.56x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.323, Ratio=2.62x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.317, Ratio=2.56x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.318, Ratio=2.54x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.322, Ratio=2.52x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.337, Ratio=2.61x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.59x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.318, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.320, Ratio=2.50x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.320, Ratio=2.61x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.332, Ratio=2.63x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.319, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.313, Ratio=2.54x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.339, Ratio=2.66x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.56x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.308, Ratio=2.45x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.324, Ratio=2.59x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.318, Ratio=2.51x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.332, Ratio=2.73x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.317, Ratio=2.58x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.308, Ratio=2.47x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.324, Ratio=2.57x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.306, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.318, Ratio=2.47x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.302, Ratio=2.48x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.316, Ratio=2.51x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.51x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.321, Ratio=2.59x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.306, Ratio=2.46x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.295, Ratio=2.40x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.326, Ratio=2.67x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.317, Ratio=2.57x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.335, Ratio=2.74x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.327, Ratio=2.66x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.71x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.320, Ratio=2.61x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.327, Ratio=2.55x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.322, Ratio=2.65x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.311, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.321, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.316, Ratio=2.62x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.58x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.313, Ratio=2.54x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.304, Ratio=2.49x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.315, Ratio=2.53x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.309, Ratio=2.51x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.309, Ratio=2.43x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.320, Ratio=2.56x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.64x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.331, Ratio=2.61x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.327, Ratio=2.53x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.314, Ratio=2.58x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.311, Ratio=2.46x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.342, Ratio=2.78x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.318, Ratio=2.49x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.312, Ratio=2.59x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.310, Ratio=2.53x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.320, Ratio=2.65x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.332, Ratio=2.60x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.309, Ratio=2.54x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.313, Ratio=2.54x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.68x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.331, Ratio=2.66x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.319, Ratio=2.51x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.315, Ratio=2.55x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.63x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.310, Ratio=2.50x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.55x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.60x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.70x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.62x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.326, Ratio=2.60x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.332, Ratio=2.67x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.75x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.325, Ratio=2.59x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.315, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.309, Ratio=2.62x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.312, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.329, Ratio=2.58x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.310, Ratio=2.46x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.318, Ratio=2.56x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.44x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.326, Ratio=2.55x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.332, Ratio=2.71x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.325, Ratio=2.47x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.319, Ratio=2.47x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.318, Ratio=2.55x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.328, Ratio=2.58x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.322, Ratio=2.55x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.327, Ratio=2.55x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.322, Ratio=2.64x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.54x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.325, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.328, Ratio=2.58x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.325, Ratio=2.52x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.329, Ratio=2.58x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.323, Ratio=2.63x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.54x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.326, Ratio=2.54x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.313, Ratio=2.56x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.324, Ratio=2.60x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.65x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.313, Ratio=2.56x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.309, Ratio=2.47x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.313, Ratio=2.58x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.315, Ratio=2.55x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.303, Ratio=2.42x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.315, Ratio=2.59x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.317, Ratio=2.56x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.327, Ratio=2.64x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.327, Ratio=2.71x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.309, Ratio=2.52x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.58x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.319, Ratio=2.55x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.327, Ratio=2.62x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.58x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.317, Ratio=2.47x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.317, Ratio=2.55x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.321, Ratio=2.53x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.320, Ratio=2.52x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.63x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.60x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.321, Ratio=2.57x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.305, Ratio=2.47x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.334, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.66x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.306, Ratio=2.42x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.308, Ratio=2.48x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.308, Ratio=2.48x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.332, Ratio=2.62x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.328, Ratio=2.54x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.67x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.46x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.317, Ratio=2.56x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.66x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.329, Ratio=2.74x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.322, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.320, Ratio=2.64x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.318, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.65x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.321, Ratio=2.57x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.330, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.314, Ratio=2.53x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.325, Ratio=2.51x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.319, Ratio=2.59x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.319, Ratio=2.60x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.329, Ratio=2.61x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.315, Ratio=2.54x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.310, Ratio=2.42x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.317, Ratio=2.57x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.321, Ratio=2.48x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.311, Ratio=2.57x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.59x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.318, Ratio=2.57x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.63x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.321, Ratio=2.63x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.320, Ratio=2.49x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.313, Ratio=2.48x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.318, Ratio=2.50x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.322, Ratio=2.58x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.327, Ratio=2.52x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.54x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.325, Ratio=2.60x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.320, Ratio=2.49x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.305, Ratio=2.43x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.312, Ratio=2.53x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.334, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.315, Ratio=2.53x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.315, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.304, Ratio=2.39x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.307, Ratio=2.47x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.336, Ratio=2.75x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.334, Ratio=2.54x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.336, Ratio=2.58x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.325, Ratio=2.56x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.62x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.325, Ratio=2.53x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.67x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.320, Ratio=2.53x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.311, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.317, Ratio=2.58x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.62x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.323, Ratio=2.56x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.321, Ratio=2.56x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.331, Ratio=2.65x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.312, Ratio=2.54x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.333, Ratio=2.68x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.323, Ratio=2.62x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.321, Ratio=2.54x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.329, Ratio=2.59x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.334, Ratio=2.77x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.319, Ratio=2.58x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.322, Ratio=2.52x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.313, Ratio=2.48x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.335, Ratio=2.61x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.330, Ratio=2.60x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.320, Ratio=2.53x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.321, Ratio=2.63x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.50x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.320, Ratio=2.53x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.322, Ratio=2.61x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.328, Ratio=2.57x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.324, Ratio=2.54x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.317, Ratio=2.56x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.322, Ratio=2.62x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.320, Ratio=2.55x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.317, Ratio=2.52x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.317, Ratio=2.54x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.61x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.65x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.74x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.313, Ratio=2.54x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.319, Ratio=2.58x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.317, Ratio=2.66x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.51x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.319, Ratio=2.56x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.336, Ratio=2.59x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.317, Ratio=2.58x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.318, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.335, Ratio=2.73x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.308, Ratio=2.50x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.317, Ratio=2.54x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.330, Ratio=2.67x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.319, Ratio=2.56x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.313, Ratio=2.59x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.59x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.301, Ratio=2.40x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.310, Ratio=2.48x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.332, Ratio=2.62x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.314, Ratio=2.52x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.326, Ratio=2.56x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.299, Ratio=2.46x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.312, Ratio=2.56x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.318, Ratio=2.52x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.323, Ratio=2.65x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.306, Ratio=2.45x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.338, Ratio=2.60x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.322, Ratio=2.54x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.310, Ratio=2.51x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.313, Ratio=2.52x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.304, Ratio=2.47x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.317, Ratio=2.54x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.326, Ratio=2.62x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.313, Ratio=2.58x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.320, Ratio=2.57x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.327, Ratio=2.63x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.323, Ratio=2.57x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.69x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.316, Ratio=2.55x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.63x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.327, Ratio=2.64x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.327, Ratio=2.61x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.327, Ratio=2.58x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.309, Ratio=2.53x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.319, Ratio=2.50x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.326, Ratio=2.67x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.309, Ratio=2.42x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.311, Ratio=2.47x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.314, Ratio=2.55x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.321, Ratio=2.53x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.60x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.326, Ratio=2.61x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.54x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.313, Ratio=2.54x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.307, Ratio=2.52x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.65x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.73x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.300, Ratio=2.40x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.336, Ratio=2.79x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.326, Ratio=2.65x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.62x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.55x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.325, Ratio=2.56x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.62x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.321, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.322, Ratio=2.63x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.59x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.316, Ratio=2.55x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.314, Ratio=2.53x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.322, Ratio=2.57x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.323, Ratio=2.56x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.317, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.329, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.319, Ratio=2.52x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.337, Ratio=2.67x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.316, Ratio=2.51x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.57x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.60x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.66x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.316, Ratio=2.51x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.323, Ratio=2.54x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.311, Ratio=2.53x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.302, Ratio=2.45x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.319, Ratio=2.55x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.318, Ratio=2.55x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.340, Ratio=2.79x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.327, Ratio=2.68x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.330, Ratio=2.60x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.322, Ratio=2.52x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.320, Ratio=2.55x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.329, Ratio=2.60x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.327, Ratio=2.51x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.318, Ratio=2.46x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.323, Ratio=2.56x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.315, Ratio=2.56x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.307, Ratio=2.49x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.329, Ratio=2.62x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.307, Ratio=2.46x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.315, Ratio=2.55x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.51x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.327, Ratio=2.66x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.310, Ratio=2.45x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.78x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.321, Ratio=2.49x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.316, Ratio=2.53x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.330, Ratio=2.68x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.326, Ratio=2.52x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.317, Ratio=2.54x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.56x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.324, Ratio=2.57x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.317, Ratio=2.49x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.62x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.318, Ratio=2.57x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.62x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.319, Ratio=2.60x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.319, Ratio=2.58x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.326, Ratio=2.59x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.317, Ratio=2.55x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.354, Ratio=2.74x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.326, Ratio=2.58x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.308, Ratio=2.51x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.55x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.312, Ratio=2.51x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.322, Ratio=2.63x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.303, Ratio=2.44x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.315, Ratio=2.51x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.65x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.347, Ratio=2.76x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.316, Ratio=2.56x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.322, Ratio=2.55x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.59x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.315, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.319, Ratio=2.53x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.335, Ratio=2.55x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.319, Ratio=2.60x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.321, Ratio=2.49x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.318, Ratio=2.61x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.317, Ratio=2.60x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.59x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.316, Ratio=2.48x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.308, Ratio=2.53x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.308, Ratio=2.38x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.332, Ratio=2.62x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.322, Ratio=2.57x, Gap=-2.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.319, Ratio=2.56x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.332, Ratio=2.63x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.312, Ratio=2.52x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.323, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.334, Ratio=2.63x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.332, Ratio=2.66x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.322, Ratio=2.53x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.328, Ratio=2.64x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.310, Ratio=2.54x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.326, Ratio=2.60x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.63x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.600

============================================================
Epoch 11/20 completed in 28.9s
Train: Loss=1.2802 (C:1.2802, R:0.0000) Ratio=2.40x
Val:   Loss=1.2541 (C:1.2541, R:0.0000) Ratio=2.73x
‚úÖ New best model saved (Val Loss: 1.2541)
============================================================

Epoch 12 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.323, Ratio=2.49x, Gap=-2.704
Batch   0/537: Loss=1.2717 (C:1.2717, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.326, Ratio=2.48x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.325, Ratio=2.47x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.330, Ratio=2.53x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.316, Ratio=2.44x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.330, Ratio=2.58x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.304, Ratio=2.38x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.307, Ratio=2.41x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.316, Ratio=2.46x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.313, Ratio=2.44x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.319, Ratio=2.45x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.326, Ratio=2.55x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.329, Ratio=2.47x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.330, Ratio=2.49x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.312, Ratio=2.40x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.324, Ratio=2.51x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.324, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.328, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.311, Ratio=2.40x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.323, Ratio=2.62x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.328, Ratio=2.59x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.51x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.314, Ratio=2.50x, Gap=-2.732
Batch  25/537: Loss=1.2705 (C:1.2705, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.48x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.325, Ratio=2.55x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.296, Ratio=2.33x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.326, Ratio=2.52x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.309, Ratio=2.44x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.327, Ratio=2.56x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.322, Ratio=2.50x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.328, Ratio=2.53x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.310, Ratio=2.47x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.303, Ratio=2.39x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.305, Ratio=2.39x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.314, Ratio=2.49x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.44x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.320, Ratio=2.47x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.318, Ratio=2.43x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.320, Ratio=2.44x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.311, Ratio=2.44x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.63x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.313, Ratio=2.43x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.320, Ratio=2.48x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.320, Ratio=2.50x, Gap=-2.744
Batch  50/537: Loss=1.2658 (C:1.2658, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.49x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.324, Ratio=2.49x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.316, Ratio=2.57x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.316, Ratio=2.44x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.308, Ratio=2.53x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.318, Ratio=2.42x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.312, Ratio=2.40x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.337, Ratio=2.61x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.320, Ratio=2.47x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.302, Ratio=2.40x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.327, Ratio=2.50x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.326, Ratio=2.54x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.307, Ratio=2.43x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.342, Ratio=2.64x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.327, Ratio=2.55x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.305, Ratio=2.42x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.304, Ratio=2.40x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.310, Ratio=2.50x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.50x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.316, Ratio=2.49x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.50x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.321, Ratio=2.48x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.65x, Gap=-2.651
Batch  75/537: Loss=1.2324 (C:1.2324, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.338, Ratio=2.62x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.300, Ratio=2.43x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.318, Ratio=2.46x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.314, Ratio=2.43x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.317, Ratio=2.46x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.315, Ratio=2.48x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.326, Ratio=2.53x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.57x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.329, Ratio=2.49x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.314, Ratio=2.39x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.318, Ratio=2.49x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.315, Ratio=2.52x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.309, Ratio=2.40x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.305, Ratio=2.49x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.317, Ratio=2.46x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.318, Ratio=2.44x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.328, Ratio=2.59x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.306, Ratio=2.44x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.331, Ratio=2.50x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.321, Ratio=2.45x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.327, Ratio=2.49x, Gap=-3.160
Batch 100/537: Loss=1.2709 (C:1.2709, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.326, Ratio=2.51x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.341, Ratio=2.66x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.312, Ratio=2.33x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.315, Ratio=2.42x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.305, Ratio=2.44x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.307, Ratio=2.41x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.315, Ratio=2.50x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.65x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.309, Ratio=2.48x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.318, Ratio=2.43x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.334, Ratio=2.55x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.318, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.49x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.323, Ratio=2.47x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.330, Ratio=2.56x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.297, Ratio=2.37x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.285, Ratio=2.34x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.314, Ratio=2.46x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.318, Ratio=2.46x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.305, Ratio=2.48x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.323, Ratio=2.50x, Gap=-2.684
Batch 125/537: Loss=1.2685 (C:1.2685, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.327, Ratio=2.53x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.313, Ratio=2.44x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.324, Ratio=2.51x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.319, Ratio=2.48x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.326, Ratio=2.52x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.328, Ratio=2.52x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.297, Ratio=2.30x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.317, Ratio=2.50x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.307, Ratio=2.40x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.297, Ratio=2.41x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.317, Ratio=2.48x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.312, Ratio=2.42x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.311, Ratio=2.41x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.329, Ratio=2.59x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.329, Ratio=2.52x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.320, Ratio=2.45x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.312, Ratio=2.43x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.333, Ratio=2.57x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.323, Ratio=2.48x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.324, Ratio=2.57x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.323, Ratio=2.52x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.310, Ratio=2.39x, Gap=-2.883
Batch 150/537: Loss=1.2990 (C:1.2990, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.314, Ratio=2.49x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.328, Ratio=2.59x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.307, Ratio=2.43x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.319, Ratio=2.40x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.302, Ratio=2.38x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.58x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.330, Ratio=2.63x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.318, Ratio=2.45x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.310, Ratio=2.42x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.57x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.315, Ratio=2.48x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.309, Ratio=2.38x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.326, Ratio=2.55x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.312, Ratio=2.44x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.315, Ratio=2.48x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.304, Ratio=2.30x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.311, Ratio=2.45x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.310, Ratio=2.39x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.314, Ratio=2.50x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.316, Ratio=2.47x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.323, Ratio=2.53x, Gap=-2.723
Batch 175/537: Loss=1.2595 (C:1.2595, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.312, Ratio=2.41x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.325, Ratio=2.54x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.310, Ratio=2.39x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.330, Ratio=2.55x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.321, Ratio=2.45x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.307, Ratio=2.37x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.327, Ratio=2.54x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.311, Ratio=2.40x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.319, Ratio=2.41x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.317, Ratio=2.50x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.309, Ratio=2.45x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.300, Ratio=2.39x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.311, Ratio=2.45x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.309, Ratio=2.44x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.303, Ratio=2.42x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.311, Ratio=2.44x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.326, Ratio=2.48x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.333, Ratio=2.56x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.319, Ratio=2.44x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.318, Ratio=2.51x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.312, Ratio=2.54x, Gap=-2.600
Batch 200/537: Loss=1.2631 (C:1.2631, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.324, Ratio=2.49x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.323, Ratio=2.52x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.295, Ratio=2.41x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.321, Ratio=2.49x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.303, Ratio=2.35x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.321, Ratio=2.55x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.297, Ratio=2.40x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.317, Ratio=2.54x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.306, Ratio=2.48x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.297, Ratio=2.36x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.65x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.323, Ratio=2.38x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.325, Ratio=2.46x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.314, Ratio=2.45x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.315, Ratio=2.47x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.331, Ratio=2.50x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.324, Ratio=2.51x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.327, Ratio=2.51x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.332, Ratio=2.58x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.313, Ratio=2.41x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.300, Ratio=2.47x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.325, Ratio=2.57x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.302, Ratio=2.42x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.611
Batch 225/537: Loss=1.2688 (C:1.2688, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.320, Ratio=2.50x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.311, Ratio=2.49x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.306, Ratio=2.43x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.311, Ratio=2.48x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.319, Ratio=2.56x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.314, Ratio=2.48x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.314, Ratio=2.45x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.329, Ratio=2.50x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.310, Ratio=2.53x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.44x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.306, Ratio=2.44x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.307, Ratio=2.44x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.304, Ratio=2.38x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.318, Ratio=2.52x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.312, Ratio=2.49x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.312, Ratio=2.49x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.303, Ratio=2.41x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.315, Ratio=2.57x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.328, Ratio=2.49x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.310, Ratio=2.52x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.319, Ratio=2.55x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.321, Ratio=2.55x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.324, Ratio=2.46x, Gap=-2.749
Batch 250/537: Loss=1.2768 (C:1.2768, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.311, Ratio=2.43x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.310, Ratio=2.39x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.329, Ratio=2.57x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.306, Ratio=2.38x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.315, Ratio=2.43x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.332, Ratio=2.53x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.319, Ratio=2.49x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.307, Ratio=2.43x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.329, Ratio=2.46x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.317, Ratio=2.50x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.321, Ratio=2.53x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.334, Ratio=2.55x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.326, Ratio=2.53x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.324, Ratio=2.62x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.310, Ratio=2.37x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.345, Ratio=2.62x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.307, Ratio=2.40x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.320, Ratio=2.46x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.324, Ratio=2.50x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.302, Ratio=2.46x, Gap=-2.689
Batch 275/537: Loss=1.2855 (C:1.2855, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.328, Ratio=2.53x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.306, Ratio=2.37x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.306, Ratio=2.55x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.323, Ratio=2.53x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.305, Ratio=2.43x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.309, Ratio=2.40x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.323, Ratio=2.51x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.321, Ratio=2.48x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.328, Ratio=2.55x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.312, Ratio=2.44x, Gap=-2.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.316, Ratio=2.46x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.323, Ratio=2.53x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.318, Ratio=2.52x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.311, Ratio=2.47x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.321, Ratio=2.52x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.319, Ratio=2.52x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.318, Ratio=2.47x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.316, Ratio=2.42x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.322, Ratio=2.49x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.330, Ratio=2.59x, Gap=-2.727
Batch 300/537: Loss=1.2470 (C:1.2470, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.340, Ratio=2.67x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.315, Ratio=2.46x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.322, Ratio=2.54x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.304, Ratio=2.40x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.310, Ratio=2.41x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.311, Ratio=2.48x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.304, Ratio=2.41x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.316, Ratio=2.49x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.309, Ratio=2.45x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.311, Ratio=2.45x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.332, Ratio=2.55x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.328, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.309, Ratio=2.40x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.312, Ratio=2.50x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.299, Ratio=2.33x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.308, Ratio=2.40x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.318, Ratio=2.42x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.307, Ratio=2.43x, Gap=-2.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.313, Ratio=2.42x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.314, Ratio=2.48x, Gap=-2.663
Batch 325/537: Loss=1.2768 (C:1.2768, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.319, Ratio=2.48x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.317, Ratio=2.48x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.306, Ratio=2.43x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.319, Ratio=2.54x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.309, Ratio=2.51x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.313, Ratio=2.49x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.314, Ratio=2.49x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.49x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.318, Ratio=2.47x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.323, Ratio=2.56x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.322, Ratio=2.47x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.302, Ratio=2.41x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.313, Ratio=2.46x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.317, Ratio=2.50x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.326, Ratio=2.53x, Gap=-3.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.326, Ratio=2.58x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.302, Ratio=2.38x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.305, Ratio=2.46x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.334, Ratio=2.52x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.299, Ratio=2.40x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.322, Ratio=2.49x, Gap=-2.843
Batch 350/537: Loss=1.2732 (C:1.2732, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.325, Ratio=2.50x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.325, Ratio=2.46x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.318, Ratio=2.48x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.329, Ratio=2.46x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.307, Ratio=2.47x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.318, Ratio=2.47x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.313, Ratio=2.41x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.308, Ratio=2.37x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.309, Ratio=2.42x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.318, Ratio=2.43x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.310, Ratio=2.42x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.311, Ratio=2.40x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.318, Ratio=2.53x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.327, Ratio=2.51x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.323, Ratio=2.44x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.333, Ratio=2.55x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.315, Ratio=2.39x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.320, Ratio=2.48x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.316, Ratio=2.52x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.319, Ratio=2.48x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.310, Ratio=2.46x, Gap=-2.683
Batch 375/537: Loss=1.2824 (C:1.2824, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.330, Ratio=2.51x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.51x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.311, Ratio=2.43x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.52x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.322, Ratio=2.53x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.322, Ratio=2.40x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.313, Ratio=2.45x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.345, Ratio=2.63x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.323, Ratio=2.46x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.317, Ratio=2.44x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.331, Ratio=2.58x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.319, Ratio=2.54x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.330, Ratio=2.61x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.305, Ratio=2.35x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.308, Ratio=2.42x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.319, Ratio=2.45x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.317, Ratio=2.41x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.307, Ratio=2.37x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.305, Ratio=2.37x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.319, Ratio=2.51x, Gap=-2.678
Batch 400/537: Loss=1.2658 (C:1.2658, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.306, Ratio=2.40x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.306, Ratio=2.41x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.322, Ratio=2.47x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.307, Ratio=2.45x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.299, Ratio=2.39x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.302, Ratio=2.40x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.318, Ratio=2.41x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.295, Ratio=2.44x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.320, Ratio=2.47x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.307, Ratio=2.41x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.321, Ratio=2.50x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.309, Ratio=2.43x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.306, Ratio=2.41x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.315, Ratio=2.40x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.306, Ratio=2.38x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.305, Ratio=2.35x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.62x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.60x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.323, Ratio=2.54x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.319, Ratio=2.52x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.325, Ratio=2.46x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.314, Ratio=2.45x, Gap=-2.774
Batch 425/537: Loss=1.2837 (C:1.2837, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.305, Ratio=2.37x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.341, Ratio=2.65x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.312, Ratio=2.51x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.307, Ratio=2.42x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.333, Ratio=2.63x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.317, Ratio=2.46x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.320, Ratio=2.49x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.326, Ratio=2.56x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.309, Ratio=2.44x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.309, Ratio=2.41x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.316, Ratio=2.39x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.311, Ratio=2.43x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.310, Ratio=2.59x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.316, Ratio=2.44x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.306, Ratio=2.36x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.318, Ratio=2.55x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.332, Ratio=2.51x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.312, Ratio=2.40x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.327, Ratio=2.54x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.301, Ratio=2.40x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.314, Ratio=2.42x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.55x, Gap=-2.691
Batch 450/537: Loss=1.2530 (C:1.2530, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.336, Ratio=2.62x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.314, Ratio=2.52x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.317, Ratio=2.44x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.315, Ratio=2.44x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.320, Ratio=2.43x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.318, Ratio=2.42x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.316, Ratio=2.45x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.316, Ratio=2.45x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.301, Ratio=2.35x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.298, Ratio=2.33x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.320, Ratio=2.48x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.51x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.326, Ratio=2.54x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.327, Ratio=2.48x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.310, Ratio=2.38x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.334, Ratio=2.61x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.312, Ratio=2.43x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.314, Ratio=2.40x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.326, Ratio=2.58x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.301, Ratio=2.40x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.314, Ratio=2.47x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.306, Ratio=2.41x, Gap=-2.598
Batch 475/537: Loss=1.2936 (C:1.2936, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.55x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.313, Ratio=2.50x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.301, Ratio=2.34x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.324, Ratio=2.55x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.337, Ratio=2.60x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.318, Ratio=2.50x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.316, Ratio=2.42x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.335, Ratio=2.51x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.306, Ratio=2.40x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.322, Ratio=2.48x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.320, Ratio=2.48x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.301, Ratio=2.43x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.303, Ratio=2.40x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.64x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.324, Ratio=2.53x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.311, Ratio=2.43x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.48x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.310, Ratio=2.44x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.316, Ratio=2.49x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.310, Ratio=2.35x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.305, Ratio=2.50x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.310, Ratio=2.45x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.311, Ratio=2.45x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-2.777
Batch 500/537: Loss=1.2444 (C:1.2444, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.313, Ratio=2.56x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.311, Ratio=2.42x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.321, Ratio=2.47x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.327, Ratio=2.50x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.321, Ratio=2.48x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.318, Ratio=2.50x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.314, Ratio=2.47x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.315, Ratio=2.45x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.321, Ratio=2.54x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.310, Ratio=2.44x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.314, Ratio=2.46x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.317, Ratio=2.47x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.326, Ratio=2.49x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.309, Ratio=2.45x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.327, Ratio=2.51x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.306, Ratio=2.36x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.304, Ratio=2.37x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.51x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.313, Ratio=2.46x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.320, Ratio=2.51x, Gap=-2.629
Batch 525/537: Loss=1.2661 (C:1.2661, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.310, Ratio=2.42x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.319, Ratio=2.49x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.322, Ratio=2.54x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.319, Ratio=2.43x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.328, Ratio=2.59x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.321, Ratio=2.45x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.317, Ratio=2.51x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.320, Ratio=2.49x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.323, Ratio=2.48x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.322, Ratio=2.45x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.317, Ratio=2.58x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.336, Ratio=2.70x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.335, Ratio=2.74x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.64x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.312, Ratio=2.51x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.327, Ratio=2.65x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.314, Ratio=2.53x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.308, Ratio=2.54x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.322, Ratio=2.64x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.325, Ratio=2.52x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.314, Ratio=2.55x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.334, Ratio=2.73x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.318, Ratio=2.55x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.329, Ratio=2.61x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.315, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.311, Ratio=2.52x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.320, Ratio=2.65x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.320, Ratio=2.58x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.325, Ratio=2.68x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.313, Ratio=2.59x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.326, Ratio=2.64x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.330, Ratio=2.73x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.310, Ratio=2.49x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.65x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.324, Ratio=2.58x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.321, Ratio=2.66x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.323, Ratio=2.54x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.318, Ratio=2.61x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.331, Ratio=2.59x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.64x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.318, Ratio=2.57x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.320, Ratio=2.53x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.319, Ratio=2.53x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.348, Ratio=2.90x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.64x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.312, Ratio=2.47x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.318, Ratio=2.56x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.317, Ratio=2.66x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.316, Ratio=2.49x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.322, Ratio=2.53x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.328, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.313, Ratio=2.47x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.330, Ratio=2.67x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.324, Ratio=2.57x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.324, Ratio=2.61x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.329, Ratio=2.64x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.335, Ratio=2.75x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.317, Ratio=2.61x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.318, Ratio=2.48x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.319, Ratio=2.51x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.74x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.316, Ratio=2.52x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.325, Ratio=2.59x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.313, Ratio=2.46x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.317, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.306, Ratio=2.51x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.70x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.70x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.322, Ratio=2.58x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.314, Ratio=2.45x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.314, Ratio=2.51x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.311, Ratio=2.51x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.320, Ratio=2.54x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.324, Ratio=2.59x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.331, Ratio=2.64x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.328, Ratio=2.69x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.321, Ratio=2.64x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.316, Ratio=2.50x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.61x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.336, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.323, Ratio=2.58x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.62x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.328, Ratio=2.61x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.60x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.339, Ratio=2.70x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.311, Ratio=2.50x, Gap=-2.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.318, Ratio=2.49x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.345, Ratio=2.73x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.332, Ratio=2.66x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.308, Ratio=2.51x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.337, Ratio=2.76x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.324, Ratio=2.56x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.313, Ratio=2.50x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.328, Ratio=2.67x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.66x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.327, Ratio=2.63x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.324, Ratio=2.64x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.336, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.324, Ratio=2.65x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.323, Ratio=2.54x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.312, Ratio=2.46x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.322, Ratio=2.54x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.51x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.314, Ratio=2.47x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.326, Ratio=2.63x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.332, Ratio=2.62x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.323, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.317, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.315, Ratio=2.44x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.326, Ratio=2.67x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.338, Ratio=2.85x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.323, Ratio=2.58x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.68x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.318, Ratio=2.54x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.320, Ratio=2.62x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.306, Ratio=2.51x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.313, Ratio=2.56x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.328, Ratio=2.59x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.72x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.321, Ratio=2.55x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.325, Ratio=2.64x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.52x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.313, Ratio=2.54x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.329, Ratio=2.60x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.49x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.327, Ratio=2.64x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.310, Ratio=2.47x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.323, Ratio=2.58x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.327, Ratio=2.63x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.332, Ratio=2.62x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.313, Ratio=2.54x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.319, Ratio=2.62x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.323, Ratio=2.65x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.312, Ratio=2.53x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.66x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.322, Ratio=2.66x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.321, Ratio=2.57x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.323, Ratio=2.59x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.326, Ratio=2.65x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.313, Ratio=2.48x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.320, Ratio=2.64x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.326, Ratio=2.61x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.324, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.319, Ratio=2.50x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.316, Ratio=2.60x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.341, Ratio=2.66x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.313, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.345, Ratio=2.76x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.331, Ratio=2.63x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.65x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.329, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.316, Ratio=2.51x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.314, Ratio=2.48x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.331, Ratio=2.70x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.328, Ratio=2.59x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.333, Ratio=2.60x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.67x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.313, Ratio=2.56x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.70x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.329, Ratio=2.59x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.57x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.310, Ratio=2.45x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.311, Ratio=2.55x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.315, Ratio=2.48x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.83x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.64x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.315, Ratio=2.56x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.308, Ratio=2.57x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.317, Ratio=2.55x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.68x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.322, Ratio=2.50x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.320, Ratio=2.56x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.314, Ratio=2.55x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.322, Ratio=2.57x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.331, Ratio=2.64x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.319, Ratio=2.63x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.303, Ratio=2.45x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.329, Ratio=2.63x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.324, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.307, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.327, Ratio=2.66x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.318, Ratio=2.66x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.310, Ratio=2.52x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.346, Ratio=2.76x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.308, Ratio=2.54x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.319, Ratio=2.53x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.318, Ratio=2.58x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.325, Ratio=2.65x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.325, Ratio=2.54x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.331, Ratio=2.64x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.324, Ratio=2.54x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.331, Ratio=2.70x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.319, Ratio=2.62x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.62x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.309, Ratio=2.49x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.306, Ratio=2.47x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.322, Ratio=2.63x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.318, Ratio=2.58x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.330, Ratio=2.59x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.314, Ratio=2.53x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.316, Ratio=2.57x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.323, Ratio=2.52x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.335, Ratio=2.72x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.311, Ratio=2.49x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.320, Ratio=2.60x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.327, Ratio=2.59x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.310, Ratio=2.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.52x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.327, Ratio=2.70x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.76x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.326, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.61x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.325, Ratio=2.61x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.309, Ratio=2.46x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.321, Ratio=2.60x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.323, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.316, Ratio=2.54x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.322, Ratio=2.59x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.312, Ratio=2.50x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.321, Ratio=2.59x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.320, Ratio=2.60x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.319, Ratio=2.61x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.319, Ratio=2.53x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.319, Ratio=2.57x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.325, Ratio=2.65x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.325, Ratio=2.74x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.332, Ratio=2.71x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.327, Ratio=2.58x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.325, Ratio=2.61x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.309, Ratio=2.55x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.64x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.327, Ratio=2.61x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.317, Ratio=2.60x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.327, Ratio=2.73x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.321, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.334, Ratio=2.73x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.65x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.60x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.333, Ratio=2.61x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.66x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.326, Ratio=2.58x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.324, Ratio=2.52x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.314, Ratio=2.54x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.316, Ratio=2.48x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.331, Ratio=2.72x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.319, Ratio=2.61x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.305, Ratio=2.41x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.327, Ratio=2.63x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.323, Ratio=2.65x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.318, Ratio=2.64x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.59x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.310, Ratio=2.51x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.324, Ratio=2.58x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.323, Ratio=2.57x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.332, Ratio=2.65x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.327, Ratio=2.58x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.308, Ratio=2.47x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.70x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.326, Ratio=2.65x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.317, Ratio=2.56x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.306, Ratio=2.44x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.325, Ratio=2.58x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.337, Ratio=2.70x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.63x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.319, Ratio=2.62x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.321, Ratio=2.54x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.314, Ratio=2.49x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.328, Ratio=2.67x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.305, Ratio=2.42x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.334, Ratio=2.68x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.327, Ratio=2.55x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.316, Ratio=2.55x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.315, Ratio=2.61x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.314, Ratio=2.48x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.77x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.297, Ratio=2.41x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.329, Ratio=2.55x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.333, Ratio=2.65x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.329, Ratio=2.56x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.315, Ratio=2.52x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.325, Ratio=2.53x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.68x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.324, Ratio=2.54x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.309, Ratio=2.52x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.321, Ratio=2.56x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.324, Ratio=2.55x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.324, Ratio=2.65x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.319, Ratio=2.52x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.321, Ratio=2.56x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.313, Ratio=2.48x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.57x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.320, Ratio=2.61x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.337, Ratio=2.66x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.329, Ratio=2.62x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.323, Ratio=2.62x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.326, Ratio=2.62x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.316, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.315, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.57x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.313, Ratio=2.50x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.322, Ratio=2.51x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.317, Ratio=2.49x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.314, Ratio=2.63x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.336, Ratio=2.72x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.318, Ratio=2.56x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.321, Ratio=2.61x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.320, Ratio=2.57x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.336, Ratio=2.67x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.311, Ratio=2.51x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.321, Ratio=2.61x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.311, Ratio=2.51x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.310, Ratio=2.43x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.319, Ratio=2.55x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.320, Ratio=2.55x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.308, Ratio=2.44x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.60x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.316, Ratio=2.56x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.327, Ratio=2.65x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.312, Ratio=2.54x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.314, Ratio=2.60x, Gap=-2.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.58x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.74x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.319, Ratio=2.46x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.312, Ratio=2.53x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.315, Ratio=2.52x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.309, Ratio=2.54x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.321, Ratio=2.63x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.333, Ratio=2.72x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.90x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.312, Ratio=2.46x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.64x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.323, Ratio=2.51x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.315, Ratio=2.51x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.71x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.327, Ratio=2.56x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.319, Ratio=2.59x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.329, Ratio=2.68x, Gap=-2.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.320, Ratio=2.52x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.342, Ratio=2.81x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.323, Ratio=2.57x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.315, Ratio=2.58x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.316, Ratio=2.54x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.322, Ratio=2.59x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.334, Ratio=2.71x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.314, Ratio=2.51x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.301, Ratio=2.48x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.321, Ratio=2.57x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.63x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.317, Ratio=2.51x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.330, Ratio=2.68x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.325, Ratio=2.64x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.345, Ratio=2.85x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.331, Ratio=2.71x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.326, Ratio=2.58x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.318, Ratio=2.61x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.68x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.325, Ratio=2.60x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.317, Ratio=2.56x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.332, Ratio=2.59x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.304, Ratio=2.50x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.320, Ratio=2.56x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.79x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.327, Ratio=2.65x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.339, Ratio=2.68x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.322, Ratio=2.53x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.330, Ratio=2.68x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.316, Ratio=2.53x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.311, Ratio=2.46x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.319, Ratio=2.57x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.328, Ratio=2.70x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.321, Ratio=2.54x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.318, Ratio=2.47x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.62x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.322, Ratio=2.60x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.333, Ratio=2.71x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.61x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.333, Ratio=2.67x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.306, Ratio=2.42x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.323, Ratio=2.61x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.321, Ratio=2.57x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.321, Ratio=2.55x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.310, Ratio=2.50x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.58x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.326, Ratio=2.56x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.322, Ratio=2.59x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.335, Ratio=2.63x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.54x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.303, Ratio=2.43x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.74x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.317, Ratio=2.49x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.326, Ratio=2.54x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.67x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.325, Ratio=2.64x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.323, Ratio=2.61x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.327, Ratio=2.66x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.305, Ratio=2.48x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.322, Ratio=2.56x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.320, Ratio=2.57x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.320, Ratio=2.65x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.324, Ratio=2.63x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.311, Ratio=2.54x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.311, Ratio=2.57x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.71x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-2.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.312, Ratio=2.46x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.332, Ratio=2.66x, Gap=-2.633

============================================================
Epoch 12/20 completed in 28.8s
Train: Loss=1.2738 (C:1.2738, R:0.0000) Ratio=2.47x
Val:   Loss=1.2466 (C:1.2466, R:0.0000) Ratio=2.78x
‚úÖ New best model saved (Val Loss: 1.2466)
============================================================

üåç Updating global dataset at epoch 13
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.513 ¬± 0.687
    Neg distances: 1.326 ¬± 0.871
    Separation ratio: 2.58x
    Gap: -2.443
    ‚úÖ Good global separation

Epoch 13 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.340, Ratio=2.60x, Gap=-2.823
Batch   0/537: Loss=1.2445 (C:1.2445, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.334, Ratio=2.65x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.320, Ratio=2.46x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.70x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.344, Ratio=2.63x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.344, Ratio=2.56x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.318, Ratio=2.39x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.342, Ratio=2.63x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.65x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.348, Ratio=2.59x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.331, Ratio=2.45x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.340, Ratio=2.60x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.335, Ratio=2.51x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.325, Ratio=2.47x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.334, Ratio=2.65x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.337, Ratio=2.58x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.329, Ratio=2.51x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.351, Ratio=2.62x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.346, Ratio=2.63x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.338, Ratio=2.55x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.337, Ratio=2.65x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.346, Ratio=2.56x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.334, Ratio=2.57x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.334, Ratio=2.53x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.321, Ratio=2.51x, Gap=-2.806
Batch  25/537: Loss=1.2693 (C:1.2693, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.327, Ratio=2.55x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.324, Ratio=2.44x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.315, Ratio=2.44x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.330, Ratio=2.56x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.326, Ratio=2.47x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.350, Ratio=2.57x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.340, Ratio=2.54x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.338, Ratio=2.46x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.337, Ratio=2.55x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.353, Ratio=2.58x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.336, Ratio=2.62x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.335, Ratio=2.58x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.328, Ratio=2.50x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.333, Ratio=2.54x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.335, Ratio=2.58x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.325, Ratio=2.50x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.343, Ratio=2.61x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.319, Ratio=2.44x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.337, Ratio=2.55x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.343, Ratio=2.50x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.328, Ratio=2.44x, Gap=-2.815
Batch  50/537: Loss=1.2887 (C:1.2887, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.334, Ratio=2.44x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.329, Ratio=2.46x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.368, Ratio=2.72x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.336, Ratio=2.53x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.338, Ratio=2.58x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.339, Ratio=2.58x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.342, Ratio=2.50x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.352, Ratio=2.71x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.319, Ratio=2.50x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.319, Ratio=2.55x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.341, Ratio=2.58x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.339, Ratio=2.58x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.325, Ratio=2.46x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.58x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.339, Ratio=2.56x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.341, Ratio=2.52x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.332, Ratio=2.54x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.334, Ratio=2.55x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.331, Ratio=2.48x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.345, Ratio=2.65x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.336, Ratio=2.54x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-2.790
Batch  75/537: Loss=1.2279 (C:1.2279, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.346, Ratio=2.61x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.332, Ratio=2.56x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.335, Ratio=2.62x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.339, Ratio=2.67x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.341, Ratio=2.58x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.348, Ratio=2.65x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.349, Ratio=2.73x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.343, Ratio=2.54x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.338, Ratio=2.64x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.333, Ratio=2.61x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.335, Ratio=2.53x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.338, Ratio=2.58x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.343, Ratio=2.56x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.336, Ratio=2.57x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.338, Ratio=2.55x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.330, Ratio=2.53x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.350, Ratio=2.64x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.350, Ratio=2.63x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.348, Ratio=2.61x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.350, Ratio=2.69x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.334, Ratio=2.54x, Gap=-2.661
Batch 100/537: Loss=1.2594 (C:1.2594, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.325, Ratio=2.45x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.337, Ratio=2.61x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.316, Ratio=2.47x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.340, Ratio=2.59x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.324, Ratio=2.52x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.331, Ratio=2.49x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.333, Ratio=2.59x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.335, Ratio=2.56x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.323, Ratio=2.43x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.351, Ratio=2.68x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.331, Ratio=2.50x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.317, Ratio=2.51x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.340, Ratio=2.60x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.335, Ratio=2.54x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.339, Ratio=2.55x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.350, Ratio=2.60x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.320, Ratio=2.49x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.326, Ratio=2.47x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.344, Ratio=2.62x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.335, Ratio=2.51x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.327, Ratio=2.48x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.75x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.709
Batch 125/537: Loss=1.2531 (C:1.2531, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.346, Ratio=2.64x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.324, Ratio=2.48x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.343, Ratio=2.61x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.330, Ratio=2.59x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.325, Ratio=2.53x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.55x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.329, Ratio=2.55x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.319, Ratio=2.43x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.334, Ratio=2.63x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.324, Ratio=2.48x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.336, Ratio=2.58x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.338, Ratio=2.61x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.328, Ratio=2.57x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.343, Ratio=2.63x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.342, Ratio=2.60x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.355, Ratio=2.67x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.338, Ratio=2.52x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.329, Ratio=2.53x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.335, Ratio=2.53x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.333, Ratio=2.50x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.335, Ratio=2.56x, Gap=-2.638
Batch 150/537: Loss=1.2561 (C:1.2561, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.328, Ratio=2.55x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.330, Ratio=2.53x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.325, Ratio=2.45x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.332, Ratio=2.53x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.58x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.325, Ratio=2.49x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.59x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.333, Ratio=2.48x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.334, Ratio=2.62x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.348, Ratio=2.65x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.349, Ratio=2.63x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.332, Ratio=2.52x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.330, Ratio=2.50x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.331, Ratio=2.55x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.345, Ratio=2.62x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.326, Ratio=2.51x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.342, Ratio=2.63x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.328, Ratio=2.57x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.337, Ratio=2.56x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.336, Ratio=2.55x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.319, Ratio=2.38x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.324, Ratio=2.46x, Gap=-2.683
Batch 175/537: Loss=1.2826 (C:1.2826, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.346, Ratio=2.65x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.330, Ratio=2.51x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.60x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.332, Ratio=2.54x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.326, Ratio=2.63x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.325, Ratio=2.47x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.318, Ratio=2.51x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.338, Ratio=2.57x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.331, Ratio=2.49x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.335, Ratio=2.56x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.335, Ratio=2.56x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.314, Ratio=2.45x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.330, Ratio=2.51x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.337, Ratio=2.52x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.331, Ratio=2.51x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.334, Ratio=2.46x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.330, Ratio=2.53x, Gap=-3.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.312, Ratio=2.42x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.341, Ratio=2.57x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.323, Ratio=2.49x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.324, Ratio=2.47x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.329, Ratio=2.51x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.323, Ratio=2.52x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.325, Ratio=2.55x, Gap=-2.770
Batch 200/537: Loss=1.2632 (C:1.2632, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.335, Ratio=2.46x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.71x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.317, Ratio=2.45x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.331, Ratio=2.53x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.339, Ratio=2.52x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.319, Ratio=2.45x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.354, Ratio=2.65x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.348, Ratio=2.60x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.329, Ratio=2.47x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.356, Ratio=2.65x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.317, Ratio=2.45x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.327, Ratio=2.50x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.342, Ratio=2.65x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-2.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.333, Ratio=2.57x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.335, Ratio=2.58x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.69x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.342, Ratio=2.56x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.343, Ratio=2.62x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.326, Ratio=2.52x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.352, Ratio=2.60x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.341, Ratio=2.54x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.626
Batch 225/537: Loss=1.2752 (C:1.2752, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.325, Ratio=2.52x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.340, Ratio=2.61x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.345, Ratio=2.62x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.345, Ratio=2.61x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.59x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.329, Ratio=2.53x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.321, Ratio=2.44x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.337, Ratio=2.55x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.347, Ratio=2.63x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.342, Ratio=2.51x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.325, Ratio=2.47x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.325, Ratio=2.48x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.321, Ratio=2.50x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.322, Ratio=2.44x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.60x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.340, Ratio=2.61x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.332, Ratio=2.56x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.328, Ratio=2.45x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.335, Ratio=2.50x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.336, Ratio=2.52x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.332, Ratio=2.44x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.340, Ratio=2.63x, Gap=-2.724
Batch 250/537: Loss=1.2447 (C:1.2447, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.347, Ratio=2.58x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.325, Ratio=2.44x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.331, Ratio=2.51x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.338, Ratio=2.56x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.315, Ratio=2.40x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.321, Ratio=2.46x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.340, Ratio=2.59x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.326, Ratio=2.49x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.345, Ratio=2.64x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.347, Ratio=2.62x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.319, Ratio=2.43x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.333, Ratio=2.55x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.329, Ratio=2.49x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.63x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.346, Ratio=2.63x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.329, Ratio=2.41x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.343, Ratio=2.59x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.328, Ratio=2.52x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.344, Ratio=2.60x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.340, Ratio=2.56x, Gap=-3.008
Batch 275/537: Loss=1.2524 (C:1.2524, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.327, Ratio=2.48x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.333, Ratio=2.51x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.59x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.334, Ratio=2.58x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.330, Ratio=2.57x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.330, Ratio=2.50x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.67x, Gap=-2.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.331, Ratio=2.61x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.347, Ratio=2.68x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.331, Ratio=2.57x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.344, Ratio=2.64x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.348, Ratio=2.61x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.327, Ratio=2.49x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.330, Ratio=2.41x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.333, Ratio=2.50x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.314, Ratio=2.42x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.325, Ratio=2.50x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.326, Ratio=2.48x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.346, Ratio=2.58x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.319, Ratio=2.44x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.335, Ratio=2.55x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.339, Ratio=2.59x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.339, Ratio=2.56x, Gap=-2.681
Batch 300/537: Loss=1.2504 (C:1.2504, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.337, Ratio=2.55x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.70x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.345, Ratio=2.59x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.342, Ratio=2.51x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.356, Ratio=2.68x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.334, Ratio=2.54x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.348, Ratio=2.58x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.332, Ratio=2.47x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.324, Ratio=2.52x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.330, Ratio=2.61x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.344, Ratio=2.56x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.329, Ratio=2.56x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.330, Ratio=2.54x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.334, Ratio=2.57x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.336, Ratio=2.58x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.327, Ratio=2.50x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.337, Ratio=2.57x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.333, Ratio=2.54x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.324, Ratio=2.54x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.340, Ratio=2.55x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.341, Ratio=2.52x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.345, Ratio=2.56x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.335, Ratio=2.64x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.336, Ratio=2.47x, Gap=-2.898
Batch 325/537: Loss=1.2770 (C:1.2770, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.328, Ratio=2.53x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.329, Ratio=2.51x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.341, Ratio=2.52x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.331, Ratio=2.52x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.329, Ratio=2.52x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.323, Ratio=2.49x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.334, Ratio=2.59x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.347, Ratio=2.61x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.330, Ratio=2.57x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.341, Ratio=2.65x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.58x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.321, Ratio=2.48x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.332, Ratio=2.57x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.339, Ratio=2.60x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.343, Ratio=2.56x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.346, Ratio=2.61x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.312, Ratio=2.42x, Gap=-2.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.337, Ratio=2.57x, Gap=-2.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.339, Ratio=2.62x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.334, Ratio=2.53x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.342, Ratio=2.57x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.345, Ratio=2.60x, Gap=-2.649
Batch 350/537: Loss=1.2424 (C:1.2424, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.333, Ratio=2.50x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.343, Ratio=2.57x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.352, Ratio=2.72x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.337, Ratio=2.50x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.319, Ratio=2.49x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.67x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.349, Ratio=2.63x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.342, Ratio=2.66x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.329, Ratio=2.60x, Gap=-2.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.350, Ratio=2.70x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.343, Ratio=2.53x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.335, Ratio=2.46x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.320, Ratio=2.39x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.56x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.343, Ratio=2.60x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.343, Ratio=2.58x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.355, Ratio=2.61x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.325, Ratio=2.46x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.330, Ratio=2.50x, Gap=-2.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.329, Ratio=2.59x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.341, Ratio=2.58x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.340, Ratio=2.57x, Gap=-2.962
Batch 375/537: Loss=1.2487 (C:1.2487, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.319, Ratio=2.40x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.345, Ratio=2.55x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.332, Ratio=2.49x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.336, Ratio=2.50x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.338, Ratio=2.53x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.334, Ratio=2.55x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.316, Ratio=2.48x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.341, Ratio=2.65x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.320, Ratio=2.46x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.340, Ratio=2.63x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.322, Ratio=2.46x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.333, Ratio=2.58x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.337, Ratio=2.53x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.343, Ratio=2.60x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.340, Ratio=2.47x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.340, Ratio=2.52x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.327, Ratio=2.47x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.328, Ratio=2.42x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.341, Ratio=2.53x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.336, Ratio=2.55x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.322, Ratio=2.52x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.320, Ratio=2.47x, Gap=-2.710
Batch 400/537: Loss=1.2819 (C:1.2819, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.333, Ratio=2.56x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.323, Ratio=2.53x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.333, Ratio=2.48x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.339, Ratio=2.60x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.339, Ratio=2.51x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.76x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.326, Ratio=2.42x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.344, Ratio=2.63x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.327, Ratio=2.48x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.327, Ratio=2.44x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.332, Ratio=2.45x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.341, Ratio=2.60x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.333, Ratio=2.55x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.327, Ratio=2.37x, Gap=-3.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.334, Ratio=2.56x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.56x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.330, Ratio=2.50x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.347, Ratio=2.72x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.335, Ratio=2.62x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.326, Ratio=2.51x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.344, Ratio=2.63x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.323, Ratio=2.50x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.328, Ratio=2.54x, Gap=-2.890
Batch 425/537: Loss=1.2661 (C:1.2661, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.329, Ratio=2.52x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.342, Ratio=2.58x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.335, Ratio=2.54x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.339, Ratio=2.62x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.316, Ratio=2.44x, Gap=-2.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.330, Ratio=2.56x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.353, Ratio=2.77x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.337, Ratio=2.51x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.344, Ratio=2.53x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.344, Ratio=2.57x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.340, Ratio=2.62x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.327, Ratio=2.51x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.332, Ratio=2.46x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.345, Ratio=2.55x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.340, Ratio=2.57x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.329, Ratio=2.56x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.352, Ratio=2.72x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.303, Ratio=2.49x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.333, Ratio=2.49x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.334, Ratio=2.55x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.341, Ratio=2.59x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.341, Ratio=2.60x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.323, Ratio=2.49x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.347, Ratio=2.69x, Gap=-3.010
Batch 450/537: Loss=1.2220 (C:1.2220, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.319, Ratio=2.47x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.334, Ratio=2.47x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.322, Ratio=2.49x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.346, Ratio=2.63x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.344, Ratio=2.59x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.351, Ratio=2.58x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.343, Ratio=2.54x, Gap=-3.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.342, Ratio=2.56x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.317, Ratio=2.44x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.330, Ratio=2.69x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.345, Ratio=2.61x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.335, Ratio=2.54x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.320, Ratio=2.44x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.324, Ratio=2.47x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.345, Ratio=2.53x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.335, Ratio=2.50x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.334, Ratio=2.47x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.342, Ratio=2.50x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.333, Ratio=2.48x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.340, Ratio=2.59x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.341, Ratio=2.57x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.342, Ratio=2.55x, Gap=-2.677
Batch 475/537: Loss=1.2527 (C:1.2527, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.322, Ratio=2.51x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.329, Ratio=2.51x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.335, Ratio=2.60x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.326, Ratio=2.49x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.55x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.323, Ratio=2.46x, Gap=-2.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.345, Ratio=2.59x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.338, Ratio=2.59x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.350, Ratio=2.57x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.333, Ratio=2.50x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.75x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.344, Ratio=2.57x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.322, Ratio=2.41x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.338, Ratio=2.52x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.338, Ratio=2.63x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.347, Ratio=2.67x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.320, Ratio=2.45x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.312, Ratio=2.37x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.302, Ratio=2.31x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.325, Ratio=2.45x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.334, Ratio=2.59x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-2.636
Batch 500/537: Loss=1.2214 (C:1.2214, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.333, Ratio=2.57x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.335, Ratio=2.50x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.332, Ratio=2.45x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.346, Ratio=2.53x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.336, Ratio=2.47x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.343, Ratio=2.47x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.346, Ratio=2.59x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.339, Ratio=2.55x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.321, Ratio=2.49x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.322, Ratio=2.50x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.318, Ratio=2.54x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.337, Ratio=2.59x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.358, Ratio=2.80x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.340, Ratio=2.58x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.339, Ratio=2.59x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.323, Ratio=2.46x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.345, Ratio=2.61x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.317, Ratio=2.46x, Gap=-2.653
Batch 525/537: Loss=1.2828 (C:1.2828, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.324, Ratio=2.44x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.324, Ratio=2.46x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.331, Ratio=2.51x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.332, Ratio=2.52x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.329, Ratio=2.46x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.338, Ratio=2.58x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.351, Ratio=2.67x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.338, Ratio=2.52x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.337, Ratio=2.56x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.357, Ratio=2.74x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.333, Ratio=2.62x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.326, Ratio=2.55x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.68x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.326, Ratio=2.64x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.319, Ratio=2.46x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.351, Ratio=2.81x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.332, Ratio=2.67x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.322, Ratio=2.66x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.330, Ratio=2.66x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.342, Ratio=2.68x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.320, Ratio=2.59x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.87x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.340, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.72x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.338, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.337, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.329, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.355, Ratio=2.83x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.80x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.343, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.332, Ratio=2.63x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.327, Ratio=2.72x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.339, Ratio=2.59x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.328, Ratio=2.65x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.355, Ratio=2.92x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.328, Ratio=2.61x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.341, Ratio=2.80x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.75x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.335, Ratio=2.64x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.350, Ratio=2.76x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.63x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.337, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.345, Ratio=2.73x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.328, Ratio=2.70x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.344, Ratio=2.77x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.336, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.346, Ratio=2.77x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.55x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.341, Ratio=2.73x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.336, Ratio=2.71x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.333, Ratio=2.57x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.340, Ratio=2.72x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.340, Ratio=2.72x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.328, Ratio=2.71x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.334, Ratio=2.70x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.64x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.309, Ratio=2.50x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.337, Ratio=2.65x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.59x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.337, Ratio=2.62x, Gap=-2.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.339, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.91x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.341, Ratio=2.78x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.335, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.337, Ratio=2.77x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.321, Ratio=2.59x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.330, Ratio=2.72x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.326, Ratio=2.66x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.335, Ratio=2.69x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.67x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.341, Ratio=2.77x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.66x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.319, Ratio=2.59x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.66x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.345, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.56x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.337, Ratio=2.74x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.328, Ratio=2.58x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.341, Ratio=2.71x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.326, Ratio=2.60x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.329, Ratio=2.59x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.341, Ratio=2.70x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.341, Ratio=2.69x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.340, Ratio=2.68x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.77x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.332, Ratio=2.63x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.335, Ratio=2.68x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.337, Ratio=2.69x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.340, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.331, Ratio=2.62x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.321, Ratio=2.58x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.338, Ratio=2.76x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.73x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.71x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.342, Ratio=2.67x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.346, Ratio=2.81x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.348, Ratio=2.87x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.76x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.328, Ratio=2.65x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.361, Ratio=2.84x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.343, Ratio=2.73x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.325, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.74x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.91x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.75x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.317, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.356, Ratio=2.85x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.332, Ratio=2.68x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.319, Ratio=2.59x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.311, Ratio=2.55x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.322, Ratio=2.61x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.329, Ratio=2.60x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.329, Ratio=2.64x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.55x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.346, Ratio=2.82x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.336, Ratio=2.78x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.79x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.76x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.308, Ratio=2.56x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.326, Ratio=2.62x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.334, Ratio=2.63x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.325, Ratio=2.56x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.321, Ratio=2.68x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.321, Ratio=2.56x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.329, Ratio=2.58x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.338, Ratio=2.65x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.71x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.331, Ratio=2.63x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.334, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.339, Ratio=2.69x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.344, Ratio=2.78x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.341, Ratio=2.72x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.341, Ratio=2.79x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.337, Ratio=2.62x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.82x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.334, Ratio=2.68x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.339, Ratio=2.75x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.341, Ratio=2.69x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.318, Ratio=2.52x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.342, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.66x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.338, Ratio=2.78x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.330, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.327, Ratio=2.60x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.346, Ratio=2.87x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.69x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.329, Ratio=2.63x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.330, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.319, Ratio=2.56x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.64x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.72x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.316, Ratio=2.54x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.80x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.327, Ratio=2.61x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.333, Ratio=2.72x, Gap=-2.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.322, Ratio=2.57x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.344, Ratio=2.68x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.334, Ratio=2.61x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.337, Ratio=2.66x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.338, Ratio=2.63x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.330, Ratio=2.76x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.332, Ratio=2.70x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.70x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.329, Ratio=2.62x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.341, Ratio=2.80x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.338, Ratio=2.72x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.330, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.362, Ratio=2.91x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.342, Ratio=2.76x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.345, Ratio=2.72x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.317, Ratio=2.52x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.80x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.331, Ratio=2.62x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.319, Ratio=2.62x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.321, Ratio=2.63x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.320, Ratio=2.53x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.348, Ratio=2.77x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.339, Ratio=2.63x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.344, Ratio=2.80x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.330, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.318, Ratio=2.53x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.334, Ratio=2.70x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.322, Ratio=2.63x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.323, Ratio=2.68x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.76x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.81x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.342, Ratio=2.71x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.338, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.341, Ratio=2.85x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.70x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.339, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.350, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.72x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.337, Ratio=2.61x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.327, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.332, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.351, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.326, Ratio=2.61x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.329, Ratio=2.69x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.336, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.336, Ratio=2.72x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.345, Ratio=2.80x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.337, Ratio=2.69x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.328, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.346, Ratio=2.94x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.344, Ratio=2.78x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.329, Ratio=2.67x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.339, Ratio=2.74x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.352, Ratio=2.90x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.74x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.351, Ratio=2.80x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.347, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.315, Ratio=2.56x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.330, Ratio=2.60x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.339, Ratio=2.64x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.342, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.85x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.346, Ratio=2.81x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.336, Ratio=2.62x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.333, Ratio=2.59x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.69x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.72x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.328, Ratio=2.66x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.326, Ratio=2.70x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.341, Ratio=2.72x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.338, Ratio=2.66x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.323, Ratio=2.66x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.87x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.330, Ratio=2.57x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.335, Ratio=2.72x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.339, Ratio=2.81x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.352, Ratio=2.79x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.76x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.331, Ratio=2.62x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.350, Ratio=2.76x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.344, Ratio=2.77x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.69x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.337, Ratio=2.67x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.337, Ratio=2.61x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.325, Ratio=2.61x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.324, Ratio=2.54x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.342, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.338, Ratio=2.66x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.322, Ratio=2.57x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.322, Ratio=2.58x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.334, Ratio=2.72x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.327, Ratio=2.64x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.332, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.75x, Gap=-2.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.340, Ratio=2.75x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.334, Ratio=2.71x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.340, Ratio=2.69x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.340, Ratio=2.71x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.327, Ratio=2.59x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.350, Ratio=2.85x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.339, Ratio=2.64x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.71x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.76x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.336, Ratio=2.63x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.348, Ratio=2.72x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.331, Ratio=2.62x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.345, Ratio=2.73x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.326, Ratio=2.72x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.60x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.324, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.343, Ratio=2.67x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.341, Ratio=2.69x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.323, Ratio=2.58x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.76x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.77x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.340, Ratio=2.84x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.89x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.331, Ratio=2.71x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.325, Ratio=2.54x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.347, Ratio=2.75x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.67x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.341, Ratio=2.81x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.327, Ratio=2.67x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.342, Ratio=2.72x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.329, Ratio=2.70x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.343, Ratio=2.82x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.67x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.327, Ratio=2.62x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.336, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.330, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.332, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.328, Ratio=2.62x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.90x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.334, Ratio=2.67x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.324, Ratio=2.62x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.331, Ratio=2.66x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.336, Ratio=2.79x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.69x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.324, Ratio=2.61x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.325, Ratio=2.60x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.330, Ratio=2.64x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.336, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.332, Ratio=2.68x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.329, Ratio=2.54x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.347, Ratio=2.79x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.348, Ratio=2.91x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.331, Ratio=2.68x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.341, Ratio=2.79x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.334, Ratio=2.72x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.331, Ratio=2.74x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.71x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.339, Ratio=2.82x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.327, Ratio=2.59x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.351, Ratio=2.78x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.76x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.339, Ratio=2.67x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.325, Ratio=2.67x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.332, Ratio=2.70x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.325, Ratio=2.68x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.341, Ratio=2.71x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.352, Ratio=2.81x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.355, Ratio=2.80x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.79x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.338, Ratio=2.76x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.341, Ratio=2.71x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.342, Ratio=2.65x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.66x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.340, Ratio=2.75x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.327, Ratio=2.53x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.333, Ratio=2.67x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.78x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.355, Ratio=2.85x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.355, Ratio=2.84x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.56x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.86x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.332, Ratio=2.58x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.346, Ratio=2.79x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.330, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.66x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.323, Ratio=2.55x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.344, Ratio=2.81x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.336, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.337, Ratio=2.72x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.339, Ratio=2.66x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.339, Ratio=2.82x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.323, Ratio=2.67x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.339, Ratio=2.75x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.76x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.87x, Gap=-2.412

============================================================
Epoch 13/20 completed in 34.0s
Train: Loss=1.2577 (C:1.2577, R:0.0000) Ratio=2.51x
Val:   Loss=1.2269 (C:1.2269, R:0.0000) Ratio=2.89x
‚úÖ New best model saved (Val Loss: 1.2269)
============================================================

Epoch 14 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.345, Ratio=2.61x, Gap=-2.845
Batch   0/537: Loss=1.2419 (C:1.2419, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.342, Ratio=2.56x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.339, Ratio=2.55x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.65x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.321, Ratio=2.53x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.334, Ratio=2.49x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.352, Ratio=2.68x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.359, Ratio=2.74x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.339, Ratio=2.56x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.332, Ratio=2.53x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.326, Ratio=2.57x, Gap=-2.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.309, Ratio=2.47x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.340, Ratio=2.60x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.334, Ratio=2.60x, Gap=-2.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.349, Ratio=2.72x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.332, Ratio=2.53x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.339, Ratio=2.60x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.332, Ratio=2.52x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.352, Ratio=2.67x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.339, Ratio=2.52x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.324, Ratio=2.45x, Gap=-2.905
Batch  25/537: Loss=1.2866 (C:1.2866, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.349, Ratio=2.64x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.344, Ratio=2.59x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.334, Ratio=2.56x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.58x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.336, Ratio=2.63x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.342, Ratio=2.68x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.338, Ratio=2.58x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.360, Ratio=2.63x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.339, Ratio=2.51x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.335, Ratio=2.45x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.350, Ratio=2.65x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.338, Ratio=2.53x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.339, Ratio=2.52x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.337, Ratio=2.61x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.337, Ratio=2.59x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.334, Ratio=2.58x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.353, Ratio=2.68x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.335, Ratio=2.57x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.349, Ratio=2.63x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.345, Ratio=2.57x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.57x, Gap=-2.869
Batch  50/537: Loss=1.2567 (C:1.2567, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.331, Ratio=2.53x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.343, Ratio=2.65x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.59x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.60x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.323, Ratio=2.50x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.334, Ratio=2.51x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.346, Ratio=2.60x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.336, Ratio=2.47x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.338, Ratio=2.52x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.338, Ratio=2.53x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.354, Ratio=2.59x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.331, Ratio=2.48x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.55x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.348, Ratio=2.71x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.352, Ratio=2.66x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.330, Ratio=2.56x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.344, Ratio=2.63x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.334, Ratio=2.55x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.354, Ratio=2.71x, Gap=-2.637
Batch  75/537: Loss=1.2166 (C:1.2166, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.328, Ratio=2.54x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.326, Ratio=2.44x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.336, Ratio=2.57x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.346, Ratio=2.69x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.353, Ratio=2.67x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.339, Ratio=2.62x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.328, Ratio=2.45x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.331, Ratio=2.55x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.344, Ratio=2.58x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.325, Ratio=2.46x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.330, Ratio=2.59x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.339, Ratio=2.56x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.56x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.341, Ratio=2.62x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.343, Ratio=2.62x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.329, Ratio=2.54x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.318, Ratio=2.38x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.355, Ratio=2.79x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.333, Ratio=2.53x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.342, Ratio=2.58x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.343, Ratio=2.62x, Gap=-2.668
Batch 100/537: Loss=1.2406 (C:1.2406, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.329, Ratio=2.52x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.365, Ratio=2.71x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.340, Ratio=2.59x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.334, Ratio=2.59x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.351, Ratio=2.71x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.313, Ratio=2.45x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.331, Ratio=2.61x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.68x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.323, Ratio=2.45x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.321, Ratio=2.51x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.335, Ratio=2.48x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.327, Ratio=2.53x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.356, Ratio=2.63x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.346, Ratio=2.69x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.326, Ratio=2.46x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.344, Ratio=2.66x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.351, Ratio=2.78x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.331, Ratio=2.54x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.323, Ratio=2.47x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.79x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.330, Ratio=2.54x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.328, Ratio=2.60x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.346, Ratio=2.61x, Gap=-2.725
Batch 125/537: Loss=1.2410 (C:1.2410, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.329, Ratio=2.58x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.328, Ratio=2.61x, Gap=-2.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.334, Ratio=2.50x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.334, Ratio=2.64x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.348, Ratio=2.61x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.334, Ratio=2.60x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.336, Ratio=2.61x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.344, Ratio=2.57x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.350, Ratio=2.64x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.333, Ratio=2.60x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.327, Ratio=2.51x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.336, Ratio=2.53x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.329, Ratio=2.48x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.324, Ratio=2.59x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.349, Ratio=2.69x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.347, Ratio=2.66x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.359, Ratio=2.73x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.337, Ratio=2.51x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.343, Ratio=2.56x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.347, Ratio=2.59x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.329, Ratio=2.40x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.335, Ratio=2.60x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.352, Ratio=2.70x, Gap=-2.796
Batch 150/537: Loss=1.2201 (C:1.2201, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.332, Ratio=2.58x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.341, Ratio=2.60x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.331, Ratio=2.58x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.343, Ratio=2.58x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.325, Ratio=2.46x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.312, Ratio=2.43x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.341, Ratio=2.72x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.328, Ratio=2.50x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.356, Ratio=2.77x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.325, Ratio=2.49x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.329, Ratio=2.55x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.318, Ratio=2.50x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.341, Ratio=2.57x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.346, Ratio=2.63x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.326, Ratio=2.50x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.350, Ratio=2.65x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.359, Ratio=2.75x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.338, Ratio=2.44x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.322, Ratio=2.47x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.329, Ratio=2.48x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.338, Ratio=2.59x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.345, Ratio=2.73x, Gap=-2.761
Batch 175/537: Loss=1.2177 (C:1.2177, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.345, Ratio=2.64x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.339, Ratio=2.64x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.351, Ratio=2.72x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.341, Ratio=2.62x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.333, Ratio=2.53x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.331, Ratio=2.55x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.324, Ratio=2.47x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.326, Ratio=2.46x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.357, Ratio=2.65x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.348, Ratio=2.65x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.336, Ratio=2.57x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.333, Ratio=2.56x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.331, Ratio=2.52x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.323, Ratio=2.53x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.346, Ratio=2.58x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.346, Ratio=2.62x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.329, Ratio=2.40x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.327, Ratio=2.53x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.337, Ratio=2.60x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.339, Ratio=2.54x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.330, Ratio=2.54x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.334, Ratio=2.44x, Gap=-3.001
Batch 200/537: Loss=1.2831 (C:1.2831, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.59x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.333, Ratio=2.53x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.347, Ratio=2.64x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.346, Ratio=2.62x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.353, Ratio=2.66x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.330, Ratio=2.51x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.327, Ratio=2.49x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.333, Ratio=2.55x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.344, Ratio=2.59x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.339, Ratio=2.51x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.353, Ratio=2.64x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.343, Ratio=2.59x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.342, Ratio=2.54x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.339, Ratio=2.66x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.326, Ratio=2.52x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.326, Ratio=2.47x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.60x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.337, Ratio=2.56x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.340, Ratio=2.60x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.324, Ratio=2.46x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.334, Ratio=2.53x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.325, Ratio=2.51x, Gap=-2.637
Batch 225/537: Loss=1.2720 (C:1.2720, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.351, Ratio=2.60x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.341, Ratio=2.64x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.351, Ratio=2.59x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.326, Ratio=2.58x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.345, Ratio=2.60x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.341, Ratio=2.59x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.339, Ratio=2.60x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.340, Ratio=2.55x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.323, Ratio=2.41x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.339, Ratio=2.61x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.351, Ratio=2.59x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.307, Ratio=2.34x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.328, Ratio=2.52x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.337, Ratio=2.59x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.341, Ratio=2.59x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.336, Ratio=2.62x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.345, Ratio=2.61x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.327, Ratio=2.50x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.329, Ratio=2.48x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.341, Ratio=2.59x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.317, Ratio=2.43x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.328, Ratio=2.45x, Gap=-2.792
Batch 250/537: Loss=1.2813 (C:1.2813, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.73x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.333, Ratio=2.51x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.336, Ratio=2.62x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.326, Ratio=2.46x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.342, Ratio=2.52x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.328, Ratio=2.49x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.340, Ratio=2.53x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.322, Ratio=2.52x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.334, Ratio=2.54x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.342, Ratio=2.66x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.356, Ratio=2.69x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.349, Ratio=2.68x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.341, Ratio=2.52x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.334, Ratio=2.49x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.345, Ratio=2.62x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.327, Ratio=2.47x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.321, Ratio=2.50x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.336, Ratio=2.55x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.337, Ratio=2.57x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.336, Ratio=2.51x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.329, Ratio=2.55x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.335, Ratio=2.51x, Gap=-2.811
Batch 275/537: Loss=1.2703 (C:1.2703, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.341, Ratio=2.62x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.328, Ratio=2.57x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.59x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.342, Ratio=2.71x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.342, Ratio=2.70x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.335, Ratio=2.52x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.332, Ratio=2.47x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.318, Ratio=2.46x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.349, Ratio=2.60x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.334, Ratio=2.51x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.329, Ratio=2.42x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.343, Ratio=2.52x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.352, Ratio=2.68x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.326, Ratio=2.53x, Gap=-2.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.339, Ratio=2.60x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.329, Ratio=2.55x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.325, Ratio=2.54x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.333, Ratio=2.52x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.336, Ratio=2.55x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.327, Ratio=2.52x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.324, Ratio=2.50x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.325, Ratio=2.59x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.319, Ratio=2.42x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.65x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.323, Ratio=2.53x, Gap=-2.752
Batch 300/537: Loss=1.2663 (C:1.2663, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.353, Ratio=2.64x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.331, Ratio=2.50x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.333, Ratio=2.50x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.56x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.335, Ratio=2.48x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.350, Ratio=2.68x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.326, Ratio=2.44x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.320, Ratio=2.51x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.330, Ratio=2.56x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.341, Ratio=2.60x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.357, Ratio=2.72x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.359, Ratio=2.64x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.341, Ratio=2.57x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.336, Ratio=2.52x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.333, Ratio=2.47x, Gap=-2.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.348, Ratio=2.61x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.358, Ratio=2.74x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.336, Ratio=2.51x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.317, Ratio=2.53x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.321, Ratio=2.41x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.65x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.333, Ratio=2.52x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.649
Batch 325/537: Loss=1.2437 (C:1.2437, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.348, Ratio=2.68x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.340, Ratio=2.63x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.353, Ratio=2.63x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.346, Ratio=2.62x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.327, Ratio=2.44x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.340, Ratio=2.59x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.349, Ratio=2.69x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.336, Ratio=2.57x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.337, Ratio=2.56x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.334, Ratio=2.60x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.338, Ratio=2.58x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.339, Ratio=2.57x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.337, Ratio=2.53x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.337, Ratio=2.54x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.364, Ratio=2.77x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.350, Ratio=2.63x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.351, Ratio=2.64x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.57x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.329, Ratio=2.47x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.327, Ratio=2.48x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.351, Ratio=2.60x, Gap=-3.031
Batch 350/537: Loss=1.2402 (C:1.2402, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.339, Ratio=2.59x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.328, Ratio=2.48x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.330, Ratio=2.58x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.345, Ratio=2.66x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.340, Ratio=2.62x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.334, Ratio=2.62x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.345, Ratio=2.63x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.339, Ratio=2.60x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.338, Ratio=2.55x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.324, Ratio=2.48x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.341, Ratio=2.61x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.353, Ratio=2.70x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.60x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.334, Ratio=2.55x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.347, Ratio=2.65x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.337, Ratio=2.55x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.332, Ratio=2.56x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.326, Ratio=2.50x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.331, Ratio=2.49x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.329, Ratio=2.51x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.342, Ratio=2.69x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.331, Ratio=2.53x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.318, Ratio=2.38x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.342, Ratio=2.63x, Gap=-2.785
Batch 375/537: Loss=1.2390 (C:1.2390, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.328, Ratio=2.58x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.342, Ratio=2.63x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.322, Ratio=2.52x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.316, Ratio=2.33x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.330, Ratio=2.52x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.355, Ratio=2.67x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.343, Ratio=2.54x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.343, Ratio=2.59x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.320, Ratio=2.48x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.355, Ratio=2.70x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.337, Ratio=2.52x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.338, Ratio=2.51x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.341, Ratio=2.62x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.348, Ratio=2.62x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.349, Ratio=2.53x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.338, Ratio=2.49x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.341, Ratio=2.54x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.340, Ratio=2.59x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.345, Ratio=2.59x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.322, Ratio=2.43x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.336, Ratio=2.70x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.347, Ratio=2.68x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.330, Ratio=2.53x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.328, Ratio=2.56x, Gap=-2.806
Batch 400/537: Loss=1.2614 (C:1.2614, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.348, Ratio=2.65x, Gap=-2.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.328, Ratio=2.60x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.335, Ratio=2.63x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.330, Ratio=2.56x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.352, Ratio=2.62x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.342, Ratio=2.60x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.346, Ratio=2.55x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.337, Ratio=2.61x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.345, Ratio=2.56x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.330, Ratio=2.50x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.339, Ratio=2.53x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.336, Ratio=2.53x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.341, Ratio=2.56x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.329, Ratio=2.42x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.328, Ratio=2.50x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.344, Ratio=2.63x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.352, Ratio=2.63x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.330, Ratio=2.56x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.308, Ratio=2.42x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.343, Ratio=2.63x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.342, Ratio=2.57x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.334, Ratio=2.54x, Gap=-2.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.339, Ratio=2.63x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.320, Ratio=2.54x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.339, Ratio=2.58x, Gap=-2.862
Batch 425/537: Loss=1.2491 (C:1.2491, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.325, Ratio=2.45x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.331, Ratio=2.53x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.335, Ratio=2.47x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.348, Ratio=2.63x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.321, Ratio=2.44x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.315, Ratio=2.39x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.332, Ratio=2.53x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.319, Ratio=2.46x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.344, Ratio=2.61x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.352, Ratio=2.74x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.346, Ratio=2.64x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.315, Ratio=2.46x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.340, Ratio=2.57x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.333, Ratio=2.55x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.343, Ratio=2.58x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.348, Ratio=2.62x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.326, Ratio=2.41x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.348, Ratio=2.73x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.338, Ratio=2.73x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.349, Ratio=2.83x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.325, Ratio=2.40x, Gap=-2.778
Batch 450/537: Loss=1.2992 (C:1.2992, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.332, Ratio=2.53x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.356, Ratio=2.78x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.330, Ratio=2.48x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.322, Ratio=2.39x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.328, Ratio=2.48x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.338, Ratio=2.59x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.342, Ratio=2.51x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.343, Ratio=2.60x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.346, Ratio=2.56x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.347, Ratio=2.55x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.356, Ratio=2.69x, Gap=-2.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.339, Ratio=2.66x, Gap=-2.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.324, Ratio=2.50x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.330, Ratio=2.55x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.313, Ratio=2.41x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.334, Ratio=2.52x, Gap=-3.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.331, Ratio=2.54x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.344, Ratio=2.61x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.338, Ratio=2.51x, Gap=-2.676
Batch 475/537: Loss=1.2669 (C:1.2669, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.337, Ratio=2.55x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.336, Ratio=2.57x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.324, Ratio=2.45x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.320, Ratio=2.55x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.323, Ratio=2.52x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.321, Ratio=2.46x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.59x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.331, Ratio=2.53x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.318, Ratio=2.42x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.61x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.334, Ratio=2.51x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.328, Ratio=2.48x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.321, Ratio=2.45x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.340, Ratio=2.60x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.336, Ratio=2.58x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.337, Ratio=2.55x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.330, Ratio=2.55x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.349, Ratio=2.67x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.348, Ratio=2.60x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.340, Ratio=2.55x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.343, Ratio=2.63x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.346, Ratio=2.56x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.345, Ratio=2.65x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.66x, Gap=-2.720
Batch 500/537: Loss=1.2310 (C:1.2310, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.330, Ratio=2.61x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.333, Ratio=2.60x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.344, Ratio=2.58x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.322, Ratio=2.50x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.352, Ratio=2.56x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.350, Ratio=2.70x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.326, Ratio=2.51x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.346, Ratio=2.59x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.341, Ratio=2.61x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.334, Ratio=2.55x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.318, Ratio=2.46x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.335, Ratio=2.51x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.335, Ratio=2.54x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.347, Ratio=2.57x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.352, Ratio=2.65x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.319, Ratio=2.42x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.338, Ratio=2.56x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.67x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.324, Ratio=2.49x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.327, Ratio=2.59x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.352, Ratio=2.70x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.344, Ratio=2.61x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.346, Ratio=2.63x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.334, Ratio=2.48x, Gap=-2.816
Batch 525/537: Loss=1.2739 (C:1.2739, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.328, Ratio=2.49x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.355, Ratio=2.74x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.322, Ratio=2.48x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.343, Ratio=2.62x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.347, Ratio=2.65x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.343, Ratio=2.63x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.339, Ratio=2.58x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.355, Ratio=2.71x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.346, Ratio=2.51x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.334, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.331, Ratio=2.64x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.325, Ratio=2.60x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.338, Ratio=2.65x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.349, Ratio=2.69x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.346, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.334, Ratio=2.65x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.66x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.342, Ratio=2.67x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.333, Ratio=2.73x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.352, Ratio=2.88x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.334, Ratio=2.61x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.350, Ratio=2.85x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.358, Ratio=2.93x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.331, Ratio=2.60x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.344, Ratio=2.79x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.343, Ratio=2.80x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.347, Ratio=2.76x, Gap=-2.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.359, Ratio=3.03x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.332, Ratio=2.76x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.337, Ratio=2.61x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.331, Ratio=2.59x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.339, Ratio=2.71x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.70x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.346, Ratio=2.77x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.330, Ratio=2.67x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.341, Ratio=2.68x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.73x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.324, Ratio=2.58x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.340, Ratio=2.64x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.336, Ratio=2.75x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.329, Ratio=2.72x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.342, Ratio=2.78x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.357, Ratio=2.87x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.333, Ratio=2.68x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.343, Ratio=2.72x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.74x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.341, Ratio=2.66x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.338, Ratio=2.79x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.328, Ratio=2.67x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.77x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.335, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.346, Ratio=2.77x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.336, Ratio=2.75x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.347, Ratio=2.72x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.352, Ratio=2.79x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.74x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.341, Ratio=2.74x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.339, Ratio=2.63x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.71x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.337, Ratio=2.78x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.348, Ratio=2.84x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.77x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.341, Ratio=2.83x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.346, Ratio=2.80x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.357, Ratio=2.86x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.342, Ratio=2.68x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.72x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.77x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.333, Ratio=2.67x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.350, Ratio=2.84x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.334, Ratio=2.72x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.337, Ratio=2.66x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.339, Ratio=2.70x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.339, Ratio=2.62x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.93x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.353, Ratio=2.78x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.341, Ratio=2.78x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.351, Ratio=2.78x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.342, Ratio=2.69x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.80x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.352, Ratio=2.81x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.367, Ratio=2.88x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.82x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.341, Ratio=2.79x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.343, Ratio=2.73x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.350, Ratio=2.85x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.351, Ratio=2.81x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.346, Ratio=2.81x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.342, Ratio=2.68x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.332, Ratio=2.62x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.341, Ratio=2.75x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.346, Ratio=2.80x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.332, Ratio=2.65x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.339, Ratio=2.75x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.78x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.352, Ratio=2.75x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.345, Ratio=2.63x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.71x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.327, Ratio=2.56x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.334, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.342, Ratio=2.81x, Gap=-2.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.92x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.68x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.79x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.328, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.77x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.351, Ratio=2.68x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.83x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.345, Ratio=2.75x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.346, Ratio=2.73x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.75x, Gap=-2.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.347, Ratio=2.75x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.332, Ratio=2.61x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.325, Ratio=2.62x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.74x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.343, Ratio=2.77x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.331, Ratio=2.65x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.332, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.64x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.341, Ratio=2.76x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.82x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.75x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.328, Ratio=2.57x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.344, Ratio=2.77x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.349, Ratio=2.82x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.357, Ratio=2.98x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.339, Ratio=2.67x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.77x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.333, Ratio=2.61x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.322, Ratio=2.59x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.343, Ratio=2.70x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.337, Ratio=2.64x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.330, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.339, Ratio=2.70x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.345, Ratio=2.77x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.332, Ratio=2.71x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.336, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.339, Ratio=2.67x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.77x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.335, Ratio=2.58x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.337, Ratio=2.62x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.342, Ratio=2.71x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.338, Ratio=2.76x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.334, Ratio=2.65x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.330, Ratio=2.61x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.347, Ratio=2.85x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.340, Ratio=2.67x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.345, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.345, Ratio=2.77x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.66x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.338, Ratio=2.61x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.338, Ratio=2.83x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.336, Ratio=2.72x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.75x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.326, Ratio=2.51x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.335, Ratio=2.66x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.68x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.353, Ratio=2.72x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.79x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.76x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.341, Ratio=2.71x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.333, Ratio=2.74x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.87x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.69x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.336, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.78x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.351, Ratio=2.78x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.364, Ratio=2.89x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.345, Ratio=2.86x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.342, Ratio=2.71x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.332, Ratio=2.71x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.75x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.324, Ratio=2.51x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.354, Ratio=2.90x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.68x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.354, Ratio=2.85x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.331, Ratio=2.60x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.356, Ratio=2.81x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.350, Ratio=2.78x, Gap=-2.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.75x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.333, Ratio=2.72x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.332, Ratio=2.62x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.343, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.73x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.87x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.75x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.347, Ratio=2.75x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.336, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.335, Ratio=2.61x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.340, Ratio=2.64x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.78x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.328, Ratio=2.58x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.358, Ratio=2.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.334, Ratio=2.63x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.327, Ratio=2.72x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.334, Ratio=2.59x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.81x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.331, Ratio=2.69x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.324, Ratio=2.63x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.345, Ratio=2.77x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.76x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.345, Ratio=2.72x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.333, Ratio=2.73x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.361, Ratio=2.81x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.335, Ratio=2.62x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.329, Ratio=2.70x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.350, Ratio=2.86x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.321, Ratio=2.67x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.337, Ratio=2.66x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.340, Ratio=2.74x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.319, Ratio=2.60x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.344, Ratio=2.81x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.334, Ratio=2.58x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.352, Ratio=2.84x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.329, Ratio=2.60x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.80x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.337, Ratio=2.69x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.337, Ratio=2.63x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.78x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.67x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.338, Ratio=2.72x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.336, Ratio=2.76x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.331, Ratio=2.63x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-2.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.334, Ratio=2.64x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.334, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.331, Ratio=2.68x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.338, Ratio=2.74x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.348, Ratio=2.72x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.353, Ratio=2.93x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.354, Ratio=2.87x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.83x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.337, Ratio=2.83x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.335, Ratio=2.61x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.327, Ratio=2.56x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.354, Ratio=2.82x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.338, Ratio=2.60x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.349, Ratio=2.69x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.341, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.348, Ratio=2.87x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.341, Ratio=2.64x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.340, Ratio=2.69x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.343, Ratio=2.88x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.331, Ratio=2.73x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.339, Ratio=2.78x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.340, Ratio=2.69x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.332, Ratio=2.74x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.341, Ratio=2.66x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.332, Ratio=2.68x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.345, Ratio=2.75x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.339, Ratio=2.69x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.64x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.74x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.338, Ratio=2.68x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.334, Ratio=2.75x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.71x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.335, Ratio=2.68x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.329, Ratio=2.76x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.69x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.354, Ratio=2.93x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.66x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.66x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.358, Ratio=2.90x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.345, Ratio=2.77x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.80x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.343, Ratio=2.68x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.71x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.339, Ratio=2.79x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.329, Ratio=2.72x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.329, Ratio=2.65x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.342, Ratio=2.79x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.335, Ratio=2.64x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.334, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.326, Ratio=2.65x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.343, Ratio=2.70x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.332, Ratio=2.64x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.337, Ratio=2.68x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.345, Ratio=2.69x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.351, Ratio=2.78x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.347, Ratio=2.86x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.346, Ratio=2.73x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.83x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.342, Ratio=2.72x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.349, Ratio=2.79x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.70x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.329, Ratio=2.66x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.71x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.347, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.330, Ratio=2.72x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.66x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.339, Ratio=2.70x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.347, Ratio=2.80x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.71x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.73x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.325, Ratio=2.57x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.76x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.339, Ratio=2.68x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.340, Ratio=2.71x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.338, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.334, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.333, Ratio=2.70x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.326, Ratio=2.60x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.319, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.335, Ratio=2.76x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.339, Ratio=2.63x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.338, Ratio=2.67x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.347, Ratio=2.85x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.73x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.348, Ratio=2.84x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.330, Ratio=2.62x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.353, Ratio=2.83x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.336, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.64x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.328, Ratio=2.66x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.345, Ratio=2.88x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.338, Ratio=2.68x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.329, Ratio=2.71x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.334, Ratio=2.63x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.341, Ratio=2.71x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.342, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.330, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.336, Ratio=2.74x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.335, Ratio=2.81x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.340, Ratio=2.67x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.329, Ratio=2.64x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.338, Ratio=2.81x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.336, Ratio=2.64x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.348, Ratio=2.73x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.350, Ratio=2.82x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.359, Ratio=2.95x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.356, Ratio=2.96x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.346, Ratio=2.72x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.67x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.73x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.322, Ratio=2.56x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.345, Ratio=2.73x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.349, Ratio=2.82x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.329, Ratio=2.63x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.339, Ratio=2.78x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.343, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.340, Ratio=2.64x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.329, Ratio=2.69x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.333, Ratio=2.66x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.348, Ratio=2.69x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.334, Ratio=2.62x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.350, Ratio=2.78x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.340, Ratio=2.72x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.342, Ratio=2.78x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.343, Ratio=2.71x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.333, Ratio=2.61x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.346, Ratio=2.88x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.336, Ratio=2.68x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.344, Ratio=2.74x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.337, Ratio=2.67x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.350, Ratio=2.82x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.342, Ratio=2.79x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.338, Ratio=2.66x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.345, Ratio=2.73x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.81x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.335, Ratio=2.69x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.343, Ratio=2.79x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.59x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.350, Ratio=2.72x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.359, Ratio=2.88x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.325, Ratio=2.58x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.333, Ratio=2.76x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.343, Ratio=2.75x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.327, Ratio=2.62x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.342, Ratio=2.83x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.443

============================================================
Epoch 14/20 completed in 29.1s
Train: Loss=1.2526 (C:1.2526, R:0.0000) Ratio=2.55x
Val:   Loss=1.2217 (C:1.2217, R:0.0000) Ratio=2.96x
‚úÖ New best model saved (Val Loss: 1.2217)
============================================================

Epoch 15 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.345, Ratio=2.65x, Gap=-2.803
Batch   0/537: Loss=1.2370 (C:1.2370, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.325, Ratio=2.50x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.333, Ratio=2.55x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.347, Ratio=2.70x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.339, Ratio=2.72x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.347, Ratio=2.74x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.354, Ratio=2.78x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.361, Ratio=2.72x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.323, Ratio=2.47x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.347, Ratio=2.64x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.337, Ratio=2.55x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.352, Ratio=2.61x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.66x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.331, Ratio=2.63x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.354, Ratio=2.73x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.341, Ratio=2.52x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.344, Ratio=2.59x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.354, Ratio=2.71x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.331, Ratio=2.59x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.346, Ratio=2.67x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.341, Ratio=2.62x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.757
Batch  25/537: Loss=1.2079 (C:1.2079, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.66x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.345, Ratio=2.61x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.334, Ratio=2.53x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.332, Ratio=2.55x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.338, Ratio=2.56x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.349, Ratio=2.58x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.341, Ratio=2.61x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.332, Ratio=2.59x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.349, Ratio=2.59x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.339, Ratio=2.58x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.339, Ratio=2.57x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.69x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.338, Ratio=2.56x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.348, Ratio=2.69x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.343, Ratio=2.61x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.337, Ratio=2.63x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.348, Ratio=2.64x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.335, Ratio=2.60x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.346, Ratio=2.66x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.343, Ratio=2.57x, Gap=-2.879
Batch  50/537: Loss=1.2556 (C:1.2556, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.355, Ratio=2.60x, Gap=-2.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.344, Ratio=2.54x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.331, Ratio=2.52x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.349, Ratio=2.62x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.325, Ratio=2.48x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.336, Ratio=2.63x, Gap=-3.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.323, Ratio=2.48x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.328, Ratio=2.50x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.340, Ratio=2.63x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.343, Ratio=2.63x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.345, Ratio=2.62x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.334, Ratio=2.52x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.341, Ratio=2.65x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.346, Ratio=2.54x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.356, Ratio=2.70x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.340, Ratio=2.53x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.333, Ratio=2.52x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.343, Ratio=2.67x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.343, Ratio=2.64x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.332, Ratio=2.56x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.330, Ratio=2.49x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-3.017
Batch  75/537: Loss=1.2232 (C:1.2232, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.327, Ratio=2.52x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.338, Ratio=2.56x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.345, Ratio=2.66x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.330, Ratio=2.50x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.333, Ratio=2.54x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.349, Ratio=2.63x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.346, Ratio=2.64x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.335, Ratio=2.50x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.336, Ratio=2.53x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.351, Ratio=2.64x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.335, Ratio=2.55x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.347, Ratio=2.63x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.334, Ratio=2.59x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.344, Ratio=2.63x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.334, Ratio=2.58x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.335, Ratio=2.60x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.354, Ratio=2.65x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.72x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.357, Ratio=2.65x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.353, Ratio=2.66x, Gap=-2.731
Batch 100/537: Loss=1.2280 (C:1.2280, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.330, Ratio=2.53x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.357, Ratio=2.69x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.339, Ratio=2.55x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.329, Ratio=2.52x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.353, Ratio=2.78x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.336, Ratio=2.69x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.333, Ratio=2.55x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.325, Ratio=2.53x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.331, Ratio=2.53x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.333, Ratio=2.52x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.334, Ratio=2.57x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.344, Ratio=2.61x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.354, Ratio=2.68x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.354, Ratio=2.68x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.350, Ratio=2.62x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.346, Ratio=2.63x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.346, Ratio=2.49x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.355, Ratio=2.73x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.329, Ratio=2.60x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.340, Ratio=2.57x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.319, Ratio=2.53x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.349, Ratio=2.64x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-2.917
Batch 125/537: Loss=1.2260 (C:1.2260, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.343, Ratio=2.60x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.350, Ratio=2.69x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.344, Ratio=2.60x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.358, Ratio=2.71x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.333, Ratio=2.47x, Gap=-2.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.338, Ratio=2.50x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.323, Ratio=2.57x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.339, Ratio=2.63x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.338, Ratio=2.57x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.332, Ratio=2.55x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.327, Ratio=2.50x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.340, Ratio=2.61x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.334, Ratio=2.50x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.341, Ratio=2.63x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.341, Ratio=2.66x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.335, Ratio=2.58x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.338, Ratio=2.58x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.355, Ratio=2.68x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.335, Ratio=2.57x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.350, Ratio=2.64x, Gap=-2.785
Batch 150/537: Loss=1.2311 (C:1.2311, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.333, Ratio=2.59x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.341, Ratio=2.61x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.334, Ratio=2.56x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.320, Ratio=2.37x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.59x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.69x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.346, Ratio=2.63x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.343, Ratio=2.68x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.351, Ratio=2.62x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.345, Ratio=2.66x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.342, Ratio=2.63x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.340, Ratio=2.56x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.351, Ratio=2.64x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.341, Ratio=2.49x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.67x, Gap=-2.605
Batch 175/537: Loss=1.2317 (C:1.2317, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.353, Ratio=2.69x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.337, Ratio=2.56x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.350, Ratio=2.59x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.342, Ratio=2.54x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.351, Ratio=2.76x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.328, Ratio=2.54x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.321, Ratio=2.47x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.351, Ratio=2.69x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.327, Ratio=2.63x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.356, Ratio=2.65x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.320, Ratio=2.40x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.338, Ratio=2.52x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.333, Ratio=2.51x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.343, Ratio=2.52x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.350, Ratio=2.59x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.335, Ratio=2.58x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.342, Ratio=2.66x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.336, Ratio=2.56x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.60x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.343, Ratio=2.67x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.316, Ratio=2.50x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.346, Ratio=2.57x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.320, Ratio=2.48x, Gap=-2.905
Batch 200/537: Loss=1.2810 (C:1.2810, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.333, Ratio=2.51x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.341, Ratio=2.55x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.326, Ratio=2.49x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.332, Ratio=2.65x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.360, Ratio=2.73x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.341, Ratio=2.63x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.353, Ratio=2.69x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.334, Ratio=2.51x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.346, Ratio=2.63x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.343, Ratio=2.52x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.347, Ratio=2.65x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.347, Ratio=2.61x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.74x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.349, Ratio=2.58x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.320, Ratio=2.47x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.326, Ratio=2.50x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.325, Ratio=2.43x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.328, Ratio=2.39x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.334, Ratio=2.54x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.355, Ratio=2.77x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.342, Ratio=2.57x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.339, Ratio=2.59x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.756
Batch 225/537: Loss=1.2555 (C:1.2555, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.361, Ratio=2.73x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.351, Ratio=2.68x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.349, Ratio=2.60x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.321, Ratio=2.52x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.324, Ratio=2.55x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.336, Ratio=2.65x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.351, Ratio=2.63x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.348, Ratio=2.60x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.333, Ratio=2.52x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.332, Ratio=2.57x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.337, Ratio=2.50x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.363, Ratio=2.76x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.345, Ratio=2.64x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.73x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.332, Ratio=2.56x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.323, Ratio=2.55x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.337, Ratio=2.63x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.74x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.341, Ratio=2.62x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.336, Ratio=2.56x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.344, Ratio=2.59x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.337, Ratio=2.61x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.327, Ratio=2.42x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.333, Ratio=2.57x, Gap=-2.781
Batch 250/537: Loss=1.2554 (C:1.2554, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.349, Ratio=2.63x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.335, Ratio=2.50x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.340, Ratio=2.63x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.336, Ratio=2.64x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.338, Ratio=2.56x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.336, Ratio=2.64x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.341, Ratio=2.59x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.340, Ratio=2.57x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.352, Ratio=2.63x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.355, Ratio=2.68x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.347, Ratio=2.62x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.333, Ratio=2.51x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.340, Ratio=2.60x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.355, Ratio=2.67x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.344, Ratio=2.63x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.336, Ratio=2.57x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.335, Ratio=2.55x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.331, Ratio=2.53x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.354, Ratio=2.68x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.347, Ratio=2.71x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.344, Ratio=2.50x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.337, Ratio=2.50x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.352, Ratio=2.67x, Gap=-2.701
Batch 275/537: Loss=1.2307 (C:1.2307, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.343, Ratio=2.53x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.340, Ratio=2.63x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.335, Ratio=2.55x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.341, Ratio=2.63x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.333, Ratio=2.61x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.326, Ratio=2.57x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.342, Ratio=2.59x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.336, Ratio=2.56x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.345, Ratio=2.64x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.349, Ratio=2.62x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.338, Ratio=2.64x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.329, Ratio=2.56x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.349, Ratio=2.72x, Gap=-2.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.350, Ratio=2.68x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.342, Ratio=2.59x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.356, Ratio=2.70x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.349, Ratio=2.73x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.334, Ratio=2.58x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.363, Ratio=2.74x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.67x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.330, Ratio=2.52x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.337, Ratio=2.59x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.335, Ratio=2.63x, Gap=-3.093
Batch 300/537: Loss=1.2421 (C:1.2421, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.61x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.329, Ratio=2.59x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.328, Ratio=2.55x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.330, Ratio=2.55x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.325, Ratio=2.54x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.349, Ratio=2.62x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.342, Ratio=2.52x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.329, Ratio=2.47x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.335, Ratio=2.49x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.333, Ratio=2.56x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.319, Ratio=2.44x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.326, Ratio=2.48x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.332, Ratio=2.56x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.353, Ratio=2.69x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.338, Ratio=2.54x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.343, Ratio=2.66x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.329, Ratio=2.62x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.346, Ratio=2.63x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.367, Ratio=2.78x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.348, Ratio=2.64x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.358, Ratio=2.71x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.335, Ratio=2.65x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.341, Ratio=2.66x, Gap=-3.065
Batch 325/537: Loss=1.2348 (C:1.2348, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.324, Ratio=2.52x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.328, Ratio=2.51x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.336, Ratio=2.56x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.332, Ratio=2.57x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.321, Ratio=2.49x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.350, Ratio=2.54x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.347, Ratio=2.59x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.339, Ratio=2.59x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.350, Ratio=2.59x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.330, Ratio=2.52x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.337, Ratio=2.58x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.327, Ratio=2.52x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.336, Ratio=2.57x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.326, Ratio=2.54x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.334, Ratio=2.48x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.342, Ratio=2.56x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.342, Ratio=2.65x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.344, Ratio=2.54x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.338, Ratio=2.59x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.333, Ratio=2.57x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.353, Ratio=2.68x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.337, Ratio=2.57x, Gap=-2.811
Batch 350/537: Loss=1.2558 (C:1.2558, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.348, Ratio=2.61x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.333, Ratio=2.62x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.337, Ratio=2.56x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.341, Ratio=2.59x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.346, Ratio=2.58x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.333, Ratio=2.51x, Gap=-3.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.341, Ratio=2.55x, Gap=-2.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.344, Ratio=2.55x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.56x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.341, Ratio=2.61x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.338, Ratio=2.57x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.348, Ratio=2.62x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.339, Ratio=2.62x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.338, Ratio=2.58x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.66x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.338, Ratio=2.61x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.335, Ratio=2.54x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.348, Ratio=2.66x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.324, Ratio=2.52x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.340, Ratio=2.58x, Gap=-2.812
Batch 375/537: Loss=1.2524 (C:1.2524, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.330, Ratio=2.52x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.330, Ratio=2.51x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.355, Ratio=2.71x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.334, Ratio=2.56x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.348, Ratio=2.68x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.343, Ratio=2.65x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.334, Ratio=2.57x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.347, Ratio=2.62x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.342, Ratio=2.54x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.340, Ratio=2.53x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.332, Ratio=2.59x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.367, Ratio=2.70x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.363, Ratio=2.77x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.66x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.336, Ratio=2.57x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.325, Ratio=2.51x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.338, Ratio=2.56x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.324, Ratio=2.43x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.333, Ratio=2.60x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.345, Ratio=2.62x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.325, Ratio=2.43x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.354, Ratio=2.71x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.329, Ratio=2.57x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.357, Ratio=2.68x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.336, Ratio=2.60x, Gap=-3.062
Batch 400/537: Loss=1.2479 (C:1.2479, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.345, Ratio=2.64x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.371, Ratio=2.75x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.343, Ratio=2.59x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.339, Ratio=2.56x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.337, Ratio=2.60x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.336, Ratio=2.60x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.356, Ratio=2.74x, Gap=-3.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.332, Ratio=2.60x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.335, Ratio=2.52x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.336, Ratio=2.59x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.335, Ratio=2.48x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.362, Ratio=2.81x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.336, Ratio=2.57x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.341, Ratio=2.54x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.342, Ratio=2.60x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.335, Ratio=2.60x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.345, Ratio=2.70x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.336, Ratio=2.53x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.338, Ratio=2.58x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.327, Ratio=2.57x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.339, Ratio=2.58x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.336, Ratio=2.64x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.352, Ratio=2.72x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.342, Ratio=2.65x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.343, Ratio=2.59x, Gap=-2.723
Batch 425/537: Loss=1.2476 (C:1.2476, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.335, Ratio=2.49x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.335, Ratio=2.60x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.335, Ratio=2.59x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.319, Ratio=2.47x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.348, Ratio=2.66x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.339, Ratio=2.50x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.336, Ratio=2.60x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.334, Ratio=2.56x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.338, Ratio=2.56x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.338, Ratio=2.55x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.341, Ratio=2.58x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.348, Ratio=2.60x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.346, Ratio=2.67x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.340, Ratio=2.61x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.357, Ratio=2.74x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.341, Ratio=2.62x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.362, Ratio=2.76x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.352, Ratio=2.59x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.335, Ratio=2.59x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.344, Ratio=2.57x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.337, Ratio=2.64x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.350, Ratio=2.64x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.323, Ratio=2.50x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.328, Ratio=2.54x, Gap=-2.663
Batch 450/537: Loss=1.2648 (C:1.2648, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.349, Ratio=2.60x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.349, Ratio=2.63x, Gap=-3.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.339, Ratio=2.57x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.336, Ratio=2.54x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.332, Ratio=2.57x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.335, Ratio=2.53x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.328, Ratio=2.55x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.355, Ratio=2.65x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.337, Ratio=2.55x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.334, Ratio=2.53x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.348, Ratio=2.50x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.327, Ratio=2.48x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.345, Ratio=2.68x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.331, Ratio=2.47x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.338, Ratio=2.64x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.350, Ratio=2.60x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.320, Ratio=2.49x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.346, Ratio=2.63x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.346, Ratio=2.54x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.338, Ratio=2.60x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.354, Ratio=2.62x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.335, Ratio=2.54x, Gap=-2.840
Batch 475/537: Loss=1.2605 (C:1.2605, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.351, Ratio=2.61x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.345, Ratio=2.73x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.329, Ratio=2.50x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.322, Ratio=2.55x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.342, Ratio=2.69x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.350, Ratio=2.61x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.325, Ratio=2.47x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.343, Ratio=2.64x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.335, Ratio=2.57x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.339, Ratio=2.55x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.335, Ratio=2.52x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.344, Ratio=2.61x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.341, Ratio=2.62x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.337, Ratio=2.58x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.344, Ratio=2.56x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.315, Ratio=2.47x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.73x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.330, Ratio=2.44x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.347, Ratio=2.61x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.335, Ratio=2.56x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.349, Ratio=2.60x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.341, Ratio=2.63x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.340, Ratio=2.50x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.346, Ratio=2.61x, Gap=-2.774
Batch 500/537: Loss=1.2437 (C:1.2437, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.341, Ratio=2.56x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.348, Ratio=2.65x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.336, Ratio=2.54x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.343, Ratio=2.54x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.341, Ratio=2.60x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.333, Ratio=2.53x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.350, Ratio=2.62x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.342, Ratio=2.62x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.339, Ratio=2.56x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.340, Ratio=2.66x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.332, Ratio=2.53x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.318, Ratio=2.48x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.337, Ratio=2.57x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.340, Ratio=2.67x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.349, Ratio=2.62x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.333, Ratio=2.49x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.340, Ratio=2.62x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.328, Ratio=2.48x, Gap=-2.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.322, Ratio=2.63x, Gap=-2.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.335, Ratio=2.58x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.327, Ratio=2.60x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.322, Ratio=2.51x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-3.112
Batch 525/537: Loss=1.2168 (C:1.2168, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.322, Ratio=2.47x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.341, Ratio=2.60x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.348, Ratio=2.61x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.343, Ratio=2.61x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.339, Ratio=2.47x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.332, Ratio=2.48x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.339, Ratio=2.57x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.348, Ratio=2.63x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.343, Ratio=2.58x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.347, Ratio=2.87x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.337, Ratio=2.65x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.89x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.348, Ratio=2.76x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.338, Ratio=2.78x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.90x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.336, Ratio=2.64x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.346, Ratio=2.71x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.358, Ratio=2.88x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.339, Ratio=2.76x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.332, Ratio=2.63x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.77x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.88x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.66x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.331, Ratio=2.60x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.347, Ratio=2.83x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.65x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.346, Ratio=2.79x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.363, Ratio=2.88x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.357, Ratio=2.86x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.341, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.84x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.347, Ratio=2.76x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.71x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.356, Ratio=2.78x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.342, Ratio=2.66x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.334, Ratio=2.64x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.354, Ratio=2.81x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.335, Ratio=2.73x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.366, Ratio=2.88x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.343, Ratio=2.73x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.331, Ratio=2.59x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.346, Ratio=2.74x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.348, Ratio=2.78x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.344, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.67x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.344, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.327, Ratio=2.58x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.321, Ratio=2.62x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.349, Ratio=2.77x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.325, Ratio=2.66x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.351, Ratio=2.76x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.77x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.73x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.336, Ratio=2.65x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.340, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.329, Ratio=2.68x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.344, Ratio=2.85x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.331, Ratio=2.69x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.352, Ratio=2.79x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.354, Ratio=2.93x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.343, Ratio=2.65x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.342, Ratio=2.71x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.355, Ratio=2.88x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.70x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.71x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.324, Ratio=2.54x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.320, Ratio=2.62x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.353, Ratio=2.79x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.335, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.334, Ratio=2.68x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.328, Ratio=2.70x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.347, Ratio=2.72x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.332, Ratio=2.64x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.349, Ratio=2.77x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.342, Ratio=2.68x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.346, Ratio=2.74x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.337, Ratio=2.70x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.347, Ratio=2.88x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.345, Ratio=2.79x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.337, Ratio=2.70x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.337, Ratio=2.69x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.330, Ratio=2.65x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.83x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.354, Ratio=2.91x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.345, Ratio=2.87x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.344, Ratio=2.71x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.358, Ratio=2.85x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.345, Ratio=2.79x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.70x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.82x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.318, Ratio=2.57x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.347, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.332, Ratio=2.62x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.343, Ratio=2.76x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.348, Ratio=2.83x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.337, Ratio=2.71x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.341, Ratio=2.67x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.331, Ratio=2.67x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.61x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.337, Ratio=2.69x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.337, Ratio=2.74x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.333, Ratio=2.60x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.333, Ratio=2.64x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.334, Ratio=2.66x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-2.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.333, Ratio=2.63x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.340, Ratio=2.74x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.339, Ratio=2.67x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.338, Ratio=2.77x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.355, Ratio=2.84x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.347, Ratio=2.71x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.356, Ratio=2.85x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.75x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.337, Ratio=2.81x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.331, Ratio=2.68x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.341, Ratio=2.71x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.335, Ratio=2.72x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.338, Ratio=2.77x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.329, Ratio=2.66x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.339, Ratio=2.78x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.343, Ratio=2.65x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.362, Ratio=2.89x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.355, Ratio=2.83x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.342, Ratio=2.80x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.84x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.67x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.355, Ratio=2.89x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.68x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.334, Ratio=2.73x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.349, Ratio=2.83x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.75x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.340, Ratio=2.70x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.77x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.345, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.341, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.330, Ratio=2.59x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.347, Ratio=2.72x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.340, Ratio=2.65x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.347, Ratio=2.74x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.341, Ratio=2.73x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.332, Ratio=2.72x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.341, Ratio=2.73x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.346, Ratio=2.80x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.341, Ratio=2.73x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.74x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.333, Ratio=2.66x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.357, Ratio=2.90x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.338, Ratio=2.62x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.340, Ratio=2.66x, Gap=-2.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.336, Ratio=2.69x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.337, Ratio=2.57x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.336, Ratio=2.66x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.357, Ratio=2.93x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.348, Ratio=2.80x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.339, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.343, Ratio=2.76x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.334, Ratio=2.67x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.357, Ratio=2.84x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.342, Ratio=2.68x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.337, Ratio=2.59x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.86x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.341, Ratio=2.79x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.360, Ratio=2.82x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.336, Ratio=2.77x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.339, Ratio=2.71x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.342, Ratio=2.74x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.345, Ratio=2.78x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.336, Ratio=2.71x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.351, Ratio=2.89x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.324, Ratio=2.64x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.345, Ratio=2.77x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.343, Ratio=2.60x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.327, Ratio=2.69x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.349, Ratio=2.82x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.343, Ratio=2.82x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.344, Ratio=2.76x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.332, Ratio=2.62x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.347, Ratio=2.78x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.327, Ratio=2.64x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.332, Ratio=2.71x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.353, Ratio=2.87x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.330, Ratio=2.61x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.340, Ratio=2.73x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.350, Ratio=2.91x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.347, Ratio=2.87x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.360, Ratio=2.81x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.343, Ratio=2.75x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.348, Ratio=2.75x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.322, Ratio=2.62x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.339, Ratio=2.75x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.343, Ratio=2.70x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.324, Ratio=2.53x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.320, Ratio=2.59x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.349, Ratio=2.81x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.84x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.333, Ratio=2.69x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.354, Ratio=2.84x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.344, Ratio=2.84x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.333, Ratio=2.70x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.332, Ratio=2.69x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.84x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.332, Ratio=2.57x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.313, Ratio=2.55x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.343, Ratio=2.73x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.329, Ratio=2.66x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.340, Ratio=2.81x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.322, Ratio=2.63x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.315, Ratio=2.49x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.328, Ratio=2.52x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.73x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.79x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.329, Ratio=2.58x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.346, Ratio=2.81x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.330, Ratio=2.67x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.333, Ratio=2.67x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.337, Ratio=2.76x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.344, Ratio=2.80x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.335, Ratio=2.70x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.348, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.341, Ratio=2.69x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.337, Ratio=2.64x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.338, Ratio=2.77x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.354, Ratio=2.80x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.351, Ratio=2.82x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.341, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.343, Ratio=2.84x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.340, Ratio=2.67x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.339, Ratio=2.67x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.356, Ratio=2.93x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.78x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.338, Ratio=2.70x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.330, Ratio=2.65x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.335, Ratio=2.68x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.328, Ratio=2.68x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.347, Ratio=2.78x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.326, Ratio=2.62x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.339, Ratio=2.75x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.74x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.340, Ratio=2.70x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.77x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.343, Ratio=2.76x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.325, Ratio=2.65x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.353, Ratio=2.82x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.322, Ratio=2.61x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.346, Ratio=2.84x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.332, Ratio=2.61x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.340, Ratio=2.76x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.330, Ratio=2.62x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.337, Ratio=2.62x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.333, Ratio=2.65x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.80x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.344, Ratio=2.73x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.348, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.340, Ratio=2.75x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.344, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.338, Ratio=2.69x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.344, Ratio=2.82x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.333, Ratio=2.71x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.349, Ratio=2.75x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.347, Ratio=2.69x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.329, Ratio=2.74x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.343, Ratio=2.72x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.72x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.340, Ratio=2.71x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.349, Ratio=2.74x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.80x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.352, Ratio=2.92x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.339, Ratio=2.74x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.337, Ratio=2.64x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.346, Ratio=2.83x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.341, Ratio=2.72x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.340, Ratio=2.79x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.346, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.341, Ratio=2.66x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.329, Ratio=2.60x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.348, Ratio=2.80x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.341, Ratio=2.72x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.76x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.331, Ratio=2.65x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.331, Ratio=2.67x, Gap=-2.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.342, Ratio=2.77x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.354, Ratio=2.83x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.91x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.344, Ratio=2.80x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.335, Ratio=2.66x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.85x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.334, Ratio=2.70x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.342, Ratio=2.69x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.344, Ratio=2.73x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.334, Ratio=2.64x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.341, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.77x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.336, Ratio=2.68x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.340, Ratio=2.69x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.344, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.338, Ratio=2.77x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.82x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.341, Ratio=2.73x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.348, Ratio=2.81x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.351, Ratio=2.77x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.326, Ratio=2.66x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.81x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.341, Ratio=2.70x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.351, Ratio=2.92x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.85x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.84x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.329, Ratio=2.70x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.343, Ratio=2.69x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.335, Ratio=2.61x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.352, Ratio=2.90x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.352, Ratio=2.80x, Gap=-2.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.354, Ratio=2.80x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.335, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.337, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.338, Ratio=2.69x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.340, Ratio=2.76x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.346, Ratio=2.80x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.316, Ratio=2.63x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.330, Ratio=2.61x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.352, Ratio=2.82x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.346, Ratio=2.74x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.337, Ratio=2.72x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.325, Ratio=2.64x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.323, Ratio=2.59x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.357, Ratio=2.85x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.341, Ratio=2.76x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.344, Ratio=2.76x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.327, Ratio=2.60x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.342, Ratio=2.75x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.322, Ratio=2.61x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.325, Ratio=2.59x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.352, Ratio=2.86x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.346, Ratio=2.71x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.343, Ratio=2.86x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.341, Ratio=2.75x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.335, Ratio=2.71x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.358, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.333, Ratio=2.63x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.345, Ratio=2.90x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.338, Ratio=2.75x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.331, Ratio=2.70x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.344, Ratio=2.83x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.346, Ratio=2.85x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.74x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.339, Ratio=2.72x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.341, Ratio=2.72x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.340, Ratio=2.63x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.342, Ratio=2.73x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.344, Ratio=2.81x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.342, Ratio=2.75x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.323, Ratio=2.62x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.73x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.346, Ratio=2.78x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.345, Ratio=2.72x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.345, Ratio=2.77x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.340, Ratio=2.65x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.339, Ratio=2.87x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.340, Ratio=2.68x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.339, Ratio=2.82x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.344, Ratio=2.72x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.334, Ratio=2.75x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.339, Ratio=2.73x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.345, Ratio=2.80x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.330, Ratio=2.70x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.335, Ratio=2.69x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.339, Ratio=2.68x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.347, Ratio=2.77x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.329, Ratio=2.72x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.334, Ratio=2.62x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.343, Ratio=2.64x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.337, Ratio=2.82x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.336, Ratio=2.65x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.323, Ratio=2.50x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.327, Ratio=2.62x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.338, Ratio=2.71x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.347, Ratio=2.77x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.335, Ratio=2.63x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.343, Ratio=2.74x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.333, Ratio=2.69x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.77x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.345, Ratio=2.77x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.340, Ratio=2.68x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.345, Ratio=2.75x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.343, Ratio=2.78x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.90x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.350, Ratio=2.81x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.342, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.77x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.344, Ratio=2.65x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.359, Ratio=2.90x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.360, Ratio=2.85x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.342, Ratio=2.84x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.335, Ratio=2.67x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.350, Ratio=2.77x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.347, Ratio=2.72x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.337, Ratio=2.77x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.336, Ratio=2.75x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.338, Ratio=2.64x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.85x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.333, Ratio=2.70x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.86x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.71x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.351, Ratio=2.90x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.345, Ratio=2.86x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.348, Ratio=2.82x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.351, Ratio=2.84x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.76x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.347, Ratio=2.78x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.336, Ratio=2.63x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.331, Ratio=2.66x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.347, Ratio=2.76x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.334, Ratio=2.65x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.331, Ratio=2.66x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.335, Ratio=2.66x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.344, Ratio=2.67x, Gap=-2.412

============================================================
Epoch 15/20 completed in 29.4s
Train: Loss=1.2466 (C:1.2466, R:0.0000) Ratio=2.65x
Val:   Loss=1.2177 (C:1.2177, R:0.0000) Ratio=3.02x
‚úÖ New best model saved (Val Loss: 1.2177)
Checkpoint saved at epoch 15
============================================================

üåç Updating global dataset at epoch 16
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.475 ¬± 0.662
    Neg distances: 1.354 ¬± 0.864
    Separation ratio: 2.85x
    Gap: -2.452
    ‚úÖ Good global separation

Epoch 16 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.770
Batch   0/537: Loss=1.2218 (C:1.2218, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.362, Ratio=2.79x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.352, Ratio=2.67x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.78x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.76x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.369, Ratio=2.80x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.357, Ratio=2.66x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.365, Ratio=2.74x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.361, Ratio=2.70x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.358, Ratio=2.71x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.80x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.358, Ratio=2.83x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.350, Ratio=2.66x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.376, Ratio=2.85x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.350, Ratio=2.65x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.348, Ratio=2.73x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.344, Ratio=2.63x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.371, Ratio=2.80x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.351, Ratio=2.72x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.365, Ratio=2.78x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.363, Ratio=2.86x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.365, Ratio=2.85x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.360, Ratio=2.71x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.367, Ratio=2.86x, Gap=-3.410
Batch  25/537: Loss=1.1857 (C:1.1857, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.342, Ratio=2.64x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.365, Ratio=2.91x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.356, Ratio=2.62x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.356, Ratio=2.86x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.359, Ratio=2.72x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.363, Ratio=2.84x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.365, Ratio=2.65x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.358, Ratio=2.80x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.352, Ratio=2.60x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.354, Ratio=2.78x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.364, Ratio=2.92x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.354, Ratio=2.84x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.370, Ratio=2.82x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.375, Ratio=2.88x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.357, Ratio=2.73x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.343, Ratio=2.70x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.355, Ratio=2.83x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.361, Ratio=2.75x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.344, Ratio=2.67x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.378, Ratio=2.93x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.363, Ratio=2.78x, Gap=-3.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.355, Ratio=2.76x, Gap=-2.749
Batch  50/537: Loss=1.2076 (C:1.2076, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.373, Ratio=2.83x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.350, Ratio=2.72x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.65x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.372, Ratio=2.75x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.377, Ratio=2.84x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.366, Ratio=2.83x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.352, Ratio=2.65x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.364, Ratio=2.74x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.86x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.360, Ratio=2.75x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.355, Ratio=2.66x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.347, Ratio=2.70x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.369, Ratio=2.90x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.364, Ratio=2.85x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.353, Ratio=2.71x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.370, Ratio=2.93x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.367, Ratio=2.77x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.353, Ratio=2.70x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.363, Ratio=2.73x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.350, Ratio=2.72x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.920
Batch  75/537: Loss=1.1905 (C:1.1905, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.74x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.370, Ratio=2.85x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.354, Ratio=2.82x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.356, Ratio=2.82x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.360, Ratio=2.73x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.360, Ratio=2.64x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.368, Ratio=2.80x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.361, Ratio=2.81x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.367, Ratio=2.80x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.365, Ratio=2.81x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.78x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.347, Ratio=2.81x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.365, Ratio=2.78x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.356, Ratio=2.80x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.373, Ratio=2.85x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.76x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.355, Ratio=2.64x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.362, Ratio=2.76x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.342, Ratio=2.66x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.367, Ratio=2.91x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.390, Ratio=3.04x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.378, Ratio=2.94x, Gap=-2.811
Batch 100/537: Loss=1.1665 (C:1.1665, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.361, Ratio=2.85x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.365, Ratio=2.80x, Gap=-2.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.364, Ratio=2.67x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.370, Ratio=2.75x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.369, Ratio=2.84x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.349, Ratio=2.62x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.356, Ratio=2.83x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.356, Ratio=2.81x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.333, Ratio=2.61x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.355, Ratio=2.77x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.351, Ratio=2.60x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.365, Ratio=2.89x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.369, Ratio=2.80x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.382, Ratio=2.93x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.368, Ratio=2.78x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.358, Ratio=2.78x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.342, Ratio=2.65x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-2.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.340, Ratio=2.72x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.84x, Gap=-2.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.353, Ratio=2.72x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.350, Ratio=2.76x, Gap=-2.892
Batch 125/537: Loss=1.2100 (C:1.2100, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.362, Ratio=2.80x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.356, Ratio=2.72x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.359, Ratio=2.74x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.366, Ratio=2.79x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.362, Ratio=2.70x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.366, Ratio=2.79x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.361, Ratio=2.72x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.358, Ratio=2.71x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.366, Ratio=2.73x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.370, Ratio=2.87x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.354, Ratio=2.70x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.359, Ratio=2.79x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.348, Ratio=2.70x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.344, Ratio=2.66x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.363, Ratio=2.77x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.349, Ratio=2.67x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.364, Ratio=2.81x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.343, Ratio=2.66x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.351, Ratio=2.66x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.354, Ratio=2.69x, Gap=-2.819
Batch 150/537: Loss=1.2193 (C:1.2193, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.355, Ratio=2.72x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.376, Ratio=2.94x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.372, Ratio=2.88x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.357, Ratio=2.68x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.368, Ratio=2.87x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.366, Ratio=2.76x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.375, Ratio=2.81x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.84x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.369, Ratio=2.82x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.354, Ratio=2.68x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.361, Ratio=2.76x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.358, Ratio=2.72x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.371, Ratio=2.96x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.353, Ratio=2.71x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.350, Ratio=2.65x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.374, Ratio=2.89x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.351, Ratio=2.71x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.367, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.363, Ratio=2.72x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.369, Ratio=2.73x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.76x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.77x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.356, Ratio=2.82x, Gap=-2.607
Batch 175/537: Loss=1.1975 (C:1.1975, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.364, Ratio=2.81x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.348, Ratio=2.71x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.68x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.343, Ratio=2.75x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.358, Ratio=2.78x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.355, Ratio=2.76x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.367, Ratio=2.79x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.357, Ratio=2.78x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.367, Ratio=2.82x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.348, Ratio=2.67x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.358, Ratio=2.68x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.359, Ratio=2.78x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.352, Ratio=2.73x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.356, Ratio=2.72x, Gap=-2.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.353, Ratio=2.60x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.352, Ratio=2.75x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.348, Ratio=2.74x, Gap=-3.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.352, Ratio=2.72x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.350, Ratio=2.70x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.348, Ratio=2.64x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.373, Ratio=2.81x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.341, Ratio=2.63x, Gap=-2.838
Batch 200/537: Loss=1.2434 (C:1.2434, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.370, Ratio=2.83x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.345, Ratio=2.59x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.360, Ratio=2.78x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.343, Ratio=2.65x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.346, Ratio=2.70x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.346, Ratio=2.64x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.366, Ratio=2.83x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.359, Ratio=2.82x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.374, Ratio=2.89x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.81x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.74x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.358, Ratio=2.73x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.357, Ratio=2.69x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.365, Ratio=2.83x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.355, Ratio=2.71x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.355, Ratio=2.83x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.374, Ratio=2.90x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.78x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.353, Ratio=2.74x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.355, Ratio=2.70x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.374, Ratio=2.82x, Gap=-2.729
Batch 225/537: Loss=1.1930 (C:1.1930, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.373, Ratio=2.78x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.343, Ratio=2.58x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.353, Ratio=2.68x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.379, Ratio=2.93x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.353, Ratio=2.64x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.357, Ratio=2.72x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.374, Ratio=2.93x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.340, Ratio=2.69x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.372, Ratio=2.82x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.351, Ratio=2.60x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.347, Ratio=2.66x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.80x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.361, Ratio=2.77x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.354, Ratio=2.70x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.84x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.361, Ratio=2.76x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.359, Ratio=2.77x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.364, Ratio=2.82x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.364, Ratio=2.70x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.362, Ratio=2.82x, Gap=-3.031
Batch 250/537: Loss=1.1968 (C:1.1968, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.357, Ratio=2.72x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.366, Ratio=2.78x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.362, Ratio=2.75x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.365, Ratio=2.73x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.350, Ratio=2.70x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.352, Ratio=2.67x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.73x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.351, Ratio=2.69x, Gap=-2.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.368, Ratio=2.86x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.371, Ratio=2.86x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.372, Ratio=2.88x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.88x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.357, Ratio=2.67x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.83x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.368, Ratio=2.76x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.375, Ratio=2.84x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.356, Ratio=2.67x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.78x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.351, Ratio=2.74x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.67x, Gap=-2.730
Batch 275/537: Loss=1.2283 (C:1.2283, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.352, Ratio=2.74x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.340, Ratio=2.64x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.361, Ratio=2.79x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.367, Ratio=2.83x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.381, Ratio=2.94x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.76x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.368, Ratio=2.92x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.369, Ratio=2.85x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.352, Ratio=2.71x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.345, Ratio=2.62x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.363, Ratio=2.79x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.93x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.348, Ratio=2.64x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.363, Ratio=2.80x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.357, Ratio=2.74x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.356, Ratio=2.73x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.374, Ratio=2.89x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.342, Ratio=2.67x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.364, Ratio=2.79x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.372, Ratio=2.93x, Gap=-3.043
Batch 300/537: Loss=1.1706 (C:1.1706, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.350, Ratio=2.65x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.366, Ratio=2.82x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.372, Ratio=2.78x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.66x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.339, Ratio=2.69x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.347, Ratio=2.68x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.356, Ratio=2.80x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.351, Ratio=2.71x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.343, Ratio=2.66x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.351, Ratio=2.69x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.346, Ratio=2.64x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.347, Ratio=2.63x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.365, Ratio=2.83x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.74x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.356, Ratio=2.72x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.344, Ratio=2.72x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.349, Ratio=2.67x, Gap=-3.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.354, Ratio=2.68x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.357, Ratio=2.73x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.352, Ratio=2.62x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.360, Ratio=2.80x, Gap=-2.929
Batch 325/537: Loss=1.1988 (C:1.1988, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.74x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.366, Ratio=2.85x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.354, Ratio=2.67x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.373, Ratio=2.83x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.371, Ratio=2.80x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.367, Ratio=2.84x, Gap=-2.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.358, Ratio=2.79x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.365, Ratio=2.77x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.369, Ratio=2.77x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.364, Ratio=2.77x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.346, Ratio=2.73x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.351, Ratio=2.71x, Gap=-2.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.78x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.364, Ratio=2.77x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.359, Ratio=2.77x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.361, Ratio=2.72x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.369, Ratio=2.83x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.352, Ratio=2.75x, Gap=-2.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.364, Ratio=2.81x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.367, Ratio=2.78x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.355, Ratio=2.69x, Gap=-2.837
Batch 350/537: Loss=1.2259 (C:1.2259, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.366, Ratio=2.70x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.336, Ratio=2.65x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.354, Ratio=2.75x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.372, Ratio=2.93x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.342, Ratio=2.57x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.365, Ratio=2.81x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.359, Ratio=2.74x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.81x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.351, Ratio=2.66x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.361, Ratio=2.81x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.358, Ratio=2.80x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.344, Ratio=2.61x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.354, Ratio=2.71x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.366, Ratio=2.72x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.369, Ratio=2.84x, Gap=-2.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.87x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.365, Ratio=2.72x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.77x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.369, Ratio=2.78x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.372, Ratio=2.75x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.86x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.360, Ratio=2.77x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.357, Ratio=2.70x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.360, Ratio=2.84x, Gap=-2.956
Batch 375/537: Loss=1.1946 (C:1.1946, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.369, Ratio=2.85x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.359, Ratio=2.92x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.361, Ratio=2.74x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.367, Ratio=2.87x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.364, Ratio=2.78x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.353, Ratio=2.86x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.366, Ratio=2.89x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.371, Ratio=2.78x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.352, Ratio=2.74x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.72x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.361, Ratio=2.88x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.371, Ratio=2.79x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.347, Ratio=2.64x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.369, Ratio=2.85x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.356, Ratio=2.74x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.350, Ratio=2.68x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.373, Ratio=2.84x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.355, Ratio=2.71x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.342, Ratio=2.55x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.352, Ratio=2.70x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.351, Ratio=2.72x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.350, Ratio=2.64x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.363, Ratio=2.74x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.354, Ratio=2.69x, Gap=-2.907
Batch 400/537: Loss=1.2230 (C:1.2230, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.351, Ratio=2.71x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.376, Ratio=2.90x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.363, Ratio=2.78x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.349, Ratio=2.69x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.360, Ratio=2.78x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.377, Ratio=2.88x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.354, Ratio=2.71x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.359, Ratio=2.78x, Gap=-2.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.362, Ratio=2.72x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.348, Ratio=2.72x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.73x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.348, Ratio=2.64x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.351, Ratio=2.77x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.355, Ratio=2.68x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.349, Ratio=2.70x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.354, Ratio=2.68x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.342, Ratio=2.78x, Gap=-2.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.344, Ratio=2.69x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.365, Ratio=2.84x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.75x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.367, Ratio=2.85x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.354, Ratio=2.78x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.383, Ratio=2.98x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.346, Ratio=2.65x, Gap=-2.742
Batch 425/537: Loss=1.2341 (C:1.2341, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.380, Ratio=2.85x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.359, Ratio=2.75x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.337, Ratio=2.63x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.348, Ratio=2.63x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.78x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.369, Ratio=2.80x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.349, Ratio=2.80x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.339, Ratio=2.66x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.358, Ratio=2.73x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.362, Ratio=2.73x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.357, Ratio=2.66x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.369, Ratio=2.82x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.365, Ratio=2.81x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.363, Ratio=2.80x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.369, Ratio=2.86x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.351, Ratio=2.69x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.354, Ratio=2.73x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.362, Ratio=2.79x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.358, Ratio=2.69x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.359, Ratio=2.80x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.358, Ratio=2.73x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.340, Ratio=2.67x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.371, Ratio=2.84x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.733
Batch 450/537: Loss=1.2168 (C:1.2168, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.371, Ratio=2.83x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.363, Ratio=2.74x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.350, Ratio=2.58x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.365, Ratio=2.76x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.354, Ratio=2.74x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.361, Ratio=2.73x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.344, Ratio=2.62x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.341, Ratio=2.66x, Gap=-2.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.368, Ratio=2.84x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.349, Ratio=2.73x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.371, Ratio=2.78x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.344, Ratio=2.75x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.381, Ratio=2.88x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.354, Ratio=2.72x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.359, Ratio=2.67x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.356, Ratio=2.69x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.349, Ratio=2.68x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.357, Ratio=2.70x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.342, Ratio=2.64x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.356, Ratio=2.80x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.343, Ratio=2.85x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.357, Ratio=2.76x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.369, Ratio=2.79x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.354, Ratio=2.66x, Gap=-2.952
Batch 475/537: Loss=1.2292 (C:1.2292, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.361, Ratio=2.72x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.368, Ratio=2.77x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.374, Ratio=2.77x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.358, Ratio=2.64x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.346, Ratio=2.70x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.357, Ratio=2.71x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.352, Ratio=2.85x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.358, Ratio=2.70x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.353, Ratio=2.67x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.357, Ratio=2.69x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.364, Ratio=2.76x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.390, Ratio=3.01x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.359, Ratio=2.74x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.365, Ratio=2.83x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.347, Ratio=2.74x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.357, Ratio=2.73x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.353, Ratio=2.79x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.359, Ratio=2.71x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.359, Ratio=2.77x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.357, Ratio=2.67x, Gap=-2.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.354, Ratio=2.70x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.361, Ratio=2.69x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.358, Ratio=2.72x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.363, Ratio=2.80x, Gap=-2.734
Batch 500/537: Loss=1.1983 (C:1.1983, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.356, Ratio=2.69x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.350, Ratio=2.68x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.370, Ratio=2.92x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.356, Ratio=2.69x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.348, Ratio=2.63x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.355, Ratio=2.71x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.350, Ratio=2.73x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.372, Ratio=2.89x, Gap=-2.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.365, Ratio=2.68x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.359, Ratio=2.80x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.360, Ratio=2.74x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.346, Ratio=2.61x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.362, Ratio=2.75x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.368, Ratio=2.74x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.368, Ratio=2.81x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.87x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.353, Ratio=2.65x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.352, Ratio=2.76x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-3.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.343, Ratio=2.60x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.352, Ratio=2.71x, Gap=-2.870
Batch 525/537: Loss=1.2191 (C:1.2191, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.77x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.377, Ratio=2.90x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.77x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.349, Ratio=2.69x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.362, Ratio=2.71x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.363, Ratio=2.72x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.374, Ratio=2.86x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.355, Ratio=2.75x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.352, Ratio=2.61x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.370, Ratio=2.76x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.369, Ratio=2.97x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.359, Ratio=2.91x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.377, Ratio=3.04x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.365, Ratio=2.94x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.68x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.372, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.367, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.351, Ratio=2.78x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.357, Ratio=2.90x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.369, Ratio=2.95x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.89x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.380, Ratio=3.07x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.84x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.367, Ratio=3.01x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.352, Ratio=2.82x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.375, Ratio=3.12x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.352, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.94x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.359, Ratio=3.04x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.91x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.356, Ratio=2.95x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.346, Ratio=2.83x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.360, Ratio=2.94x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.00x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.07x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.352, Ratio=2.90x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.366, Ratio=3.07x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.96x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.374, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.369, Ratio=3.03x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.361, Ratio=2.89x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.94x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.353, Ratio=2.95x, Gap=-2.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.369, Ratio=2.92x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.03x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.358, Ratio=2.87x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.02x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.97x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.370, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.95x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.363, Ratio=3.02x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.355, Ratio=2.84x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.371, Ratio=3.09x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.77x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.355, Ratio=3.02x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.98x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.369, Ratio=2.94x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.362, Ratio=2.92x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.373, Ratio=3.06x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.360, Ratio=3.09x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.363, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.377, Ratio=3.20x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.356, Ratio=2.97x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.358, Ratio=2.96x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.363, Ratio=2.91x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.04x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.354, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.336, Ratio=2.73x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.376, Ratio=3.13x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.378, Ratio=3.03x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.353, Ratio=2.97x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.349, Ratio=2.75x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.97x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.04x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.375, Ratio=3.03x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.373, Ratio=3.10x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.362, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.368, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.359, Ratio=2.90x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.360, Ratio=2.90x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.91x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.345, Ratio=2.83x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.02x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.373, Ratio=3.12x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.02x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.356, Ratio=2.87x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.355, Ratio=2.89x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.98x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.364, Ratio=2.82x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.382, Ratio=3.29x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.82x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.356, Ratio=2.90x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.359, Ratio=2.92x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.362, Ratio=3.04x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.350, Ratio=2.93x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.354, Ratio=2.88x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.96x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.348, Ratio=2.77x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.361, Ratio=2.91x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.358, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.349, Ratio=2.94x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.372, Ratio=2.94x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.87x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.363, Ratio=2.98x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.358, Ratio=2.94x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.347, Ratio=2.91x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.84x, Gap=-2.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.349, Ratio=2.83x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.87x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.369, Ratio=3.14x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.356, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.382, Ratio=3.21x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.362, Ratio=3.06x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.379, Ratio=3.14x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.348, Ratio=2.85x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.351, Ratio=2.81x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.360, Ratio=2.86x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.362, Ratio=3.04x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.356, Ratio=2.98x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.343, Ratio=2.86x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.372, Ratio=2.96x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.376, Ratio=3.12x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.363, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.06x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.93x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.368, Ratio=2.89x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.359, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.373, Ratio=2.98x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.87x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.364, Ratio=2.93x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.352, Ratio=2.86x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.374, Ratio=3.09x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.90x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.97x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.343, Ratio=2.83x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.98x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.367, Ratio=3.03x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.352, Ratio=2.87x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.83x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.374, Ratio=3.18x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.357, Ratio=2.92x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.374, Ratio=3.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.360, Ratio=2.91x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.86x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.339, Ratio=2.77x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.348, Ratio=2.93x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.351, Ratio=2.95x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.358, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.372, Ratio=3.13x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.370, Ratio=2.95x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.370, Ratio=3.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.01x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.97x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.352, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-2.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.368, Ratio=3.05x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.354, Ratio=2.99x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.353, Ratio=2.82x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.351, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.347, Ratio=2.81x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.85x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.04x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.365, Ratio=2.93x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.345, Ratio=2.74x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.348, Ratio=2.96x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.84x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.376, Ratio=3.03x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.346, Ratio=2.85x, Gap=-2.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.360, Ratio=2.87x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.363, Ratio=2.89x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.354, Ratio=2.83x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.89x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.353, Ratio=2.90x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.352, Ratio=2.78x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.351, Ratio=2.89x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.97x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.90x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.352, Ratio=2.74x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.366, Ratio=3.01x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.334, Ratio=2.69x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.347, Ratio=2.76x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.351, Ratio=2.89x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.343, Ratio=2.85x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.354, Ratio=2.93x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.368, Ratio=2.96x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.352, Ratio=2.88x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.358, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.369, Ratio=3.02x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.337, Ratio=2.75x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.354, Ratio=2.86x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.368, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.357, Ratio=2.93x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.359, Ratio=2.88x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.360, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.363, Ratio=2.95x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.350, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.355, Ratio=2.87x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.356, Ratio=2.83x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.339, Ratio=2.70x, Gap=-2.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.367, Ratio=3.05x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.356, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.355, Ratio=2.83x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.365, Ratio=3.05x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.359, Ratio=2.91x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.359, Ratio=2.87x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.07x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.348, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.367, Ratio=2.92x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.355, Ratio=2.83x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.362, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.98x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.350, Ratio=2.98x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.368, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.373, Ratio=2.98x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.362, Ratio=2.99x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.359, Ratio=2.90x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.355, Ratio=2.89x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.359, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.375, Ratio=2.95x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.93x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.356, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.371, Ratio=2.92x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.97x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.377, Ratio=3.00x, Gap=-2.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.368, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.364, Ratio=3.08x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.353, Ratio=2.93x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.362, Ratio=3.00x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=3.00x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.376, Ratio=3.02x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.345, Ratio=2.81x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.369, Ratio=2.97x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.361, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.381, Ratio=3.19x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.348, Ratio=2.78x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.361, Ratio=2.87x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.369, Ratio=2.93x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.85x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.356, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.98x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.362, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.354, Ratio=2.88x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.356, Ratio=2.92x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.361, Ratio=2.85x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.355, Ratio=2.81x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.372, Ratio=3.03x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.350, Ratio=2.84x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.354, Ratio=2.94x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.346, Ratio=2.84x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.355, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.02x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.378, Ratio=3.07x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.373, Ratio=3.08x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.350, Ratio=2.78x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.09x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.366, Ratio=2.91x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.355, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.371, Ratio=3.01x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.76x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.362, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.81x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.358, Ratio=2.95x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.368, Ratio=3.05x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.73x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.355, Ratio=2.87x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.376, Ratio=3.13x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.357, Ratio=2.89x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.349, Ratio=2.87x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.360, Ratio=2.84x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.360, Ratio=2.98x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.350, Ratio=2.88x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.345, Ratio=2.81x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.358, Ratio=2.92x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.367, Ratio=3.08x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.350, Ratio=2.79x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.371, Ratio=3.03x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.360, Ratio=3.01x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.365, Ratio=2.99x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.372, Ratio=3.05x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.98x, Gap=-2.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.360, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.03x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.353, Ratio=2.87x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.01x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.373, Ratio=3.12x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.350, Ratio=2.83x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.358, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.92x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.358, Ratio=2.87x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.94x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.385, Ratio=3.14x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.384, Ratio=3.08x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.356, Ratio=2.92x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.361, Ratio=2.85x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.349, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=3.00x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.364, Ratio=3.06x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.346, Ratio=2.75x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.362, Ratio=2.93x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.353, Ratio=2.85x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.94x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.09x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.365, Ratio=3.02x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.374, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.350, Ratio=2.85x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.361, Ratio=3.07x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.354, Ratio=2.84x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.363, Ratio=3.02x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.359, Ratio=2.87x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.356, Ratio=2.93x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.366, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.04x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.355, Ratio=2.94x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.367, Ratio=2.93x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.361, Ratio=2.91x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.95x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.74x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.350, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.364, Ratio=2.91x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.91x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.384, Ratio=3.17x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.374, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.90x, Gap=-2.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.358, Ratio=3.03x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.360, Ratio=2.88x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.355, Ratio=2.87x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.343, Ratio=2.85x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.376, Ratio=3.07x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.348, Ratio=2.86x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.369, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.367, Ratio=3.14x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.367, Ratio=3.08x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.367, Ratio=2.96x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.352, Ratio=2.79x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.378, Ratio=2.97x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.358, Ratio=2.84x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.357, Ratio=2.86x, Gap=-2.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.357, Ratio=2.92x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.351, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.355, Ratio=2.87x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.374, Ratio=3.07x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.356, Ratio=2.99x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.356, Ratio=2.80x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.353, Ratio=2.87x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.360, Ratio=3.04x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.348, Ratio=2.79x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.374, Ratio=3.02x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.358, Ratio=2.98x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.372, Ratio=3.00x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.368, Ratio=3.08x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.356, Ratio=2.82x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.341, Ratio=2.76x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.372, Ratio=3.05x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.87x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.382, Ratio=3.20x, Gap=-2.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.370, Ratio=3.10x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.359, Ratio=2.90x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.371, Ratio=2.95x, Gap=-2.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.02x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.373, Ratio=2.99x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.88x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.351, Ratio=2.80x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.365, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.96x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.366, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.370, Ratio=3.11x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.89x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.350, Ratio=2.93x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.09x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.361, Ratio=2.99x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.361, Ratio=2.87x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.366, Ratio=3.08x, Gap=-2.391

============================================================
Epoch 16/20 completed in 35.4s
Train: Loss=1.2090 (C:1.2090, R:0.0000) Ratio=2.68x
Val:   Loss=1.1746 (C:1.1746, R:0.0000) Ratio=3.11x
‚úÖ New best model saved (Val Loss: 1.1746)
============================================================

Epoch 17 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.350, Ratio=2.69x, Gap=-2.918
Batch   0/537: Loss=1.2264 (C:1.2264, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.353, Ratio=2.76x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.366, Ratio=2.78x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.79x, Gap=-2.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.359, Ratio=2.72x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.367, Ratio=2.83x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.371, Ratio=2.83x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.352, Ratio=2.65x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.352, Ratio=2.74x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.69x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.88x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.353, Ratio=2.68x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.355, Ratio=2.76x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.00x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.371, Ratio=2.84x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.359, Ratio=2.76x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.373, Ratio=2.90x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.370, Ratio=2.87x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.67x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.371, Ratio=2.79x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.370, Ratio=2.95x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.376, Ratio=2.98x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.365, Ratio=2.76x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.375, Ratio=2.84x, Gap=-2.929
Batch  25/537: Loss=1.1861 (C:1.1861, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.373, Ratio=2.99x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.356, Ratio=2.77x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.369, Ratio=2.90x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.361, Ratio=2.72x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.368, Ratio=2.76x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.342, Ratio=2.72x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.349, Ratio=2.68x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.352, Ratio=2.83x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.356, Ratio=2.74x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.361, Ratio=2.77x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.378, Ratio=2.94x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.374, Ratio=2.88x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.373, Ratio=2.78x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.369, Ratio=2.78x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.344, Ratio=2.74x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.372, Ratio=2.80x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.357, Ratio=2.68x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.337, Ratio=2.73x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.355, Ratio=2.86x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.98x, Gap=-2.888
Batch  50/537: Loss=1.1655 (C:1.1655, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.342, Ratio=2.75x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.382, Ratio=2.95x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.356, Ratio=2.75x, Gap=-2.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.370, Ratio=2.80x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.373, Ratio=2.83x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.368, Ratio=2.75x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.345, Ratio=2.72x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.355, Ratio=2.78x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.372, Ratio=2.75x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.357, Ratio=2.76x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.349, Ratio=2.80x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.360, Ratio=2.83x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.379, Ratio=2.86x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.353, Ratio=2.69x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.356, Ratio=2.76x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.358, Ratio=2.72x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.356, Ratio=2.77x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.371, Ratio=2.87x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.367, Ratio=2.74x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.381, Ratio=2.85x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.360, Ratio=2.79x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.369, Ratio=2.84x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.363, Ratio=2.93x, Gap=-2.742
Batch  75/537: Loss=1.1740 (C:1.1740, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.348, Ratio=2.76x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.359, Ratio=2.81x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.349, Ratio=2.65x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.372, Ratio=2.75x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.365, Ratio=2.78x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.376, Ratio=2.75x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.366, Ratio=2.71x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.365, Ratio=2.85x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.80x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.366, Ratio=2.87x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.77x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.370, Ratio=2.87x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.376, Ratio=2.87x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.349, Ratio=2.67x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.357, Ratio=2.67x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.370, Ratio=2.84x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.365, Ratio=2.80x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.76x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.388, Ratio=2.89x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.370, Ratio=2.84x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.349, Ratio=2.70x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.356, Ratio=2.77x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.368, Ratio=2.97x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.362, Ratio=2.81x, Gap=-2.717
Batch 100/537: Loss=1.1976 (C:1.1976, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.365, Ratio=2.84x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.376, Ratio=2.98x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.371, Ratio=2.86x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.359, Ratio=2.86x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.374, Ratio=2.84x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.375, Ratio=2.87x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.374, Ratio=2.81x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.361, Ratio=2.72x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.363, Ratio=2.80x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.369, Ratio=2.92x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.365, Ratio=2.86x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.359, Ratio=2.86x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.376, Ratio=2.93x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.351, Ratio=2.72x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.368, Ratio=2.73x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.370, Ratio=2.80x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.342, Ratio=2.66x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.369, Ratio=2.88x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.378, Ratio=3.02x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.366, Ratio=2.70x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.363, Ratio=2.75x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.360, Ratio=2.73x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.355, Ratio=2.68x, Gap=-2.719
Batch 125/537: Loss=1.2243 (C:1.2243, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.361, Ratio=2.69x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.356, Ratio=2.68x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.369, Ratio=2.79x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.343, Ratio=2.64x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.362, Ratio=2.74x, Gap=-2.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.356, Ratio=2.76x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.378, Ratio=2.88x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.371, Ratio=2.92x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.364, Ratio=2.81x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.343, Ratio=2.62x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.354, Ratio=2.64x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.366, Ratio=2.68x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.359, Ratio=2.77x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.379, Ratio=2.88x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.89x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.373, Ratio=2.94x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.366, Ratio=2.81x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.362, Ratio=2.73x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.358, Ratio=2.68x, Gap=-2.890
Batch 150/537: Loss=1.2283 (C:1.2283, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.369, Ratio=2.86x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.355, Ratio=2.69x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.348, Ratio=2.71x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.351, Ratio=2.67x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.82x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.359, Ratio=2.84x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.363, Ratio=2.85x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.373, Ratio=2.84x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.366, Ratio=2.74x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.364, Ratio=2.73x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.370, Ratio=2.77x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.356, Ratio=2.79x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.373, Ratio=2.84x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.357, Ratio=2.76x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.351, Ratio=2.69x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.346, Ratio=2.68x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.336, Ratio=2.61x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.80x, Gap=-3.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.385, Ratio=2.99x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.357, Ratio=2.72x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.378, Ratio=2.86x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.79x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.357, Ratio=2.74x, Gap=-2.706
Batch 175/537: Loss=1.2131 (C:1.2131, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.381, Ratio=2.92x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.371, Ratio=2.88x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.370, Ratio=2.89x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.355, Ratio=2.71x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.343, Ratio=2.78x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.361, Ratio=2.86x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.364, Ratio=2.87x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.341, Ratio=2.68x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.369, Ratio=2.83x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.367, Ratio=2.72x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.374, Ratio=2.85x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.78x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.360, Ratio=2.75x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.359, Ratio=2.73x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.371, Ratio=2.89x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.378, Ratio=2.94x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.74x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.379, Ratio=2.98x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.359, Ratio=2.70x, Gap=-2.814
Batch 200/537: Loss=1.2230 (C:1.2230, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.375, Ratio=2.95x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.348, Ratio=2.66x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.349, Ratio=2.69x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.372, Ratio=2.96x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.365, Ratio=2.81x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.356, Ratio=2.75x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.362, Ratio=2.74x, Gap=-2.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.73x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.356, Ratio=2.75x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.370, Ratio=2.86x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.376, Ratio=2.89x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.360, Ratio=2.76x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.358, Ratio=2.83x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.371, Ratio=2.88x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.365, Ratio=2.76x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.367, Ratio=2.88x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.368, Ratio=2.78x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.360, Ratio=2.79x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.368, Ratio=2.78x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.369, Ratio=2.81x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.369, Ratio=2.75x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.374, Ratio=2.89x, Gap=-2.793
Batch 225/537: Loss=1.1818 (C:1.1818, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.353, Ratio=2.70x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.370, Ratio=2.90x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.365, Ratio=2.81x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.357, Ratio=2.79x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.366, Ratio=2.80x, Gap=-2.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.353, Ratio=2.74x, Gap=-3.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.377, Ratio=2.93x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.369, Ratio=2.88x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.364, Ratio=2.72x, Gap=-2.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.368, Ratio=2.79x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.371, Ratio=2.72x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.378, Ratio=2.82x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.365, Ratio=2.77x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.347, Ratio=2.71x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.369, Ratio=2.89x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.87x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.353, Ratio=2.70x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.360, Ratio=2.82x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.89x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.370, Ratio=2.96x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.370, Ratio=2.85x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.341, Ratio=2.56x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.361, Ratio=2.70x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.358, Ratio=2.74x, Gap=-2.846
Batch 250/537: Loss=1.2134 (C:1.2134, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.354, Ratio=2.69x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.373, Ratio=2.81x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.378, Ratio=2.98x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.361, Ratio=2.78x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.370, Ratio=2.87x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.359, Ratio=2.83x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.350, Ratio=2.76x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.70x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.332, Ratio=2.55x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.79x, Gap=-2.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.367, Ratio=2.76x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.364, Ratio=2.65x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.370, Ratio=2.78x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.370, Ratio=2.74x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.353, Ratio=2.76x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.361, Ratio=2.76x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.368, Ratio=2.84x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-2.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.356, Ratio=2.67x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.348, Ratio=2.65x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.661
Batch 275/537: Loss=1.2093 (C:1.2093, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.369, Ratio=2.81x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.362, Ratio=2.71x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.79x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-3.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.370, Ratio=2.88x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.370, Ratio=2.87x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.359, Ratio=2.78x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.77x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.364, Ratio=2.77x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.09x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.353, Ratio=2.60x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.342, Ratio=2.65x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.357, Ratio=2.65x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.372, Ratio=2.93x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.363, Ratio=2.66x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.362, Ratio=2.79x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.357, Ratio=2.77x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.371, Ratio=2.83x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.346, Ratio=2.75x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.373, Ratio=2.85x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.390, Ratio=3.09x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.351, Ratio=2.70x, Gap=-2.847
Batch 300/537: Loss=1.2235 (C:1.2235, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.352, Ratio=2.73x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.76x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.367, Ratio=2.76x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.354, Ratio=2.81x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.361, Ratio=2.73x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.370, Ratio=2.86x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.356, Ratio=2.81x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.356, Ratio=2.76x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.76x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.365, Ratio=2.78x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.356, Ratio=2.67x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.363, Ratio=2.66x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.360, Ratio=2.68x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.339, Ratio=2.73x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.346, Ratio=2.73x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.372, Ratio=2.77x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.361, Ratio=2.72x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.363, Ratio=2.79x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.362, Ratio=2.74x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.363, Ratio=2.72x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.357, Ratio=2.70x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.361, Ratio=2.73x, Gap=-2.762
Batch 325/537: Loss=1.2133 (C:1.2133, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.368, Ratio=2.78x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.361, Ratio=2.78x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.362, Ratio=2.67x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.350, Ratio=2.69x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.360, Ratio=2.74x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.370, Ratio=2.92x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.365, Ratio=2.87x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.354, Ratio=2.67x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.375, Ratio=2.92x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.342, Ratio=2.61x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.341, Ratio=2.63x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.343, Ratio=2.69x, Gap=-2.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.343, Ratio=2.77x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.351, Ratio=2.78x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.359, Ratio=2.67x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.361, Ratio=2.67x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.83x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.358, Ratio=2.74x, Gap=-2.768
Batch 350/537: Loss=1.2139 (C:1.2139, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.368, Ratio=2.87x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.352, Ratio=2.65x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.73x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.352, Ratio=2.77x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.354, Ratio=2.65x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.358, Ratio=2.79x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.373, Ratio=2.78x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.364, Ratio=2.91x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.369, Ratio=2.86x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.375, Ratio=2.77x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.337, Ratio=2.64x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.345, Ratio=2.70x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.355, Ratio=2.65x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.360, Ratio=2.79x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.76x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.344, Ratio=2.64x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.366, Ratio=2.85x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.345, Ratio=2.68x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.370, Ratio=2.91x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.363, Ratio=2.76x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.360, Ratio=2.75x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.359, Ratio=2.72x, Gap=-2.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.360, Ratio=2.81x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.363, Ratio=2.74x, Gap=-2.996
Batch 375/537: Loss=1.2075 (C:1.2075, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.369, Ratio=2.73x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.366, Ratio=2.69x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.368, Ratio=2.75x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.352, Ratio=2.72x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.362, Ratio=2.76x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.359, Ratio=2.71x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.364, Ratio=2.75x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.346, Ratio=2.73x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.347, Ratio=2.82x, Gap=-2.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.366, Ratio=2.87x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.361, Ratio=2.81x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.369, Ratio=2.76x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.372, Ratio=2.76x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.363, Ratio=2.74x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.79x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.357, Ratio=2.66x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.369, Ratio=2.88x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.360, Ratio=2.92x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.361, Ratio=2.75x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.373, Ratio=2.87x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.346, Ratio=2.77x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.357, Ratio=2.68x, Gap=-2.883
Batch 400/537: Loss=1.2244 (C:1.2244, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.341, Ratio=2.67x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.346, Ratio=2.59x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.367, Ratio=2.70x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.371, Ratio=2.79x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.361, Ratio=2.71x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.366, Ratio=2.78x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.379, Ratio=2.86x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.347, Ratio=2.63x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.364, Ratio=2.74x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.375, Ratio=2.86x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.365, Ratio=2.82x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.354, Ratio=2.73x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.354, Ratio=2.68x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.346, Ratio=2.68x, Gap=-2.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-3.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.370, Ratio=2.93x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.349, Ratio=2.60x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.370, Ratio=2.76x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.368, Ratio=2.72x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.367, Ratio=2.79x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.374, Ratio=2.79x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.355, Ratio=2.65x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.369, Ratio=2.81x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.349, Ratio=2.78x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.77x, Gap=-2.923
Batch 425/537: Loss=1.2109 (C:1.2109, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.378, Ratio=2.93x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.358, Ratio=2.68x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.367, Ratio=2.85x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.383, Ratio=2.86x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.362, Ratio=2.75x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.371, Ratio=2.80x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.354, Ratio=2.76x, Gap=-3.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.366, Ratio=2.78x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.370, Ratio=2.88x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.373, Ratio=2.80x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.360, Ratio=2.73x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.363, Ratio=2.82x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.354, Ratio=2.75x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.361, Ratio=2.77x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.365, Ratio=2.84x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.367, Ratio=2.87x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.352, Ratio=2.71x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.367, Ratio=2.79x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.370, Ratio=2.89x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.349, Ratio=2.63x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.355, Ratio=2.67x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.79x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.367, Ratio=2.87x, Gap=-2.877
Batch 450/537: Loss=1.1876 (C:1.1876, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.362, Ratio=2.82x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.357, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.369, Ratio=2.92x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.364, Ratio=2.85x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.367, Ratio=2.78x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.379, Ratio=2.92x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.363, Ratio=2.80x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.367, Ratio=2.74x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.376, Ratio=2.78x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.378, Ratio=2.84x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.356, Ratio=2.70x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.356, Ratio=2.79x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.362, Ratio=2.80x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.340, Ratio=2.61x, Gap=-2.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.352, Ratio=2.73x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.354, Ratio=2.75x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.349, Ratio=2.71x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.366, Ratio=2.90x, Gap=-2.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.73x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.365, Ratio=2.83x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.370, Ratio=2.83x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.367, Ratio=2.77x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.361, Ratio=2.74x, Gap=-3.200
Batch 475/537: Loss=1.2108 (C:1.2108, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.360, Ratio=2.73x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.372, Ratio=2.92x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.371, Ratio=2.85x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.353, Ratio=2.71x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.339, Ratio=2.68x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.350, Ratio=2.70x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.363, Ratio=2.87x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.367, Ratio=2.83x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.367, Ratio=2.83x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.352, Ratio=2.70x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.348, Ratio=2.69x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.348, Ratio=2.62x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.369, Ratio=2.74x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.77x, Gap=-2.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.367, Ratio=2.78x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.368, Ratio=2.88x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.352, Ratio=2.71x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.343, Ratio=2.72x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.363, Ratio=2.77x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.369, Ratio=2.84x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.365, Ratio=2.73x, Gap=-2.747
Batch 500/537: Loss=1.2103 (C:1.2103, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.356, Ratio=2.72x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.354, Ratio=2.79x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.345, Ratio=2.71x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.351, Ratio=2.65x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.345, Ratio=2.71x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.359, Ratio=2.70x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.76x, Gap=-2.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.366, Ratio=2.75x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.365, Ratio=2.79x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.354, Ratio=2.70x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.360, Ratio=2.78x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.370, Ratio=2.74x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.355, Ratio=2.77x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.365, Ratio=2.83x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.79x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.347, Ratio=2.64x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.359, Ratio=2.74x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.369, Ratio=2.82x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.357, Ratio=2.77x, Gap=-2.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.376, Ratio=2.78x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.362, Ratio=2.73x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.368, Ratio=2.85x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.352, Ratio=2.75x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.341, Ratio=2.70x, Gap=-2.919
Batch 525/537: Loss=1.2279 (C:1.2279, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.382, Ratio=2.92x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.351, Ratio=2.76x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.359, Ratio=2.75x, Gap=-2.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.350, Ratio=2.80x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.352, Ratio=2.68x, Gap=-3.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.363, Ratio=2.81x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.357, Ratio=2.63x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.374, Ratio=2.86x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.77x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.00x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.384, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.379, Ratio=3.14x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.382, Ratio=3.19x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.365, Ratio=2.92x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.367, Ratio=3.06x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.375, Ratio=3.15x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.01x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.04x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.371, Ratio=3.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.350, Ratio=2.77x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.359, Ratio=2.92x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.04x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.94x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.354, Ratio=2.90x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.366, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.354, Ratio=3.02x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.380, Ratio=3.15x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.372, Ratio=3.05x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.372, Ratio=3.12x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.359, Ratio=2.97x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.367, Ratio=3.05x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.361, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.351, Ratio=2.87x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.374, Ratio=3.09x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.89x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.03x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.97x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.365, Ratio=3.04x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.374, Ratio=3.07x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.354, Ratio=2.83x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.353, Ratio=2.89x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.344, Ratio=2.82x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.365, Ratio=2.93x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.98x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.367, Ratio=3.11x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.352, Ratio=2.95x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.00x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.365, Ratio=2.91x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.11x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.370, Ratio=3.12x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.369, Ratio=2.92x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.350, Ratio=2.88x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.382, Ratio=3.11x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.366, Ratio=3.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.358, Ratio=2.85x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.368, Ratio=2.92x, Gap=-2.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.352, Ratio=2.90x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.341, Ratio=2.84x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.360, Ratio=2.93x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.363, Ratio=2.88x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.377, Ratio=3.13x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.357, Ratio=2.91x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.355, Ratio=3.02x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.368, Ratio=2.94x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.365, Ratio=3.06x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.14x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.347, Ratio=2.89x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.01x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.13x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.366, Ratio=3.00x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.378, Ratio=3.11x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.367, Ratio=3.01x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.371, Ratio=3.12x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.349, Ratio=2.80x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.356, Ratio=2.84x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.365, Ratio=2.97x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.360, Ratio=2.85x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.04x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.365, Ratio=2.92x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.359, Ratio=2.87x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.357, Ratio=2.93x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.353, Ratio=2.96x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.342, Ratio=2.87x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.95x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.351, Ratio=2.93x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.368, Ratio=2.91x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.359, Ratio=2.93x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.364, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.362, Ratio=3.01x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.367, Ratio=3.09x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.356, Ratio=2.87x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.378, Ratio=3.17x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.351, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.356, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.359, Ratio=2.95x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.12x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.92x, Gap=-2.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.377, Ratio=3.20x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.367, Ratio=2.92x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.351, Ratio=2.86x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.09x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.364, Ratio=2.89x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.362, Ratio=3.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.02x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.352, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.365, Ratio=2.94x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.360, Ratio=2.93x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.341, Ratio=2.84x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.384, Ratio=3.19x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.376, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.346, Ratio=2.86x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.350, Ratio=2.98x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.378, Ratio=3.08x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.371, Ratio=3.15x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.372, Ratio=3.01x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.06x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.347, Ratio=2.87x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.364, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.356, Ratio=2.94x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.367, Ratio=2.89x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=2.99x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.357, Ratio=2.93x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.367, Ratio=3.10x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.376, Ratio=3.11x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.353, Ratio=2.76x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.359, Ratio=2.98x, Gap=-2.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.353, Ratio=2.96x, Gap=-2.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.370, Ratio=2.97x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.371, Ratio=3.07x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.371, Ratio=3.11x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.363, Ratio=2.96x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.370, Ratio=3.19x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.363, Ratio=3.01x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.378, Ratio=3.04x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.369, Ratio=2.95x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.374, Ratio=3.20x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.367, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.345, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.362, Ratio=2.86x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.359, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.370, Ratio=3.07x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.368, Ratio=2.96x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.374, Ratio=3.13x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.365, Ratio=3.10x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.373, Ratio=3.06x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.371, Ratio=3.02x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.359, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.378, Ratio=3.03x, Gap=-2.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.359, Ratio=3.06x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.381, Ratio=3.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.366, Ratio=3.11x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.358, Ratio=2.81x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.377, Ratio=3.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.362, Ratio=2.96x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.364, Ratio=3.06x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.370, Ratio=3.05x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.343, Ratio=2.85x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.372, Ratio=3.06x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.09x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.357, Ratio=2.98x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.344, Ratio=2.73x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.369, Ratio=3.01x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.351, Ratio=2.78x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.357, Ratio=2.81x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.351, Ratio=2.84x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.359, Ratio=2.86x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.359, Ratio=2.90x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.361, Ratio=3.02x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.370, Ratio=3.01x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.357, Ratio=3.05x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.373, Ratio=3.19x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.357, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.372, Ratio=3.07x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.384, Ratio=3.11x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.351, Ratio=2.96x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.358, Ratio=2.95x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.360, Ratio=3.00x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.351, Ratio=2.77x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.370, Ratio=3.03x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.354, Ratio=2.86x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.98x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.359, Ratio=2.91x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.92x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.360, Ratio=2.99x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.345, Ratio=2.84x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.353, Ratio=2.88x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.00x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.372, Ratio=3.07x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.370, Ratio=3.12x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.92x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.342, Ratio=2.78x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.345, Ratio=2.91x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.354, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.373, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.366, Ratio=3.01x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.376, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.346, Ratio=2.85x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.350, Ratio=2.97x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.366, Ratio=3.04x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.358, Ratio=2.86x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.357, Ratio=2.86x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.347, Ratio=2.79x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.91x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.373, Ratio=2.98x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.09x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.359, Ratio=3.07x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.387, Ratio=3.14x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.348, Ratio=2.95x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.384, Ratio=3.14x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.377, Ratio=3.09x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.00x, Gap=-2.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.350, Ratio=2.96x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.371, Ratio=3.03x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.370, Ratio=3.05x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.358, Ratio=2.91x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.359, Ratio=3.02x, Gap=-2.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.364, Ratio=2.99x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.363, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.349, Ratio=2.92x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.366, Ratio=2.98x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.380, Ratio=3.10x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.374, Ratio=3.09x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.374, Ratio=3.10x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.352, Ratio=2.85x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.365, Ratio=3.08x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.345, Ratio=2.84x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.01x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.374, Ratio=3.17x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.367, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.353, Ratio=2.90x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.366, Ratio=2.92x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.346, Ratio=2.79x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.369, Ratio=3.15x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.360, Ratio=2.91x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.98x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.359, Ratio=2.90x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.373, Ratio=3.02x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.355, Ratio=2.85x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.351, Ratio=2.87x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.380, Ratio=3.20x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.87x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.379, Ratio=3.17x, Gap=-2.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.355, Ratio=2.88x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.360, Ratio=2.99x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.379, Ratio=3.04x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.373, Ratio=3.02x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.362, Ratio=2.84x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.341, Ratio=2.86x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.349, Ratio=2.87x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.371, Ratio=3.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.358, Ratio=2.80x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.369, Ratio=3.08x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.367, Ratio=2.96x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.374, Ratio=3.05x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.347, Ratio=2.83x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.354, Ratio=2.83x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.95x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.350, Ratio=2.79x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.367, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.359, Ratio=2.83x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.370, Ratio=3.00x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.371, Ratio=3.08x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.369, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.378, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.90x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.363, Ratio=2.97x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.360, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.366, Ratio=3.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.359, Ratio=2.95x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.373, Ratio=3.02x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.370, Ratio=3.01x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.372, Ratio=3.04x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.03x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.373, Ratio=3.08x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.353, Ratio=2.99x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.368, Ratio=3.02x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.365, Ratio=3.06x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.377, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.05x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.366, Ratio=2.98x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.374, Ratio=2.99x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.355, Ratio=2.82x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.381, Ratio=3.05x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.364, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.339, Ratio=2.79x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.368, Ratio=2.96x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.355, Ratio=2.96x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.373, Ratio=3.06x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.347, Ratio=2.80x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.352, Ratio=3.07x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.00x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.369, Ratio=3.05x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.363, Ratio=2.88x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.03x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.373, Ratio=3.11x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.96x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.374, Ratio=3.12x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.353, Ratio=3.03x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.350, Ratio=2.88x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.377, Ratio=3.08x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.346, Ratio=2.78x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.372, Ratio=3.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.334, Ratio=2.69x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.376, Ratio=3.04x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.376, Ratio=3.09x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.372, Ratio=3.18x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.359, Ratio=2.91x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.368, Ratio=3.09x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.385, Ratio=3.10x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.369, Ratio=3.02x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.360, Ratio=2.93x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.367, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.366, Ratio=3.04x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.375, Ratio=3.13x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.365, Ratio=3.01x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.369, Ratio=3.05x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.368, Ratio=2.98x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.357, Ratio=2.79x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.370, Ratio=2.94x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.367, Ratio=3.09x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.363, Ratio=2.89x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.360, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.358, Ratio=2.98x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.372, Ratio=2.97x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.350, Ratio=2.83x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.354, Ratio=2.89x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.366, Ratio=3.03x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.87x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.371, Ratio=3.12x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.347, Ratio=2.91x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.353, Ratio=2.90x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.374, Ratio=2.98x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.98x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.351, Ratio=2.88x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.369, Ratio=2.86x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.353, Ratio=2.96x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.364, Ratio=2.91x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.356, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.360, Ratio=2.94x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.396, Ratio=3.27x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.356, Ratio=2.86x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.358, Ratio=3.03x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.352, Ratio=2.91x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.97x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.350, Ratio=2.87x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.364, Ratio=2.84x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.358, Ratio=3.01x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.368, Ratio=2.95x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.361, Ratio=2.97x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.361, Ratio=2.97x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.372, Ratio=3.07x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.355, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.356, Ratio=2.91x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.361, Ratio=2.87x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.355, Ratio=2.92x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.365, Ratio=3.02x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.373, Ratio=3.06x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.347, Ratio=2.74x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.373, Ratio=3.12x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.364, Ratio=2.97x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.376, Ratio=3.16x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.372, Ratio=2.97x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.375, Ratio=3.07x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.371, Ratio=3.09x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.349, Ratio=2.86x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.361, Ratio=2.97x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.98x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.377, Ratio=3.17x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.361, Ratio=3.07x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.365, Ratio=3.04x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.359, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.379, Ratio=3.08x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.11x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.360, Ratio=2.86x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.354, Ratio=2.91x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.348, Ratio=2.78x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.363, Ratio=3.01x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.378, Ratio=3.16x, Gap=-2.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.359, Ratio=2.99x, Gap=-2.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.371, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.356, Ratio=2.79x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.371, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.374, Ratio=3.05x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.364, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.367, Ratio=2.98x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.374, Ratio=2.99x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.353, Ratio=2.92x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.363, Ratio=3.00x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.357, Ratio=2.83x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.357, Ratio=2.97x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.357, Ratio=2.93x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.336, Ratio=2.77x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.378, Ratio=3.15x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.345, Ratio=2.87x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.364, Ratio=2.91x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.362, Ratio=2.95x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.362, Ratio=3.06x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.372, Ratio=3.09x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.366, Ratio=3.02x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.379, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.360, Ratio=2.87x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.368, Ratio=3.05x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.379, Ratio=3.10x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.349, Ratio=2.88x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.375, Ratio=3.12x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.353, Ratio=2.99x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.363, Ratio=2.97x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.369, Ratio=3.05x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.360, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.358, Ratio=2.90x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.357, Ratio=2.94x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.357, Ratio=2.96x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.359, Ratio=2.95x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.366, Ratio=2.98x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.366, Ratio=3.01x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.09x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.356, Ratio=2.89x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.365, Ratio=3.04x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.363, Ratio=2.87x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.369, Ratio=2.92x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.348, Ratio=2.99x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.361, Ratio=2.90x, Gap=-2.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.359, Ratio=2.94x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.355, Ratio=2.94x, Gap=-2.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.365, Ratio=2.95x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.372, Ratio=3.06x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.363, Ratio=3.02x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.392

============================================================
Epoch 17/20 completed in 29.5s
Train: Loss=1.2038 (C:1.2038, R:0.0000) Ratio=2.73x
Val:   Loss=1.1702 (C:1.1702, R:0.0000) Ratio=3.21x
‚úÖ New best model saved (Val Loss: 1.1702)
============================================================

Epoch 18 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-2.797
Batch   0/537: Loss=1.1951 (C:1.1951, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.382, Ratio=2.88x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.358, Ratio=2.76x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.88x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.353, Ratio=2.72x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.342, Ratio=2.71x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.73x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.361, Ratio=2.82x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.361, Ratio=2.67x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.369, Ratio=2.80x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.365, Ratio=2.77x, Gap=-2.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.386, Ratio=2.95x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.361, Ratio=2.75x, Gap=-2.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.373, Ratio=2.88x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.352, Ratio=2.80x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.340, Ratio=2.65x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.348, Ratio=2.76x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.364, Ratio=2.75x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.358, Ratio=2.72x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.379, Ratio=2.95x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-2.932
Batch  25/537: Loss=1.2065 (C:1.2065, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.81x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.377, Ratio=2.79x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.373, Ratio=2.75x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.351, Ratio=2.75x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.365, Ratio=2.88x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.354, Ratio=2.78x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.356, Ratio=2.83x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.368, Ratio=3.01x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.367, Ratio=2.92x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.357, Ratio=2.82x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.374, Ratio=2.86x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.371, Ratio=2.79x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.385, Ratio=2.95x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.382, Ratio=2.95x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.367, Ratio=2.79x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.351, Ratio=2.81x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.367, Ratio=2.81x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.366, Ratio=2.81x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.360, Ratio=2.81x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.360, Ratio=2.71x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.376, Ratio=2.91x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.367, Ratio=2.91x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.79x, Gap=-2.747
Batch  50/537: Loss=1.2009 (C:1.2009, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.382, Ratio=2.94x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.353, Ratio=2.75x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.381, Ratio=2.91x, Gap=-2.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.373, Ratio=2.90x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.365, Ratio=2.79x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.350, Ratio=2.67x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.351, Ratio=2.71x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.359, Ratio=2.74x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.359, Ratio=2.73x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.366, Ratio=2.76x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.377, Ratio=2.93x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.365, Ratio=2.99x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.365, Ratio=2.80x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.371, Ratio=2.74x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.359, Ratio=2.70x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.350, Ratio=2.61x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.371, Ratio=2.84x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.356, Ratio=2.71x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.365, Ratio=2.75x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.358, Ratio=2.76x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.374, Ratio=2.87x, Gap=-2.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.369, Ratio=2.78x, Gap=-3.135
Batch  75/537: Loss=1.1972 (C:1.1972, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.363, Ratio=2.74x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.355, Ratio=2.84x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.363, Ratio=2.80x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.364, Ratio=2.71x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.384, Ratio=2.91x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.359, Ratio=2.77x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.363, Ratio=2.80x, Gap=-2.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.355, Ratio=2.68x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.372, Ratio=2.78x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.362, Ratio=2.78x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.369, Ratio=2.91x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.355, Ratio=2.71x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.356, Ratio=2.79x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.369, Ratio=2.86x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.362, Ratio=2.77x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.356, Ratio=2.86x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.373, Ratio=2.90x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.374, Ratio=2.96x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.357, Ratio=2.70x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.368, Ratio=2.87x, Gap=-2.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.362, Ratio=2.81x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.378, Ratio=2.93x, Gap=-2.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.356, Ratio=2.73x, Gap=-2.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.675
Batch 100/537: Loss=1.1993 (C:1.1993, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.351, Ratio=2.83x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.359, Ratio=2.79x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.375, Ratio=2.71x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.364, Ratio=2.70x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.368, Ratio=2.81x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.376, Ratio=2.96x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.348, Ratio=2.63x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.370, Ratio=2.87x, Gap=-2.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.363, Ratio=2.72x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.365, Ratio=2.89x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.82x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.352, Ratio=2.67x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.370, Ratio=2.88x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.355, Ratio=2.81x, Gap=-2.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.379, Ratio=2.90x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.384, Ratio=2.88x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.367, Ratio=2.85x, Gap=-2.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.362, Ratio=2.75x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.377, Ratio=2.90x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.371, Ratio=2.90x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.79x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.352, Ratio=2.73x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.353, Ratio=2.81x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.357, Ratio=2.82x, Gap=-2.577
Batch 125/537: Loss=1.1968 (C:1.1968, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.361, Ratio=2.83x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.351, Ratio=2.68x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.360, Ratio=2.81x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.371, Ratio=2.82x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.361, Ratio=2.78x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.365, Ratio=2.70x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.382, Ratio=2.82x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.360, Ratio=2.69x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.376, Ratio=2.83x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.364, Ratio=2.79x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.375, Ratio=2.92x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.360, Ratio=2.85x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.368, Ratio=2.80x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.360, Ratio=2.76x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.74x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.92x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.350, Ratio=2.81x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.356, Ratio=2.70x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.367, Ratio=2.75x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.353, Ratio=2.68x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.354, Ratio=2.68x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.377, Ratio=2.90x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.361, Ratio=2.80x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.350, Ratio=2.66x, Gap=-2.756
Batch 150/537: Loss=1.2340 (C:1.2340, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.350, Ratio=2.66x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.367, Ratio=2.76x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.375, Ratio=2.96x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.368, Ratio=2.84x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.354, Ratio=2.69x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.359, Ratio=2.80x, Gap=-2.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.357, Ratio=2.75x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.369, Ratio=2.87x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.376, Ratio=2.88x, Gap=-3.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.377, Ratio=2.90x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.375, Ratio=2.87x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.362, Ratio=2.72x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.369, Ratio=2.84x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.348, Ratio=2.75x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.357, Ratio=2.79x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.347, Ratio=2.70x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.362, Ratio=2.78x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.358, Ratio=2.85x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.363, Ratio=2.83x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.376, Ratio=2.92x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.343, Ratio=2.63x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.371, Ratio=2.89x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.361, Ratio=2.70x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.371, Ratio=2.89x, Gap=-2.803
Batch 175/537: Loss=1.1802 (C:1.1802, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.379, Ratio=2.93x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.375, Ratio=2.89x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.363, Ratio=2.69x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.358, Ratio=2.69x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.364, Ratio=2.95x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.360, Ratio=2.80x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.348, Ratio=2.68x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.373, Ratio=2.85x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.357, Ratio=2.73x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.374, Ratio=2.90x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.350, Ratio=2.73x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.361, Ratio=2.73x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.368, Ratio=2.84x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.373, Ratio=3.05x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.375, Ratio=2.85x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.348, Ratio=2.80x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.361, Ratio=2.80x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.360, Ratio=2.75x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.368, Ratio=2.86x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.368, Ratio=2.72x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.368, Ratio=2.80x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.379, Ratio=2.87x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.365, Ratio=2.80x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.361, Ratio=2.72x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.365, Ratio=2.74x, Gap=-2.768
Batch 200/537: Loss=1.2057 (C:1.2057, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.376, Ratio=2.82x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.343, Ratio=2.71x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.354, Ratio=2.80x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.360, Ratio=2.86x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.82x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.346, Ratio=2.72x, Gap=-2.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.359, Ratio=2.82x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.370, Ratio=2.85x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.368, Ratio=2.73x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.363, Ratio=2.77x, Gap=-2.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.338, Ratio=2.61x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.371, Ratio=2.89x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.368, Ratio=2.86x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.379, Ratio=2.89x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.77x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.356, Ratio=2.71x, Gap=-2.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.364, Ratio=2.75x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.358, Ratio=2.75x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.372, Ratio=2.89x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.383, Ratio=2.94x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.347, Ratio=2.69x, Gap=-2.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.374, Ratio=2.91x, Gap=-2.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.372, Ratio=2.77x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.355, Ratio=2.78x, Gap=-2.881
Batch 225/537: Loss=1.2091 (C:1.2091, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.361, Ratio=2.79x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.357, Ratio=2.76x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.355, Ratio=2.72x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.358, Ratio=2.86x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.382, Ratio=2.98x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.360, Ratio=2.72x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.360, Ratio=2.82x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.368, Ratio=2.77x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.370, Ratio=2.84x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.361, Ratio=2.73x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.356, Ratio=2.68x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.362, Ratio=2.82x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.371, Ratio=2.94x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.359, Ratio=2.70x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.361, Ratio=2.76x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.368, Ratio=2.84x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.365, Ratio=2.85x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.362, Ratio=2.81x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.365, Ratio=2.76x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.359, Ratio=2.76x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.361, Ratio=2.88x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.344, Ratio=2.70x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.379, Ratio=2.86x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.354, Ratio=2.69x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.338, Ratio=2.64x, Gap=-2.751
Batch 250/537: Loss=1.2389 (C:1.2389, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.361, Ratio=2.79x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.356, Ratio=2.77x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.363, Ratio=2.74x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.376, Ratio=2.87x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.358, Ratio=2.79x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.375, Ratio=2.85x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.366, Ratio=2.81x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.384, Ratio=3.01x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.353, Ratio=2.73x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.367, Ratio=2.90x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.363, Ratio=2.78x, Gap=-3.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.371, Ratio=2.88x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.364, Ratio=2.83x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.350, Ratio=2.69x, Gap=-2.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.345, Ratio=2.72x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.372, Ratio=2.91x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.352, Ratio=2.70x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.363, Ratio=2.71x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.365, Ratio=2.85x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.377, Ratio=2.79x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.375, Ratio=2.83x, Gap=-2.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.376, Ratio=3.00x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.89x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.364, Ratio=2.70x, Gap=-2.884
Batch 275/537: Loss=1.2173 (C:1.2173, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.350, Ratio=2.71x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.76x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.358, Ratio=2.75x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.349, Ratio=2.72x, Gap=-2.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.350, Ratio=2.72x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.355, Ratio=2.79x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.365, Ratio=2.78x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.365, Ratio=2.73x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.371, Ratio=2.89x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.360, Ratio=2.82x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.368, Ratio=2.95x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.375, Ratio=2.86x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.368, Ratio=2.71x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.382, Ratio=2.76x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.374, Ratio=2.90x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.367, Ratio=2.77x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.345, Ratio=2.74x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.362, Ratio=2.83x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.352, Ratio=2.78x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.352, Ratio=2.77x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.354, Ratio=2.65x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.374, Ratio=2.79x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.370, Ratio=2.78x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.364, Ratio=2.74x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.358, Ratio=2.77x, Gap=-2.787
Batch 300/537: Loss=1.2079 (C:1.2079, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.362, Ratio=2.79x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.374, Ratio=2.96x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.364, Ratio=2.82x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.344, Ratio=2.71x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.350, Ratio=2.76x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.357, Ratio=2.84x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.340, Ratio=2.77x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.360, Ratio=2.76x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.367, Ratio=2.90x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.354, Ratio=2.81x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.363, Ratio=2.75x, Gap=-2.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.350, Ratio=2.75x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.357, Ratio=2.75x, Gap=-3.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.368, Ratio=2.89x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.383, Ratio=2.90x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.372, Ratio=2.83x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.360, Ratio=2.64x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.357, Ratio=2.74x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.86x, Gap=-2.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.362, Ratio=2.72x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.342, Ratio=2.68x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.351, Ratio=2.80x, Gap=-2.816
Batch 325/537: Loss=1.2025 (C:1.2025, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.366, Ratio=2.79x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.371, Ratio=2.82x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.353, Ratio=2.75x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.358, Ratio=2.76x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.378, Ratio=2.89x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.340, Ratio=2.70x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.369, Ratio=2.88x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.367, Ratio=2.86x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.375, Ratio=2.84x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.364, Ratio=2.81x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.353, Ratio=2.69x, Gap=-2.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.347, Ratio=2.68x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.376, Ratio=2.92x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.365, Ratio=2.94x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.373, Ratio=2.94x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.366, Ratio=2.75x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.364, Ratio=2.74x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.360, Ratio=2.74x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.350, Ratio=2.66x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.367, Ratio=2.86x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.366, Ratio=2.78x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.355, Ratio=2.73x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.366, Ratio=2.87x, Gap=-2.756
Batch 350/537: Loss=1.1835 (C:1.1835, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.343, Ratio=2.70x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.375, Ratio=2.99x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.355, Ratio=2.75x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.357, Ratio=2.86x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.361, Ratio=2.81x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.379, Ratio=2.89x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.363, Ratio=2.80x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.354, Ratio=2.77x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.381, Ratio=2.90x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.370, Ratio=2.77x, Gap=-3.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.372, Ratio=2.91x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.362, Ratio=2.73x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.341, Ratio=2.68x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.354, Ratio=2.84x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.373, Ratio=2.95x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.368, Ratio=2.92x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.364, Ratio=2.75x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.378, Ratio=2.93x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.87x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.375, Ratio=2.90x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.363, Ratio=2.70x, Gap=-2.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.373, Ratio=2.78x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.356, Ratio=2.75x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.374, Ratio=2.94x, Gap=-3.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.358, Ratio=2.76x, Gap=-2.727
Batch 375/537: Loss=1.2074 (C:1.2074, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.348, Ratio=2.63x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.353, Ratio=2.78x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.360, Ratio=2.75x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.361, Ratio=2.78x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.343, Ratio=2.64x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.377, Ratio=2.88x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.369, Ratio=2.77x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.344, Ratio=2.60x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.381, Ratio=2.89x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.372, Ratio=2.91x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.362, Ratio=2.87x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.348, Ratio=2.67x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.364, Ratio=2.81x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.359, Ratio=2.79x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.347, Ratio=2.67x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.344, Ratio=2.77x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.351, Ratio=2.71x, Gap=-2.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.358, Ratio=2.78x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.358, Ratio=2.77x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.360, Ratio=2.74x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.370, Ratio=2.77x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.357, Ratio=2.80x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.372, Ratio=2.81x, Gap=-2.880
Batch 400/537: Loss=1.1955 (C:1.1955, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.360, Ratio=2.82x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.372, Ratio=2.82x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.361, Ratio=2.69x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.366, Ratio=2.81x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.346, Ratio=2.67x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.348, Ratio=2.70x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.346, Ratio=2.70x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.345, Ratio=2.68x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.373, Ratio=2.92x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.369, Ratio=2.82x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.375, Ratio=2.88x, Gap=-2.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.75x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.370, Ratio=2.81x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.351, Ratio=2.65x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.371, Ratio=2.86x, Gap=-2.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.372, Ratio=2.92x, Gap=-2.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.359, Ratio=2.77x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.356, Ratio=2.70x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.370, Ratio=2.92x, Gap=-2.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.367, Ratio=2.88x, Gap=-2.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.360, Ratio=2.77x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.356, Ratio=2.70x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.368, Ratio=2.92x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.357, Ratio=2.79x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.371, Ratio=2.86x, Gap=-2.817
Batch 425/537: Loss=1.1884 (C:1.1884, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.354, Ratio=2.65x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.383, Ratio=2.81x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.377, Ratio=2.82x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.367, Ratio=2.72x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.385, Ratio=2.89x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.357, Ratio=2.77x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.368, Ratio=2.88x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.349, Ratio=2.70x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.360, Ratio=2.73x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.352, Ratio=2.71x, Gap=-2.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.349, Ratio=2.73x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.352, Ratio=2.72x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.347, Ratio=2.73x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.344, Ratio=2.66x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.370, Ratio=2.88x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.380, Ratio=2.83x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.352, Ratio=2.79x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.371, Ratio=2.82x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.359, Ratio=2.71x, Gap=-3.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.365, Ratio=2.68x, Gap=-3.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.369, Ratio=2.80x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.378, Ratio=2.99x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.359, Ratio=2.72x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.380, Ratio=2.95x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.354, Ratio=2.77x, Gap=-2.774
Batch 450/537: Loss=1.2081 (C:1.2081, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.354, Ratio=2.72x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.352, Ratio=2.72x, Gap=-2.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.365, Ratio=2.90x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.379, Ratio=2.82x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.360, Ratio=2.87x, Gap=-2.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.354, Ratio=2.75x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.354, Ratio=2.74x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.364, Ratio=2.83x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.365, Ratio=2.82x, Gap=-2.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.369, Ratio=2.81x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.344, Ratio=2.69x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.350, Ratio=2.74x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.368, Ratio=2.75x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.365, Ratio=2.87x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.375, Ratio=2.77x, Gap=-2.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.363, Ratio=2.69x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.350, Ratio=2.77x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.362, Ratio=2.81x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.364, Ratio=2.76x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.350, Ratio=2.74x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.377, Ratio=3.02x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.358, Ratio=2.75x, Gap=-2.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.362, Ratio=2.67x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.376, Ratio=2.89x, Gap=-2.961
Batch 475/537: Loss=1.1769 (C:1.1769, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.359, Ratio=2.71x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.361, Ratio=2.75x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.372, Ratio=2.83x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.366, Ratio=2.72x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.370, Ratio=2.76x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.88x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.349, Ratio=2.85x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.360, Ratio=2.81x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.370, Ratio=2.82x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.368, Ratio=2.85x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.347, Ratio=2.71x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.360, Ratio=2.81x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.350, Ratio=2.67x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.345, Ratio=2.69x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.368, Ratio=2.87x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.342, Ratio=2.63x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.357, Ratio=2.63x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.380, Ratio=2.94x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.380, Ratio=2.86x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.378, Ratio=2.79x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.356, Ratio=2.68x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.384, Ratio=2.97x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.352, Ratio=2.70x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.352, Ratio=2.76x, Gap=-2.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.357, Ratio=2.78x, Gap=-3.188
Batch 500/537: Loss=1.2050 (C:1.2050, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.352, Ratio=2.70x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.364, Ratio=2.82x, Gap=-2.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.366, Ratio=2.82x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.368, Ratio=2.79x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.377, Ratio=2.99x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.379, Ratio=2.94x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.367, Ratio=2.74x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.362, Ratio=2.77x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.367, Ratio=2.82x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.363, Ratio=2.76x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.369, Ratio=2.89x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.385, Ratio=3.00x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.356, Ratio=2.69x, Gap=-2.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.357, Ratio=2.80x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.363, Ratio=2.82x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.366, Ratio=2.81x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.86x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.337, Ratio=2.57x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.356, Ratio=2.76x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.348, Ratio=2.69x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.360, Ratio=2.77x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.357, Ratio=2.72x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.370, Ratio=2.78x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.381, Ratio=2.88x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.385, Ratio=2.86x, Gap=-3.040
Batch 525/537: Loss=1.1805 (C:1.1805, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.365, Ratio=2.85x, Gap=-3.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.370, Ratio=2.91x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.362, Ratio=2.79x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.355, Ratio=2.76x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.351, Ratio=2.69x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.360, Ratio=2.68x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.372, Ratio=2.95x, Gap=-2.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.361, Ratio=2.80x, Gap=-2.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.371, Ratio=2.84x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.375, Ratio=2.85x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.368, Ratio=2.80x, Gap=-2.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.376, Ratio=3.16x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.387, Ratio=3.20x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.382, Ratio=3.12x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.378, Ratio=3.07x, Gap=-2.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.351, Ratio=2.94x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.379, Ratio=3.17x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.382, Ratio=3.12x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.367, Ratio=3.02x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.361, Ratio=2.94x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.367, Ratio=3.05x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.359, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.361, Ratio=2.83x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.368, Ratio=3.09x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.370, Ratio=2.93x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.378, Ratio=3.07x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.369, Ratio=3.03x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.367, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.381, Ratio=3.07x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.381, Ratio=3.25x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.370, Ratio=3.02x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.88x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.380, Ratio=3.15x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.383, Ratio=3.17x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.378, Ratio=3.02x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.85x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.374, Ratio=3.00x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.376, Ratio=3.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.358, Ratio=2.87x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.363, Ratio=2.84x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.377, Ratio=3.13x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.374, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.368, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.368, Ratio=3.03x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.364, Ratio=3.05x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.377, Ratio=3.01x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.380, Ratio=3.05x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.385, Ratio=3.18x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.379, Ratio=3.10x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.384, Ratio=3.24x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.365, Ratio=2.90x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.374, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.370, Ratio=2.95x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.371, Ratio=3.01x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.364, Ratio=3.00x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.362, Ratio=3.00x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.362, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.383, Ratio=3.24x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.373, Ratio=2.98x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.384, Ratio=3.08x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.86x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.374, Ratio=3.04x, Gap=-2.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.95x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.377, Ratio=3.11x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.375, Ratio=3.08x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.365, Ratio=2.96x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.356, Ratio=2.86x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.367, Ratio=2.88x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.368, Ratio=3.08x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.384, Ratio=3.14x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.378, Ratio=3.04x, Gap=-2.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.373, Ratio=3.02x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.368, Ratio=3.14x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.95x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.367, Ratio=2.97x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.349, Ratio=2.77x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.376, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.358, Ratio=2.79x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.364, Ratio=2.96x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.364, Ratio=2.91x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.361, Ratio=2.89x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.371, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.378, Ratio=3.15x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.357, Ratio=2.87x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.361, Ratio=2.89x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.367, Ratio=2.98x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.377, Ratio=3.13x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=2.99x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.372, Ratio=3.09x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.355, Ratio=2.89x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.379, Ratio=3.12x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.368, Ratio=3.00x, Gap=-2.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.371, Ratio=3.03x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.353, Ratio=2.90x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.376, Ratio=2.99x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.378, Ratio=3.03x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.366, Ratio=3.05x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.363, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.364, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.360, Ratio=2.83x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.00x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.382, Ratio=3.07x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.377, Ratio=3.05x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.366, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.359, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.358, Ratio=2.88x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.357, Ratio=2.79x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.368, Ratio=3.04x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.354, Ratio=2.78x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.372, Ratio=3.00x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.364, Ratio=2.98x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.98x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.371, Ratio=2.90x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.362, Ratio=2.91x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.371, Ratio=3.16x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.371, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.355, Ratio=2.90x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.358, Ratio=2.99x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.364, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.377, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.378, Ratio=3.03x, Gap=-2.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.366, Ratio=3.06x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.88x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.367, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.12x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.374, Ratio=3.01x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.375, Ratio=3.27x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.357, Ratio=2.88x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.379, Ratio=3.05x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.373, Ratio=3.04x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.374, Ratio=2.93x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.356, Ratio=2.85x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.377, Ratio=3.08x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.372, Ratio=3.03x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.368, Ratio=2.93x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.361, Ratio=3.03x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.354, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.381, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.363, Ratio=2.91x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.363, Ratio=2.91x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.353, Ratio=2.82x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.380, Ratio=3.18x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.365, Ratio=2.93x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.383, Ratio=3.08x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.355, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.368, Ratio=3.01x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.380, Ratio=2.95x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.379, Ratio=3.13x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.378, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.365, Ratio=2.96x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.365, Ratio=2.89x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.377, Ratio=3.16x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.362, Ratio=2.99x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.375, Ratio=3.09x, Gap=-2.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.378, Ratio=3.07x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.364, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.361, Ratio=2.96x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.348, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.370, Ratio=2.99x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.378, Ratio=3.12x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.377, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.360, Ratio=2.86x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.357, Ratio=2.88x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.360, Ratio=2.96x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.375, Ratio=3.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.356, Ratio=2.93x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.14x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.358, Ratio=2.94x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.370, Ratio=2.93x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.366, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.385, Ratio=3.17x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.373, Ratio=2.98x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.370, Ratio=2.96x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.362, Ratio=2.93x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.372, Ratio=2.96x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.369, Ratio=2.98x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.368, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.01x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.382, Ratio=3.17x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.374, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.363, Ratio=2.85x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.99x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.380, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.367, Ratio=3.02x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.351, Ratio=2.91x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.368, Ratio=2.89x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.369, Ratio=3.07x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.374, Ratio=3.09x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.376, Ratio=3.05x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.349, Ratio=2.89x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.378, Ratio=3.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.362, Ratio=2.88x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.365, Ratio=2.91x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.363, Ratio=2.95x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.376, Ratio=3.13x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.373, Ratio=3.06x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.359, Ratio=2.92x, Gap=-2.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.358, Ratio=2.85x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.95x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.360, Ratio=2.84x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.356, Ratio=2.82x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.378, Ratio=3.19x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.371, Ratio=2.93x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.366, Ratio=2.99x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.349, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.373, Ratio=3.00x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.353, Ratio=2.86x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.92x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.353, Ratio=2.85x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.381, Ratio=3.03x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.375, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.375, Ratio=2.91x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.366, Ratio=2.97x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.392, Ratio=3.13x, Gap=-2.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.358, Ratio=2.81x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.371, Ratio=3.00x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.382, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.98x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.372, Ratio=3.01x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.345, Ratio=2.79x, Gap=-2.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.361, Ratio=2.85x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.379, Ratio=3.13x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.363, Ratio=2.91x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.377, Ratio=3.08x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.371, Ratio=3.02x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.372, Ratio=3.16x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.373, Ratio=2.95x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.369, Ratio=3.06x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.356, Ratio=2.88x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.367, Ratio=2.95x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.369, Ratio=2.97x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.392, Ratio=3.23x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.361, Ratio=2.87x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.365, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.373, Ratio=3.11x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.364, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.382, Ratio=3.12x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.386, Ratio=3.20x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.377, Ratio=3.14x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.348, Ratio=2.82x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.367, Ratio=2.98x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.362, Ratio=2.84x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.368, Ratio=3.03x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.389, Ratio=3.17x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.370, Ratio=3.03x, Gap=-2.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.362, Ratio=3.01x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.379, Ratio=3.14x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.361, Ratio=2.91x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.379, Ratio=3.10x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.368, Ratio=3.00x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.361, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.385, Ratio=3.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.369, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.04x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.372, Ratio=3.08x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.378, Ratio=3.14x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.373, Ratio=3.07x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.359, Ratio=2.88x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.372, Ratio=3.02x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.362, Ratio=2.94x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.385, Ratio=3.12x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.380, Ratio=3.05x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.375, Ratio=3.02x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.368, Ratio=3.04x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.25x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.348, Ratio=2.89x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.364, Ratio=3.03x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.375, Ratio=3.09x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.373, Ratio=2.97x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.352, Ratio=2.89x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.380, Ratio=3.15x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.381, Ratio=3.07x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.18x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.376, Ratio=3.12x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.366, Ratio=2.94x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.358, Ratio=3.01x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.370, Ratio=3.03x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.369, Ratio=3.04x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.346, Ratio=2.76x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.375, Ratio=3.06x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.373, Ratio=3.05x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.369, Ratio=2.98x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.358, Ratio=2.92x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.369, Ratio=2.97x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.03x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.363, Ratio=2.83x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.362, Ratio=2.87x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.375, Ratio=3.07x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.365, Ratio=2.94x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.387, Ratio=3.10x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.362, Ratio=2.98x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.361, Ratio=2.99x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.366, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.372, Ratio=3.07x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.375, Ratio=3.04x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.377, Ratio=3.03x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.363, Ratio=2.95x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.370, Ratio=3.05x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.376, Ratio=3.22x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.375, Ratio=3.08x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.355, Ratio=2.93x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.362, Ratio=2.95x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.377, Ratio=3.15x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.373, Ratio=3.04x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.369, Ratio=3.00x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.371, Ratio=2.93x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.372, Ratio=2.92x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.372, Ratio=2.91x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.361, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.367, Ratio=2.89x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.376, Ratio=3.05x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.379, Ratio=3.16x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.360, Ratio=2.97x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.392, Ratio=3.18x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.86x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.378, Ratio=3.01x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.366, Ratio=3.02x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.354, Ratio=2.92x, Gap=-2.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.362, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.376, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.358, Ratio=2.89x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-2.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.384, Ratio=3.01x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.385, Ratio=3.17x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.377, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.09x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.361, Ratio=2.85x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.382, Ratio=3.13x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.373, Ratio=3.05x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.357, Ratio=2.96x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.10x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.378, Ratio=3.11x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.370, Ratio=2.96x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.369, Ratio=3.01x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.372, Ratio=3.03x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.370, Ratio=3.08x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.377, Ratio=3.02x, Gap=-2.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.00x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.388, Ratio=3.10x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.92x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.367, Ratio=2.95x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.370, Ratio=3.07x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.388, Ratio=3.14x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.368, Ratio=3.00x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.384, Ratio=3.11x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.364, Ratio=2.87x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.370, Ratio=3.07x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.363, Ratio=3.08x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.368, Ratio=2.97x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.369, Ratio=2.89x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.363, Ratio=3.08x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.379, Ratio=3.02x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.371, Ratio=3.03x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.372, Ratio=3.00x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.380, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.361, Ratio=3.00x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.385, Ratio=3.12x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.378, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.363, Ratio=2.97x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.354, Ratio=2.93x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.85x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.381, Ratio=3.08x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.361, Ratio=2.92x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.375, Ratio=3.16x, Gap=-2.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.342, Ratio=2.80x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.371, Ratio=3.08x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.368, Ratio=2.99x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.354, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.376, Ratio=2.97x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.373, Ratio=2.99x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.367, Ratio=2.89x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.379, Ratio=3.07x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.366, Ratio=2.98x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.378, Ratio=3.05x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.375, Ratio=2.99x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.365, Ratio=2.98x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.372, Ratio=3.09x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.354, Ratio=2.87x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.371, Ratio=2.98x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.365, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.371, Ratio=2.99x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.369, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.361, Ratio=2.91x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.357, Ratio=2.83x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.370, Ratio=2.86x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.353, Ratio=2.84x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.368, Ratio=2.95x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.365, Ratio=2.82x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.352, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.380, Ratio=3.08x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.364, Ratio=2.88x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.96x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.368, Ratio=3.16x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.380, Ratio=3.11x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.372, Ratio=2.97x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.367, Ratio=3.03x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.371, Ratio=2.94x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.377, Ratio=3.10x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.364, Ratio=2.94x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.365, Ratio=2.88x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.361, Ratio=2.91x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.362, Ratio=2.89x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.349, Ratio=2.84x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.360, Ratio=2.85x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.364, Ratio=3.01x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.370, Ratio=2.86x, Gap=-2.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.363, Ratio=2.94x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.370, Ratio=3.04x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.368, Ratio=3.01x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.353, Ratio=2.81x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.378, Ratio=3.04x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.367, Ratio=2.99x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.362, Ratio=2.84x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.376, Ratio=3.03x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.369, Ratio=3.09x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.342, Ratio=2.85x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.364, Ratio=2.87x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.381, Ratio=3.15x, Gap=-2.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.366, Ratio=2.97x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.370, Ratio=2.99x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.377, Ratio=3.08x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.366, Ratio=2.94x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.372, Ratio=2.88x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.381, Ratio=2.97x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.383, Ratio=3.10x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.96x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.378, Ratio=3.13x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.362, Ratio=3.00x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.347, Ratio=2.87x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.362, Ratio=3.06x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.362, Ratio=2.86x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.355, Ratio=2.86x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.355, Ratio=2.90x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.364, Ratio=2.90x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.372, Ratio=3.08x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.390, Ratio=3.22x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.378, Ratio=3.08x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.370, Ratio=3.01x, Gap=-2.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.371, Ratio=3.05x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.375, Ratio=3.08x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.366, Ratio=2.96x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.370, Ratio=2.89x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.366, Ratio=2.95x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.359, Ratio=2.90x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.372, Ratio=2.98x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.371, Ratio=2.88x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.373, Ratio=3.00x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.373, Ratio=3.05x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.386, Ratio=3.11x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.379, Ratio=3.08x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.362, Ratio=3.02x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.369, Ratio=2.93x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.366, Ratio=2.99x, Gap=-2.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.378, Ratio=3.03x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.374, Ratio=3.08x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.376, Ratio=3.02x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.361, Ratio=2.90x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.376, Ratio=3.08x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.369, Ratio=3.04x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.363, Ratio=2.89x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.374, Ratio=3.16x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.360, Ratio=2.96x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.363, Ratio=2.92x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.375, Ratio=3.05x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.385, Ratio=3.16x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.369, Ratio=2.98x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.338, Ratio=2.71x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.369, Ratio=2.92x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.374, Ratio=3.03x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.365, Ratio=2.83x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.366, Ratio=2.92x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.366, Ratio=2.93x, Gap=-2.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.355, Ratio=2.86x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.379, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.384, Ratio=3.13x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.372, Ratio=2.95x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.366, Ratio=2.90x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.367, Ratio=2.94x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.345, Ratio=2.88x, Gap=-2.390

============================================================
Epoch 18/20 completed in 29.5s
Train: Loss=1.2001 (C:1.2001, R:0.0000) Ratio=2.78x
Val:   Loss=1.1667 (C:1.1667, R:0.0000) Ratio=3.26x
‚úÖ New best model saved (Val Loss: 1.1667)
============================================================

üåç Updating global dataset at epoch 19
üåç Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 3000 samples
  Global dataset updated: 3000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.414 ¬± 0.632
    Neg distances: 1.390 ¬± 0.888
    Separation ratio: 3.36x
    Gap: -2.438
    ‚úÖ Excellent global separation!

Epoch 19 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.393, Ratio=3.14x, Gap=-3.077
Batch   0/537: Loss=1.1376 (C:1.1376, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.408, Ratio=3.28x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.385, Ratio=3.11x, Gap=-2.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.382, Ratio=3.00x, Gap=-2.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.384, Ratio=3.02x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.412, Ratio=3.27x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.410, Ratio=3.25x, Gap=-3.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.407, Ratio=3.20x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.392, Ratio=3.04x, Gap=-2.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.387, Ratio=2.93x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.406, Ratio=3.13x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.393, Ratio=3.09x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.401, Ratio=3.10x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.379, Ratio=3.06x, Gap=-2.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.389, Ratio=3.10x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.393, Ratio=3.16x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.394, Ratio=3.09x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.376, Ratio=2.92x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.395, Ratio=3.19x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.399, Ratio=3.20x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.384, Ratio=2.99x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.405, Ratio=3.15x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.367, Ratio=2.96x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.399, Ratio=3.14x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.390, Ratio=2.99x, Gap=-2.783
Batch  25/537: Loss=1.1627 (C:1.1627, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.396, Ratio=3.14x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.399, Ratio=3.09x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.401, Ratio=3.12x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.385, Ratio=2.90x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.401, Ratio=3.20x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.387, Ratio=3.02x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.393, Ratio=3.15x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.401, Ratio=3.30x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.397, Ratio=3.04x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.384, Ratio=2.97x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.395, Ratio=3.14x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.396, Ratio=3.16x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.393, Ratio=3.09x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.392, Ratio=3.14x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.394, Ratio=3.25x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.402, Ratio=3.16x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.388, Ratio=3.13x, Gap=-3.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.398, Ratio=3.10x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.389, Ratio=3.01x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.386, Ratio=3.01x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.384, Ratio=3.01x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.391, Ratio=3.03x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.393, Ratio=3.09x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.374, Ratio=2.90x, Gap=-2.917
Batch  50/537: Loss=1.1859 (C:1.1859, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.383, Ratio=3.07x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.381, Ratio=2.95x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.392, Ratio=3.30x, Gap=-3.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.399, Ratio=3.13x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.377, Ratio=2.96x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.388, Ratio=3.08x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.402, Ratio=3.16x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.406, Ratio=3.26x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.400, Ratio=3.18x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.388, Ratio=3.00x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.391, Ratio=3.09x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.406, Ratio=3.20x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.407, Ratio=3.22x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.403, Ratio=3.11x, Gap=-2.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.386, Ratio=2.93x, Gap=-2.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.415, Ratio=3.29x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.393, Ratio=3.14x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.396, Ratio=3.17x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.377, Ratio=2.90x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.387, Ratio=3.14x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.382, Ratio=3.07x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.400, Ratio=3.25x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.405, Ratio=3.24x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.397, Ratio=3.20x, Gap=-2.816
Batch  75/537: Loss=1.1284 (C:1.1284, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.393, Ratio=3.20x, Gap=-2.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.398, Ratio=3.07x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.402, Ratio=3.12x, Gap=-2.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.392, Ratio=3.08x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.413, Ratio=3.19x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.378, Ratio=3.09x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.378, Ratio=3.01x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.395, Ratio=3.07x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.389, Ratio=3.12x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.378, Ratio=2.97x, Gap=-2.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.370, Ratio=3.08x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.379, Ratio=2.97x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.388, Ratio=3.08x, Gap=-2.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.402, Ratio=3.25x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.397, Ratio=3.14x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.386, Ratio=3.07x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.378, Ratio=2.94x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.392, Ratio=3.08x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.400, Ratio=2.99x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.381, Ratio=3.05x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.390, Ratio=2.97x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.385, Ratio=3.12x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.393, Ratio=3.14x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.404, Ratio=3.20x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.397, Ratio=3.07x, Gap=-2.919
Batch 100/537: Loss=1.1473 (C:1.1473, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.397, Ratio=3.14x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.396, Ratio=3.14x, Gap=-2.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.398, Ratio=3.09x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.389, Ratio=3.08x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.366, Ratio=2.86x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.392, Ratio=3.04x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.395, Ratio=3.04x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.380, Ratio=2.96x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.416, Ratio=3.31x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.378, Ratio=2.94x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.384, Ratio=3.04x, Gap=-2.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.398, Ratio=3.17x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.383, Ratio=3.11x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.400, Ratio=3.23x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.399, Ratio=3.10x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.377, Ratio=2.93x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.400, Ratio=3.19x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.402, Ratio=3.37x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.385, Ratio=3.16x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.386, Ratio=3.06x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.381, Ratio=3.05x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.389, Ratio=3.03x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.384, Ratio=3.01x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.387, Ratio=3.08x, Gap=-2.926
Batch 125/537: Loss=1.1490 (C:1.1490, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.412, Ratio=3.25x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.392, Ratio=3.03x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.388, Ratio=3.09x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.413, Ratio=3.24x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.393, Ratio=3.02x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.381, Ratio=3.00x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.389, Ratio=3.06x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.393, Ratio=3.08x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.387, Ratio=3.13x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.384, Ratio=3.03x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.378, Ratio=2.98x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.390, Ratio=3.13x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.380, Ratio=3.04x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.374, Ratio=2.90x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.397, Ratio=3.19x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.383, Ratio=2.88x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.408, Ratio=3.23x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.388, Ratio=3.04x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.390, Ratio=3.03x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.384, Ratio=3.02x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.384, Ratio=3.15x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.379, Ratio=2.90x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.401, Ratio=3.19x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.395, Ratio=3.08x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.387, Ratio=3.02x, Gap=-2.970
Batch 150/537: Loss=1.1592 (C:1.1592, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.394, Ratio=3.14x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.389, Ratio=3.23x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.386, Ratio=3.03x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.392, Ratio=3.07x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.385, Ratio=2.91x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.381, Ratio=3.08x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.396, Ratio=3.20x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.388, Ratio=3.00x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.378, Ratio=3.06x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.365, Ratio=3.02x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.410, Ratio=3.24x, Gap=-3.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.377, Ratio=3.12x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.399, Ratio=3.04x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.400, Ratio=3.31x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.386, Ratio=3.04x, Gap=-2.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.392, Ratio=3.16x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.390, Ratio=3.15x, Gap=-2.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.393, Ratio=3.01x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.400, Ratio=3.10x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.366, Ratio=2.81x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.405, Ratio=3.19x, Gap=-3.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.387, Ratio=3.07x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.386, Ratio=2.97x, Gap=-3.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.393, Ratio=3.12x, Gap=-2.781
Batch 175/537: Loss=1.1408 (C:1.1408, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.391, Ratio=3.09x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.398, Ratio=3.11x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.403, Ratio=3.14x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.385, Ratio=3.02x, Gap=-2.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.395, Ratio=3.11x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.383, Ratio=2.99x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.383, Ratio=3.03x, Gap=-2.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.383, Ratio=3.13x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.401, Ratio=3.24x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.380, Ratio=3.10x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.386, Ratio=3.18x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.379, Ratio=3.05x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.389, Ratio=3.01x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.383, Ratio=2.99x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.401, Ratio=3.13x, Gap=-2.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.380, Ratio=2.97x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.396, Ratio=3.01x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.385, Ratio=3.09x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.394, Ratio=3.04x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.402, Ratio=2.98x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.413, Ratio=3.25x, Gap=-2.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.388, Ratio=2.98x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.402, Ratio=3.04x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.396, Ratio=3.02x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.397, Ratio=3.29x, Gap=-2.700
Batch 200/537: Loss=1.1118 (C:1.1118, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.375, Ratio=3.01x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.385, Ratio=3.03x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.377, Ratio=3.04x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.394, Ratio=2.99x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.383, Ratio=3.03x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.408, Ratio=3.13x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.404, Ratio=3.25x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.398, Ratio=2.98x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.408, Ratio=3.23x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.395, Ratio=3.03x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.404, Ratio=3.22x, Gap=-3.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.391, Ratio=3.06x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.388, Ratio=3.17x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.381, Ratio=2.98x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.388, Ratio=3.08x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.404, Ratio=3.24x, Gap=-2.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.370, Ratio=2.97x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.390, Ratio=3.09x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.397, Ratio=3.14x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.388, Ratio=3.05x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.405, Ratio=3.30x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.388, Ratio=2.94x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.397, Ratio=3.14x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.395, Ratio=3.15x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.401, Ratio=3.16x, Gap=-2.864
Batch 225/537: Loss=1.1338 (C:1.1338, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.395, Ratio=3.09x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.394, Ratio=2.99x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.385, Ratio=2.96x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.381, Ratio=2.97x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.393, Ratio=3.14x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.399, Ratio=3.18x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.401, Ratio=3.15x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.380, Ratio=2.96x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.381, Ratio=3.06x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.376, Ratio=2.98x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.384, Ratio=3.13x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.384, Ratio=3.08x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.384, Ratio=3.12x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.380, Ratio=2.98x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.388, Ratio=3.05x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.377, Ratio=3.10x, Gap=-2.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.369, Ratio=2.93x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.395, Ratio=3.08x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.379, Ratio=2.97x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.401, Ratio=3.11x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.394, Ratio=3.00x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.388, Ratio=3.16x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.383, Ratio=3.08x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.389, Ratio=3.03x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.388, Ratio=3.06x, Gap=-2.863
Batch 250/537: Loss=1.1561 (C:1.1561, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.390, Ratio=3.09x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.396, Ratio=3.09x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.386, Ratio=3.04x, Gap=-2.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.379, Ratio=3.08x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.387, Ratio=3.06x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.380, Ratio=3.06x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.368, Ratio=2.99x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.411, Ratio=3.26x, Gap=-2.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.382, Ratio=2.99x, Gap=-3.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.392, Ratio=3.11x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.400, Ratio=3.07x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.389, Ratio=3.01x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.376, Ratio=2.86x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.383, Ratio=2.99x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.407, Ratio=3.16x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.395, Ratio=2.96x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.401, Ratio=3.15x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.417, Ratio=3.31x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.395, Ratio=3.25x, Gap=-2.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.379, Ratio=2.99x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.386, Ratio=3.00x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.383, Ratio=3.15x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.368, Ratio=2.86x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.390, Ratio=3.12x, Gap=-2.746
Batch 275/537: Loss=1.1413 (C:1.1413, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.373, Ratio=2.89x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.386, Ratio=2.97x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.396, Ratio=3.22x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.413, Ratio=3.52x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.394, Ratio=3.14x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.383, Ratio=2.89x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.390, Ratio=3.11x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.399, Ratio=3.01x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.391, Ratio=3.16x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.398, Ratio=3.14x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.403, Ratio=3.12x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.406, Ratio=3.19x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.381, Ratio=2.94x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.383, Ratio=3.02x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.392, Ratio=3.08x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.380, Ratio=3.11x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.377, Ratio=2.86x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.392, Ratio=3.04x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.379, Ratio=3.01x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.410, Ratio=3.30x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.386, Ratio=3.01x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.406, Ratio=3.14x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.383, Ratio=3.01x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.406, Ratio=3.24x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.377, Ratio=2.86x, Gap=-2.918
Batch 300/537: Loss=1.1942 (C:1.1942, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.394, Ratio=3.20x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.399, Ratio=3.10x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.375, Ratio=2.98x, Gap=-3.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.387, Ratio=3.00x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.387, Ratio=3.03x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.384, Ratio=3.26x, Gap=-2.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.20x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.397, Ratio=3.12x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.410, Ratio=3.22x, Gap=-2.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.415, Ratio=3.24x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.390, Ratio=3.00x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.391, Ratio=3.06x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.387, Ratio=3.04x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.391, Ratio=3.21x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.405, Ratio=3.18x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.380, Ratio=3.11x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.393, Ratio=3.14x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.386, Ratio=3.03x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.385, Ratio=3.02x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.373, Ratio=3.06x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.384, Ratio=2.99x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.389, Ratio=3.08x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.399, Ratio=3.19x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.390, Ratio=3.13x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.376, Ratio=2.99x, Gap=-2.832
Batch 325/537: Loss=1.1702 (C:1.1702, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.408, Ratio=3.26x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.391, Ratio=2.96x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.389, Ratio=3.05x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.389, Ratio=3.07x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.391, Ratio=3.04x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.399, Ratio=3.24x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.380, Ratio=3.12x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.381, Ratio=3.06x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.394, Ratio=3.16x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.389, Ratio=3.03x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.410, Ratio=3.15x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.404, Ratio=3.15x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.396, Ratio=3.08x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.396, Ratio=2.98x, Gap=-2.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.387, Ratio=2.98x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.391, Ratio=3.10x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.398, Ratio=3.04x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.395, Ratio=3.15x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.394, Ratio=3.06x, Gap=-3.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.387, Ratio=3.06x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.373, Ratio=2.97x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.400, Ratio=3.12x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.384, Ratio=3.04x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.353, Ratio=2.93x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.401, Ratio=3.04x, Gap=-3.240
Batch 350/537: Loss=1.1505 (C:1.1505, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.396, Ratio=3.11x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.384, Ratio=3.02x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.379, Ratio=2.93x, Gap=-2.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.394, Ratio=3.01x, Gap=-2.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.373, Ratio=2.99x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.389, Ratio=3.00x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.389, Ratio=3.03x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.400, Ratio=3.03x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.399, Ratio=3.12x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.398, Ratio=3.07x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.398, Ratio=3.26x, Gap=-2.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.392, Ratio=2.96x, Gap=-3.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.388, Ratio=3.16x, Gap=-2.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.385, Ratio=3.14x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.377, Ratio=3.05x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.378, Ratio=3.00x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.384, Ratio=2.99x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.403, Ratio=3.15x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.401, Ratio=3.18x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.08x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.385, Ratio=3.07x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.405, Ratio=3.21x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.400, Ratio=3.22x, Gap=-2.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.394, Ratio=3.23x, Gap=-2.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.402, Ratio=3.29x, Gap=-2.769
Batch 375/537: Loss=1.1148 (C:1.1148, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.390, Ratio=2.98x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.385, Ratio=3.14x, Gap=-2.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.389, Ratio=3.18x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.379, Ratio=3.02x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.406, Ratio=3.25x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.392, Ratio=3.19x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.397, Ratio=3.05x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.378, Ratio=2.96x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.374, Ratio=3.01x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.400, Ratio=2.99x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.08x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.381, Ratio=3.00x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.396, Ratio=3.20x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.395, Ratio=3.18x, Gap=-2.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.386, Ratio=3.03x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.385, Ratio=3.06x, Gap=-2.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.381, Ratio=3.14x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.386, Ratio=3.03x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.384, Ratio=3.04x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.409, Ratio=3.18x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.381, Ratio=2.89x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.384, Ratio=2.83x, Gap=-2.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.397, Ratio=3.13x, Gap=-3.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.392, Ratio=2.95x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.392, Ratio=3.16x, Gap=-2.985
Batch 400/537: Loss=1.1389 (C:1.1389, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.381, Ratio=2.92x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.384, Ratio=3.08x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.365, Ratio=2.88x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.396, Ratio=3.11x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.381, Ratio=3.06x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.383, Ratio=3.00x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.396, Ratio=3.20x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.391, Ratio=3.14x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.401, Ratio=3.30x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.371, Ratio=3.00x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.401, Ratio=3.16x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.386, Ratio=3.00x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.369, Ratio=2.86x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.396, Ratio=3.18x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.413, Ratio=3.24x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.396, Ratio=3.04x, Gap=-2.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.391, Ratio=3.06x, Gap=-2.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.375, Ratio=2.91x, Gap=-2.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.386, Ratio=3.09x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.399, Ratio=3.13x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.371, Ratio=2.90x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.381, Ratio=3.01x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.376, Ratio=2.96x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.387, Ratio=3.04x, Gap=-2.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.395, Ratio=3.09x, Gap=-2.761
Batch 425/537: Loss=1.1418 (C:1.1418, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.378, Ratio=2.91x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.382, Ratio=2.93x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.381, Ratio=2.98x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.386, Ratio=3.10x, Gap=-2.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.405, Ratio=3.15x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.383, Ratio=3.14x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.403, Ratio=3.10x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.392, Ratio=3.12x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.394, Ratio=3.04x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.378, Ratio=2.97x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.393, Ratio=3.07x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.400, Ratio=3.12x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.386, Ratio=2.99x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.385, Ratio=3.01x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.395, Ratio=3.11x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.401, Ratio=3.24x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.405, Ratio=3.08x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.392, Ratio=3.10x, Gap=-3.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.381, Ratio=3.03x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.382, Ratio=3.13x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.385, Ratio=3.10x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.390, Ratio=3.19x, Gap=-2.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.389, Ratio=3.18x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.380, Ratio=2.95x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.384, Ratio=3.12x, Gap=-2.764
Batch 450/537: Loss=1.1423 (C:1.1423, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.383, Ratio=3.09x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.385, Ratio=2.97x, Gap=-2.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.392, Ratio=3.06x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.384, Ratio=2.96x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.391, Ratio=3.14x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.399, Ratio=3.10x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.381, Ratio=3.05x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.390, Ratio=3.14x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.397, Ratio=3.09x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.396, Ratio=3.10x, Gap=-2.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.394, Ratio=3.16x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.389, Ratio=3.28x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.383, Ratio=2.91x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.399, Ratio=3.22x, Gap=-2.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.394, Ratio=3.03x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.390, Ratio=3.02x, Gap=-2.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.369, Ratio=2.84x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.08x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.400, Ratio=3.19x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.396, Ratio=3.15x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.402, Ratio=2.94x, Gap=-3.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.402, Ratio=3.23x, Gap=-2.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.380, Ratio=2.88x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.386, Ratio=2.89x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.390, Ratio=3.17x, Gap=-2.785
Batch 475/537: Loss=1.1368 (C:1.1368, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.381, Ratio=2.94x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.07x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.395, Ratio=3.11x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.398, Ratio=3.13x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.385, Ratio=3.19x, Gap=-2.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.376, Ratio=2.97x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.396, Ratio=3.16x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.388, Ratio=3.10x, Gap=-2.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.386, Ratio=3.10x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.391, Ratio=3.08x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.390, Ratio=3.00x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.378, Ratio=3.05x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.398, Ratio=3.14x, Gap=-3.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.384, Ratio=3.02x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.381, Ratio=2.95x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.392, Ratio=3.03x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.389, Ratio=2.97x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.390, Ratio=3.00x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.386, Ratio=3.01x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.402, Ratio=3.22x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.386, Ratio=3.02x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.370, Ratio=2.94x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.397, Ratio=3.24x, Gap=-2.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.382, Ratio=2.99x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.388, Ratio=3.14x, Gap=-2.711
Batch 500/537: Loss=1.1393 (C:1.1393, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.392, Ratio=3.06x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.377, Ratio=2.97x, Gap=-2.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.412, Ratio=3.20x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.384, Ratio=2.99x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.400, Ratio=3.07x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.394, Ratio=2.99x, Gap=-2.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.395, Ratio=2.99x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.389, Ratio=2.99x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.388, Ratio=3.13x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.410, Ratio=3.24x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.386, Ratio=3.08x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.378, Ratio=3.06x, Gap=-2.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.410, Ratio=3.25x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.378, Ratio=2.97x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.390, Ratio=3.01x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.386, Ratio=3.04x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.382, Ratio=3.11x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.406, Ratio=3.14x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.368, Ratio=2.90x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.376, Ratio=3.07x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.387, Ratio=3.05x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.383, Ratio=3.03x, Gap=-2.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.389, Ratio=3.23x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.370, Ratio=2.89x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.376, Ratio=2.94x, Gap=-2.904
Batch 525/537: Loss=1.1801 (C:1.1801, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.399, Ratio=3.11x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.404, Ratio=3.27x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.395, Ratio=3.04x, Gap=-2.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.387, Ratio=3.05x, Gap=-2.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.384, Ratio=3.14x, Gap=-2.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.381, Ratio=2.93x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.397, Ratio=3.07x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.407, Ratio=3.23x, Gap=-2.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.408, Ratio=3.21x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.382, Ratio=3.07x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.385, Ratio=3.14x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.395, Ratio=3.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.401, Ratio=3.55x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.405, Ratio=3.44x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.404, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.377, Ratio=3.16x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.390, Ratio=3.51x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.383, Ratio=3.32x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.396, Ratio=3.38x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.398, Ratio=3.50x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.396, Ratio=3.51x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.383, Ratio=3.28x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.378, Ratio=3.28x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.387, Ratio=3.21x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.387, Ratio=3.21x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.404, Ratio=3.46x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.393, Ratio=3.35x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.400, Ratio=3.55x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.387, Ratio=3.22x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.397, Ratio=3.45x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.391, Ratio=3.46x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.411, Ratio=3.45x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.382, Ratio=3.22x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.379, Ratio=3.32x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.400, Ratio=3.55x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.380, Ratio=3.27x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.372, Ratio=3.16x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.387, Ratio=3.43x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.392, Ratio=3.34x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.410, Ratio=3.56x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.390, Ratio=3.49x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.384, Ratio=3.41x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.389, Ratio=3.37x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.401, Ratio=3.34x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.380, Ratio=3.19x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.405, Ratio=3.47x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.397, Ratio=3.53x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.404, Ratio=3.45x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.392, Ratio=3.38x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.373, Ratio=3.23x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.395, Ratio=3.34x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.385, Ratio=3.25x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.407, Ratio=3.48x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.386, Ratio=3.32x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.374, Ratio=3.21x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.383, Ratio=3.31x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.390, Ratio=3.33x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.394, Ratio=3.33x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.407, Ratio=3.52x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.398, Ratio=3.43x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.386, Ratio=3.32x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.389, Ratio=3.45x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.378, Ratio=3.21x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.395, Ratio=3.29x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.382, Ratio=3.22x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.407, Ratio=3.44x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.389, Ratio=3.21x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.389, Ratio=3.29x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.411, Ratio=3.56x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.392, Ratio=3.36x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.402, Ratio=3.50x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.397, Ratio=3.39x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.396, Ratio=3.33x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.404, Ratio=3.48x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.400, Ratio=3.39x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.375, Ratio=3.27x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.398, Ratio=3.43x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.399, Ratio=3.42x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.383, Ratio=3.41x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.383, Ratio=3.14x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.381, Ratio=3.37x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.390, Ratio=3.43x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.407, Ratio=3.40x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.393, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.396, Ratio=3.44x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.396, Ratio=3.49x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.397, Ratio=3.41x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.413, Ratio=3.64x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.384, Ratio=3.32x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.396, Ratio=3.46x, Gap=-2.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.402, Ratio=3.38x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.406, Ratio=3.37x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.401, Ratio=3.34x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.395, Ratio=3.53x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.400, Ratio=3.61x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.385, Ratio=3.24x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.384, Ratio=3.26x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.396, Ratio=3.41x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.380, Ratio=3.22x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.392, Ratio=3.27x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.399, Ratio=3.48x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.397, Ratio=3.63x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.394, Ratio=3.46x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.387, Ratio=3.39x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.399, Ratio=3.42x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.400, Ratio=3.45x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.397, Ratio=3.47x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.383, Ratio=3.19x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.402, Ratio=3.34x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.388, Ratio=3.25x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.404, Ratio=3.58x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.380, Ratio=3.32x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.387, Ratio=3.35x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.378, Ratio=3.17x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.381, Ratio=3.38x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.398, Ratio=3.49x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.391, Ratio=3.47x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.394, Ratio=3.39x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.401, Ratio=3.55x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.383, Ratio=3.26x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.389, Ratio=3.31x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.380, Ratio=3.28x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.389, Ratio=3.40x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.40x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.382, Ratio=3.19x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.388, Ratio=3.40x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.401, Ratio=3.38x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.395, Ratio=3.30x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.385, Ratio=3.36x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.405, Ratio=3.55x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.360, Ratio=3.12x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.400, Ratio=3.40x, Gap=-2.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.377, Ratio=3.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.383, Ratio=3.20x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.402, Ratio=3.50x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.396, Ratio=3.36x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.390, Ratio=3.38x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.381, Ratio=3.30x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.386, Ratio=3.33x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.380, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.399, Ratio=3.39x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.397, Ratio=3.43x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.379, Ratio=3.20x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.394, Ratio=3.38x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.397, Ratio=3.40x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.396, Ratio=3.32x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.399, Ratio=3.36x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.375, Ratio=3.10x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.400, Ratio=3.41x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.398, Ratio=3.39x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.405, Ratio=3.42x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.385, Neg=1.407, Ratio=3.66x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.389, Ratio=3.33x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.401, Ratio=3.52x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.388, Ratio=3.28x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.384, Ratio=3.36x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.404, Ratio=3.47x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.390, Ratio=3.25x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.393, Ratio=3.38x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.406, Ratio=3.50x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.382, Ratio=3.12x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.392, Ratio=3.31x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.388, Ratio=3.34x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.401, Ratio=3.48x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.395, Ratio=3.27x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.406, Ratio=3.36x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.389, Ratio=3.26x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.380, Ratio=3.20x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.375, Ratio=3.18x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.380, Ratio=3.24x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.391, Ratio=3.34x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.400, Ratio=3.43x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.394, Ratio=3.33x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.391, Ratio=3.31x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.396, Ratio=3.39x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.389, Ratio=3.33x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.394, Ratio=3.42x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.401, Ratio=3.49x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.394, Ratio=3.46x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.380, Ratio=3.29x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.387, Ratio=3.30x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.400, Ratio=3.46x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.384, Ratio=3.20x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.404, Ratio=3.41x, Gap=-2.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.375, Ratio=3.24x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.387, Ratio=3.29x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.395, Ratio=3.39x, Gap=-2.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.391, Ratio=3.33x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.382, Ratio=3.25x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.399, Ratio=3.45x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.401, Ratio=3.49x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.376, Ratio=3.29x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.396, Ratio=3.49x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.380, Ratio=3.18x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.394, Ratio=3.40x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.368, Ratio=3.06x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.394, Ratio=3.34x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.389, Ratio=3.26x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.391, Ratio=3.35x, Gap=-2.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.401, Ratio=3.47x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.381, Ratio=3.26x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.394, Ratio=3.31x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.398, Ratio=3.61x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.381, Ratio=3.14x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.393, Ratio=3.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.395, Ratio=3.35x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.388, Ratio=3.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.388, Ratio=3.47x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.395, Ratio=3.33x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.376, Ratio=3.16x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.375, Ratio=3.18x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.373, Ratio=3.14x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.393, Ratio=3.47x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.377, Ratio=3.19x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.392, Ratio=3.46x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.387, Ratio=3.23x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.382, Ratio=3.21x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.379, Ratio=3.17x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.397, Ratio=3.42x, Gap=-2.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.389, Ratio=3.30x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.386, Ratio=3.30x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.379, Ratio=3.30x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.392, Ratio=3.51x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.391, Ratio=3.34x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.392, Ratio=3.43x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.401, Ratio=3.52x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.404, Ratio=3.40x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.383, Ratio=3.30x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.412, Ratio=3.63x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.388, Ratio=3.42x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.386, Ratio=3.21x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.392, Ratio=3.37x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.401, Ratio=3.50x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.380, Ratio=3.25x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.405, Ratio=3.55x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.366, Ratio=3.18x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.393, Ratio=3.41x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.377, Ratio=3.12x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.391, Ratio=3.41x, Gap=-2.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.377, Ratio=3.22x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.402, Ratio=3.57x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.25x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.387, Ratio=3.27x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.384, Ratio=3.32x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.400, Ratio=3.43x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.395, Ratio=3.47x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.405, Ratio=3.54x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.416, Ratio=3.63x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.377, Ratio=3.29x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.381, Ratio=3.27x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.416, Ratio=3.55x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.401, Ratio=3.35x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.391, Ratio=3.37x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.375, Ratio=3.19x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.381, Ratio=3.30x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.376, Ratio=3.24x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.373, Ratio=3.19x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.393, Ratio=3.43x, Gap=-2.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.403, Ratio=3.54x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.400, Ratio=3.46x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.395, Ratio=3.43x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.388, Ratio=3.23x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.403, Ratio=3.53x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.394, Ratio=3.36x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.398, Ratio=3.43x, Gap=-2.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.392, Ratio=3.39x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.395, Ratio=3.31x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.374, Ratio=3.25x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.391, Ratio=3.39x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.379, Ratio=3.40x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.410, Ratio=3.41x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.410, Ratio=3.59x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.382, Ratio=3.24x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.389, Ratio=3.32x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.399, Ratio=3.38x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.381, Ratio=3.27x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.392, Ratio=3.43x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.383, Ratio=3.23x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.407, Ratio=3.45x, Gap=-2.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.413, Ratio=3.56x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.392, Ratio=3.41x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.373, Ratio=3.27x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.388, Ratio=3.43x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.387, Ratio=3.41x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.396, Ratio=3.21x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.390, Ratio=3.33x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.388, Ratio=3.22x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.392, Ratio=3.34x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.393, Ratio=3.23x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.374, Ratio=3.26x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.401, Ratio=3.55x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.391, Ratio=3.25x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.398, Ratio=3.30x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.394, Ratio=3.32x, Gap=-2.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.404, Ratio=3.47x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.375, Ratio=3.19x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.393, Ratio=3.18x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.391, Ratio=3.25x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.409, Ratio=3.47x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.397, Ratio=3.31x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.377, Ratio=3.33x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.386, Ratio=3.20x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.376, Ratio=3.20x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.402, Ratio=3.33x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.381, Ratio=3.30x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.389, Ratio=3.20x, Gap=-2.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.397, Ratio=3.48x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.392, Ratio=3.39x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.377, Ratio=3.15x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.385, Ratio=3.26x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.380, Ratio=3.19x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.397, Ratio=3.40x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.382, Ratio=3.31x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.399, Ratio=3.54x, Gap=-2.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.388, Ratio=3.27x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.384, Ratio=3.38x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.409, Ratio=3.53x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.383, Ratio=3.34x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.390, Ratio=3.45x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.391, Ratio=3.26x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.398, Ratio=3.42x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.389, Ratio=3.23x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.398, Ratio=3.52x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.387, Ratio=3.36x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.394, Ratio=3.45x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.416, Ratio=3.59x, Gap=-2.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.394, Ratio=3.25x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.400, Ratio=3.45x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.32x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.398, Ratio=3.49x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.413, Ratio=3.60x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.385, Ratio=3.28x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.387, Ratio=3.21x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.390, Ratio=3.35x, Gap=-2.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.400, Ratio=3.51x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.375, Ratio=3.27x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.391, Ratio=3.23x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.370, Ratio=3.12x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.401, Ratio=3.30x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.402, Ratio=3.47x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.397, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.386, Ratio=3.23x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.397, Ratio=3.30x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.394, Ratio=3.34x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.383, Ratio=3.20x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.382, Ratio=3.16x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.407, Ratio=3.44x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.406, Ratio=3.36x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.394, Ratio=3.28x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.405, Ratio=3.55x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.391, Ratio=3.26x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.390, Ratio=3.21x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.380, Ratio=3.23x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.390, Ratio=3.34x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.404, Ratio=3.32x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.388, Ratio=3.30x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.404, Ratio=3.47x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.390, Ratio=3.37x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.392, Ratio=3.33x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.393, Ratio=3.38x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.379, Ratio=3.23x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.405, Ratio=3.45x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.379, Ratio=3.16x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.396, Ratio=3.38x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.399, Ratio=3.42x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.388, Ratio=3.35x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.368, Ratio=3.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.372, Ratio=3.25x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.368, Ratio=3.14x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.391, Ratio=3.36x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.381, Ratio=3.23x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.380, Ratio=3.15x, Gap=-2.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.399, Ratio=3.45x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.387, Ratio=3.26x, Gap=-2.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.398, Ratio=3.56x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.404, Ratio=3.50x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.395, Ratio=3.36x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.396, Ratio=3.42x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.386, Ratio=3.12x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.399, Ratio=3.45x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.385, Ratio=3.14x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.393, Ratio=3.50x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.400, Ratio=3.38x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.389, Ratio=3.25x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.379, Ratio=3.21x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.424, Ratio=3.67x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.396, Ratio=3.51x, Gap=-2.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.390, Ratio=3.29x, Gap=-2.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.409, Ratio=3.45x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.409, Ratio=3.50x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.386, Ratio=3.25x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.390, Ratio=3.28x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.393, Ratio=3.35x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.391, Ratio=3.26x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.385, Ratio=3.41x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.409, Ratio=3.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.382, Ratio=3.43x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.398, Ratio=3.48x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.384, Ratio=3.21x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.382, Ratio=3.50x, Gap=-2.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.408, Ratio=3.54x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.394, Ratio=3.40x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.397, Ratio=3.38x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.369, Ratio=3.13x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.382, Ratio=3.32x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.394, Ratio=3.43x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.404, Ratio=3.57x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.400, Ratio=3.54x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.382, Ratio=3.21x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.396, Ratio=3.39x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.384, Ratio=3.22x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.398, Ratio=3.47x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.400, Ratio=3.41x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.369, Ratio=3.14x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.398, Ratio=3.54x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.379, Ratio=3.35x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.403, Ratio=3.44x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.402, Ratio=3.39x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.394, Ratio=3.37x, Gap=-2.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.383, Ratio=3.19x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.393, Ratio=3.37x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.384, Ratio=3.22x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.379, Ratio=3.17x, Gap=-2.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.386, Ratio=3.28x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.377, Ratio=3.30x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.394, Ratio=3.30x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.394, Ratio=3.37x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.390, Ratio=3.42x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.407, Ratio=3.59x, Gap=-2.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.378, Ratio=3.10x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.394, Ratio=3.21x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.390, Ratio=3.47x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.375, Ratio=3.15x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.404, Ratio=3.37x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.394, Ratio=3.43x, Gap=-2.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.405, Ratio=3.47x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.40x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.392, Ratio=3.34x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.382, Ratio=3.20x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.389, Ratio=3.37x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.380, Ratio=3.18x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.41x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.395, Ratio=3.48x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.393, Ratio=3.33x, Gap=-2.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.384, Ratio=3.41x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.393, Ratio=3.38x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.387, Ratio=3.36x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.403, Ratio=3.51x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.393, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.398, Ratio=3.32x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.405, Ratio=3.42x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.383, Ratio=3.23x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.404, Ratio=3.57x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.395, Ratio=3.42x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.373, Ratio=3.27x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.395, Ratio=3.43x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.383, Ratio=3.26x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.413, Ratio=3.55x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.393, Ratio=3.28x, Gap=-2.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.415, Ratio=3.64x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.397, Ratio=3.46x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.393, Ratio=3.40x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.394, Ratio=3.36x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.403, Ratio=3.52x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.402, Ratio=3.54x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.392, Ratio=3.37x, Gap=-2.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.378, Ratio=3.18x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.405, Ratio=3.46x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.398, Ratio=3.58x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.390, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.382, Ratio=3.29x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.381, Ratio=3.40x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.398, Ratio=3.35x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.393, Ratio=3.24x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.401, Ratio=3.52x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.386, Ratio=3.38x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.387, Ratio=3.48x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.374, Ratio=3.28x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.392, Ratio=3.39x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.391, Ratio=3.41x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.379, Ratio=3.24x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.397, Ratio=3.37x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.403, Ratio=3.48x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.399, Ratio=3.44x, Gap=-2.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.398, Ratio=3.46x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.382, Ratio=3.35x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.416, Ratio=3.62x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.388, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.390, Ratio=3.38x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.397, Ratio=3.36x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.392, Ratio=3.40x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.397, Ratio=3.50x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.396, Ratio=3.32x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.386, Ratio=3.33x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.393, Ratio=3.50x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.390, Ratio=3.28x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.388, Ratio=3.30x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.395, Ratio=3.56x, Gap=-2.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.379, Ratio=3.19x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.405, Ratio=3.45x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.398, Ratio=3.60x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.382, Ratio=3.20x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.389, Ratio=3.30x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.386, Ratio=3.22x, Gap=-2.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.378, Ratio=3.29x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.414, Ratio=3.54x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.408, Ratio=3.42x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.395, Ratio=3.30x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.379, Ratio=3.25x, Gap=-2.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.415, Ratio=3.55x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.394, Ratio=3.46x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.401, Ratio=3.45x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.393, Ratio=3.34x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.385, Ratio=3.30x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.404, Ratio=3.41x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.403, Ratio=3.45x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.383, Ratio=3.23x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.388, Ratio=3.50x, Gap=-2.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.388, Ratio=3.33x, Gap=-2.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.398, Ratio=3.41x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.387, Ratio=3.36x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.386, Ratio=3.20x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.389, Ratio=3.38x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.400, Ratio=3.45x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.397, Ratio=3.34x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.383, Ratio=3.35x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.398, Ratio=3.41x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.395, Ratio=3.41x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.394, Ratio=3.40x, Gap=-2.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.398, Ratio=3.54x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.394, Ratio=3.44x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.396, Ratio=3.43x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.392, Ratio=3.49x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.373, Ratio=3.15x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.382, Ratio=3.39x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.411, Ratio=3.63x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.403, Ratio=3.52x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.394, Ratio=3.36x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.400, Ratio=3.44x, Gap=-2.438

============================================================
Epoch 19/20 completed in 34.7s
Train: Loss=1.1493 (C:1.1493, R:0.0000) Ratio=2.81x
Val:   Loss=1.1109 (C:1.1109, R:0.0000) Ratio=3.38x
‚úÖ New best model saved (Val Loss: 1.1109)
============================================================

Epoch 20 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.393, Ratio=3.18x, Gap=-2.916
Batch   0/537: Loss=1.1337 (C:1.1337, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.393, Ratio=3.07x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.384, Ratio=3.07x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.407, Ratio=3.30x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.09x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.373, Ratio=3.03x, Gap=-2.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.391, Ratio=3.12x, Gap=-2.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.399, Ratio=3.18x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.412, Ratio=3.33x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.421, Ratio=3.34x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.396, Ratio=3.12x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.389, Ratio=2.98x, Gap=-2.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.402, Ratio=3.20x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.397, Ratio=3.04x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.404, Ratio=3.12x, Gap=-3.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.390, Ratio=2.97x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.398, Ratio=3.15x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.395, Ratio=3.22x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.388, Ratio=3.07x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.388, Ratio=3.20x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.401, Ratio=3.00x, Gap=-2.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.408, Ratio=3.32x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.402, Ratio=3.20x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.392, Ratio=3.14x, Gap=-2.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.397, Ratio=3.08x, Gap=-2.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.403, Ratio=3.29x, Gap=-2.875
Batch  25/537: Loss=1.1143 (C:1.1143, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.408, Ratio=3.22x, Gap=-2.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.382, Ratio=3.02x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.396, Ratio=3.08x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.380, Ratio=3.11x, Gap=-2.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.404, Ratio=3.33x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.385, Ratio=3.04x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.390, Ratio=3.01x, Gap=-2.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.391, Ratio=3.04x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.383, Ratio=2.95x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.395, Ratio=3.19x, Gap=-3.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.392, Ratio=3.15x, Gap=-3.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.407, Ratio=3.33x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.409, Ratio=3.34x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.392, Ratio=3.07x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.403, Ratio=3.20x, Gap=-2.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.09x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.401, Ratio=3.25x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.390, Ratio=3.09x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.398, Ratio=3.22x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.407, Ratio=3.23x, Gap=-2.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.401, Ratio=3.12x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.384, Ratio=3.05x, Gap=-2.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.388, Ratio=3.16x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.413, Ratio=3.20x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.399, Ratio=3.04x, Gap=-2.999
Batch  50/537: Loss=1.1529 (C:1.1529, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.405, Ratio=3.28x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.417, Ratio=3.11x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.378, Ratio=2.93x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.401, Ratio=3.10x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.392, Ratio=3.17x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.382, Ratio=3.08x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.375, Ratio=3.14x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.403, Ratio=3.20x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.378, Ratio=3.00x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.377, Ratio=3.05x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.386, Ratio=3.05x, Gap=-2.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.388, Ratio=3.13x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.396, Ratio=2.99x, Gap=-2.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.380, Ratio=2.99x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.404, Ratio=3.19x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.407, Ratio=3.20x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.408, Ratio=3.30x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.382, Ratio=3.04x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.404, Ratio=3.19x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.393, Ratio=3.02x, Gap=-2.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.384, Ratio=2.98x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.387, Ratio=3.08x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.389, Ratio=3.19x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.391, Ratio=3.18x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.398, Ratio=3.22x, Gap=-2.740
Batch  75/537: Loss=1.1228 (C:1.1228, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.383, Ratio=3.11x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.401, Ratio=3.14x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.388, Ratio=3.19x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.386, Ratio=3.04x, Gap=-2.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.414, Ratio=3.16x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.407, Ratio=3.23x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.418, Ratio=3.23x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.391, Ratio=3.01x, Gap=-2.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.406, Ratio=3.26x, Gap=-2.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.392, Ratio=3.00x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.382, Ratio=2.99x, Gap=-2.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.370, Ratio=2.98x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.378, Ratio=3.16x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.386, Ratio=3.12x, Gap=-2.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.396, Ratio=3.20x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.371, Ratio=3.05x, Gap=-2.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.387, Ratio=3.11x, Gap=-3.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.409, Ratio=3.13x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.429, Ratio=3.45x, Gap=-2.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.405, Ratio=3.23x, Gap=-3.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.400, Ratio=3.08x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.402, Ratio=3.06x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.405, Ratio=3.16x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.381, Ratio=2.90x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.384, Ratio=3.05x, Gap=-3.109
Batch 100/537: Loss=1.1539 (C:1.1539, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.395, Ratio=3.10x, Gap=-2.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.390, Ratio=3.07x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.388, Ratio=3.15x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.388, Ratio=3.06x, Gap=-3.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.400, Ratio=3.29x, Gap=-2.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.408, Ratio=3.30x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.399, Ratio=3.28x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.382, Ratio=3.20x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.384, Ratio=3.11x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.403, Ratio=3.29x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.398, Ratio=3.16x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.09x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.397, Ratio=3.13x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.395, Ratio=3.18x, Gap=-2.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.411, Ratio=3.27x, Gap=-3.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.409, Ratio=3.26x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.389, Ratio=3.11x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.381, Ratio=3.01x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.397, Ratio=3.04x, Gap=-2.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.372, Ratio=2.86x, Gap=-2.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.19x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.390, Ratio=3.09x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.400, Ratio=3.00x, Gap=-2.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.398, Ratio=3.14x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.383, Ratio=2.99x, Gap=-2.823
Batch 125/537: Loss=1.1648 (C:1.1648, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.391, Ratio=3.18x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.400, Ratio=3.23x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.390, Ratio=3.08x, Gap=-2.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.09x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.383, Ratio=3.07x, Gap=-2.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.388, Ratio=3.07x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.389, Ratio=3.06x, Gap=-2.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.398, Ratio=3.21x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.400, Ratio=3.21x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.405, Ratio=3.16x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.396, Ratio=3.25x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.410, Ratio=3.16x, Gap=-2.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.392, Ratio=3.29x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.398, Ratio=3.08x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.372, Ratio=2.98x, Gap=-2.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.371, Ratio=2.81x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.394, Ratio=2.92x, Gap=-2.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.402, Ratio=3.15x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.378, Ratio=2.87x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.394, Ratio=3.20x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.398, Ratio=3.25x, Gap=-2.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.372, Ratio=2.99x, Gap=-2.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.396, Ratio=3.08x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.405, Ratio=3.24x, Gap=-2.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.410, Ratio=3.21x, Gap=-2.750
Batch 150/537: Loss=1.1218 (C:1.1218, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.404, Ratio=3.17x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.396, Ratio=3.12x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.382, Ratio=3.05x, Gap=-2.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.383, Ratio=2.97x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.397, Ratio=3.28x, Gap=-3.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.388, Ratio=3.09x, Gap=-2.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.384, Ratio=3.01x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.394, Ratio=3.19x, Gap=-2.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.401, Ratio=3.24x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.381, Ratio=3.08x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.385, Ratio=3.06x, Gap=-2.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.400, Ratio=3.11x, Gap=-2.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.387, Ratio=3.05x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.396, Ratio=3.08x, Gap=-2.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.371, Ratio=3.21x, Gap=-2.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.415, Ratio=3.28x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.403, Ratio=3.23x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.399, Ratio=3.22x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.387, Ratio=3.07x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.381, Ratio=3.04x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.388, Ratio=3.09x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.410, Ratio=3.33x, Gap=-2.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.401, Ratio=3.17x, Gap=-2.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.394, Ratio=3.09x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.376, Ratio=2.91x, Gap=-2.787
Batch 175/537: Loss=1.1819 (C:1.1819, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.380, Ratio=3.03x, Gap=-2.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.388, Ratio=3.07x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.387, Ratio=3.07x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.410, Ratio=3.24x, Gap=-2.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.406, Ratio=3.25x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.388, Ratio=3.05x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.385, Ratio=3.02x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.389, Ratio=2.94x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.400, Ratio=3.24x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.380, Ratio=3.03x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.388, Ratio=3.15x, Gap=-2.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.401, Ratio=3.11x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.375, Ratio=2.89x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.389, Ratio=3.11x, Gap=-2.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.391, Ratio=3.03x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.374, Ratio=3.04x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.371, Ratio=3.04x, Gap=-2.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.383, Ratio=3.05x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.392, Ratio=3.14x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.398, Ratio=3.23x, Gap=-2.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.411, Ratio=3.25x, Gap=-2.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.400, Ratio=3.17x, Gap=-2.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.398, Ratio=3.31x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.407, Ratio=3.24x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.406, Ratio=3.22x, Gap=-2.699
Batch 200/537: Loss=1.1208 (C:1.1208, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.387, Ratio=3.13x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.392, Ratio=3.11x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.389, Ratio=3.17x, Gap=-2.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.400, Ratio=3.28x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.374, Ratio=2.99x, Gap=-2.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.380, Ratio=3.03x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.388, Ratio=3.08x, Gap=-2.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.396, Ratio=3.19x, Gap=-3.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.394, Ratio=3.07x, Gap=-3.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.411, Ratio=3.29x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.388, Ratio=2.97x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.409, Ratio=3.19x, Gap=-2.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.402, Ratio=3.12x, Gap=-3.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.395, Ratio=3.09x, Gap=-2.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.401, Ratio=3.16x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.393, Ratio=3.19x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.402, Ratio=3.12x, Gap=-3.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.410, Ratio=3.22x, Gap=-3.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.389, Ratio=3.07x, Gap=-2.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.371, Ratio=2.97x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.385, Ratio=3.00x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.391, Ratio=3.19x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.393, Ratio=3.18x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.407, Ratio=3.27x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.407, Ratio=3.26x, Gap=-2.843
Batch 225/537: Loss=1.1135 (C:1.1135, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.383, Ratio=2.95x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.389, Ratio=3.03x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.398, Ratio=3.13x, Gap=-2.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.383, Ratio=3.03x, Gap=-2.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.392, Ratio=2.99x, Gap=-2.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.397, Ratio=3.27x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.399, Ratio=3.18x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.379, Ratio=3.00x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.394, Ratio=2.98x, Gap=-2.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.374, Ratio=3.08x, Gap=-2.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.388, Ratio=3.10x, Gap=-2.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.385, Ratio=3.12x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.389, Ratio=3.01x, Gap=-2.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.389, Ratio=3.04x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.385, Ratio=2.94x, Gap=-2.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.375, Ratio=3.09x, Gap=-2.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.413, Ratio=3.30x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.378, Ratio=2.97x, Gap=-2.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.406, Ratio=3.12x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.401, Ratio=3.07x, Gap=-3.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.384, Ratio=2.93x, Gap=-2.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.393, Ratio=3.01x, Gap=-2.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.404, Ratio=3.16x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.397, Ratio=3.26x, Gap=-2.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.400, Ratio=3.05x, Gap=-2.895
Batch 250/537: Loss=1.1485 (C:1.1485, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.397, Ratio=3.17x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.392, Ratio=3.00x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.390, Ratio=2.98x, Gap=-2.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.390, Ratio=3.21x, Gap=-2.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.384, Ratio=3.14x, Gap=-2.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.387, Ratio=3.14x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.391, Ratio=3.11x, Gap=-2.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.398, Ratio=3.04x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.383, Ratio=3.07x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.373, Ratio=3.02x, Gap=-2.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.387, Ratio=3.01x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.405, Ratio=3.07x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.390, Ratio=3.02x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.394, Ratio=3.05x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.395, Ratio=3.06x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.384, Ratio=2.95x, Gap=-2.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.396, Ratio=3.22x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.392, Ratio=3.09x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.398, Ratio=3.27x, Gap=-2.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.382, Ratio=3.00x, Gap=-2.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.406, Ratio=3.29x, Gap=-3.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.390, Ratio=3.13x, Gap=-2.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.401, Ratio=3.12x, Gap=-2.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.394, Ratio=3.25x, Gap=-2.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.389, Ratio=3.12x, Gap=-2.821
Batch 275/537: Loss=1.1409 (C:1.1409, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.392, Ratio=3.07x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.390, Ratio=3.03x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.386, Ratio=3.15x, Gap=-2.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.389, Ratio=3.00x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.396, Ratio=3.09x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.390, Ratio=3.03x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.378, Ratio=2.95x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.402, Ratio=3.20x, Gap=-2.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.407, Ratio=3.10x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.401, Ratio=3.06x, Gap=-2.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.378, Ratio=3.11x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.391, Ratio=3.09x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.385, Ratio=3.03x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.382, Ratio=3.01x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.389, Ratio=3.08x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.398, Ratio=3.09x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.387, Ratio=3.16x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.390, Ratio=3.05x, Gap=-2.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.401, Ratio=3.09x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.407, Ratio=3.07x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.408, Ratio=3.16x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.416, Ratio=3.28x, Gap=-2.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.400, Ratio=3.09x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.414, Ratio=3.15x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.387, Ratio=3.07x, Gap=-2.732
Batch 300/537: Loss=1.1540 (C:1.1540, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.393, Ratio=3.06x, Gap=-2.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.392, Ratio=3.19x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.395, Ratio=3.20x, Gap=-2.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.406, Ratio=3.36x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.391, Ratio=3.17x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.402, Ratio=3.09x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.407, Ratio=3.16x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.384, Ratio=3.03x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.393, Ratio=3.25x, Gap=-2.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.374, Ratio=2.92x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.379, Ratio=3.01x, Gap=-2.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.375, Ratio=2.92x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.401, Ratio=3.20x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.398, Ratio=3.16x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.390, Ratio=3.05x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.396, Ratio=3.14x, Gap=-2.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.399, Ratio=3.24x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.405, Ratio=3.17x, Gap=-2.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.383, Ratio=3.11x, Gap=-2.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.399, Ratio=3.12x, Gap=-2.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.382, Ratio=3.09x, Gap=-2.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.407, Ratio=3.24x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.388, Ratio=3.02x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.407, Ratio=3.19x, Gap=-2.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.382, Ratio=3.07x, Gap=-2.924
Batch 325/537: Loss=1.1555 (C:1.1555, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.405, Ratio=3.15x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.380, Ratio=2.96x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.391, Ratio=3.02x, Gap=-2.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.390, Ratio=2.97x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.390, Ratio=3.12x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.392, Ratio=3.21x, Gap=-2.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.370, Ratio=2.91x, Gap=-2.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.389, Ratio=3.06x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.399, Ratio=3.10x, Gap=-2.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.408, Ratio=3.23x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.398, Ratio=3.21x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.394, Ratio=3.08x, Gap=-2.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.381, Ratio=3.00x, Gap=-3.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.394, Ratio=3.11x, Gap=-3.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.403, Ratio=3.28x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.409, Ratio=3.25x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.385, Ratio=3.11x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.394, Ratio=3.13x, Gap=-2.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.384, Ratio=3.05x, Gap=-2.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.392, Ratio=3.27x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.388, Ratio=3.15x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.388, Ratio=3.14x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.378, Ratio=3.05x, Gap=-2.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.387, Ratio=3.13x, Gap=-2.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.395, Ratio=3.23x, Gap=-2.693
Batch 350/537: Loss=1.1249 (C:1.1249, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.397, Ratio=3.16x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.405, Ratio=3.31x, Gap=-2.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.378, Ratio=2.99x, Gap=-2.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.401, Ratio=3.22x, Gap=-3.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.394, Ratio=3.15x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.408, Ratio=3.16x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.373, Ratio=2.97x, Gap=-2.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.393, Ratio=3.08x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.405, Ratio=3.11x, Gap=-2.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.374, Ratio=2.91x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.390, Ratio=3.06x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.403, Ratio=3.10x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.397, Ratio=3.09x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.389, Ratio=3.08x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.385, Ratio=3.05x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.408, Ratio=3.18x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.393, Ratio=3.16x, Gap=-2.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.384, Ratio=3.03x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.400, Ratio=3.17x, Gap=-2.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.398, Ratio=3.08x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.381, Ratio=3.05x, Gap=-2.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.384, Ratio=3.00x, Gap=-2.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.398, Ratio=3.16x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.388, Ratio=3.00x, Gap=-2.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.393, Ratio=3.00x, Gap=-2.796
Batch 375/537: Loss=1.1627 (C:1.1627, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.387, Ratio=3.07x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.400, Ratio=3.12x, Gap=-2.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.396, Ratio=3.12x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.369, Ratio=2.99x, Gap=-2.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.403, Ratio=3.35x, Gap=-2.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.380, Ratio=3.02x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.400, Ratio=3.31x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.391, Ratio=3.04x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.391, Ratio=3.07x, Gap=-3.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.411, Ratio=3.25x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.370, Ratio=2.98x, Gap=-2.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.392, Ratio=3.17x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.392, Ratio=3.16x, Gap=-2.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.378, Ratio=3.04x, Gap=-2.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.397, Ratio=3.20x, Gap=-2.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.398, Ratio=3.14x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.398, Ratio=3.15x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.407, Ratio=3.15x, Gap=-2.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.393, Ratio=3.06x, Gap=-2.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.403, Ratio=3.12x, Gap=-2.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.405, Ratio=3.16x, Gap=-2.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.377, Ratio=3.06x, Gap=-2.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.399, Ratio=3.07x, Gap=-2.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.401, Ratio=3.10x, Gap=-2.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.385, Ratio=3.03x, Gap=-2.945
Batch 400/537: Loss=1.1592 (C:1.1592, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.378, Ratio=2.98x, Gap=-2.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.405, Ratio=3.10x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.397, Ratio=3.10x, Gap=-2.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.388, Ratio=3.06x, Gap=-2.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.411, Ratio=3.27x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.387, Ratio=3.02x, Gap=-2.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.397, Ratio=3.08x, Gap=-3.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.414, Ratio=3.24x, Gap=-3.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.398, Ratio=3.10x, Gap=-3.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.399, Ratio=3.06x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.369, Ratio=2.90x, Gap=-3.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.392, Ratio=3.11x, Gap=-2.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.396, Ratio=3.08x, Gap=-2.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.372, Ratio=3.04x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.404, Ratio=3.22x, Gap=-2.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.382, Ratio=2.96x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.405, Ratio=3.22x, Gap=-2.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.402, Ratio=3.19x, Gap=-2.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.391, Ratio=2.98x, Gap=-2.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.384, Ratio=3.02x, Gap=-2.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.405, Ratio=3.29x, Gap=-2.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.405, Ratio=3.20x, Gap=-2.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.401, Ratio=3.21x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.383, Ratio=2.87x, Gap=-2.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.386, Ratio=2.98x, Gap=-2.906
Batch 425/537: Loss=1.1659 (C:1.1659, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.385, Ratio=3.02x, Gap=-2.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.396, Ratio=3.10x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.383, Ratio=2.91x, Gap=-2.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.407, Ratio=3.21x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.397, Ratio=3.12x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.369, Ratio=2.96x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.399, Ratio=3.10x, Gap=-2.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.379, Ratio=3.01x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.391, Ratio=3.08x, Gap=-2.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.398, Ratio=3.19x, Gap=-3.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.386, Ratio=2.96x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.403, Ratio=3.08x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.402, Ratio=3.24x, Gap=-2.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.393, Ratio=3.07x, Gap=-2.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.395, Ratio=3.16x, Gap=-2.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.387, Ratio=2.96x, Gap=-2.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.399, Ratio=3.08x, Gap=-2.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.390, Ratio=3.11x, Gap=-3.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.390, Ratio=3.08x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.382, Ratio=2.95x, Gap=-3.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.386, Ratio=3.08x, Gap=-2.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.384, Ratio=2.94x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.386, Ratio=3.08x, Gap=-2.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.377, Ratio=3.02x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.396, Ratio=3.22x, Gap=-2.790
Batch 450/537: Loss=1.1230 (C:1.1230, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.397, Ratio=3.11x, Gap=-2.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.392, Ratio=3.09x, Gap=-2.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.382, Ratio=3.06x, Gap=-3.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.395, Ratio=3.17x, Gap=-2.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.383, Ratio=2.98x, Gap=-2.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.397, Ratio=3.03x, Gap=-2.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.387, Ratio=3.04x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.398, Ratio=3.22x, Gap=-2.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.405, Ratio=3.24x, Gap=-2.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.380, Ratio=3.06x, Gap=-2.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.402, Ratio=3.13x, Gap=-2.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.389, Ratio=3.10x, Gap=-2.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.383, Ratio=3.07x, Gap=-2.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.396, Ratio=3.05x, Gap=-2.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.388, Ratio=3.18x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.390, Ratio=3.17x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.398, Ratio=3.07x, Gap=-2.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.391, Ratio=3.17x, Gap=-2.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.379, Ratio=3.00x, Gap=-2.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.397, Ratio=3.08x, Gap=-2.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.384, Ratio=3.15x, Gap=-2.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.378, Ratio=3.06x, Gap=-2.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.393, Ratio=3.07x, Gap=-2.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.389, Ratio=3.15x, Gap=-2.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.398, Ratio=3.09x, Gap=-3.223
Batch 475/537: Loss=1.1469 (C:1.1469, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.399, Ratio=3.17x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.402, Ratio=3.18x, Gap=-2.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.394, Ratio=3.05x, Gap=-3.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.373, Ratio=2.93x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.375, Ratio=2.94x, Gap=-2.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.388, Ratio=2.97x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.382, Ratio=3.04x, Gap=-2.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.391, Ratio=3.13x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.403, Ratio=3.07x, Gap=-2.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.400, Ratio=3.21x, Gap=-2.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.404, Ratio=3.20x, Gap=-2.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.388, Ratio=3.07x, Gap=-2.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.391, Ratio=3.03x, Gap=-2.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.410, Ratio=3.24x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.399, Ratio=3.03x, Gap=-2.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.405, Ratio=3.14x, Gap=-2.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.399, Ratio=3.11x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.395, Ratio=3.09x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.382, Ratio=3.13x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.407, Ratio=3.20x, Gap=-2.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.374, Ratio=3.01x, Gap=-2.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.400, Ratio=3.15x, Gap=-2.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.383, Ratio=3.05x, Gap=-2.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.394, Ratio=3.09x, Gap=-2.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.371, Ratio=2.90x, Gap=-2.882
Batch 500/537: Loss=1.1858 (C:1.1858, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.396, Ratio=3.10x, Gap=-2.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.379, Ratio=2.92x, Gap=-3.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.387, Ratio=3.17x, Gap=-2.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.393, Ratio=3.12x, Gap=-2.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.393, Ratio=3.18x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.389, Ratio=3.12x, Gap=-3.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.397, Ratio=3.19x, Gap=-2.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.383, Ratio=2.99x, Gap=-2.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.402, Ratio=3.22x, Gap=-2.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.396, Ratio=3.07x, Gap=-2.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.387, Ratio=2.99x, Gap=-2.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.407, Ratio=3.06x, Gap=-2.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.397, Ratio=3.10x, Gap=-2.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.385, Ratio=3.06x, Gap=-2.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.392, Ratio=3.09x, Gap=-2.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.387, Ratio=2.90x, Gap=-2.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.372, Ratio=2.95x, Gap=-2.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.399, Ratio=3.19x, Gap=-3.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.403, Ratio=3.24x, Gap=-2.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.383, Ratio=3.10x, Gap=-2.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.411, Ratio=3.28x, Gap=-2.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.394, Ratio=3.15x, Gap=-2.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.379, Ratio=3.00x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.403, Ratio=3.13x, Gap=-2.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.390, Ratio=3.00x, Gap=-2.764
Batch 525/537: Loss=1.1601 (C:1.1601, R:0.0000)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.409, Ratio=3.17x, Gap=-2.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.394, Ratio=3.01x, Gap=-2.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.383, Ratio=2.97x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.398, Ratio=3.15x, Gap=-2.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.395, Ratio=3.13x, Gap=-2.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.389, Ratio=3.10x, Gap=-3.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.395, Ratio=3.03x, Gap=-2.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.391, Ratio=3.03x, Gap=-2.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.396, Ratio=3.18x, Gap=-2.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.380, Ratio=3.09x, Gap=-2.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.393, Ratio=3.09x, Gap=-2.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.392, Ratio=3.23x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.392, Ratio=3.41x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.396, Ratio=3.44x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.397, Ratio=3.42x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.401, Ratio=3.50x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.394, Ratio=3.33x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.378, Ratio=3.18x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.399, Ratio=3.54x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.397, Ratio=3.38x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.397, Ratio=3.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.387, Ratio=3.38x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.407, Ratio=3.47x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.375, Neg=1.423, Ratio=3.80x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.388, Ratio=3.13x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.382, Ratio=3.32x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.390, Ratio=3.46x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.401, Ratio=3.38x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.384, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.408, Ratio=3.49x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.398, Ratio=3.44x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.419, Ratio=3.64x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.416, Ratio=3.59x, Gap=-2.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.406, Ratio=3.41x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.395, Ratio=3.34x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.391, Ratio=3.41x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.401, Ratio=3.44x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.407, Ratio=3.51x, Gap=-2.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.391, Ratio=3.36x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.387, Ratio=3.32x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.407, Ratio=3.32x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.397, Ratio=3.31x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.392, Ratio=3.34x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.391, Ratio=3.23x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.396, Ratio=3.59x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.377, Ratio=3.24x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.397, Ratio=3.38x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.407, Ratio=3.53x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.397, Ratio=3.39x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.390, Ratio=3.22x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.385, Ratio=3.30x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.382, Ratio=3.11x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.412, Ratio=3.49x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.391, Ratio=3.31x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.420, Ratio=3.64x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.25x, Gap=-2.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.383, Ratio=3.37x, Gap=-2.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.395, Ratio=3.31x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.25x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.399, Ratio=3.43x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.392, Ratio=3.38x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.405, Ratio=3.56x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.416, Ratio=3.59x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.399, Ratio=3.47x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.401, Ratio=3.41x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.388, Ratio=3.30x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.391, Ratio=3.34x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.407, Ratio=3.47x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.400, Ratio=3.50x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.397, Ratio=3.33x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.403, Ratio=3.57x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.383, Neg=1.416, Ratio=3.69x, Gap=-2.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.387, Ratio=3.34x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.396, Ratio=3.48x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.384, Ratio=3.14x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.377, Ratio=3.29x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.389, Ratio=3.21x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.398, Ratio=3.41x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.379, Ratio=3.25x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.396, Ratio=3.46x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.399, Ratio=3.53x, Gap=-2.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.399, Ratio=3.48x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.389, Ratio=3.26x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.382, Ratio=3.20x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.406, Ratio=3.53x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.402, Ratio=3.28x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.391, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.399, Ratio=3.43x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.403, Ratio=3.45x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.395, Ratio=3.53x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.404, Ratio=3.38x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.406, Ratio=3.42x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.377, Neg=1.419, Ratio=3.77x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.406, Ratio=3.42x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.410, Ratio=3.41x, Gap=-2.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.380, Ratio=3.29x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.390, Ratio=3.28x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.392, Ratio=3.33x, Gap=-2.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.390, Ratio=3.52x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.381, Neg=1.403, Ratio=3.68x, Gap=-2.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.385, Ratio=3.28x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.397, Ratio=3.36x, Gap=-2.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.381, Ratio=3.19x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.404, Ratio=3.33x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.396, Ratio=3.38x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.399, Ratio=3.35x, Gap=-2.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.410, Ratio=3.40x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.393, Ratio=3.34x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.395, Ratio=3.43x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.402, Ratio=3.52x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.405, Ratio=3.55x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.410, Ratio=3.51x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.404, Ratio=3.40x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.392, Ratio=3.38x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.409, Ratio=3.37x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.397, Ratio=3.47x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.392, Ratio=3.36x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.386, Ratio=3.25x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.410, Ratio=3.55x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.419, Ratio=3.59x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.385, Ratio=3.34x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.404, Ratio=3.57x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.392, Ratio=3.30x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.401, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.388, Ratio=3.37x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.391, Ratio=3.25x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.387, Ratio=3.33x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.394, Ratio=3.43x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.414, Ratio=3.57x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.400, Ratio=3.41x, Gap=-2.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.405, Ratio=3.42x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.396, Ratio=3.36x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.398, Ratio=3.38x, Gap=-2.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.400, Ratio=3.31x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.393, Ratio=3.36x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.385, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.388, Ratio=3.32x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.396, Ratio=3.54x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.379, Ratio=3.25x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.405, Ratio=3.47x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.402, Ratio=3.36x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.391, Ratio=3.25x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.404, Ratio=3.39x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.396, Ratio=3.31x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.395, Ratio=3.48x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.395, Ratio=3.38x, Gap=-2.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.397, Ratio=3.28x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.388, Ratio=3.29x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.394, Ratio=3.28x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.394, Ratio=3.29x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.386, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.396, Ratio=3.35x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.388, Ratio=3.40x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.381, Ratio=3.33x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.395, Ratio=3.31x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.390, Ratio=3.39x, Gap=-2.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.32x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.381, Neg=1.419, Ratio=3.73x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.407, Ratio=3.41x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.410, Ratio=3.50x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.401, Ratio=3.53x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.412, Ratio=3.61x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.402, Ratio=3.39x, Gap=-2.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.384, Ratio=3.36x, Gap=-2.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.387, Ratio=3.31x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.391, Ratio=3.27x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.393, Ratio=3.40x, Gap=-2.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.405, Ratio=3.44x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.401, Ratio=3.36x, Gap=-2.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.406, Ratio=3.51x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.388, Ratio=3.28x, Gap=-2.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.398, Ratio=3.40x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.397, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.391, Ratio=3.47x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.390, Ratio=3.33x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.405, Ratio=3.45x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.402, Ratio=3.37x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.397, Ratio=3.32x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.399, Ratio=3.42x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.398, Ratio=3.50x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.401, Ratio=3.34x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.406, Ratio=3.43x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.393, Ratio=3.24x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.412, Ratio=3.65x, Gap=-2.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.397, Ratio=3.34x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.389, Ratio=3.34x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.401, Ratio=3.48x, Gap=-2.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.391, Ratio=3.46x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.389, Ratio=3.33x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.387, Ratio=3.35x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.399, Ratio=3.40x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.398, Ratio=3.28x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.409, Ratio=3.51x, Gap=-2.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.399, Ratio=3.43x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.392, Neg=1.411, Ratio=3.60x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.395, Ratio=3.45x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.396, Ratio=3.39x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.412, Ratio=3.51x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.404, Ratio=3.49x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.400, Ratio=3.37x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.404, Ratio=3.46x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.376, Ratio=3.10x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.405, Ratio=3.43x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.398, Ratio=3.61x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.376, Neg=1.416, Ratio=3.77x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.401, Ratio=3.36x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.389, Ratio=3.19x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.392, Ratio=3.30x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.403, Ratio=3.54x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.391, Ratio=3.39x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.386, Ratio=3.26x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.398, Ratio=3.46x, Gap=-2.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.410, Ratio=3.61x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.393, Ratio=3.38x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.389, Ratio=3.42x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.410, Ratio=3.50x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.375, Ratio=3.27x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.403, Ratio=3.36x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.389, Ratio=3.33x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.390, Ratio=3.31x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.394, Ratio=3.27x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.394, Ratio=3.34x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.396, Ratio=3.28x, Gap=-2.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.399, Ratio=3.48x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.393, Neg=1.410, Ratio=3.58x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.398, Ratio=3.53x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.391, Ratio=3.38x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.32x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.406, Ratio=3.47x, Gap=-2.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.400, Ratio=3.38x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.392, Ratio=3.28x, Gap=-2.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.388, Ratio=3.18x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.394, Ratio=3.26x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.390, Ratio=3.27x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.400, Ratio=3.33x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.394, Ratio=3.35x, Gap=-2.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.391, Ratio=3.28x, Gap=-2.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.388, Ratio=3.34x, Gap=-2.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.376, Ratio=3.18x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.409, Ratio=3.47x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.399, Ratio=3.40x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.401, Ratio=3.46x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.409, Ratio=3.48x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.390, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.394, Ratio=3.36x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.392, Ratio=3.42x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.389, Ratio=3.22x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.405, Ratio=3.36x, Gap=-2.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.403, Ratio=3.40x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.395, Ratio=3.34x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.409, Ratio=3.39x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.382, Ratio=3.25x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.404, Ratio=3.46x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.389, Ratio=3.42x, Gap=-2.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.393, Ratio=3.28x, Gap=-2.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.399, Ratio=3.35x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.401, Ratio=3.50x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.386, Ratio=3.25x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.407, Ratio=3.47x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.421, Ratio=3.55x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.397, Ratio=3.38x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.387, Ratio=3.13x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.387, Ratio=3.20x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.406, Ratio=3.44x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.398, Ratio=3.35x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.402, Ratio=3.58x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.393, Ratio=3.42x, Gap=-2.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.413, Ratio=3.43x, Gap=-2.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.388, Ratio=3.31x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.391, Ratio=3.22x, Gap=-2.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.403, Ratio=3.38x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.393, Ratio=3.47x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.397, Ratio=3.24x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.397, Ratio=3.45x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.399, Ratio=3.50x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.402, Ratio=3.46x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.398, Ratio=3.39x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.403, Ratio=3.61x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.40x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.375, Ratio=3.10x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.395, Ratio=3.32x, Gap=-2.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.400, Ratio=3.40x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.393, Ratio=3.34x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.395, Ratio=3.25x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.410, Ratio=3.49x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.390, Ratio=3.47x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.388, Ratio=3.22x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.398, Ratio=3.30x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.400, Ratio=3.35x, Gap=-2.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.382, Ratio=3.15x, Gap=-2.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.375, Ratio=3.18x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.386, Ratio=3.28x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.396, Ratio=3.32x, Gap=-2.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.400, Ratio=3.36x, Gap=-2.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.397, Ratio=3.35x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.396, Ratio=3.42x, Gap=-2.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.403, Ratio=3.54x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.394, Ratio=3.34x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.399, Ratio=3.37x, Gap=-2.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.393, Ratio=3.41x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.400, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.390, Ratio=3.27x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.410, Ratio=3.53x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.416, Ratio=3.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.408, Ratio=3.52x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.374, Ratio=3.23x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.392, Ratio=3.23x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.398, Ratio=3.42x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.404, Ratio=3.51x, Gap=-2.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.376, Ratio=3.01x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.416, Ratio=3.59x, Gap=-2.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.32x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.413, Ratio=3.52x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.392, Ratio=3.40x, Gap=-2.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.400, Ratio=3.34x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.403, Ratio=3.25x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.395, Ratio=3.30x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=1.414, Ratio=3.64x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.384, Ratio=3.22x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.405, Ratio=3.51x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.395, Ratio=3.44x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.407, Ratio=3.48x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.399, Ratio=3.43x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.410, Ratio=3.56x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.417, Ratio=3.41x, Gap=-2.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.390, Ratio=3.41x, Gap=-2.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.395, Ratio=3.37x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.395, Ratio=3.33x, Gap=-2.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.392, Ratio=3.32x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.389, Ratio=3.30x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.398, Ratio=3.34x, Gap=-2.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.387, Ratio=3.40x, Gap=-2.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.395, Ratio=3.30x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.389, Ratio=3.36x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.410, Ratio=3.52x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.395, Ratio=3.32x, Gap=-2.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.390, Ratio=3.37x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.400, Ratio=3.34x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.401, Ratio=3.39x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.391, Ratio=3.47x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.410, Ratio=3.39x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.395, Ratio=3.40x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.405, Ratio=3.44x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.402, Ratio=3.52x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.386, Ratio=3.29x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.384, Ratio=3.33x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.407, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.387, Ratio=3.38x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.398, Ratio=3.45x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.398, Ratio=3.26x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.396, Ratio=3.39x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.399, Ratio=3.41x, Gap=-2.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.400, Ratio=3.33x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.400, Ratio=3.47x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.387, Ratio=3.21x, Gap=-2.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.403, Ratio=3.48x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.392, Ratio=3.20x, Gap=-2.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.403, Ratio=3.46x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.390, Ratio=3.46x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.389, Ratio=3.34x, Gap=-2.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.383, Neg=1.424, Ratio=3.72x, Gap=-2.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.384, Ratio=3.18x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.386, Ratio=3.31x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.406, Ratio=3.33x, Gap=-2.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.408, Ratio=3.35x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.389, Ratio=3.34x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.409, Ratio=3.43x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.394, Ratio=3.26x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.387, Ratio=3.27x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.391, Ratio=3.28x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.373, Ratio=3.16x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.389, Ratio=3.41x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.393, Ratio=3.29x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.403, Ratio=3.34x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=1.383, Ratio=3.23x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.399, Ratio=3.40x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.399, Ratio=3.34x, Gap=-2.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.382, Ratio=3.18x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.405, Ratio=3.59x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.400, Ratio=3.45x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.398, Ratio=3.42x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.398, Ratio=3.41x, Gap=-2.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.403, Ratio=3.39x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.410, Ratio=3.46x, Gap=-2.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.395, Ratio=3.37x, Gap=-2.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.396, Ratio=3.32x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.392, Ratio=3.27x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.393, Ratio=3.28x, Gap=-2.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.403, Ratio=3.48x, Gap=-2.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.391, Ratio=3.18x, Gap=-2.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.400, Ratio=3.37x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.395, Ratio=3.29x, Gap=-2.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.401, Ratio=3.51x, Gap=-2.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.393, Ratio=3.32x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.387, Ratio=3.31x, Gap=-2.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=1.404, Ratio=3.53x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.396, Ratio=3.28x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.406, Ratio=3.48x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=1.392, Ratio=3.21x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.402, Ratio=3.40x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.408, Ratio=3.47x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.397, Ratio=3.31x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.404, Ratio=3.36x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.391, Ratio=3.33x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.401, Ratio=3.44x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.409, Ratio=3.40x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.395, Ratio=3.45x, Gap=-2.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.403, Ratio=3.45x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.382, Ratio=3.26x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.388, Ratio=3.34x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.389, Ratio=3.22x, Gap=-2.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.395, Ratio=3.45x, Gap=-2.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.405, Ratio=3.32x, Gap=-2.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.401, Ratio=3.35x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.401, Ratio=3.42x, Gap=-2.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.374, Ratio=3.25x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.390, Neg=1.412, Ratio=3.62x, Gap=-2.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.400, Ratio=3.48x, Gap=-2.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.381, Ratio=3.28x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.392, Ratio=3.42x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.406, Ratio=3.40x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.406, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.399, Ratio=3.44x, Gap=-2.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.402, Ratio=3.42x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.403, Ratio=3.43x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.393, Ratio=3.43x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.400, Ratio=3.55x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.396, Ratio=3.32x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.403, Ratio=3.36x, Gap=-2.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.398, Ratio=3.27x, Gap=-2.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.404, Ratio=3.54x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.395, Ratio=3.49x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.385, Ratio=3.24x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.387, Neg=1.404, Ratio=3.63x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.382, Ratio=3.15x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.391, Ratio=3.42x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.398, Ratio=3.40x, Gap=-2.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.389, Ratio=3.23x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.394, Ratio=3.28x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.374, Ratio=3.23x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.409, Ratio=3.50x, Gap=-2.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.398, Ratio=3.47x, Gap=-2.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.395, Ratio=3.34x, Gap=-2.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.407, Ratio=3.37x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.403, Ratio=3.37x, Gap=-2.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.413, Ratio=3.56x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.385, Ratio=3.29x, Gap=-2.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.379, Ratio=3.14x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.389, Ratio=3.31x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=1.393, Ratio=3.27x, Gap=-2.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.403, Ratio=3.41x, Gap=-2.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.399, Ratio=3.41x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.389, Ratio=3.44x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=1.410, Ratio=3.51x, Gap=-2.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.392, Ratio=3.20x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.386, Ratio=3.27x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.404, Ratio=3.46x, Gap=-2.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=1.391, Ratio=3.25x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.399, Ratio=3.28x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.387, Ratio=3.18x, Gap=-2.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.397, Ratio=3.41x, Gap=-2.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.405, Ratio=3.35x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=1.411, Ratio=3.60x, Gap=-2.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.398, Ratio=3.32x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=1.397, Ratio=3.54x, Gap=-2.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.394, Ratio=3.34x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.399, Ratio=3.47x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.393, Ratio=3.30x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.395, Ratio=3.26x, Gap=-2.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=1.384, Ratio=3.45x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.401, Ratio=3.46x, Gap=-2.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.379, Ratio=3.16x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.400, Ratio=3.34x, Gap=-2.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.405, Ratio=3.41x, Gap=-2.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.388, Ratio=3.38x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.412, Ratio=3.37x, Gap=-2.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=1.389, Ratio=3.31x, Gap=-2.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.402, Ratio=3.36x, Gap=-2.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.402, Ratio=3.39x, Gap=-2.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.414, Ratio=3.48x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.395, Ratio=3.36x, Gap=-2.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=1.409, Ratio=3.56x, Gap=-2.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.384, Ratio=3.23x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.405, Ratio=3.40x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.380, Ratio=3.30x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.386, Ratio=3.28x, Gap=-2.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.408, Ratio=3.53x, Gap=-2.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.402, Ratio=3.45x, Gap=-2.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.387, Ratio=3.52x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.398, Ratio=3.31x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.394, Ratio=3.42x, Gap=-2.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.397, Neg=1.400, Ratio=3.52x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.382, Ratio=3.16x, Gap=-2.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.390, Ratio=3.41x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.401, Ratio=3.61x, Gap=-2.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.391, Ratio=3.26x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=1.396, Ratio=3.44x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.405, Ratio=3.49x, Gap=-2.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=1.391, Ratio=3.30x, Gap=-2.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=1.403, Ratio=3.35x, Gap=-2.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.385, Ratio=3.15x, Gap=-2.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.388, Neg=1.400, Ratio=3.61x, Gap=-2.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.400, Ratio=3.39x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.396, Ratio=3.28x, Gap=-2.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=1.411, Ratio=3.50x, Gap=-2.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.373, Ratio=3.19x, Gap=-2.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=1.413, Ratio=3.53x, Gap=-2.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.398, Ratio=3.44x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.400, Ratio=3.38x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.390, Ratio=3.29x, Gap=-2.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=1.391, Ratio=3.37x, Gap=-2.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.401, Ratio=3.41x, Gap=-2.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.392, Ratio=3.15x, Gap=-2.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.384, Ratio=3.18x, Gap=-2.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=1.414, Ratio=3.43x, Gap=-2.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.396, Ratio=3.31x, Gap=-2.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=1.385, Ratio=3.27x, Gap=-2.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=1.416, Ratio=3.46x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=1.400, Ratio=3.46x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.390, Ratio=3.26x, Gap=-2.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=1.395, Ratio=3.39x, Gap=-2.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=1.388, Ratio=3.33x, Gap=-2.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.390, Ratio=3.35x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.411, Ratio=3.41x, Gap=-2.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.384, Ratio=3.40x, Gap=-2.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.391, Ratio=3.34x, Gap=-2.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.410, Ratio=3.40x, Gap=-2.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.394, Neg=1.394, Ratio=3.54x, Gap=-2.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=1.393, Ratio=3.37x, Gap=-2.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=1.392, Ratio=3.28x, Gap=-2.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=1.399, Ratio=3.42x, Gap=-2.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=1.386, Ratio=3.28x, Gap=-2.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.399, Neg=1.408, Ratio=3.53x, Gap=-2.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=1.398, Ratio=3.43x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=1.410, Ratio=3.36x, Gap=-2.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.378, Ratio=3.19x, Gap=-2.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.394, Ratio=3.35x, Gap=-2.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=1.404, Ratio=3.38x, Gap=-2.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.401, Ratio=3.37x, Gap=-2.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=1.405, Ratio=3.48x, Gap=-2.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=1.404, Ratio=3.44x, Gap=-2.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=1.405, Ratio=3.38x, Gap=-2.444

============================================================
Epoch 20/20 completed in 28.9s
Train: Loss=1.1441 (C:1.1441, R:0.0000) Ratio=2.85x
Val:   Loss=1.1070 (C:1.1070, R:0.0000) Ratio=3.43x
‚úÖ New best model saved (Val Loss: 1.1070)
Checkpoint saved at epoch 20
============================================================

Global Dataset Training Completed!
Best epoch: 20
Best validation loss: 1.1070
Final separation ratios: Train=2.85x, Val=3.43x
Training completed!
Loading best model from experiments/global_lattice_test_20250712_120043/checkpoints/best_model.pt
Starting model evaluation...
========================================
GlobalContrastiveEvaluator initialized on cuda
Starting comprehensive evaluation...
============================================================
Extracting latent representations...
  Processed 1/539 batches
  Processed 51/539 batches
  Processed 101/539 batches
  Processed 151/539 batches
  Processed 201/539 batches
  Processed 251/539 batches
  Processed 301/539 batches
  Processed 351/539 batches
  Processed 401/539 batches
  Processed 451/539 batches
  Processed 501/539 batches
Extracted representations: torch.Size([549367, 75])
Evaluating clustering performance...
