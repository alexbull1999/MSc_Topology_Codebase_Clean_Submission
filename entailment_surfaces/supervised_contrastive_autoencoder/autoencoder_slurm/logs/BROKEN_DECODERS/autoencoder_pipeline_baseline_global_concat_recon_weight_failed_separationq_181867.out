Starting Surface Distance Metric Analysis job...
Job ID: 181867
Node: gpuvm17
Time: Sat 12 Jul 12:55:41 BST 2025
Loading CUDA...
Activating conda environment...
Activated conda environment: /vol/bitbucket/ahb24/tda_entailment_new
Python location: /vol/bitbucket/ahb24/tda_entailment_new/bin/python
Checking GPU availability...
Sat Jul 12 12:55:43 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.07             Driver Version: 570.133.07     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:06.0 Off |                    0 |
| N/A   31C    P8              9W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

Testing PyTorch and CUDA...
PyTorch version: 2.4.1
CUDA available: True
CUDA device: Tesla T4
GPU memory: 15.6 GB
PyTorch setup verified!

Starting AutoEncoder Pipeline...

GLOBAL DATASET CONTRASTIVE AUTOENCODER PIPELINE
============================================================
Start time: 2025-07-12 12:56:03.423736
Using device: cuda

Configuration:
  Embedding type: concat
  Batch size: 1020
  Global update frequency: 3 epochs
  Training epochs: 20
Experiment setup completed:
  Experiment directory: experiments/global_concat_test_20250712_125603
  Config saved to: experiments/global_concat_test_20250712_125603/config.json
Loading data...
========================================
FlexibleEmbedder initialized with type: 'concat'
Output dimension will be: 1536
GlobalDataLoader initialized:
  Embedding type: concat
  Output dimension: 1536
  Sample size: All
Starting data loading pipeline...
============================================================
Loading training data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 training samples
Loading validation data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 validation samples
Loading test data from data/processed/snli_full_standard_SBERT.pt
  Loaded keys: ['premise_embeddings', 'hypothesis_embeddings', 'labels', 'texts', 'metadata']
  Final dataset: 549367 test samples
Generating embeddings for training...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for validation...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
Generating embeddings for test...
Generating concat embeddings on cuda
Processing 549367 samples in batches of 1000
  Processing batch 1/550
  Processing batch 6/550
  Processing batch 11/550
  Processing batch 16/550
  Processing batch 21/550
  Processing batch 26/550
  Processing batch 31/550
  Processing batch 36/550
  Processing batch 41/550
  Processing batch 46/550
  Processing batch 51/550
  Processing batch 56/550
  Processing batch 61/550
  Processing batch 66/550
  Processing batch 71/550
  Processing batch 76/550
  Processing batch 81/550
  Processing batch 86/550
  Processing batch 91/550
  Processing batch 96/550
  Processing batch 101/550
  Processing batch 106/550
  Processing batch 111/550
  Processing batch 116/550
  Processing batch 121/550
  Processing batch 126/550
  Processing batch 131/550
  Processing batch 136/550
  Processing batch 141/550
  Processing batch 146/550
  Processing batch 151/550
  Processing batch 156/550
  Processing batch 161/550
  Processing batch 166/550
  Processing batch 171/550
  Processing batch 176/550
  Processing batch 181/550
  Processing batch 186/550
  Processing batch 191/550
  Processing batch 196/550
  Processing batch 201/550
  Processing batch 206/550
  Processing batch 211/550
  Processing batch 216/550
  Processing batch 221/550
  Processing batch 226/550
  Processing batch 231/550
  Processing batch 236/550
  Processing batch 241/550
  Processing batch 246/550
  Processing batch 251/550
  Processing batch 256/550
  Processing batch 261/550
  Processing batch 266/550
  Processing batch 271/550
  Processing batch 276/550
  Processing batch 281/550
  Processing batch 286/550
  Processing batch 291/550
  Processing batch 296/550
  Processing batch 301/550
  Processing batch 306/550
  Processing batch 311/550
  Processing batch 316/550
  Processing batch 321/550
  Processing batch 326/550
  Processing batch 331/550
  Processing batch 336/550
  Processing batch 341/550
  Processing batch 346/550
  Processing batch 351/550
  Processing batch 356/550
  Processing batch 361/550
  Processing batch 366/550
  Processing batch 371/550
  Processing batch 376/550
  Processing batch 381/550
  Processing batch 386/550
  Processing batch 391/550
  Processing batch 396/550
  Processing batch 401/550
  Processing batch 406/550
  Processing batch 411/550
  Processing batch 416/550
  Processing batch 421/550
  Processing batch 426/550
  Processing batch 431/550
  Processing batch 436/550
  Processing batch 441/550
  Processing batch 446/550
  Processing batch 451/550
  Processing batch 456/550
  Processing batch 461/550
  Processing batch 466/550
  Processing batch 471/550
  Processing batch 476/550
  Processing batch 481/550
  Processing batch 486/550
  Processing batch 491/550
  Processing batch 496/550
  Processing batch 501/550
  Processing batch 506/550
  Processing batch 511/550
  Processing batch 516/550
  Processing batch 521/550
  Processing batch 526/550
  Processing batch 531/550
  Processing batch 536/550
  Processing batch 541/550
  Processing batch 546/550
Generated concat embeddings: torch.Size([549367, 1536])
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}
EntailmentDataset created: 549367 samples
  Embedding shape: torch.Size([549367, 1536])
  Class distribution: {'entailment': 183416, 'neutral': 182764, 'contradiction': 183187}

Data loading pipeline completed!
Output embedding dimension: 1536
Updated model input_dim to: 1536
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
BalancedBatchSampler initialized:
  Classes: [2, 0, 1]
  Samples per class per batch: 340
  Effective batch size: 1020
  Number of batches: 537
  Class 2: 183187 samples
  Class 0: 183416 samples
  Class 1: 182764 samples
DataLoaders created:
  Batch size: 1020
  Balanced sampling: True
  Train batches: 537
  Val batches: 537
  Test batches: 539
Data loading completed!
  Train: 549367 samples, 537 batches
  Val: 549367 samples, 537 batches
  Test: 549367 samples, 539 batches
Creating model and trainer...
========================================
ContrastiveAutoencoder initialized:
  Input dim: 1536
  Latent dim: 75
  Hidden dims: [512, 256]
  Dropout rate: 0.2
  Total parameters: 1,876,555
Model created with 1,876,555 parameters
FullDatasetContrastiveLoss initialized:
  Margin: 2.0
  Update frequency: 3 epochs
  Max global samples: 5000
FullDatasetCombinedLoss initialized:
  Contrastive weight: 1.0
  Base reconstruction weight: 0.0
  Scheduled reconstruction: warmup=30 epochs, max_weight=0.3
Optimizer created (lr=0.0001)
GlobalDatasetTrainer initialized on device: cuda
Model parameters: 1,876,555
Starting training...
========================================
Starting Global Dataset Training...
============================================================

🌍 Updating global dataset at epoch 1
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.095 ± 0.011
    Neg distances: 0.095 ± 0.011
    Separation ratio: 1.00x
    Gap: -0.123
    ❌ Poor global separation

Epoch 1 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.119, Neg=0.119, Ratio=1.00x, Gap=-0.197
Batch   0/537: Loss=1.9998 (C:1.9998, R:0.0117)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.119, Neg=0.120, Ratio=1.00x, Gap=-0.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.120, Neg=0.120, Ratio=1.00x, Gap=-0.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.120, Neg=0.120, Ratio=1.00x, Gap=-0.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.121, Neg=0.121, Ratio=1.00x, Gap=-0.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.121, Neg=0.121, Ratio=1.00x, Gap=-0.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.122, Neg=0.123, Ratio=1.00x, Gap=-0.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.123, Neg=0.123, Ratio=1.00x, Gap=-0.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.123, Neg=0.124, Ratio=1.01x, Gap=-0.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.124, Neg=0.124, Ratio=1.01x, Gap=-0.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.127, Ratio=1.01x, Gap=-0.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.126, Neg=0.128, Ratio=1.01x, Gap=-0.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.127, Neg=0.129, Ratio=1.01x, Gap=-0.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.131, Neg=0.133, Ratio=1.01x, Gap=-0.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.132, Neg=0.134, Ratio=1.01x, Gap=-0.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.133, Neg=0.135, Ratio=1.01x, Gap=-0.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.136, Neg=0.138, Ratio=1.01x, Gap=-0.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.139, Neg=0.141, Ratio=1.01x, Gap=-0.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.140, Neg=0.143, Ratio=1.02x, Gap=-0.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.144, Neg=0.147, Ratio=1.02x, Gap=-0.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.145, Neg=0.148, Ratio=1.02x, Gap=-0.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.152, Neg=0.155, Ratio=1.02x, Gap=-0.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.154, Neg=0.158, Ratio=1.03x, Gap=-0.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.158, Neg=0.162, Ratio=1.02x, Gap=-0.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.164, Neg=0.170, Ratio=1.03x, Gap=-0.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.171, Neg=0.176, Ratio=1.03x, Gap=-0.843
Batch  25/537: Loss=1.9946 (C:1.9946, R:0.0114)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.177, Neg=0.182, Ratio=1.03x, Gap=-0.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.181, Neg=0.188, Ratio=1.04x, Gap=-0.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.186, Neg=0.192, Ratio=1.03x, Gap=-1.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.195, Neg=0.201, Ratio=1.03x, Gap=-1.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.207, Neg=0.215, Ratio=1.03x, Gap=-1.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.212, Neg=0.220, Ratio=1.04x, Gap=-1.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.220, Neg=0.230, Ratio=1.05x, Gap=-1.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.233, Neg=0.243, Ratio=1.04x, Gap=-1.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.240, Neg=0.251, Ratio=1.05x, Gap=-1.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.249, Neg=0.262, Ratio=1.05x, Gap=-1.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.265, Neg=0.277, Ratio=1.05x, Gap=-1.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.280, Neg=0.291, Ratio=1.04x, Gap=-1.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.293, Neg=0.308, Ratio=1.05x, Gap=-2.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.309, Neg=0.326, Ratio=1.06x, Gap=-2.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.318, Neg=0.331, Ratio=1.04x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.330, Neg=0.345, Ratio=1.04x, Gap=-2.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.349, Neg=0.369, Ratio=1.06x, Gap=-2.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.362, Neg=0.379, Ratio=1.05x, Gap=-2.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.398, Neg=0.423, Ratio=1.06x, Gap=-2.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.389, Neg=0.415, Ratio=1.07x, Gap=-2.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=0.448, Ratio=1.06x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=0.455, Ratio=1.06x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=0.480, Ratio=1.06x, Gap=-2.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=0.491, Ratio=1.05x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=0.501, Ratio=1.05x, Gap=-3.238
Batch  50/537: Loss=1.9790 (C:1.9790, R:0.0113)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.519, Ratio=1.06x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.537, Ratio=1.07x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.517, Ratio=1.06x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.536, Ratio=1.07x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=0.522, Ratio=1.06x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=0.516, Ratio=1.06x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.530, Ratio=1.08x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.514, Ratio=1.06x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.527, Ratio=1.07x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=0.494, Ratio=1.06x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=0.495, Ratio=1.05x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=0.509, Ratio=1.06x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=0.503, Ratio=1.06x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=0.481, Ratio=1.06x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=0.491, Ratio=1.07x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=0.486, Ratio=1.06x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=0.502, Ratio=1.07x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=0.486, Ratio=1.06x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.508, Ratio=1.06x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.513, Ratio=1.09x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=0.504, Ratio=1.07x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=0.513, Ratio=1.07x, Gap=-2.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.526, Ratio=1.06x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.533, Ratio=1.08x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=0.550, Ratio=1.07x, Gap=-3.741
Batch  75/537: Loss=1.9706 (C:1.9706, R:0.0112)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.540, Ratio=1.06x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=0.541, Ratio=1.08x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=0.540, Ratio=1.07x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.535, Ratio=1.08x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.540, Ratio=1.07x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.536, Ratio=1.07x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=0.542, Ratio=1.08x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=0.528, Ratio=1.07x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.542, Ratio=1.07x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.514, Ratio=1.08x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.538, Ratio=1.07x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.527, Ratio=1.07x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.541, Ratio=1.08x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.524, Ratio=1.08x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.536, Ratio=1.08x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=0.517, Ratio=1.07x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.527, Ratio=1.09x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=0.516, Ratio=1.08x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=0.521, Ratio=1.09x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.534, Ratio=1.09x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=0.525, Ratio=1.08x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.524, Ratio=1.09x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=0.514, Ratio=1.08x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.515, Ratio=1.08x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=0.518, Ratio=1.08x, Gap=-3.520
Batch 100/537: Loss=1.9654 (C:1.9654, R:0.0110)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=0.504, Ratio=1.08x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=0.530, Ratio=1.10x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=0.513, Ratio=1.07x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=0.521, Ratio=1.08x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.520, Ratio=1.07x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.532, Ratio=1.09x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.523, Ratio=1.08x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.525, Ratio=1.08x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=0.528, Ratio=1.10x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=0.505, Ratio=1.07x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.542, Ratio=1.10x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.533, Ratio=1.09x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.535, Ratio=1.08x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=0.542, Ratio=1.10x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=0.543, Ratio=1.11x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.546, Ratio=1.09x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.562, Ratio=1.09x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.559, Ratio=1.09x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.553, Ratio=1.08x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.572, Ratio=1.09x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.563, Ratio=1.09x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.555, Ratio=1.07x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.561, Ratio=1.09x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.558, Ratio=1.09x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.554, Ratio=1.10x, Gap=-3.199
Batch 125/537: Loss=1.9533 (C:1.9533, R:0.0109)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.540, Ratio=1.08x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.545, Ratio=1.08x, Gap=-3.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=0.564, Ratio=1.11x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=0.540, Ratio=1.10x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=0.526, Ratio=1.09x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=0.552, Ratio=1.12x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.549, Ratio=1.09x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=0.550, Ratio=1.10x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=0.555, Ratio=1.08x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.558, Ratio=1.10x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.542, Ratio=1.09x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=0.544, Ratio=1.09x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.575, Ratio=1.10x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=0.565, Ratio=1.10x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=0.565, Ratio=1.12x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=0.549, Ratio=1.11x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=0.558, Ratio=1.10x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=0.581, Ratio=1.11x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=0.550, Ratio=1.11x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.571, Ratio=1.11x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=0.569, Ratio=1.11x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.587, Ratio=1.11x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.597, Ratio=1.11x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.587, Ratio=1.11x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.591, Ratio=1.12x, Gap=-3.770
Batch 150/537: Loss=1.9465 (C:1.9465, R:0.0108)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.591, Ratio=1.11x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.612, Ratio=1.12x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.597, Ratio=1.11x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.576, Ratio=1.10x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.592, Ratio=1.11x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.574, Ratio=1.11x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.580, Ratio=1.12x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=0.552, Ratio=1.10x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=0.565, Ratio=1.12x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=0.566, Ratio=1.13x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=0.546, Ratio=1.12x, Gap=-3.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=0.584, Ratio=1.13x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=0.574, Ratio=1.11x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.594, Ratio=1.13x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.585, Ratio=1.12x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=0.596, Ratio=1.12x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.607, Ratio=1.13x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.609, Ratio=1.13x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.609, Ratio=1.12x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.617, Ratio=1.12x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.624, Ratio=1.13x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.630, Ratio=1.13x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.611, Ratio=1.12x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.615, Ratio=1.13x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.616, Ratio=1.12x, Gap=-3.398
Batch 175/537: Loss=1.9427 (C:1.9427, R:0.0108)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.611, Ratio=1.14x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=0.583, Ratio=1.12x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.603, Ratio=1.12x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=0.584, Ratio=1.13x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.589, Ratio=1.12x, Gap=-3.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=0.577, Ratio=1.13x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=0.588, Ratio=1.14x, Gap=-3.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.585, Ratio=1.12x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.600, Ratio=1.14x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.605, Ratio=1.14x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=0.589, Ratio=1.12x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.624, Ratio=1.13x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.609, Ratio=1.14x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.620, Ratio=1.16x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=0.608, Ratio=1.13x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.617, Ratio=1.15x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=0.598, Ratio=1.13x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.613, Ratio=1.15x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.614, Ratio=1.13x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.605, Ratio=1.14x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.596, Ratio=1.12x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.593, Ratio=1.14x, Gap=-3.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=0.624, Ratio=1.18x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=0.600, Ratio=1.16x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.607, Ratio=1.15x, Gap=-3.561
Batch 200/537: Loss=1.9324 (C:1.9324, R:0.0107)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=0.592, Ratio=1.14x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=0.587, Ratio=1.16x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.610, Ratio=1.14x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.604, Ratio=1.13x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.633, Ratio=1.15x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=0.621, Ratio=1.14x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.637, Ratio=1.17x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.630, Ratio=1.17x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.641, Ratio=1.15x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.666, Ratio=1.16x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.656, Ratio=1.17x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.648, Ratio=1.15x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.650, Ratio=1.15x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.644, Ratio=1.17x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.637, Ratio=1.15x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=0.633, Ratio=1.15x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.644, Ratio=1.15x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.630, Ratio=1.15x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.621, Ratio=1.16x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.638, Ratio=1.15x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=0.620, Ratio=1.14x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.624, Ratio=1.18x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=0.626, Ratio=1.15x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=0.607, Ratio=1.16x, Gap=-3.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.609, Ratio=1.15x, Gap=-3.359
Batch 225/537: Loss=1.9293 (C:1.9293, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.613, Ratio=1.15x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=0.619, Ratio=1.17x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=0.626, Ratio=1.17x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=0.611, Ratio=1.15x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=0.603, Ratio=1.15x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.614, Ratio=1.15x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.659, Ratio=1.16x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.644, Ratio=1.15x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.646, Ratio=1.16x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.648, Ratio=1.15x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.649, Ratio=1.15x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.647, Ratio=1.17x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.665, Ratio=1.17x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.660, Ratio=1.17x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=0.625, Ratio=1.16x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=0.639, Ratio=1.16x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.650, Ratio=1.15x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.632, Ratio=1.15x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.626, Ratio=1.16x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.631, Ratio=1.18x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.618, Ratio=1.14x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=0.623, Ratio=1.17x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.653, Ratio=1.18x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=0.622, Ratio=1.15x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.640, Ratio=1.16x, Gap=-3.719
Batch 250/537: Loss=1.9279 (C:1.9279, R:0.0107)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.641, Ratio=1.17x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.649, Ratio=1.15x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.652, Ratio=1.17x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.661, Ratio=1.15x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.660, Ratio=1.16x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.648, Ratio=1.16x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=0.637, Ratio=1.17x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.647, Ratio=1.16x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.644, Ratio=1.17x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.639, Ratio=1.16x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.639, Ratio=1.15x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.655, Ratio=1.18x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.647, Ratio=1.16x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=0.646, Ratio=1.17x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.645, Ratio=1.16x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.649, Ratio=1.18x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=0.627, Ratio=1.17x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=0.638, Ratio=1.17x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.654, Ratio=1.16x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.660, Ratio=1.17x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.663, Ratio=1.18x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.665, Ratio=1.19x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.661, Ratio=1.16x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.676, Ratio=1.17x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.663, Ratio=1.16x, Gap=-3.440
Batch 275/537: Loss=1.9262 (C:1.9262, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.664, Ratio=1.18x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.653, Ratio=1.18x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.668, Ratio=1.19x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.674, Ratio=1.17x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.649, Ratio=1.17x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.671, Ratio=1.18x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.648, Ratio=1.16x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.669, Ratio=1.20x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.667, Ratio=1.16x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.660, Ratio=1.17x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.665, Ratio=1.19x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.666, Ratio=1.17x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.663, Ratio=1.18x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.672, Ratio=1.18x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.670, Ratio=1.18x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.693, Ratio=1.18x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.683, Ratio=1.18x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.671, Ratio=1.18x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.688, Ratio=1.16x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.647, Ratio=1.17x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.657, Ratio=1.18x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.666, Ratio=1.21x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=0.645, Ratio=1.18x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.654, Ratio=1.18x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-3.696
Batch 300/537: Loss=1.9141 (C:1.9141, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.669, Ratio=1.19x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.660, Ratio=1.17x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.662, Ratio=1.18x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.680, Ratio=1.19x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.682, Ratio=1.18x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.678, Ratio=1.19x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.676, Ratio=1.17x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.674, Ratio=1.18x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.685, Ratio=1.18x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.687, Ratio=1.18x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.678, Ratio=1.19x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.668, Ratio=1.17x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.688, Ratio=1.19x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.661, Ratio=1.18x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.672, Ratio=1.18x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.652, Ratio=1.18x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.655, Ratio=1.17x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=0.639, Ratio=1.19x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.684, Ratio=1.20x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.654, Ratio=1.18x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.675, Ratio=1.18x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.685, Ratio=1.17x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.669, Ratio=1.19x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.664, Ratio=1.18x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.667, Ratio=1.17x, Gap=-3.417
Batch 325/537: Loss=1.9241 (C:1.9241, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.699, Ratio=1.20x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.673, Ratio=1.20x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.689, Ratio=1.19x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.698, Ratio=1.19x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.704, Ratio=1.17x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.712, Ratio=1.19x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.712, Ratio=1.17x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.722, Ratio=1.19x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.673, Ratio=1.15x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.701, Ratio=1.18x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.689, Ratio=1.19x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.675, Ratio=1.21x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.665, Ratio=1.18x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.678, Ratio=1.20x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.657, Ratio=1.20x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=0.657, Ratio=1.22x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=0.660, Ratio=1.20x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=0.657, Ratio=1.21x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=0.651, Ratio=1.18x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.665, Ratio=1.18x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=0.657, Ratio=1.18x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.682, Ratio=1.19x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.695, Ratio=1.18x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.691, Ratio=1.20x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.683, Ratio=1.19x, Gap=-3.565
Batch 350/537: Loss=1.9116 (C:1.9116, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.699, Ratio=1.21x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.687, Ratio=1.17x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.679, Ratio=1.18x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.678, Ratio=1.19x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.691, Ratio=1.20x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.683, Ratio=1.21x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.689, Ratio=1.19x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.693, Ratio=1.19x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.679, Ratio=1.21x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.679, Ratio=1.18x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.669, Ratio=1.19x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.676, Ratio=1.18x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.699, Ratio=1.19x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.689, Ratio=1.21x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.691, Ratio=1.20x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.673, Ratio=1.21x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.678, Ratio=1.19x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.681, Ratio=1.20x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.686, Ratio=1.20x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.681, Ratio=1.20x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.686, Ratio=1.19x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.672, Ratio=1.20x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.678, Ratio=1.18x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.687, Ratio=1.20x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.687, Ratio=1.19x, Gap=-3.827
Batch 375/537: Loss=1.9125 (C:1.9125, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.690, Ratio=1.19x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.684, Ratio=1.18x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.686, Ratio=1.19x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.687, Ratio=1.19x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.694, Ratio=1.21x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.683, Ratio=1.18x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.684, Ratio=1.21x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.680, Ratio=1.20x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.683, Ratio=1.18x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.677, Ratio=1.21x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.683, Ratio=1.19x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.699, Ratio=1.20x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.670, Ratio=1.18x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.688, Ratio=1.20x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.684, Ratio=1.19x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.690, Ratio=1.22x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.681, Ratio=1.22x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.702, Ratio=1.20x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.698, Ratio=1.21x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.694, Ratio=1.17x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.690, Ratio=1.19x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.716, Ratio=1.21x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.713, Ratio=1.20x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.704, Ratio=1.17x, Gap=-3.759
Batch 400/537: Loss=1.9189 (C:1.9189, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.714, Ratio=1.22x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.725, Ratio=1.21x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.701, Ratio=1.20x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.708, Ratio=1.18x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.719, Ratio=1.22x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.716, Ratio=1.20x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.694, Ratio=1.18x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.704, Ratio=1.21x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.698, Ratio=1.21x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.697, Ratio=1.21x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.686, Ratio=1.20x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.693, Ratio=1.20x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.692, Ratio=1.19x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.681, Ratio=1.18x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.698, Ratio=1.21x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.685, Ratio=1.20x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.709, Ratio=1.19x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.701, Ratio=1.21x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.716, Ratio=1.20x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.720, Ratio=1.18x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.712, Ratio=1.17x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.710, Ratio=1.19x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.715, Ratio=1.19x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.693, Ratio=1.19x, Gap=-3.664
Batch 425/537: Loss=1.9120 (C:1.9120, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.719, Ratio=1.20x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.708, Ratio=1.22x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.695, Ratio=1.19x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.681, Ratio=1.19x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.685, Ratio=1.23x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.681, Ratio=1.20x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=0.659, Ratio=1.22x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.688, Ratio=1.21x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.671, Ratio=1.20x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.677, Ratio=1.20x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.688, Ratio=1.19x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.713, Ratio=1.20x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.719, Ratio=1.21x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.742, Ratio=1.22x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.732, Ratio=1.20x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.729, Ratio=1.20x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.731, Ratio=1.20x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.723, Ratio=1.18x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.737, Ratio=1.18x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.742, Ratio=1.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.714, Ratio=1.21x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.692, Ratio=1.20x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.697, Ratio=1.22x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.683, Ratio=1.20x, Gap=-3.304
Batch 450/537: Loss=1.9040 (C:1.9040, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.684, Ratio=1.22x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.675, Ratio=1.21x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=0.676, Ratio=1.22x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.695, Ratio=1.21x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.675, Ratio=1.21x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.679, Ratio=1.20x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.695, Ratio=1.22x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.683, Ratio=1.20x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.698, Ratio=1.21x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.681, Ratio=1.17x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.691, Ratio=1.19x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.685, Ratio=1.22x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.697, Ratio=1.20x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.695, Ratio=1.21x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.713, Ratio=1.19x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.712, Ratio=1.20x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.721, Ratio=1.23x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.716, Ratio=1.21x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.720, Ratio=1.21x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.696, Ratio=1.20x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.722, Ratio=1.21x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.717, Ratio=1.21x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.701, Ratio=1.22x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.671, Ratio=1.19x, Gap=-3.741
Batch 475/537: Loss=1.9135 (C:1.9135, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.698, Ratio=1.23x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.711, Ratio=1.22x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.682, Ratio=1.20x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.686, Ratio=1.20x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.701, Ratio=1.19x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.682, Ratio=1.22x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.701, Ratio=1.21x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.697, Ratio=1.22x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.680, Ratio=1.20x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.686, Ratio=1.19x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.689, Ratio=1.21x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.686, Ratio=1.20x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.688, Ratio=1.20x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.692, Ratio=1.21x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.689, Ratio=1.19x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.709, Ratio=1.21x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.704, Ratio=1.20x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.709, Ratio=1.21x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.710, Ratio=1.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.690, Ratio=1.20x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.712, Ratio=1.19x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.702, Ratio=1.20x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.717, Ratio=1.21x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.719, Ratio=1.21x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.727, Ratio=1.24x, Gap=-3.409
Batch 500/537: Loss=1.8881 (C:1.8881, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.714, Ratio=1.21x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.723, Ratio=1.19x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.716, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.739, Ratio=1.21x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.723, Ratio=1.21x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.704, Ratio=1.20x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.697, Ratio=1.22x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.695, Ratio=1.21x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.685, Ratio=1.21x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.679, Ratio=1.21x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.681, Ratio=1.22x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.685, Ratio=1.22x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.681, Ratio=1.21x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.679, Ratio=1.21x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.683, Ratio=1.20x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.684, Ratio=1.21x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.714, Ratio=1.22x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.709, Ratio=1.19x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.710, Ratio=1.21x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.750, Ratio=1.24x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.729, Ratio=1.21x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.728, Ratio=1.20x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.751, Ratio=1.23x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.736, Ratio=1.21x, Gap=-3.799
Batch 525/537: Loss=1.9024 (C:1.9024, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.733, Ratio=1.22x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.736, Ratio=1.23x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.730, Ratio=1.20x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.726, Ratio=1.22x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.703, Ratio=1.20x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.711, Ratio=1.23x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.704, Ratio=1.20x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.688, Ratio=1.23x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.692, Ratio=1.19x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.720, Ratio=1.22x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.709, Ratio=1.21x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.22x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.24x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.720, Ratio=1.25x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.719, Ratio=1.25x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.727, Ratio=1.23x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.736, Ratio=1.26x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.700, Ratio=1.22x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.718, Ratio=1.24x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.715, Ratio=1.25x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.712, Ratio=1.24x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.716, Ratio=1.25x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.727, Ratio=1.27x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.718, Ratio=1.21x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.714, Ratio=1.24x, Gap=-3.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.709, Ratio=1.20x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.706, Ratio=1.22x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.720, Ratio=1.23x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.715, Ratio=1.24x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.712, Ratio=1.22x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.717, Ratio=1.23x, Gap=-2.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.707, Ratio=1.23x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.711, Ratio=1.21x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.714, Ratio=1.24x, Gap=-3.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.706, Ratio=1.23x, Gap=-3.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.734, Ratio=1.24x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.700, Ratio=1.22x, Gap=-3.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.732, Ratio=1.24x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.730, Ratio=1.28x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.715, Ratio=1.24x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.709, Ratio=1.23x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.728, Ratio=1.22x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.697, Ratio=1.24x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.712, Ratio=1.23x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.711, Ratio=1.22x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.716, Ratio=1.24x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.706, Ratio=1.26x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.711, Ratio=1.25x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.709, Ratio=1.23x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.712, Ratio=1.24x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.706, Ratio=1.24x, Gap=-3.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.708, Ratio=1.22x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.718, Ratio=1.25x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.699, Ratio=1.23x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.719, Ratio=1.24x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.719, Ratio=1.23x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.710, Ratio=1.25x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.730, Ratio=1.22x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.712, Ratio=1.24x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.696, Ratio=1.25x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.707, Ratio=1.21x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.715, Ratio=1.24x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.711, Ratio=1.22x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.732, Ratio=1.25x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.720, Ratio=1.26x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.717, Ratio=1.23x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.708, Ratio=1.21x, Gap=-3.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.724, Ratio=1.23x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.716, Ratio=1.24x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.712, Ratio=1.21x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.711, Ratio=1.24x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.698, Ratio=1.22x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.699, Ratio=1.22x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.718, Ratio=1.23x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.706, Ratio=1.22x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.714, Ratio=1.24x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.720, Ratio=1.23x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.704, Ratio=1.22x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.717, Ratio=1.25x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.719, Ratio=1.24x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.719, Ratio=1.25x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.721, Ratio=1.24x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.715, Ratio=1.25x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.710, Ratio=1.25x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.708, Ratio=1.22x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.701, Ratio=1.22x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.722, Ratio=1.23x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.715, Ratio=1.21x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.727, Ratio=1.24x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.711, Ratio=1.23x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.709, Ratio=1.22x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.699, Ratio=1.22x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.704, Ratio=1.22x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.713, Ratio=1.26x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.717, Ratio=1.23x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.715, Ratio=1.23x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.701, Ratio=1.21x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.711, Ratio=1.24x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.701, Ratio=1.24x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.704, Ratio=1.21x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.712, Ratio=1.24x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.724, Ratio=1.25x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.709, Ratio=1.24x, Gap=-3.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.726, Ratio=1.24x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.708, Ratio=1.22x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.707, Ratio=1.22x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.704, Ratio=1.24x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.702, Ratio=1.22x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.715, Ratio=1.23x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.699, Ratio=1.23x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.720, Ratio=1.22x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.695, Ratio=1.23x, Gap=-3.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.712, Ratio=1.23x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.715, Ratio=1.24x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.718, Ratio=1.22x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.691, Ratio=1.21x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.741, Ratio=1.27x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.718, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.723, Ratio=1.24x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.706, Ratio=1.25x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.708, Ratio=1.22x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.705, Ratio=1.24x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.706, Ratio=1.22x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.712, Ratio=1.24x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.721, Ratio=1.25x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.692, Ratio=1.21x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.712, Ratio=1.23x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.702, Ratio=1.23x, Gap=-3.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.706, Ratio=1.26x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.705, Ratio=1.24x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.729, Ratio=1.25x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.714, Ratio=1.25x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.710, Ratio=1.22x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.711, Ratio=1.21x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.708, Ratio=1.23x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.737, Ratio=1.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.698, Ratio=1.23x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.704, Ratio=1.24x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.704, Ratio=1.22x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.691, Ratio=1.20x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.704, Ratio=1.23x, Gap=-3.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.708, Ratio=1.21x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.719, Ratio=1.24x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.723, Ratio=1.24x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.716, Ratio=1.24x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.720, Ratio=1.25x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.684, Ratio=1.22x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.704, Ratio=1.23x, Gap=-3.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.724, Ratio=1.25x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.694, Ratio=1.22x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.721, Ratio=1.24x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.697, Ratio=1.24x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.709, Ratio=1.24x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.706, Ratio=1.23x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.709, Ratio=1.22x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.711, Ratio=1.24x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.709, Ratio=1.24x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.703, Ratio=1.24x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.710, Ratio=1.22x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.721, Ratio=1.24x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.705, Ratio=1.21x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.714, Ratio=1.25x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.702, Ratio=1.21x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.711, Ratio=1.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.722, Ratio=1.24x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.715, Ratio=1.21x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.723, Ratio=1.23x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.710, Ratio=1.23x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.718, Ratio=1.24x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=0.697, Ratio=1.24x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.719, Ratio=1.23x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.718, Ratio=1.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.721, Ratio=1.21x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.718, Ratio=1.23x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.720, Ratio=1.22x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.722, Ratio=1.22x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.694, Ratio=1.23x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.707, Ratio=1.23x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.726, Ratio=1.25x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.695, Ratio=1.20x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.704, Ratio=1.25x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.714, Ratio=1.24x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.731, Ratio=1.23x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.22x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.711, Ratio=1.21x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.718, Ratio=1.22x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.721, Ratio=1.23x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.721, Ratio=1.24x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.730, Ratio=1.26x, Gap=-3.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.729, Ratio=1.24x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.718, Ratio=1.23x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.712, Ratio=1.22x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.710, Ratio=1.24x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.708, Ratio=1.24x, Gap=-3.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.705, Ratio=1.23x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.707, Ratio=1.21x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.710, Ratio=1.21x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.719, Ratio=1.24x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.718, Ratio=1.25x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.21x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.715, Ratio=1.25x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.705, Ratio=1.22x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.712, Ratio=1.23x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.718, Ratio=1.23x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.709, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.703, Ratio=1.24x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.704, Ratio=1.22x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.721, Ratio=1.27x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.724, Ratio=1.24x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.711, Ratio=1.25x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.713, Ratio=1.23x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.706, Ratio=1.21x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.709, Ratio=1.24x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.704, Ratio=1.23x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.704, Ratio=1.22x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.718, Ratio=1.24x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.714, Ratio=1.22x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.699, Ratio=1.24x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.690, Ratio=1.24x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.725, Ratio=1.23x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.707, Ratio=1.24x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.723, Ratio=1.23x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.717, Ratio=1.22x, Gap=-3.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.709, Ratio=1.22x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.717, Ratio=1.22x, Gap=-3.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.719, Ratio=1.24x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.698, Ratio=1.22x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.709, Ratio=1.21x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.707, Ratio=1.23x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.702, Ratio=1.24x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.709, Ratio=1.25x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.707, Ratio=1.24x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.702, Ratio=1.23x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.705, Ratio=1.25x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.703, Ratio=1.22x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.693, Ratio=1.20x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.718, Ratio=1.24x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.721, Ratio=1.21x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.702, Ratio=1.22x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.27x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.722, Ratio=1.22x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.728, Ratio=1.25x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.715, Ratio=1.26x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.701, Ratio=1.23x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.694, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=0.683, Ratio=1.24x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.716, Ratio=1.23x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.720, Ratio=1.24x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.712, Ratio=1.24x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.704, Ratio=1.24x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.721, Ratio=1.26x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.720, Ratio=1.24x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.721, Ratio=1.22x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.713, Ratio=1.24x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.718, Ratio=1.24x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.701, Ratio=1.21x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.702, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.697, Ratio=1.23x, Gap=-3.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.735, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.712, Ratio=1.21x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.702, Ratio=1.23x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.715, Ratio=1.23x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.708, Ratio=1.23x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.715, Ratio=1.23x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.725, Ratio=1.24x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.707, Ratio=1.24x, Gap=-3.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.714, Ratio=1.23x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.722, Ratio=1.25x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.707, Ratio=1.24x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.712, Ratio=1.24x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.710, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=0.692, Ratio=1.23x, Gap=-3.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.722, Ratio=1.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.717, Ratio=1.25x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.713, Ratio=1.21x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.708, Ratio=1.23x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.732, Ratio=1.24x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.707, Ratio=1.21x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.712, Ratio=1.24x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.725, Ratio=1.22x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.702, Ratio=1.24x, Gap=-3.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.722, Ratio=1.23x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.718, Ratio=1.24x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.718, Ratio=1.23x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.714, Ratio=1.23x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.691, Ratio=1.21x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.707, Ratio=1.24x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.727, Ratio=1.25x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.717, Ratio=1.23x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.698, Ratio=1.22x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.705, Ratio=1.22x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.719, Ratio=1.25x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.712, Ratio=1.25x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.722, Ratio=1.23x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.722, Ratio=1.22x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.726, Ratio=1.24x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.717, Ratio=1.24x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.717, Ratio=1.24x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.717, Ratio=1.23x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.708, Ratio=1.22x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.732, Ratio=1.26x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=0.693, Ratio=1.24x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.711, Ratio=1.26x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.702, Ratio=1.23x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.711, Ratio=1.21x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.701, Ratio=1.20x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.721, Ratio=1.23x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.717, Ratio=1.25x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.721, Ratio=1.24x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.703, Ratio=1.23x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.713, Ratio=1.24x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.728, Ratio=1.27x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.728, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.22x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.713, Ratio=1.24x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.715, Ratio=1.24x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.717, Ratio=1.25x, Gap=-3.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.713, Ratio=1.23x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.724, Ratio=1.23x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.710, Ratio=1.22x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.715, Ratio=1.22x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.704, Ratio=1.23x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.702, Ratio=1.22x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.723, Ratio=1.25x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=0.693, Ratio=1.25x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=0.720, Ratio=1.28x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.706, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.725, Ratio=1.25x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.719, Ratio=1.24x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.728, Ratio=1.23x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.712, Ratio=1.22x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.717, Ratio=1.24x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.710, Ratio=1.25x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.713, Ratio=1.23x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=0.697, Ratio=1.25x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.717, Ratio=1.23x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.726, Ratio=1.22x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.718, Ratio=1.25x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.710, Ratio=1.25x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.726, Ratio=1.23x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.700, Ratio=1.23x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.698, Ratio=1.23x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.718, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.709, Ratio=1.25x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.703, Ratio=1.22x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.710, Ratio=1.22x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.693, Ratio=1.20x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.712, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.708, Ratio=1.22x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.724, Ratio=1.25x, Gap=-3.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.708, Ratio=1.22x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.708, Ratio=1.25x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.717, Ratio=1.24x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.706, Ratio=1.24x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.713, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.715, Ratio=1.25x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.714, Ratio=1.22x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.704, Ratio=1.22x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.704, Ratio=1.22x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.702, Ratio=1.23x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.712, Ratio=1.25x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.719, Ratio=1.24x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.715, Ratio=1.23x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.730, Ratio=1.25x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.703, Ratio=1.23x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.707, Ratio=1.23x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.715, Ratio=1.23x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.708, Ratio=1.23x, Gap=-3.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.725, Ratio=1.25x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.717, Ratio=1.25x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.717, Ratio=1.21x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.705, Ratio=1.24x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.700, Ratio=1.21x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.704, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.725, Ratio=1.26x, Gap=-3.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.713, Ratio=1.22x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.727, Ratio=1.26x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.708, Ratio=1.23x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.714, Ratio=1.22x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.709, Ratio=1.24x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.721, Ratio=1.25x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.702, Ratio=1.22x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.709, Ratio=1.23x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.700, Ratio=1.22x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.717, Ratio=1.26x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.714, Ratio=1.24x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.709, Ratio=1.21x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.697, Ratio=1.21x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.709, Ratio=1.21x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.716, Ratio=1.25x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.703, Ratio=1.23x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.726, Ratio=1.24x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.715, Ratio=1.24x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.708, Ratio=1.22x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.731, Ratio=1.25x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.714, Ratio=1.23x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.721, Ratio=1.23x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.721, Ratio=1.24x, Gap=-3.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.716, Ratio=1.24x, Gap=-3.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.705, Ratio=1.23x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.704, Ratio=1.24x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.707, Ratio=1.23x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.711, Ratio=1.25x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.705, Ratio=1.23x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.693, Ratio=1.22x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.714, Ratio=1.23x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.713, Ratio=1.23x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.709, Ratio=1.22x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.722, Ratio=1.23x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.707, Ratio=1.23x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.718, Ratio=1.23x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.704, Ratio=1.22x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.708, Ratio=1.22x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.708, Ratio=1.22x, Gap=-3.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.708, Ratio=1.23x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.711, Ratio=1.23x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.703, Ratio=1.24x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.705, Ratio=1.20x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.715, Ratio=1.26x, Gap=-2.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.701, Ratio=1.23x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.717, Ratio=1.23x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.704, Ratio=1.22x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=0.699, Ratio=1.24x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.729, Ratio=1.25x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.722, Ratio=1.25x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.711, Ratio=1.22x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.716, Ratio=1.24x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.716, Ratio=1.23x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.728, Ratio=1.25x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.706, Ratio=1.24x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.718, Ratio=1.26x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.725, Ratio=1.23x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.710, Ratio=1.21x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.696, Ratio=1.22x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.716, Ratio=1.24x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.712, Ratio=1.22x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.722, Ratio=1.25x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.696, Ratio=1.20x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.706, Ratio=1.23x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.707, Ratio=1.25x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.729, Ratio=1.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.712, Ratio=1.22x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.706, Ratio=1.24x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.712, Ratio=1.22x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.721, Ratio=1.24x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.720, Ratio=1.25x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.733, Ratio=1.26x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.711, Ratio=1.22x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.707, Ratio=1.23x, Gap=-3.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.699, Ratio=1.19x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.707, Ratio=1.25x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.725, Ratio=1.23x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.704, Ratio=1.23x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.724, Ratio=1.24x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.712, Ratio=1.23x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.702, Ratio=1.22x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.725, Ratio=1.24x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.717, Ratio=1.23x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.715, Ratio=1.22x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.733, Ratio=1.24x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.705, Ratio=1.22x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.712, Ratio=1.23x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.716, Ratio=1.25x, Gap=-3.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.739, Ratio=1.25x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.718, Ratio=1.25x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.712, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.709, Ratio=1.22x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=0.705, Ratio=1.24x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.723, Ratio=1.23x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.710, Ratio=1.23x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.720, Ratio=1.23x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=0.705, Ratio=1.25x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.706, Ratio=1.24x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.704, Ratio=1.25x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.725, Ratio=1.24x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.715, Ratio=1.23x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.724, Ratio=1.25x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.714, Ratio=1.23x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.716, Ratio=1.24x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.713, Ratio=1.21x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.715, Ratio=1.22x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.725, Ratio=1.26x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.711, Ratio=1.22x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.712, Ratio=1.23x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.718, Ratio=1.25x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.715, Ratio=1.23x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.722, Ratio=1.24x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.714, Ratio=1.25x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.704, Ratio=1.22x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=0.696, Ratio=1.23x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.708, Ratio=1.25x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.729, Ratio=1.27x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.704, Ratio=1.21x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.710, Ratio=1.25x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=0.699, Ratio=1.23x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.723, Ratio=1.24x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.706, Ratio=1.23x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.714, Ratio=1.24x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.713, Ratio=1.24x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.706, Ratio=1.23x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.701, Ratio=1.22x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.732, Ratio=1.26x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.718, Ratio=1.25x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=0.707, Ratio=1.25x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.697, Ratio=1.22x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.717, Ratio=1.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.713, Ratio=1.23x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.718, Ratio=1.25x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=0.698, Ratio=1.22x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=0.685, Ratio=1.19x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.728, Ratio=1.24x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.720, Ratio=1.25x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.712, Ratio=1.24x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.718, Ratio=1.24x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.713, Ratio=1.22x, Gap=-3.385

============================================================
Epoch 1/20 completed in 38.1s
Train: Loss=1.9315 (C:1.9315, R:0.0108) Ratio=1.62x
Val:   Loss=1.8880 (C:1.8880, R:0.0105) Ratio=2.19x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.8880)
============================================================

Epoch 2 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.704, Ratio=1.21x, Gap=-3.207
Batch   0/537: Loss=1.8994 (C:1.8994, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.724, Ratio=1.23x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.730, Ratio=1.23x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.731, Ratio=1.21x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.725, Ratio=1.22x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.735, Ratio=1.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.730, Ratio=1.21x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.750, Ratio=1.23x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.736, Ratio=1.20x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.729, Ratio=1.23x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.718, Ratio=1.22x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.713, Ratio=1.23x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.734, Ratio=1.25x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.731, Ratio=1.21x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.723, Ratio=1.21x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.739, Ratio=1.21x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.716, Ratio=1.22x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.727, Ratio=1.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.715, Ratio=1.22x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.707, Ratio=1.22x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.729, Ratio=1.23x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.732, Ratio=1.24x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.730, Ratio=1.21x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.727, Ratio=1.23x, Gap=-3.578
Batch  25/537: Loss=1.8896 (C:1.8896, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.729, Ratio=1.21x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.729, Ratio=1.22x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.732, Ratio=1.23x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.721, Ratio=1.22x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.738, Ratio=1.22x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.719, Ratio=1.21x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.726, Ratio=1.22x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.714, Ratio=1.23x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.718, Ratio=1.23x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.742, Ratio=1.23x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.736, Ratio=1.23x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.747, Ratio=1.23x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.737, Ratio=1.24x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.721, Ratio=1.22x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.717, Ratio=1.21x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.734, Ratio=1.22x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.740, Ratio=1.22x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.730, Ratio=1.22x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.727, Ratio=1.22x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.744, Ratio=1.21x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.737, Ratio=1.22x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.729, Ratio=1.21x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.719, Ratio=1.22x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.704, Ratio=1.22x, Gap=-3.501
Batch  50/537: Loss=1.8973 (C:1.8973, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.720, Ratio=1.20x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.721, Ratio=1.21x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.725, Ratio=1.23x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.719, Ratio=1.22x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.718, Ratio=1.22x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.697, Ratio=1.22x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.724, Ratio=1.23x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.739, Ratio=1.21x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.730, Ratio=1.22x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.728, Ratio=1.23x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.742, Ratio=1.23x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.722, Ratio=1.22x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.708, Ratio=1.21x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.735, Ratio=1.25x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.735, Ratio=1.22x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.722, Ratio=1.20x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.733, Ratio=1.22x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.709, Ratio=1.23x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.714, Ratio=1.23x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.736, Ratio=1.25x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.703, Ratio=1.22x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.732, Ratio=1.22x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.722, Ratio=1.22x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.719, Ratio=1.20x, Gap=-3.558
Batch  75/537: Loss=1.9059 (C:1.9059, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.748, Ratio=1.21x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.748, Ratio=1.21x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.731, Ratio=1.22x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.757, Ratio=1.22x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.745, Ratio=1.22x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.742, Ratio=1.22x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.741, Ratio=1.22x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.739, Ratio=1.22x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.724, Ratio=1.22x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.730, Ratio=1.22x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=0.710, Ratio=1.24x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.719, Ratio=1.22x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=0.693, Ratio=1.21x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.697, Ratio=1.22x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.711, Ratio=1.23x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.707, Ratio=1.23x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.723, Ratio=1.22x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.706, Ratio=1.23x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.728, Ratio=1.23x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.726, Ratio=1.22x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.734, Ratio=1.23x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.741, Ratio=1.23x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.735, Ratio=1.24x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.767, Ratio=1.22x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.743, Ratio=1.22x, Gap=-3.610
Batch 100/537: Loss=1.8969 (C:1.8969, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.762, Ratio=1.22x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.746, Ratio=1.22x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.736, Ratio=1.21x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.733, Ratio=1.24x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.727, Ratio=1.23x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.727, Ratio=1.21x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.722, Ratio=1.20x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.708, Ratio=1.21x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.734, Ratio=1.23x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.722, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=0.707, Ratio=1.24x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.736, Ratio=1.24x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.737, Ratio=1.24x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.744, Ratio=1.23x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.756, Ratio=1.22x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.746, Ratio=1.23x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.749, Ratio=1.22x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.735, Ratio=1.23x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.756, Ratio=1.24x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.748, Ratio=1.22x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.752, Ratio=1.23x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.739, Ratio=1.22x, Gap=-3.594
Batch 125/537: Loss=1.8939 (C:1.8939, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.725, Ratio=1.21x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.741, Ratio=1.21x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.738, Ratio=1.24x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.722, Ratio=1.22x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=0.709, Ratio=1.23x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.743, Ratio=1.25x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.727, Ratio=1.23x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.715, Ratio=1.21x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.705, Ratio=1.20x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.737, Ratio=1.24x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.729, Ratio=1.24x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.731, Ratio=1.21x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.740, Ratio=1.24x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.729, Ratio=1.22x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.748, Ratio=1.24x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.735, Ratio=1.21x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.741, Ratio=1.22x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.748, Ratio=1.24x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.739, Ratio=1.24x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.746, Ratio=1.23x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.738, Ratio=1.22x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.745, Ratio=1.22x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.733, Ratio=1.23x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.742, Ratio=1.24x, Gap=-3.722
Batch 150/537: Loss=1.8826 (C:1.8826, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.736, Ratio=1.23x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.732, Ratio=1.22x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.735, Ratio=1.22x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.733, Ratio=1.23x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.731, Ratio=1.23x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.730, Ratio=1.22x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.714, Ratio=1.22x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.733, Ratio=1.25x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.730, Ratio=1.22x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.725, Ratio=1.24x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.727, Ratio=1.23x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.735, Ratio=1.23x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.726, Ratio=1.24x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.731, Ratio=1.23x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.733, Ratio=1.25x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.722, Ratio=1.21x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.742, Ratio=1.22x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.720, Ratio=1.22x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.757, Ratio=1.24x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.754, Ratio=1.24x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.756, Ratio=1.23x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.732, Ratio=1.23x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.777, Ratio=1.25x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.752, Ratio=1.21x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.734, Ratio=1.23x, Gap=-3.563
Batch 175/537: Loss=1.8921 (C:1.8921, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.750, Ratio=1.22x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.744, Ratio=1.23x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.747, Ratio=1.24x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.754, Ratio=1.22x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.736, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.754, Ratio=1.23x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.735, Ratio=1.23x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.733, Ratio=1.22x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.745, Ratio=1.24x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.725, Ratio=1.22x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.735, Ratio=1.22x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.737, Ratio=1.23x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.747, Ratio=1.22x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.738, Ratio=1.23x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.753, Ratio=1.23x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.737, Ratio=1.24x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.730, Ratio=1.22x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.721, Ratio=1.22x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.746, Ratio=1.26x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.739, Ratio=1.22x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.732, Ratio=1.21x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.736, Ratio=1.23x, Gap=-3.297
Batch 200/537: Loss=1.8888 (C:1.8888, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.720, Ratio=1.21x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.713, Ratio=1.23x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.722, Ratio=1.23x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.729, Ratio=1.24x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.726, Ratio=1.21x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.715, Ratio=1.23x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.730, Ratio=1.23x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.729, Ratio=1.21x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.740, Ratio=1.22x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.738, Ratio=1.22x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.733, Ratio=1.22x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.748, Ratio=1.24x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.736, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.754, Ratio=1.22x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.755, Ratio=1.22x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.750, Ratio=1.22x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.745, Ratio=1.23x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.750, Ratio=1.24x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.717, Ratio=1.23x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.722, Ratio=1.23x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.728, Ratio=1.24x, Gap=-3.908
Batch 225/537: Loss=1.8849 (C:1.8849, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.734, Ratio=1.22x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.742, Ratio=1.27x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.716, Ratio=1.23x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.727, Ratio=1.22x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.742, Ratio=1.26x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.727, Ratio=1.24x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.728, Ratio=1.24x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.736, Ratio=1.22x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.727, Ratio=1.22x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.753, Ratio=1.23x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.752, Ratio=1.24x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.770, Ratio=1.24x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.729, Ratio=1.22x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.739, Ratio=1.27x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.748, Ratio=1.23x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.766, Ratio=1.24x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.781, Ratio=1.24x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.749, Ratio=1.22x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.735, Ratio=1.20x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.756, Ratio=1.23x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.577
Batch 250/537: Loss=1.8898 (C:1.8898, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.745, Ratio=1.25x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.726, Ratio=1.23x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.722, Ratio=1.22x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.740, Ratio=1.22x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.747, Ratio=1.24x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.752, Ratio=1.25x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.737, Ratio=1.22x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.752, Ratio=1.25x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.730, Ratio=1.26x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=0.701, Ratio=1.24x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.720, Ratio=1.25x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.724, Ratio=1.23x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.743, Ratio=1.25x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.741, Ratio=1.20x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.762, Ratio=1.23x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.761, Ratio=1.23x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.740, Ratio=1.23x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.766, Ratio=1.27x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.741, Ratio=1.22x, Gap=-3.532
Batch 275/537: Loss=1.8965 (C:1.8965, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.748, Ratio=1.23x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.759, Ratio=1.23x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.758, Ratio=1.22x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.746, Ratio=1.23x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.731, Ratio=1.24x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.743, Ratio=1.21x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.748, Ratio=1.25x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.727, Ratio=1.24x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.745, Ratio=1.23x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.717, Ratio=1.21x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.723, Ratio=1.23x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.721, Ratio=1.24x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.727, Ratio=1.23x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.718, Ratio=1.24x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.723, Ratio=1.23x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.733, Ratio=1.25x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.722, Ratio=1.23x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.733, Ratio=1.26x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=0.718, Ratio=1.24x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.745, Ratio=1.25x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.746, Ratio=1.23x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.738, Ratio=1.25x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.751, Ratio=1.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.756, Ratio=1.21x, Gap=-3.753
Batch 300/537: Loss=1.8990 (C:1.8990, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.751, Ratio=1.22x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.765, Ratio=1.26x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.762, Ratio=1.24x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.750, Ratio=1.22x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.737, Ratio=1.22x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.741, Ratio=1.23x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.726, Ratio=1.24x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.749, Ratio=1.24x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.745, Ratio=1.23x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.741, Ratio=1.23x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.742, Ratio=1.23x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.758, Ratio=1.25x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.754, Ratio=1.22x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.746, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.742, Ratio=1.21x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.763, Ratio=1.22x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.771, Ratio=1.22x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.720, Ratio=1.23x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.760, Ratio=1.24x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.754, Ratio=1.25x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.733, Ratio=1.23x, Gap=-3.829
Batch 325/537: Loss=1.8907 (C:1.8907, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.745, Ratio=1.24x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.730, Ratio=1.22x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.746, Ratio=1.26x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.755, Ratio=1.23x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.730, Ratio=1.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.727, Ratio=1.23x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.717, Ratio=1.21x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.733, Ratio=1.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.722, Ratio=1.25x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.705, Ratio=1.21x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.742, Ratio=1.26x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.745, Ratio=1.22x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.733, Ratio=1.23x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=0.709, Ratio=1.24x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.737, Ratio=1.24x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.731, Ratio=1.22x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.724, Ratio=1.22x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.725, Ratio=1.20x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.720, Ratio=1.23x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.741, Ratio=1.24x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.742, Ratio=1.22x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.743, Ratio=1.22x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.733, Ratio=1.22x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.756, Ratio=1.22x, Gap=-3.845
Batch 350/537: Loss=1.8939 (C:1.8939, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.764, Ratio=1.23x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.775, Ratio=1.24x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.753, Ratio=1.23x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.782, Ratio=1.24x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.780, Ratio=1.26x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.768, Ratio=1.23x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.755, Ratio=1.24x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.772, Ratio=1.25x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.750, Ratio=1.25x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.745, Ratio=1.24x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.735, Ratio=1.22x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.726, Ratio=1.23x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.737, Ratio=1.25x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.730, Ratio=1.24x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.744, Ratio=1.25x, Gap=-3.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.740, Ratio=1.23x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.710, Ratio=1.21x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.738, Ratio=1.21x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.738, Ratio=1.23x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.731, Ratio=1.25x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.733, Ratio=1.26x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.740, Ratio=1.24x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.748, Ratio=1.23x, Gap=-3.871
Batch 375/537: Loss=1.8909 (C:1.8909, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.762, Ratio=1.24x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.732, Ratio=1.24x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.757, Ratio=1.25x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.741, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.742, Ratio=1.25x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.753, Ratio=1.23x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.775, Ratio=1.24x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.767, Ratio=1.24x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.766, Ratio=1.23x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.747, Ratio=1.24x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.747, Ratio=1.25x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.769, Ratio=1.23x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.757, Ratio=1.27x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.748, Ratio=1.24x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.751, Ratio=1.23x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.748, Ratio=1.24x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.749, Ratio=1.25x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.730, Ratio=1.22x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.762, Ratio=1.23x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.743, Ratio=1.23x, Gap=-3.768
Batch 400/537: Loss=1.8907 (C:1.8907, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.740, Ratio=1.23x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.751, Ratio=1.24x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.744, Ratio=1.22x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.741, Ratio=1.25x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.750, Ratio=1.25x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.753, Ratio=1.24x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.742, Ratio=1.24x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.741, Ratio=1.24x, Gap=-3.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.747, Ratio=1.24x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.735, Ratio=1.22x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.766, Ratio=1.25x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.738, Ratio=1.22x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.749, Ratio=1.24x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.750, Ratio=1.25x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.750, Ratio=1.24x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.731, Ratio=1.23x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.732, Ratio=1.22x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.733, Ratio=1.23x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.735, Ratio=1.23x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.724, Ratio=1.22x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.734, Ratio=1.25x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.735, Ratio=1.24x, Gap=-3.414
Batch 425/537: Loss=1.8857 (C:1.8857, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.722, Ratio=1.21x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.741, Ratio=1.26x, Gap=-3.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.731, Ratio=1.23x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.741, Ratio=1.23x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.742, Ratio=1.20x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.762, Ratio=1.25x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.771, Ratio=1.24x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.780, Ratio=1.25x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.750, Ratio=1.21x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.748, Ratio=1.21x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.758, Ratio=1.23x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.745, Ratio=1.23x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.765, Ratio=1.25x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.724, Ratio=1.23x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.716, Ratio=1.23x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.730, Ratio=1.24x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.723, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.726, Ratio=1.23x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.714, Ratio=1.23x, Gap=-3.321
Batch 450/537: Loss=1.8917 (C:1.8917, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.723, Ratio=1.22x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.732, Ratio=1.24x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.740, Ratio=1.24x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.741, Ratio=1.23x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.720, Ratio=1.22x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.753, Ratio=1.24x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.751, Ratio=1.23x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.743, Ratio=1.24x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.771, Ratio=1.24x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.750, Ratio=1.23x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.745, Ratio=1.23x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.754, Ratio=1.23x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.752, Ratio=1.22x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.764, Ratio=1.23x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.747, Ratio=1.23x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.730, Ratio=1.23x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.735, Ratio=1.22x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.746, Ratio=1.22x, Gap=-3.568
Batch 475/537: Loss=1.8967 (C:1.8967, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.728, Ratio=1.22x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.722, Ratio=1.22x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.723, Ratio=1.23x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.731, Ratio=1.23x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.744, Ratio=1.24x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.759, Ratio=1.24x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.736, Ratio=1.24x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.752, Ratio=1.24x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.742, Ratio=1.26x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.758, Ratio=1.26x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.746, Ratio=1.25x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.759, Ratio=1.24x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.734, Ratio=1.26x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.762, Ratio=1.25x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.742, Ratio=1.25x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.740, Ratio=1.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.748, Ratio=1.25x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.733, Ratio=1.24x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.735, Ratio=1.24x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.730, Ratio=1.24x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.736, Ratio=1.24x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.718, Ratio=1.23x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.759, Ratio=1.24x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.460
Batch 500/537: Loss=1.8821 (C:1.8821, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.742, Ratio=1.22x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.725, Ratio=1.23x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.750, Ratio=1.23x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.743, Ratio=1.24x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.737, Ratio=1.23x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.755, Ratio=1.26x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.751, Ratio=1.23x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.735, Ratio=1.25x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.730, Ratio=1.23x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.740, Ratio=1.24x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.752, Ratio=1.24x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.752, Ratio=1.23x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.749, Ratio=1.24x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.770, Ratio=1.25x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.734, Ratio=1.25x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.733, Ratio=1.23x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.738, Ratio=1.23x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.743, Ratio=1.27x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.748, Ratio=1.25x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.754, Ratio=1.24x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.750, Ratio=1.23x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.749, Ratio=1.23x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.756, Ratio=1.25x, Gap=-3.584
Batch 525/537: Loss=1.8794 (C:1.8794, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.758, Ratio=1.23x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.745, Ratio=1.23x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.741, Ratio=1.24x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.748, Ratio=1.24x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.747, Ratio=1.23x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.764, Ratio=1.23x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.758, Ratio=1.24x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.745, Ratio=1.24x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.752, Ratio=1.23x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.757, Ratio=1.28x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.753, Ratio=1.26x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.756, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.752, Ratio=1.25x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.756, Ratio=1.28x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.752, Ratio=1.26x, Gap=-3.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.757, Ratio=1.26x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.752, Ratio=1.24x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.753, Ratio=1.25x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.757, Ratio=1.27x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.744, Ratio=1.27x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.742, Ratio=1.26x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.747, Ratio=1.25x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.763, Ratio=1.30x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.765, Ratio=1.24x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.763, Ratio=1.29x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.763, Ratio=1.25x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.766, Ratio=1.28x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.750, Ratio=1.26x, Gap=-3.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.757, Ratio=1.26x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.744, Ratio=1.25x, Gap=-3.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.758, Ratio=1.27x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.774, Ratio=1.30x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.756, Ratio=1.26x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.755, Ratio=1.24x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.768, Ratio=1.29x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.776, Ratio=1.26x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.756, Ratio=1.28x, Gap=-3.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.778, Ratio=1.31x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.747, Ratio=1.26x, Gap=-3.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.28x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.761, Ratio=1.25x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.768, Ratio=1.27x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.755, Ratio=1.29x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.759, Ratio=1.28x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.761, Ratio=1.25x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.754, Ratio=1.25x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.751, Ratio=1.27x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.756, Ratio=1.26x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.25x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.764, Ratio=1.27x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.761, Ratio=1.28x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.754, Ratio=1.26x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.761, Ratio=1.28x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.748, Ratio=1.29x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.752, Ratio=1.25x, Gap=-3.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.785, Ratio=1.31x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.746, Ratio=1.27x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.765, Ratio=1.28x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.753, Ratio=1.26x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.761, Ratio=1.27x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.756, Ratio=1.28x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.756, Ratio=1.27x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.736, Ratio=1.25x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.773, Ratio=1.26x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.749, Ratio=1.27x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.775, Ratio=1.29x, Gap=-3.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.754, Ratio=1.27x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.749, Ratio=1.27x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.757, Ratio=1.25x, Gap=-3.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.749, Ratio=1.27x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.769, Ratio=1.27x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.750, Ratio=1.27x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.753, Ratio=1.27x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.761, Ratio=1.26x, Gap=-2.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.764, Ratio=1.29x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.752, Ratio=1.27x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.760, Ratio=1.25x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.28x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.761, Ratio=1.29x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.758, Ratio=1.28x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.756, Ratio=1.25x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.758, Ratio=1.26x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.756, Ratio=1.27x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.752, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.752, Ratio=1.26x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.756, Ratio=1.27x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.758, Ratio=1.26x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.743, Ratio=1.25x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.757, Ratio=1.25x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.759, Ratio=1.26x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.772, Ratio=1.28x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.743, Ratio=1.26x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.755, Ratio=1.30x, Gap=-3.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.772, Ratio=1.30x, Gap=-3.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.753, Ratio=1.26x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.774, Ratio=1.27x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.28x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.753, Ratio=1.25x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.746, Ratio=1.28x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.758, Ratio=1.27x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.751, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.771, Ratio=1.28x, Gap=-3.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.764, Ratio=1.25x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.750, Ratio=1.27x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.745, Ratio=1.25x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.761, Ratio=1.29x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.757, Ratio=1.28x, Gap=-3.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.760, Ratio=1.28x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.752, Ratio=1.27x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.753, Ratio=1.25x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.750, Ratio=1.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.776, Ratio=1.27x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.745, Ratio=1.24x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.745, Ratio=1.27x, Gap=-3.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.773, Ratio=1.30x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.761, Ratio=1.28x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.766, Ratio=1.25x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.758, Ratio=1.27x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.769, Ratio=1.27x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.745, Ratio=1.27x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.769, Ratio=1.27x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.751, Ratio=1.25x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.764, Ratio=1.27x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.762, Ratio=1.28x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.746, Ratio=1.26x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.743, Ratio=1.28x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.776, Ratio=1.27x, Gap=-3.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.775, Ratio=1.29x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.764, Ratio=1.29x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.756, Ratio=1.24x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.763, Ratio=1.26x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.767, Ratio=1.31x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.784, Ratio=1.29x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.761, Ratio=1.27x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.738, Ratio=1.24x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.766, Ratio=1.25x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.763, Ratio=1.28x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.767, Ratio=1.28x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.777, Ratio=1.30x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.742, Ratio=1.25x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.768, Ratio=1.27x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.763, Ratio=1.28x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=0.738, Ratio=1.28x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.763, Ratio=1.29x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.757, Ratio=1.27x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.765, Ratio=1.26x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.743, Ratio=1.24x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.749, Ratio=1.26x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.759, Ratio=1.25x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.748, Ratio=1.27x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.765, Ratio=1.29x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.745, Ratio=1.24x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.768, Ratio=1.27x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.765, Ratio=1.29x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.760, Ratio=1.29x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.746, Ratio=1.24x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.753, Ratio=1.26x, Gap=-3.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.770, Ratio=1.29x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.761, Ratio=1.28x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.743, Ratio=1.26x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.771, Ratio=1.30x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.744, Ratio=1.27x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.749, Ratio=1.25x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.767, Ratio=1.28x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.745, Ratio=1.25x, Gap=-3.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.761, Ratio=1.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.775, Ratio=1.29x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.755, Ratio=1.29x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.755, Ratio=1.26x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.756, Ratio=1.28x, Gap=-3.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.744, Ratio=1.26x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.745, Ratio=1.26x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.762, Ratio=1.30x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.754, Ratio=1.26x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.756, Ratio=1.25x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.755, Ratio=1.26x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.755, Ratio=1.28x, Gap=-3.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.764, Ratio=1.27x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.770, Ratio=1.29x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.769, Ratio=1.29x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.741, Ratio=1.25x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.748, Ratio=1.24x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.764, Ratio=1.25x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.767, Ratio=1.28x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.766, Ratio=1.29x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.758, Ratio=1.27x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.764, Ratio=1.27x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.756, Ratio=1.25x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.782, Ratio=1.29x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.761, Ratio=1.27x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.756, Ratio=1.26x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.751, Ratio=1.27x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.755, Ratio=1.26x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.753, Ratio=1.24x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.750, Ratio=1.26x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.761, Ratio=1.28x, Gap=-3.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.759, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.756, Ratio=1.26x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.757, Ratio=1.26x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.756, Ratio=1.27x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.757, Ratio=1.27x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.753, Ratio=1.28x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.765, Ratio=1.25x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.732, Ratio=1.25x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=0.750, Ratio=1.29x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.763, Ratio=1.29x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.774, Ratio=1.31x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.764, Ratio=1.28x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.746, Ratio=1.26x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.780, Ratio=1.27x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.766, Ratio=1.26x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.776, Ratio=1.29x, Gap=-3.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.750, Ratio=1.28x, Gap=-3.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.742, Ratio=1.27x, Gap=-3.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.743, Ratio=1.26x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.753, Ratio=1.28x, Gap=-3.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.752, Ratio=1.27x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.748, Ratio=1.27x, Gap=-3.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.751, Ratio=1.26x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.735, Ratio=1.23x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.28x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.761, Ratio=1.28x, Gap=-3.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.758, Ratio=1.24x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.757, Ratio=1.27x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.765, Ratio=1.27x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.28x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.758, Ratio=1.26x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.753, Ratio=1.25x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.759, Ratio=1.26x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.781, Ratio=1.27x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.747, Ratio=1.26x, Gap=-3.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.756, Ratio=1.26x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.762, Ratio=1.24x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.747, Ratio=1.26x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.776, Ratio=1.28x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.757, Ratio=1.25x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.771, Ratio=1.26x, Gap=-2.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.760, Ratio=1.27x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.766, Ratio=1.28x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.744, Ratio=1.24x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.758, Ratio=1.27x, Gap=-3.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.759, Ratio=1.26x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.753, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.744, Ratio=1.27x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.760, Ratio=1.26x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.752, Ratio=1.26x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.749, Ratio=1.26x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.747, Ratio=1.24x, Gap=-3.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.755, Ratio=1.26x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.27x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.762, Ratio=1.29x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.737, Ratio=1.25x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.27x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.758, Ratio=1.28x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.752, Ratio=1.26x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.750, Ratio=1.27x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.760, Ratio=1.27x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.750, Ratio=1.27x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.749, Ratio=1.25x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.754, Ratio=1.26x, Gap=-3.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.763, Ratio=1.29x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.758, Ratio=1.25x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.761, Ratio=1.28x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.750, Ratio=1.25x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.27x, Gap=-3.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.752, Ratio=1.27x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.777, Ratio=1.30x, Gap=-3.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.753, Ratio=1.26x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.762, Ratio=1.27x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.761, Ratio=1.26x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.755, Ratio=1.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.770, Ratio=1.28x, Gap=-3.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.769, Ratio=1.29x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.769, Ratio=1.27x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.759, Ratio=1.27x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.773, Ratio=1.27x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.762, Ratio=1.27x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.748, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.766, Ratio=1.26x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.741, Ratio=1.24x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.742, Ratio=1.24x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.752, Ratio=1.27x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=0.738, Ratio=1.27x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.772, Ratio=1.26x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.761, Ratio=1.28x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.740, Ratio=1.27x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.754, Ratio=1.24x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.742, Ratio=1.25x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.762, Ratio=1.26x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.751, Ratio=1.25x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.753, Ratio=1.27x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.760, Ratio=1.28x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.771, Ratio=1.31x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.753, Ratio=1.27x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.747, Ratio=1.23x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.775, Ratio=1.28x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.754, Ratio=1.25x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.761, Ratio=1.30x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.747, Ratio=1.29x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.743, Ratio=1.25x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.747, Ratio=1.26x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.783, Ratio=1.30x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.763, Ratio=1.24x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.752, Ratio=1.27x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.774, Ratio=1.30x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.763, Ratio=1.27x, Gap=-3.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.754, Ratio=1.26x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.764, Ratio=1.28x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.748, Ratio=1.25x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.758, Ratio=1.27x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.760, Ratio=1.27x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.739, Ratio=1.26x, Gap=-3.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.762, Ratio=1.26x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.731, Ratio=1.24x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.748, Ratio=1.28x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.747, Ratio=1.25x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.760, Ratio=1.29x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.753, Ratio=1.28x, Gap=-3.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.737, Ratio=1.24x, Gap=-3.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.751, Ratio=1.26x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.759, Ratio=1.27x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.743, Ratio=1.24x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.760, Ratio=1.27x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.760, Ratio=1.26x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.769, Ratio=1.29x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.758, Ratio=1.29x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.757, Ratio=1.27x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.740, Ratio=1.23x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.770, Ratio=1.29x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.758, Ratio=1.26x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.762, Ratio=1.28x, Gap=-3.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=0.746, Ratio=1.29x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.757, Ratio=1.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.761, Ratio=1.26x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.749, Ratio=1.26x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.747, Ratio=1.27x, Gap=-3.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.758, Ratio=1.28x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.767, Ratio=1.30x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.759, Ratio=1.27x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.778, Ratio=1.30x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.751, Ratio=1.25x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.761, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.770, Ratio=1.27x, Gap=-3.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.742, Ratio=1.24x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.746, Ratio=1.27x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.752, Ratio=1.28x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.761, Ratio=1.27x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.756, Ratio=1.26x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.757, Ratio=1.27x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.770, Ratio=1.28x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.746, Ratio=1.24x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.747, Ratio=1.26x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.758, Ratio=1.26x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.746, Ratio=1.26x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.761, Ratio=1.27x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.750, Ratio=1.27x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.762, Ratio=1.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.755, Ratio=1.29x, Gap=-3.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.763, Ratio=1.29x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.764, Ratio=1.25x, Gap=-3.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.763, Ratio=1.24x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.764, Ratio=1.26x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.28x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.26x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.761, Ratio=1.28x, Gap=-3.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.745, Ratio=1.25x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.747, Ratio=1.25x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.756, Ratio=1.27x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.756, Ratio=1.25x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.758, Ratio=1.28x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.748, Ratio=1.27x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.745, Ratio=1.25x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.760, Ratio=1.25x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.778, Ratio=1.29x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.738, Ratio=1.25x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.755, Ratio=1.28x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.771, Ratio=1.27x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.767, Ratio=1.28x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.756, Ratio=1.26x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.755, Ratio=1.26x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.774, Ratio=1.27x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.742, Ratio=1.26x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.768, Ratio=1.28x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.759, Ratio=1.26x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.762, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.766, Ratio=1.28x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=0.748, Ratio=1.29x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.767, Ratio=1.26x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.763, Ratio=1.25x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.777, Ratio=1.29x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.770, Ratio=1.30x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.739, Ratio=1.25x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.758, Ratio=1.25x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.758, Ratio=1.28x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.747, Ratio=1.28x, Gap=-3.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.745, Ratio=1.27x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.772, Ratio=1.28x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.744, Ratio=1.25x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.752, Ratio=1.26x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.781, Ratio=1.28x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.769, Ratio=1.28x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.759, Ratio=1.27x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.759, Ratio=1.27x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.745, Ratio=1.24x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.746, Ratio=1.25x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.763, Ratio=1.26x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.749, Ratio=1.27x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.781, Ratio=1.29x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.768, Ratio=1.28x, Gap=-3.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.758, Ratio=1.28x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.774, Ratio=1.31x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.757, Ratio=1.29x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.754, Ratio=1.25x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.770, Ratio=1.26x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.760, Ratio=1.27x, Gap=-3.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.777, Ratio=1.28x, Gap=-3.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.749, Ratio=1.26x, Gap=-3.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.767, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.736, Ratio=1.25x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.773, Ratio=1.29x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.763, Ratio=1.29x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.752, Ratio=1.27x, Gap=-3.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.745, Ratio=1.26x, Gap=-3.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.759, Ratio=1.25x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.759, Ratio=1.26x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.756, Ratio=1.26x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.754, Ratio=1.28x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.731, Ratio=1.25x, Gap=-3.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.756, Ratio=1.25x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.759, Ratio=1.26x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.769, Ratio=1.27x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.779, Ratio=1.27x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.754, Ratio=1.24x, Gap=-3.670

============================================================
Epoch 2/20 completed in 32.0s
Train: Loss=1.8887 (C:1.8887, R:0.0105) Ratio=2.16x
Val:   Loss=1.8704 (C:1.8704, R:0.0105) Ratio=2.50x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.8704)
============================================================

Epoch 3 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.734, Ratio=1.24x, Gap=-3.538
Batch   0/537: Loss=1.8863 (C:1.8863, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.739, Ratio=1.23x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.754, Ratio=1.27x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.743, Ratio=1.24x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.753, Ratio=1.28x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=0.727, Ratio=1.25x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.755, Ratio=1.27x, Gap=-3.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.758, Ratio=1.26x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.757, Ratio=1.25x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.759, Ratio=1.28x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.745, Ratio=1.25x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.755, Ratio=1.22x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.790, Ratio=1.28x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.785, Ratio=1.27x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.776, Ratio=1.27x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=0.787, Ratio=1.24x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.775, Ratio=1.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.779, Ratio=1.26x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.775, Ratio=1.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.774, Ratio=1.24x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.755, Ratio=1.24x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.776, Ratio=1.23x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.769, Ratio=1.26x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.764, Ratio=1.28x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.527
Batch  25/537: Loss=1.8755 (C:1.8755, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.757, Ratio=1.25x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.768, Ratio=1.27x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.755, Ratio=1.26x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.752, Ratio=1.26x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.769, Ratio=1.26x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.758, Ratio=1.24x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.763, Ratio=1.25x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.769, Ratio=1.25x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.766, Ratio=1.25x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.761, Ratio=1.24x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.27x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.761, Ratio=1.25x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.770, Ratio=1.25x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.762, Ratio=1.25x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.776, Ratio=1.24x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.780, Ratio=1.25x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.780, Ratio=1.25x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=0.792, Ratio=1.24x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.781, Ratio=1.23x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.793, Ratio=1.26x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.777, Ratio=1.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.785, Ratio=1.24x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.779, Ratio=1.25x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.753, Ratio=1.27x, Gap=-3.516
Batch  50/537: Loss=1.8696 (C:1.8696, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.757, Ratio=1.26x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.744, Ratio=1.24x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.753, Ratio=1.26x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.748, Ratio=1.25x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.748, Ratio=1.26x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.733, Ratio=1.25x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.735, Ratio=1.25x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.741, Ratio=1.25x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.765, Ratio=1.24x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.767, Ratio=1.25x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.772, Ratio=1.26x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.751, Ratio=1.26x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.755, Ratio=1.25x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.775, Ratio=1.26x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.790, Ratio=1.25x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.770, Ratio=1.24x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.773, Ratio=1.26x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.767, Ratio=1.24x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.777, Ratio=1.27x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.771, Ratio=1.25x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.771, Ratio=1.27x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.767, Ratio=1.25x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.770, Ratio=1.26x, Gap=-3.611
Batch  75/537: Loss=1.8768 (C:1.8768, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.754, Ratio=1.23x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.26x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.25x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.761, Ratio=1.26x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.761, Ratio=1.27x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.754, Ratio=1.24x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.794, Ratio=1.27x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.764, Ratio=1.28x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.753, Ratio=1.24x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.758, Ratio=1.24x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.763, Ratio=1.24x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.766, Ratio=1.27x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.752, Ratio=1.22x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.755, Ratio=1.24x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.787, Ratio=1.30x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.776, Ratio=1.25x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.760, Ratio=1.26x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.771, Ratio=1.27x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.761, Ratio=1.25x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.773, Ratio=1.27x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.760, Ratio=1.27x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.664
Batch 100/537: Loss=1.8697 (C:1.8697, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.745, Ratio=1.24x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.759, Ratio=1.26x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.751, Ratio=1.24x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.760, Ratio=1.28x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.749, Ratio=1.25x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.759, Ratio=1.28x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.758, Ratio=1.24x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.749, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.778, Ratio=1.26x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.764, Ratio=1.23x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.763, Ratio=1.26x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.756, Ratio=1.23x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.765, Ratio=1.25x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.779, Ratio=1.27x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.790, Ratio=1.25x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.760, Ratio=1.25x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.773, Ratio=1.25x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.770, Ratio=1.24x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.766, Ratio=1.26x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.777, Ratio=1.27x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.774, Ratio=1.28x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.764, Ratio=1.26x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.766, Ratio=1.26x, Gap=-3.552
Batch 125/537: Loss=1.8754 (C:1.8754, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.762, Ratio=1.26x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.759, Ratio=1.25x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.753, Ratio=1.25x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.747, Ratio=1.25x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.731, Ratio=1.23x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.745, Ratio=1.26x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.763, Ratio=1.28x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.738, Ratio=1.21x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.749, Ratio=1.24x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.747, Ratio=1.24x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.754, Ratio=1.24x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.762, Ratio=1.25x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.790, Ratio=1.26x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.765, Ratio=1.24x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.774, Ratio=1.25x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.774, Ratio=1.25x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.792, Ratio=1.28x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.783, Ratio=1.25x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.27x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.758, Ratio=1.26x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.784, Ratio=1.27x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.779, Ratio=1.25x, Gap=-3.364
Batch 150/537: Loss=1.8770 (C:1.8770, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.777, Ratio=1.28x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.772, Ratio=1.23x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.778, Ratio=1.27x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.768, Ratio=1.25x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.766, Ratio=1.24x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.772, Ratio=1.26x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.763, Ratio=1.25x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.757, Ratio=1.25x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.755, Ratio=1.25x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.757, Ratio=1.23x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=0.789, Ratio=1.24x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.762, Ratio=1.27x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.760, Ratio=1.24x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.752, Ratio=1.24x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.774, Ratio=1.27x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.757, Ratio=1.26x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.767, Ratio=1.27x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.776, Ratio=1.27x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.753, Ratio=1.26x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.750, Ratio=1.24x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.778, Ratio=1.27x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.779, Ratio=1.25x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.773, Ratio=1.25x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.782, Ratio=1.26x, Gap=-3.498
Batch 175/537: Loss=1.8726 (C:1.8726, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.771, Ratio=1.25x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.762, Ratio=1.25x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.757, Ratio=1.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.759, Ratio=1.26x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.762, Ratio=1.27x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.777, Ratio=1.24x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.775, Ratio=1.26x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.768, Ratio=1.28x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.762, Ratio=1.24x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.775, Ratio=1.25x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.768, Ratio=1.25x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.767, Ratio=1.25x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.766, Ratio=1.27x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.755, Ratio=1.23x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.764, Ratio=1.26x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.751, Ratio=1.24x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.770, Ratio=1.27x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.772, Ratio=1.24x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.729, Ratio=1.23x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.744, Ratio=1.26x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.757, Ratio=1.23x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.754, Ratio=1.25x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.27x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.734, Ratio=1.25x, Gap=-3.633
Batch 200/537: Loss=1.8797 (C:1.8797, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.761, Ratio=1.25x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.754, Ratio=1.25x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.758, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.761, Ratio=1.26x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.787, Ratio=1.27x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.776, Ratio=1.27x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.765, Ratio=1.23x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.774, Ratio=1.29x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.773, Ratio=1.24x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.776, Ratio=1.30x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.761, Ratio=1.24x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.749, Ratio=1.22x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.773, Ratio=1.26x, Gap=-3.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.779, Ratio=1.30x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.766, Ratio=1.25x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.763, Ratio=1.24x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.769, Ratio=1.26x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.778, Ratio=1.27x, Gap=-3.468
Batch 225/537: Loss=1.8697 (C:1.8697, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.774, Ratio=1.27x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.780, Ratio=1.26x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.772, Ratio=1.26x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.775, Ratio=1.26x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.762, Ratio=1.27x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.786, Ratio=1.27x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.763, Ratio=1.27x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.769, Ratio=1.26x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.789, Ratio=1.26x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.774, Ratio=1.25x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.772, Ratio=1.26x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.773, Ratio=1.24x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.773, Ratio=1.27x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.773, Ratio=1.27x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.777, Ratio=1.25x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.758, Ratio=1.24x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.769, Ratio=1.25x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.755, Ratio=1.24x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.762, Ratio=1.23x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.760, Ratio=1.28x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.786, Ratio=1.25x, Gap=-3.464
Batch 250/537: Loss=1.8766 (C:1.8766, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.797, Ratio=1.28x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.778, Ratio=1.24x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.776, Ratio=1.29x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.761, Ratio=1.25x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.791, Ratio=1.29x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.779, Ratio=1.24x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.762, Ratio=1.27x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.755, Ratio=1.25x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.769, Ratio=1.24x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.779, Ratio=1.25x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.765, Ratio=1.24x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.778, Ratio=1.26x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.780, Ratio=1.29x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.764, Ratio=1.25x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.760, Ratio=1.25x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.767, Ratio=1.23x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.773, Ratio=1.26x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.767, Ratio=1.24x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.778, Ratio=1.26x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.772, Ratio=1.24x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.760, Ratio=1.28x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.774, Ratio=1.25x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.748, Ratio=1.23x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.743, Ratio=1.24x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.756, Ratio=1.23x, Gap=-3.865
Batch 275/537: Loss=1.8928 (C:1.8928, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.783, Ratio=1.25x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.746, Ratio=1.25x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.25x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.746, Ratio=1.27x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.767, Ratio=1.29x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.758, Ratio=1.27x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=0.750, Ratio=1.28x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.765, Ratio=1.25x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.747, Ratio=1.26x, Gap=-3.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.761, Ratio=1.26x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.767, Ratio=1.25x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.769, Ratio=1.26x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.763, Ratio=1.25x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.781, Ratio=1.26x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.756, Ratio=1.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.756, Ratio=1.24x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.764, Ratio=1.26x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.762, Ratio=1.24x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.765, Ratio=1.24x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.776, Ratio=1.26x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.776, Ratio=1.26x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.781, Ratio=1.28x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.775, Ratio=1.26x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.783, Ratio=1.27x, Gap=-3.868
Batch 300/537: Loss=1.8685 (C:1.8685, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.796, Ratio=1.25x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.773, Ratio=1.25x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.777, Ratio=1.25x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.758, Ratio=1.25x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.760, Ratio=1.26x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.745, Ratio=1.25x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.757, Ratio=1.24x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.742, Ratio=1.24x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.749, Ratio=1.26x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.750, Ratio=1.24x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.766, Ratio=1.26x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.771, Ratio=1.26x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.763, Ratio=1.26x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.765, Ratio=1.24x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.779, Ratio=1.26x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.758, Ratio=1.23x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.761, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.781, Ratio=1.25x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.769, Ratio=1.24x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.774, Ratio=1.27x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.764, Ratio=1.25x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.740, Ratio=1.25x, Gap=-3.513
Batch 325/537: Loss=1.8788 (C:1.8788, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.786, Ratio=1.26x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.764, Ratio=1.24x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.758, Ratio=1.27x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.782, Ratio=1.26x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.781, Ratio=1.28x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.766, Ratio=1.26x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.785, Ratio=1.27x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.783, Ratio=1.28x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.771, Ratio=1.27x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.773, Ratio=1.26x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.756, Ratio=1.22x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.762, Ratio=1.25x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.771, Ratio=1.27x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.784, Ratio=1.28x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.750, Ratio=1.24x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.768, Ratio=1.27x, Gap=-3.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.782, Ratio=1.25x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.772, Ratio=1.26x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.770, Ratio=1.27x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.764, Ratio=1.25x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.775, Ratio=1.25x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.775, Ratio=1.27x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.779, Ratio=1.25x, Gap=-3.496
Batch 350/537: Loss=1.8801 (C:1.8801, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.762, Ratio=1.26x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.763, Ratio=1.24x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.766, Ratio=1.27x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.775, Ratio=1.25x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.770, Ratio=1.26x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.768, Ratio=1.25x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.778, Ratio=1.26x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.761, Ratio=1.26x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.744, Ratio=1.24x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.778, Ratio=1.27x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.784, Ratio=1.28x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.746, Ratio=1.23x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.755, Ratio=1.24x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.761, Ratio=1.25x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.732, Ratio=1.25x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.755, Ratio=1.25x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.751, Ratio=1.24x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.760, Ratio=1.26x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.768, Ratio=1.25x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.750, Ratio=1.25x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.780, Ratio=1.29x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.768, Ratio=1.26x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.768, Ratio=1.24x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.766, Ratio=1.25x, Gap=-3.509
Batch 375/537: Loss=1.8787 (C:1.8787, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.766, Ratio=1.25x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.768, Ratio=1.26x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.780, Ratio=1.25x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.774, Ratio=1.25x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.770, Ratio=1.28x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.795, Ratio=1.29x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.783, Ratio=1.26x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.785, Ratio=1.28x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.784, Ratio=1.27x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.782, Ratio=1.24x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.807, Ratio=1.26x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.774, Ratio=1.25x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.793, Ratio=1.25x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.774, Ratio=1.25x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.772, Ratio=1.25x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.772, Ratio=1.26x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.766, Ratio=1.23x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.756, Ratio=1.22x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.773, Ratio=1.27x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.751, Ratio=1.26x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.758, Ratio=1.23x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.770, Ratio=1.28x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.758, Ratio=1.26x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.750, Ratio=1.28x, Gap=-4.068
Batch 400/537: Loss=1.8665 (C:1.8665, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.760, Ratio=1.27x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.767, Ratio=1.25x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.774, Ratio=1.27x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.777, Ratio=1.27x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.776, Ratio=1.25x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.784, Ratio=1.28x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=0.790, Ratio=1.25x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.773, Ratio=1.26x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.765, Ratio=1.26x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.781, Ratio=1.24x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.765, Ratio=1.27x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.781, Ratio=1.26x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.755, Ratio=1.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.800, Ratio=1.28x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.783, Ratio=1.26x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.775, Ratio=1.28x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.775, Ratio=1.26x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.783, Ratio=1.26x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.770, Ratio=1.24x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.801, Ratio=1.29x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.791, Ratio=1.26x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.768, Ratio=1.26x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.788, Ratio=1.25x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.786, Ratio=1.24x, Gap=-3.665
Batch 425/537: Loss=1.8857 (C:1.8857, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.796, Ratio=1.27x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.780, Ratio=1.26x, Gap=-3.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.771, Ratio=1.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.759, Ratio=1.27x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.765, Ratio=1.26x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.770, Ratio=1.25x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.763, Ratio=1.26x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.783, Ratio=1.28x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.763, Ratio=1.25x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.757, Ratio=1.28x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.780, Ratio=1.26x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.779, Ratio=1.26x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.773, Ratio=1.25x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.777, Ratio=1.26x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.810, Ratio=1.28x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.786, Ratio=1.26x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.776, Ratio=1.24x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.779, Ratio=1.23x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.787, Ratio=1.28x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.780, Ratio=1.27x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.798, Ratio=1.28x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.785, Ratio=1.28x, Gap=-3.512
Batch 450/537: Loss=1.8620 (C:1.8620, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.779, Ratio=1.25x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.794, Ratio=1.27x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.776, Ratio=1.25x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.760, Ratio=1.23x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.756, Ratio=1.23x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.783, Ratio=1.26x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.766, Ratio=1.23x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.774, Ratio=1.27x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.767, Ratio=1.27x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.769, Ratio=1.27x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.748, Ratio=1.23x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.767, Ratio=1.24x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.781, Ratio=1.29x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.759, Ratio=1.26x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.770, Ratio=1.24x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.784, Ratio=1.28x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.773, Ratio=1.24x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.764, Ratio=1.25x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.786, Ratio=1.26x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.762, Ratio=1.26x, Gap=-3.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=0.793, Ratio=1.24x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.754, Ratio=1.23x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.783, Ratio=1.27x, Gap=-3.792
Batch 475/537: Loss=1.8663 (C:1.8663, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.761, Ratio=1.26x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.782, Ratio=1.25x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.788, Ratio=1.26x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.791, Ratio=1.28x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.784, Ratio=1.26x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.767, Ratio=1.25x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.750, Ratio=1.24x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.797, Ratio=1.28x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.801, Ratio=1.29x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.775, Ratio=1.25x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.772, Ratio=1.26x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.782, Ratio=1.24x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.792, Ratio=1.27x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.784, Ratio=1.26x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.761, Ratio=1.25x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.780, Ratio=1.27x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.787, Ratio=1.25x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.771, Ratio=1.27x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.785, Ratio=1.27x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.764, Ratio=1.25x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.770, Ratio=1.27x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.795, Ratio=1.27x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.783, Ratio=1.24x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.768, Ratio=1.27x, Gap=-3.609
Batch 500/537: Loss=1.8719 (C:1.8719, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.789, Ratio=1.26x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.773, Ratio=1.26x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.784, Ratio=1.28x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.788, Ratio=1.26x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.777, Ratio=1.25x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.803, Ratio=1.28x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=0.789, Ratio=1.25x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.809, Ratio=1.26x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=0.797, Ratio=1.27x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.806, Ratio=1.29x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.803, Ratio=1.27x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=0.810, Ratio=1.28x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=0.807, Ratio=1.28x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=0.797, Ratio=1.24x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=0.798, Ratio=1.26x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.782, Ratio=1.26x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.775, Ratio=1.26x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.765, Ratio=1.25x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.758, Ratio=1.24x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.759, Ratio=1.27x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.735, Ratio=1.24x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.760, Ratio=1.26x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.753, Ratio=1.25x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.767, Ratio=1.25x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.759, Ratio=1.23x, Gap=-3.614
Batch 525/537: Loss=1.8873 (C:1.8873, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.753, Ratio=1.25x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.762, Ratio=1.25x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.759, Ratio=1.25x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.770, Ratio=1.25x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.756, Ratio=1.26x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.756, Ratio=1.27x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.787, Ratio=1.27x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.776, Ratio=1.25x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.755, Ratio=1.25x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.763, Ratio=1.26x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.791, Ratio=1.29x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.789, Ratio=1.31x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.780, Ratio=1.27x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.791, Ratio=1.29x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.802, Ratio=1.31x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.777, Ratio=1.29x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.780, Ratio=1.27x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.783, Ratio=1.31x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.784, Ratio=1.29x, Gap=-3.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.779, Ratio=1.26x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.787, Ratio=1.29x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.786, Ratio=1.30x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.800, Ratio=1.30x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.769, Ratio=1.29x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.781, Ratio=1.29x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.768, Ratio=1.27x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.788, Ratio=1.32x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.775, Ratio=1.26x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.777, Ratio=1.30x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.780, Ratio=1.28x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.784, Ratio=1.28x, Gap=-3.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.763, Ratio=1.27x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.782, Ratio=1.30x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.772, Ratio=1.27x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.793, Ratio=1.28x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.783, Ratio=1.31x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.783, Ratio=1.30x, Gap=-3.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.794, Ratio=1.29x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.780, Ratio=1.29x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.774, Ratio=1.29x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.783, Ratio=1.25x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.781, Ratio=1.29x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.790, Ratio=1.29x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.766, Ratio=1.26x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.790, Ratio=1.29x, Gap=-3.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.777, Ratio=1.30x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.783, Ratio=1.29x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.777, Ratio=1.26x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.790, Ratio=1.29x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.783, Ratio=1.30x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.781, Ratio=1.29x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.789, Ratio=1.30x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.783, Ratio=1.30x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.793, Ratio=1.31x, Gap=-3.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.775, Ratio=1.28x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.794, Ratio=1.29x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.769, Ratio=1.27x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.27x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.783, Ratio=1.29x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.767, Ratio=1.25x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.767, Ratio=1.26x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.769, Ratio=1.28x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.786, Ratio=1.29x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.802, Ratio=1.33x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.781, Ratio=1.30x, Gap=-3.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.795, Ratio=1.32x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.769, Ratio=1.30x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.786, Ratio=1.28x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.789, Ratio=1.30x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.783, Ratio=1.31x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.773, Ratio=1.28x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.783, Ratio=1.29x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.782, Ratio=1.28x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.769, Ratio=1.29x, Gap=-3.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.782, Ratio=1.25x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.786, Ratio=1.29x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.774, Ratio=1.29x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.798, Ratio=1.31x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.787, Ratio=1.31x, Gap=-3.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.781, Ratio=1.31x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.762, Ratio=1.28x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.785, Ratio=1.29x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.786, Ratio=1.29x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.783, Ratio=1.28x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.794, Ratio=1.27x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.786, Ratio=1.29x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.775, Ratio=1.28x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.775, Ratio=1.29x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.795, Ratio=1.29x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.771, Ratio=1.31x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.778, Ratio=1.28x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.770, Ratio=1.28x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.772, Ratio=1.29x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.764, Ratio=1.28x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.796, Ratio=1.29x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.788, Ratio=1.30x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.781, Ratio=1.28x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.771, Ratio=1.25x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.779, Ratio=1.28x, Gap=-3.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.774, Ratio=1.25x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.775, Ratio=1.32x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.776, Ratio=1.28x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.788, Ratio=1.28x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.794, Ratio=1.30x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.785, Ratio=1.31x, Gap=-3.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.785, Ratio=1.32x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.786, Ratio=1.27x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.770, Ratio=1.26x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.798, Ratio=1.27x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.781, Ratio=1.29x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.768, Ratio=1.30x, Gap=-3.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.793, Ratio=1.29x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.790, Ratio=1.30x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.777, Ratio=1.29x, Gap=-3.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.776, Ratio=1.28x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.782, Ratio=1.28x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.771, Ratio=1.29x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.778, Ratio=1.27x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.783, Ratio=1.31x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.766, Ratio=1.29x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.771, Ratio=1.27x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.776, Ratio=1.28x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.774, Ratio=1.28x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.806, Ratio=1.29x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.769, Ratio=1.26x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.786, Ratio=1.31x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.805, Ratio=1.32x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.790, Ratio=1.31x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.780, Ratio=1.28x, Gap=-3.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.796, Ratio=1.29x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.792, Ratio=1.28x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.768, Ratio=1.27x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.778, Ratio=1.27x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.777, Ratio=1.27x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.768, Ratio=1.26x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.798, Ratio=1.33x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.793, Ratio=1.30x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.772, Ratio=1.26x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.804, Ratio=1.30x, Gap=-3.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.798, Ratio=1.29x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.799, Ratio=1.33x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.780, Ratio=1.30x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.777, Ratio=1.28x, Gap=-3.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.793, Ratio=1.29x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.789, Ratio=1.28x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.767, Ratio=1.28x, Gap=-3.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.791, Ratio=1.30x, Gap=-3.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.781, Ratio=1.31x, Gap=-3.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.801, Ratio=1.28x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.802, Ratio=1.31x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.778, Ratio=1.27x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.794, Ratio=1.29x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.788, Ratio=1.29x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.784, Ratio=1.28x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.778, Ratio=1.29x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.791, Ratio=1.27x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.790, Ratio=1.29x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.791, Ratio=1.28x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.796, Ratio=1.31x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.790, Ratio=1.27x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.788, Ratio=1.31x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.771, Ratio=1.26x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.787, Ratio=1.31x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.772, Ratio=1.29x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.780, Ratio=1.29x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.786, Ratio=1.29x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.795, Ratio=1.29x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.788, Ratio=1.30x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.784, Ratio=1.29x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.794, Ratio=1.30x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.776, Ratio=1.28x, Gap=-3.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.775, Ratio=1.28x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.805, Ratio=1.32x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.774, Ratio=1.27x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.786, Ratio=1.30x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.772, Ratio=1.28x, Gap=-3.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.28x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.784, Ratio=1.31x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.772, Ratio=1.28x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.791, Ratio=1.29x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.797, Ratio=1.35x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.784, Ratio=1.27x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.786, Ratio=1.29x, Gap=-3.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.794, Ratio=1.27x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.781, Ratio=1.28x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.790, Ratio=1.30x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.784, Ratio=1.30x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.28x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.782, Ratio=1.27x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.791, Ratio=1.32x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.781, Ratio=1.29x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.771, Ratio=1.32x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.791, Ratio=1.29x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.752, Ratio=1.26x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.783, Ratio=1.28x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.790, Ratio=1.28x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.791, Ratio=1.31x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.780, Ratio=1.28x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.775, Ratio=1.27x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.791, Ratio=1.28x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.792, Ratio=1.28x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.788, Ratio=1.28x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.780, Ratio=1.28x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=0.790, Ratio=1.27x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.785, Ratio=1.31x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.777, Ratio=1.28x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.793, Ratio=1.30x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.771, Ratio=1.28x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.783, Ratio=1.29x, Gap=-3.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.787, Ratio=1.32x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.785, Ratio=1.27x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.788, Ratio=1.28x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.777, Ratio=1.27x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.799, Ratio=1.31x, Gap=-3.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.778, Ratio=1.30x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.777, Ratio=1.27x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=0.769, Ratio=1.30x, Gap=-3.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.791, Ratio=1.29x, Gap=-3.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.774, Ratio=1.26x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.773, Ratio=1.30x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.774, Ratio=1.31x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.775, Ratio=1.31x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.766, Ratio=1.26x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.757, Ratio=1.29x, Gap=-3.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.781, Ratio=1.28x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.778, Ratio=1.28x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.788, Ratio=1.27x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.782, Ratio=1.29x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.798, Ratio=1.30x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.774, Ratio=1.30x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.774, Ratio=1.29x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.782, Ratio=1.28x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.784, Ratio=1.30x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.788, Ratio=1.31x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.786, Ratio=1.32x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.814, Ratio=1.30x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.784, Ratio=1.30x, Gap=-3.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.793, Ratio=1.31x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.789, Ratio=1.31x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.786, Ratio=1.32x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=0.791, Ratio=1.25x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.790, Ratio=1.29x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.785, Ratio=1.28x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.777, Ratio=1.25x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=0.793, Ratio=1.27x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.788, Ratio=1.28x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.788, Ratio=1.28x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.784, Ratio=1.28x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=0.816, Ratio=1.31x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.782, Ratio=1.27x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.775, Ratio=1.27x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.805, Ratio=1.32x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.781, Ratio=1.31x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.776, Ratio=1.29x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.777, Ratio=1.27x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.792, Ratio=1.27x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.776, Ratio=1.26x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.801, Ratio=1.33x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.791, Ratio=1.28x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.778, Ratio=1.29x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.790, Ratio=1.30x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.784, Ratio=1.32x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.762, Ratio=1.27x, Gap=-3.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.768, Ratio=1.30x, Gap=-3.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.779, Ratio=1.28x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.773, Ratio=1.28x, Gap=-3.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.777, Ratio=1.26x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.778, Ratio=1.29x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.782, Ratio=1.27x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.789, Ratio=1.28x, Gap=-3.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.789, Ratio=1.32x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.787, Ratio=1.29x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.779, Ratio=1.28x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.785, Ratio=1.29x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.776, Ratio=1.27x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.792, Ratio=1.30x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.776, Ratio=1.26x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.783, Ratio=1.28x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.784, Ratio=1.29x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.769, Ratio=1.28x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.770, Ratio=1.27x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.794, Ratio=1.30x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.762, Ratio=1.27x, Gap=-3.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.763, Ratio=1.27x, Gap=-3.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.800, Ratio=1.29x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.780, Ratio=1.31x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.780, Ratio=1.29x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.782, Ratio=1.29x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.775, Ratio=1.28x, Gap=-3.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.778, Ratio=1.28x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.779, Ratio=1.30x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.782, Ratio=1.29x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.782, Ratio=1.29x, Gap=-3.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.781, Ratio=1.28x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.808, Ratio=1.32x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.809, Ratio=1.32x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.782, Ratio=1.29x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.763, Ratio=1.28x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.787, Ratio=1.28x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=0.800, Ratio=1.28x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.783, Ratio=1.29x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.793, Ratio=1.29x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.780, Ratio=1.28x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.784, Ratio=1.31x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.779, Ratio=1.30x, Gap=-3.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.807, Ratio=1.31x, Gap=-3.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.789, Ratio=1.32x, Gap=-3.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.798, Ratio=1.31x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.802, Ratio=1.30x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.790, Ratio=1.28x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.773, Ratio=1.29x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.797, Ratio=1.30x, Gap=-3.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.792, Ratio=1.29x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.779, Ratio=1.30x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.788, Ratio=1.29x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.792, Ratio=1.31x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.771, Ratio=1.29x, Gap=-3.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.794, Ratio=1.30x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.795, Ratio=1.32x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.786, Ratio=1.27x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.796, Ratio=1.28x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=0.806, Ratio=1.28x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.795, Ratio=1.32x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.792, Ratio=1.27x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.776, Ratio=1.29x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.776, Ratio=1.29x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.794, Ratio=1.31x, Gap=-3.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.769, Ratio=1.28x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.791, Ratio=1.29x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.771, Ratio=1.29x, Gap=-3.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.779, Ratio=1.29x, Gap=-3.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.770, Ratio=1.28x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.777, Ratio=1.29x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.791, Ratio=1.28x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.788, Ratio=1.27x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.780, Ratio=1.27x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=0.771, Ratio=1.32x, Gap=-3.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.783, Ratio=1.28x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.784, Ratio=1.29x, Gap=-3.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.791, Ratio=1.30x, Gap=-3.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.786, Ratio=1.28x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.772, Ratio=1.28x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.786, Ratio=1.32x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.786, Ratio=1.29x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.788, Ratio=1.30x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.772, Ratio=1.29x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.778, Ratio=1.31x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.800, Ratio=1.30x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.790, Ratio=1.29x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.781, Ratio=1.26x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.794, Ratio=1.30x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.797, Ratio=1.33x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.791, Ratio=1.31x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.774, Ratio=1.29x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.791, Ratio=1.31x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.783, Ratio=1.30x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.804, Ratio=1.30x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.778, Ratio=1.30x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.790, Ratio=1.29x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.789, Ratio=1.30x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.782, Ratio=1.28x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.785, Ratio=1.28x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.790, Ratio=1.29x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.792, Ratio=1.30x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.801, Ratio=1.29x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.784, Ratio=1.29x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=0.800, Ratio=1.28x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.776, Ratio=1.29x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.782, Ratio=1.29x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.785, Ratio=1.28x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.785, Ratio=1.29x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.792, Ratio=1.31x, Gap=-3.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.778, Ratio=1.30x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.781, Ratio=1.29x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.793, Ratio=1.31x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.773, Ratio=1.28x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.788, Ratio=1.32x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.789, Ratio=1.28x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.780, Ratio=1.31x, Gap=-3.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.781, Ratio=1.30x, Gap=-3.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.760, Ratio=1.26x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.786, Ratio=1.29x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.790, Ratio=1.30x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.783, Ratio=1.29x, Gap=-3.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.772, Ratio=1.27x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.781, Ratio=1.28x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.774, Ratio=1.29x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.795, Ratio=1.31x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.787, Ratio=1.32x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.793, Ratio=1.28x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.781, Ratio=1.28x, Gap=-3.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.766, Ratio=1.27x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.785, Ratio=1.29x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.781, Ratio=1.29x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.774, Ratio=1.28x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.793, Ratio=1.30x, Gap=-3.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.782, Ratio=1.29x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.788, Ratio=1.29x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.789, Ratio=1.29x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.789, Ratio=1.28x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.769, Ratio=1.26x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.794, Ratio=1.29x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.787, Ratio=1.28x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=0.780, Ratio=1.32x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.797, Ratio=1.33x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.774, Ratio=1.26x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.29x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.772, Ratio=1.26x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.777, Ratio=1.26x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.786, Ratio=1.29x, Gap=-3.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.772, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.788, Ratio=1.28x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.782, Ratio=1.28x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.793, Ratio=1.30x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.789, Ratio=1.29x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=0.771, Ratio=1.31x, Gap=-3.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.783, Ratio=1.29x, Gap=-3.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.798, Ratio=1.30x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.791, Ratio=1.32x, Gap=-3.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.770, Ratio=1.30x, Gap=-3.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.789, Ratio=1.31x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.786, Ratio=1.29x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.796, Ratio=1.31x, Gap=-3.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.784, Ratio=1.28x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.794, Ratio=1.28x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.794, Ratio=1.30x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.793, Ratio=1.31x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.787, Ratio=1.27x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.795, Ratio=1.30x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.772, Ratio=1.28x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.780, Ratio=1.30x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.772, Ratio=1.29x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.798, Ratio=1.32x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.792, Ratio=1.29x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.795, Ratio=1.29x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=0.777, Ratio=1.25x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.786, Ratio=1.30x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.787, Ratio=1.28x, Gap=-3.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.794, Ratio=1.29x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.791, Ratio=1.32x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.785, Ratio=1.31x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.773, Ratio=1.29x, Gap=-3.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.788, Ratio=1.27x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.785, Ratio=1.30x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.781, Ratio=1.29x, Gap=-3.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.793, Ratio=1.31x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.782, Ratio=1.29x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.795, Ratio=1.27x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.781, Ratio=1.26x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.789, Ratio=1.30x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=0.772, Ratio=1.29x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.774, Ratio=1.30x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.785, Ratio=1.29x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.779, Ratio=1.28x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.797, Ratio=1.29x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.763, Ratio=1.27x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.791, Ratio=1.31x, Gap=-3.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.775, Ratio=1.30x, Gap=-3.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.771, Ratio=1.27x, Gap=-3.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.771, Ratio=1.31x, Gap=-3.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.793, Ratio=1.30x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.777, Ratio=1.28x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.793, Ratio=1.29x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.779, Ratio=1.28x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.784, Ratio=1.29x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.795, Ratio=1.30x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.789, Ratio=1.29x, Gap=-3.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=0.792, Ratio=1.27x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.802, Ratio=1.30x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.783, Ratio=1.27x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.777, Ratio=1.27x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.782, Ratio=1.27x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=0.764, Ratio=1.30x, Gap=-3.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.794, Ratio=1.29x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.786, Ratio=1.31x, Gap=-3.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.780, Ratio=1.27x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.793, Ratio=1.32x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.785, Ratio=1.30x, Gap=-3.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=0.765, Ratio=1.30x, Gap=-3.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.791, Ratio=1.29x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.788, Ratio=1.29x, Gap=-3.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.785, Ratio=1.30x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.770, Ratio=1.28x, Gap=-3.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=0.784, Ratio=1.26x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.781, Ratio=1.28x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.792, Ratio=1.29x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=0.770, Ratio=1.31x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.770, Ratio=1.27x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.780, Ratio=1.32x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=0.781, Ratio=1.30x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=0.768, Ratio=1.31x, Gap=-3.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.774, Ratio=1.29x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.782, Ratio=1.29x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.781, Ratio=1.30x, Gap=-3.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=0.767, Ratio=1.27x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=0.776, Ratio=1.27x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=0.773, Ratio=1.30x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.787, Ratio=1.28x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=0.786, Ratio=1.27x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=0.772, Ratio=1.30x, Gap=-3.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.780, Ratio=1.29x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.770, Ratio=1.27x, Gap=-3.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=0.773, Ratio=1.29x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.798, Ratio=1.31x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.778, Ratio=1.28x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.791, Ratio=1.30x, Gap=-3.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.789, Ratio=1.28x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.773, Ratio=1.28x, Gap=-3.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.796, Ratio=1.31x, Gap=-3.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.794, Ratio=1.31x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.791, Ratio=1.30x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.773, Ratio=1.29x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.785, Ratio=1.31x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.791, Ratio=1.28x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=0.788, Ratio=1.30x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.784, Ratio=1.30x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=0.772, Ratio=1.28x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.781, Ratio=1.29x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=0.769, Ratio=1.28x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=0.794, Ratio=1.30x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=0.782, Ratio=1.29x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=0.767, Ratio=1.29x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.784, Ratio=1.28x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.775, Ratio=1.29x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.775, Ratio=1.28x, Gap=-3.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=0.778, Ratio=1.27x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=0.778, Ratio=1.27x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=0.777, Ratio=1.26x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=0.795, Ratio=1.31x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.775, Ratio=1.28x, Gap=-3.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.768, Ratio=1.27x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.775, Ratio=1.28x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=0.788, Ratio=1.28x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=0.774, Ratio=1.26x, Gap=-3.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.769, Ratio=1.28x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=0.786, Ratio=1.32x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=0.795, Ratio=1.29x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=0.777, Ratio=1.31x, Gap=-3.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=0.791, Ratio=1.31x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=0.792, Ratio=1.30x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=0.755, Ratio=1.26x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=0.802, Ratio=1.30x, Gap=-3.237

============================================================
Epoch 3/20 completed in 32.0s
Train: Loss=1.8766 (C:1.8766, R:0.0105) Ratio=2.37x
Val:   Loss=1.8596 (C:1.8596, R:0.0105) Ratio=2.70x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.8596)
============================================================

🌍 Updating global dataset at epoch 4
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.616 ± 0.587
    Neg distances: 1.605 ± 0.885
    Separation ratio: 2.60x
    Gap: -3.737
    ✅ Good global separation

Epoch 4 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.614, Ratio=2.57x, Gap=-3.761
Batch   0/537: Loss=1.2306 (C:1.2306, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.589, Ratio=2.48x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.635, Ratio=2.56x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.612, Ratio=2.57x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.605, Ratio=2.63x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.614, Ratio=2.56x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.620, Ratio=2.60x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.674, Ratio=2.78x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.637, Ratio=2.63x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.645, Ratio=2.66x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.617, Ratio=2.59x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.618, Ratio=2.59x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.608, Ratio=2.46x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.618, Ratio=2.53x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.623, Ratio=2.57x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.607, Ratio=2.50x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.648, Ratio=2.63x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.630, Ratio=2.62x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.628, Ratio=2.57x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.614, Ratio=2.58x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.618, Ratio=2.56x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.619, Ratio=2.64x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.613, Ratio=2.58x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.579, Ratio=2.49x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.616, Ratio=2.61x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.621, Ratio=2.59x, Gap=-3.832
Batch  25/537: Loss=1.2224 (C:1.2224, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.599, Ratio=2.46x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.617, Ratio=2.60x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.625, Ratio=2.64x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.588, Ratio=2.47x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.581, Ratio=2.41x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.662, Neg=1.610, Ratio=2.43x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.667, Neg=1.606, Ratio=2.41x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.616, Ratio=2.49x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.626, Ratio=2.61x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.657, Neg=1.598, Ratio=2.43x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.604, Ratio=2.51x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.607, Ratio=2.57x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.613, Ratio=2.58x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.603, Ratio=2.56x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.604, Ratio=2.49x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.602, Ratio=2.54x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.580, Ratio=2.47x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.661, Neg=1.602, Ratio=2.42x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.631, Ratio=2.61x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.603, Ratio=2.53x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.615, Ratio=2.56x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.603, Ratio=2.53x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.619, Ratio=2.59x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.623, Ratio=2.64x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.617, Ratio=2.51x, Gap=-4.002
Batch  50/537: Loss=1.2477 (C:1.2477, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.618, Ratio=2.50x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.661, Neg=1.632, Ratio=2.47x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.51x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.52x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.615, Ratio=2.60x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.613, Ratio=2.61x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.623, Ratio=2.60x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.596, Ratio=2.47x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.617, Ratio=2.57x, Gap=-4.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.632, Ratio=2.62x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.658, Neg=1.572, Ratio=2.39x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.599, Ratio=2.52x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.616, Ratio=2.62x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.620, Ratio=2.57x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.614, Ratio=2.54x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.626, Ratio=2.52x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.598, Ratio=2.52x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.612, Ratio=2.60x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.602, Ratio=2.56x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.615, Ratio=2.51x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.619, Ratio=2.63x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.614, Ratio=2.54x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.634, Ratio=2.54x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.606, Ratio=2.52x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.613, Ratio=2.49x, Gap=-3.874
Batch  75/537: Loss=1.2513 (C:1.2513, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.605, Ratio=2.52x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.593, Ratio=2.44x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.621, Ratio=2.62x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.619, Ratio=2.59x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.613, Ratio=2.51x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.594, Ratio=2.47x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.614, Ratio=2.57x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.630, Ratio=2.62x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.597, Ratio=2.50x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.607, Ratio=2.50x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.612, Ratio=2.47x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.602, Ratio=2.49x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.613, Ratio=2.52x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.615, Ratio=2.57x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.596, Ratio=2.49x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.581, Ratio=2.49x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.573, Ratio=2.46x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.587, Ratio=2.55x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.587, Ratio=2.46x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.605, Ratio=2.52x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.605, Ratio=2.50x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.592, Ratio=2.46x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.625, Ratio=2.52x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.587, Ratio=2.46x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.608, Ratio=2.56x, Gap=-3.810
Batch 100/537: Loss=1.2321 (C:1.2321, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.599, Ratio=2.45x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.608, Ratio=2.53x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.594, Ratio=2.50x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.626, Ratio=2.60x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.646, Ratio=2.65x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.608, Ratio=2.54x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.608, Ratio=2.60x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.594, Ratio=2.48x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.599, Ratio=2.56x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.631, Ratio=2.64x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.633, Ratio=2.54x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.621, Ratio=2.54x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.618, Ratio=2.61x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.620, Ratio=2.58x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.602, Ratio=2.57x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.610, Ratio=2.59x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.615, Ratio=2.58x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.614, Ratio=2.57x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.641, Ratio=2.69x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.625, Ratio=2.56x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.631, Ratio=2.64x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.609, Ratio=2.54x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.619, Ratio=2.59x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.612, Ratio=2.51x, Gap=-3.833
Batch 125/537: Loss=1.2463 (C:1.2463, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.634, Ratio=2.62x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.608, Ratio=2.50x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.616, Ratio=2.50x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.619, Ratio=2.58x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.639, Ratio=2.58x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.631, Ratio=2.57x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.637, Ratio=2.67x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.618, Ratio=2.54x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.617, Ratio=2.47x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.606, Ratio=2.48x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.628, Ratio=2.59x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.604, Ratio=2.61x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.648, Ratio=2.74x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.619, Ratio=2.67x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.636, Ratio=2.67x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.605, Ratio=2.56x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.620, Ratio=2.60x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.663, Neg=1.597, Ratio=2.41x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.621, Ratio=2.54x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.628, Ratio=2.60x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.594, Ratio=2.54x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.605, Ratio=2.55x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.582, Ratio=2.42x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.601, Ratio=2.48x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.598, Ratio=2.56x, Gap=-3.942
Batch 150/537: Loss=1.2340 (C:1.2340, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.584, Ratio=2.50x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.597, Ratio=2.57x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.591, Ratio=2.53x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.628, Ratio=2.50x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.610, Ratio=2.56x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.606, Ratio=2.52x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.610, Ratio=2.53x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.602, Ratio=2.52x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.621, Ratio=2.54x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.630, Ratio=2.58x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.597, Ratio=2.53x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.611, Ratio=2.57x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.628, Ratio=2.59x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.656, Neg=1.606, Ratio=2.45x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.611, Ratio=2.61x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.602, Ratio=2.58x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.595, Ratio=2.55x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.618, Ratio=2.64x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.602, Ratio=2.54x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.609, Ratio=2.54x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.635, Ratio=2.64x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.612, Ratio=2.50x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.627, Ratio=2.53x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.633, Ratio=2.61x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.633, Ratio=2.55x, Gap=-3.529
Batch 175/537: Loss=1.2361 (C:1.2361, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.606, Ratio=2.56x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.623, Ratio=2.59x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.604, Ratio=2.52x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.624, Ratio=2.52x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.611, Ratio=2.53x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.628, Ratio=2.64x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.619, Ratio=2.62x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.609, Ratio=2.52x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.618, Ratio=2.62x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.585, Ratio=2.46x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.621, Ratio=2.52x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.619, Ratio=2.54x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.616, Ratio=2.52x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.663, Ratio=2.68x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.633, Ratio=2.59x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.614, Ratio=2.52x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.583, Ratio=2.51x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.650, Ratio=2.70x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.607, Ratio=2.56x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.598, Ratio=2.45x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.603, Ratio=2.50x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.600, Ratio=2.48x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.616, Ratio=2.55x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.602, Ratio=2.52x, Gap=-3.841
Batch 200/537: Loss=1.2445 (C:1.2445, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.592, Ratio=2.50x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.622, Ratio=2.53x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.637, Ratio=2.62x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.654, Neg=1.609, Ratio=2.46x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.612, Ratio=2.55x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.598, Ratio=2.45x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.627, Ratio=2.57x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.598, Ratio=2.48x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.600, Ratio=2.53x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.585, Ratio=2.49x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.632, Ratio=2.57x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.605, Ratio=2.48x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.621, Ratio=2.62x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.641, Ratio=2.60x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.628, Ratio=2.62x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.632, Ratio=2.57x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.609, Ratio=2.53x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.640, Ratio=2.68x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.632, Ratio=2.60x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.651, Ratio=2.65x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.630, Ratio=2.62x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.613, Ratio=2.48x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.615, Ratio=2.60x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.624, Ratio=2.59x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.618, Ratio=2.54x, Gap=-3.939
Batch 225/537: Loss=1.2394 (C:1.2394, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.606, Ratio=2.54x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.604, Ratio=2.53x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.602, Ratio=2.48x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.616, Ratio=2.60x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.610, Ratio=2.60x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.607, Ratio=2.51x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.610, Ratio=2.65x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.598, Ratio=2.50x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.639, Ratio=2.63x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.614, Ratio=2.47x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.620, Ratio=2.51x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.607, Ratio=2.52x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.626, Ratio=2.54x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.658, Neg=1.591, Ratio=2.42x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.603, Ratio=2.49x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.624, Ratio=2.54x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.606, Ratio=2.56x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.628, Ratio=2.55x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.597, Ratio=2.49x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.602, Ratio=2.54x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.602, Ratio=2.47x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.608, Ratio=2.49x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.610, Ratio=2.61x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.616, Ratio=2.58x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.618, Ratio=2.62x, Gap=-3.986
Batch 250/537: Loss=1.2139 (C:1.2139, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.608, Ratio=2.59x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.589, Ratio=2.51x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.634, Ratio=2.69x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.623, Ratio=2.60x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.608, Ratio=2.48x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.618, Ratio=2.59x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.608, Ratio=2.47x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.597, Ratio=2.44x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.634, Ratio=2.60x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.631, Ratio=2.58x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.621, Ratio=2.57x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.614, Ratio=2.53x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.615, Ratio=2.59x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.611, Ratio=2.55x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.590, Ratio=2.55x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.613, Ratio=2.62x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.611, Ratio=2.48x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.602, Ratio=2.45x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.606, Ratio=2.56x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.600, Ratio=2.46x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.604, Ratio=2.53x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.627, Ratio=2.67x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.647, Ratio=2.63x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.653, Ratio=2.61x, Gap=-3.828
Batch 275/537: Loss=1.2157 (C:1.2157, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.617, Ratio=2.49x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.658, Ratio=2.65x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.644, Ratio=2.58x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.639, Ratio=2.63x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.614, Ratio=2.48x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.599, Ratio=2.49x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.610, Ratio=2.57x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.616, Ratio=2.54x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.601, Ratio=2.55x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.620, Ratio=2.68x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.609, Ratio=2.55x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.602, Ratio=2.51x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.614, Ratio=2.57x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.595, Ratio=2.57x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.632, Ratio=2.67x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.593, Ratio=2.44x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.597, Ratio=2.50x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.624, Ratio=2.54x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.641, Ratio=2.64x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.619, Ratio=2.48x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.658, Neg=1.597, Ratio=2.43x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.657, Neg=1.608, Ratio=2.45x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.612, Ratio=2.50x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.625, Ratio=2.65x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.602, Ratio=2.60x, Gap=-3.736
Batch 300/537: Loss=1.2211 (C:1.2211, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.604, Ratio=2.56x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.51x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.613, Ratio=2.52x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.621, Ratio=2.60x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.629, Ratio=2.63x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.614, Ratio=2.50x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.616, Ratio=2.52x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.618, Ratio=2.64x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.616, Ratio=2.56x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.622, Ratio=2.56x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.638, Ratio=2.53x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.594, Ratio=2.47x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.635, Ratio=2.67x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.617, Ratio=2.50x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.613, Ratio=2.54x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.596, Ratio=2.42x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.596, Ratio=2.50x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.632, Ratio=2.58x, Gap=-4.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.643, Ratio=2.64x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.623, Ratio=2.56x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.625, Ratio=2.59x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.604, Ratio=2.50x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.622, Ratio=2.51x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.620, Ratio=2.58x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.597, Ratio=2.49x, Gap=-3.837
Batch 325/537: Loss=1.2574 (C:1.2574, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.607, Ratio=2.58x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.618, Ratio=2.59x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.597, Ratio=2.54x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.589, Ratio=2.56x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.624, Ratio=2.58x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.587, Ratio=2.50x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.606, Ratio=2.65x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.612, Ratio=2.58x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.612, Ratio=2.55x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.651, Ratio=2.70x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.607, Ratio=2.51x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.603, Ratio=2.51x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.611, Ratio=2.50x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.627, Ratio=2.66x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.600, Ratio=2.53x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.611, Ratio=2.54x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.598, Ratio=2.53x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.594, Ratio=2.50x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.602, Ratio=2.48x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.612, Ratio=2.56x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.611, Ratio=2.46x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.619, Ratio=2.58x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.641, Ratio=2.64x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.616, Ratio=2.51x, Gap=-4.117
Batch 350/537: Loss=1.2475 (C:1.2475, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.611, Ratio=2.47x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.617, Ratio=2.55x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.607, Ratio=2.61x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.626, Ratio=2.61x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.615, Ratio=2.54x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.617, Ratio=2.61x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.617, Ratio=2.68x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.619, Ratio=2.64x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.602, Ratio=2.55x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.603, Ratio=2.54x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.620, Ratio=2.60x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.629, Ratio=2.54x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.637, Ratio=2.62x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.602, Ratio=2.52x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.619, Ratio=2.56x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.617, Ratio=2.57x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.608, Ratio=2.56x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.584, Ratio=2.43x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.647, Ratio=2.66x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.635, Ratio=2.63x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.589, Ratio=2.49x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.606, Ratio=2.48x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.616, Ratio=2.49x, Gap=-4.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.631, Ratio=2.61x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.602, Ratio=2.50x, Gap=-3.939
Batch 375/537: Loss=1.2523 (C:1.2523, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.632, Ratio=2.60x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.612, Ratio=2.44x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.606, Ratio=2.50x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.606, Ratio=2.55x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.597, Ratio=2.52x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.611, Ratio=2.50x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.589, Ratio=2.54x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.605, Ratio=2.52x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.636, Ratio=2.62x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.601, Ratio=2.55x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.607, Ratio=2.55x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.608, Ratio=2.54x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.607, Ratio=2.53x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.606, Ratio=2.52x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.607, Ratio=2.48x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.629, Ratio=2.57x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.607, Ratio=2.51x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.635, Ratio=2.56x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.630, Ratio=2.56x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.614, Ratio=2.55x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.607, Ratio=2.48x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.638, Ratio=2.72x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.577, Ratio=2.43x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.600, Ratio=2.53x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.619, Ratio=2.58x, Gap=-3.765
Batch 400/537: Loss=1.2266 (C:1.2266, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.628, Ratio=2.56x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.604, Ratio=2.47x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.602, Ratio=2.48x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.609, Ratio=2.60x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.614, Ratio=2.57x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.601, Ratio=2.56x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.606, Ratio=2.55x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.613, Ratio=2.61x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.63x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.619, Ratio=2.63x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.649, Ratio=2.72x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.589, Ratio=2.43x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.616, Ratio=2.53x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.630, Ratio=2.63x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.615, Ratio=2.47x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.642, Ratio=2.70x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.635, Ratio=2.64x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.620, Ratio=2.62x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.613, Ratio=2.55x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.651, Ratio=2.71x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.626, Ratio=2.54x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.598, Ratio=2.52x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.615, Ratio=2.59x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.614, Ratio=2.55x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.609, Ratio=2.59x, Gap=-3.974
Batch 425/537: Loss=1.2244 (C:1.2244, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.620, Ratio=2.64x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.624, Ratio=2.59x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.628, Ratio=2.61x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.624, Ratio=2.61x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.637, Ratio=2.63x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.593, Ratio=2.52x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.637, Ratio=2.58x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.585, Ratio=2.47x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.608, Ratio=2.59x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.614, Ratio=2.50x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.646, Ratio=2.58x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.632, Ratio=2.59x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.600, Ratio=2.49x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.664, Neg=1.598, Ratio=2.41x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.652, Ratio=2.61x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.616, Ratio=2.58x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.593, Ratio=2.47x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.618, Ratio=2.61x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.615, Ratio=2.52x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.604, Ratio=2.52x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.596, Ratio=2.53x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.576, Ratio=2.51x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.589, Ratio=2.54x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.615, Ratio=2.57x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.607, Ratio=2.55x, Gap=-3.828
Batch 450/537: Loss=1.2369 (C:1.2369, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.615, Ratio=2.55x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.598, Ratio=2.56x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.605, Ratio=2.51x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.615, Ratio=2.56x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.647, Ratio=2.63x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.610, Ratio=2.48x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.596, Ratio=2.49x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.627, Ratio=2.64x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.620, Ratio=2.55x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.613, Ratio=2.57x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.643, Ratio=2.64x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.616, Ratio=2.65x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.615, Ratio=2.61x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.611, Ratio=2.53x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.632, Ratio=2.60x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.614, Ratio=2.57x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.604, Ratio=2.58x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.627, Ratio=2.65x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.629, Ratio=2.52x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.604, Ratio=2.49x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.646, Ratio=2.64x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.654, Ratio=2.68x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.625, Ratio=2.58x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.658, Neg=1.613, Ratio=2.45x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.626, Ratio=2.66x, Gap=-3.673
Batch 475/537: Loss=1.2074 (C:1.2074, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.621, Ratio=2.61x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.632, Ratio=2.60x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.622, Ratio=2.56x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.595, Ratio=2.50x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.616, Ratio=2.65x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.594, Ratio=2.45x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.603, Ratio=2.56x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.607, Ratio=2.54x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.631, Ratio=2.70x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.625, Ratio=2.57x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.612, Ratio=2.51x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.634, Ratio=2.63x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.637, Ratio=2.64x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.590, Ratio=2.49x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.618, Ratio=2.54x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.651, Ratio=2.72x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.643, Ratio=2.64x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.52x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.636, Ratio=2.60x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.610, Ratio=2.56x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.595, Ratio=2.49x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.626, Ratio=2.61x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.604, Ratio=2.53x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.612, Ratio=2.55x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.617, Ratio=2.54x, Gap=-3.517
Batch 500/537: Loss=1.2391 (C:1.2391, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.625, Ratio=2.67x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.624, Ratio=2.59x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.609, Ratio=2.62x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.625, Ratio=2.57x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.622, Ratio=2.54x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.618, Ratio=2.61x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.606, Ratio=2.48x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.634, Ratio=2.55x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.608, Ratio=2.59x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.626, Ratio=2.56x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.645, Neg=1.605, Ratio=2.49x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.667, Ratio=2.72x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.617, Ratio=2.63x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.639, Ratio=2.66x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.612, Ratio=2.56x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.639, Ratio=2.62x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.582, Ratio=2.46x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.605, Ratio=2.59x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.617, Ratio=2.51x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.653, Ratio=2.67x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.628, Ratio=2.62x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.626, Ratio=2.63x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.616, Ratio=2.59x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.603, Ratio=2.49x, Gap=-3.801
Batch 525/537: Loss=1.2539 (C:1.2539, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.622, Ratio=2.59x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.614, Ratio=2.60x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.603, Ratio=2.55x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.619, Ratio=2.50x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.609, Ratio=2.57x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.595, Ratio=2.52x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.613, Ratio=2.52x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.603, Ratio=2.49x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.617, Ratio=2.60x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.632, Ratio=2.67x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.618, Ratio=2.68x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.611, Ratio=2.59x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.643, Ratio=2.82x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.646, Ratio=2.76x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.644, Ratio=2.77x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.642, Ratio=2.72x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.639, Ratio=2.78x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.648, Ratio=2.83x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.627, Ratio=2.72x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.619, Ratio=2.66x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.613, Ratio=2.60x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.660, Ratio=2.88x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.645, Ratio=2.71x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.618, Ratio=2.64x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.652, Ratio=2.86x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.616, Ratio=2.60x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.628, Ratio=2.68x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.656, Ratio=2.85x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.626, Ratio=2.73x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.647, Ratio=2.75x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.634, Ratio=2.67x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.607, Ratio=2.59x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.621, Ratio=2.62x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.646, Ratio=2.70x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.633, Ratio=2.70x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.623, Ratio=2.66x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.633, Ratio=2.72x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.652, Ratio=2.72x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.642, Ratio=2.71x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.637, Ratio=2.71x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.658, Ratio=2.88x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.647, Ratio=2.75x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.635, Ratio=2.70x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.631, Ratio=2.72x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.659, Ratio=2.84x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.634, Ratio=2.66x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.647, Ratio=2.73x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.627, Ratio=2.69x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.624, Ratio=2.65x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.649, Ratio=2.76x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.640, Ratio=2.77x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.649, Ratio=2.81x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.642, Ratio=2.75x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.645, Ratio=2.74x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.620, Ratio=2.66x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.72x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.645, Ratio=2.76x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.629, Ratio=2.73x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.625, Ratio=2.69x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.652, Ratio=2.77x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.626, Ratio=2.69x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.625, Ratio=2.66x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.626, Ratio=2.66x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.630, Ratio=2.71x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.604, Ratio=2.67x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.626, Ratio=2.68x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.601, Ratio=2.59x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.647, Ratio=2.74x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.638, Ratio=2.73x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.647, Ratio=2.78x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.605, Ratio=2.59x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.650, Ratio=2.78x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.634, Ratio=2.60x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.634, Ratio=2.68x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.638, Ratio=2.77x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.636, Ratio=2.72x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.638, Ratio=2.74x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.621, Ratio=2.69x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.647, Ratio=2.81x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.646, Ratio=2.76x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.640, Ratio=2.79x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.645, Ratio=2.77x, Gap=-3.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.632, Ratio=2.75x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.631, Ratio=2.70x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.633, Ratio=2.73x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.640, Ratio=2.77x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.633, Ratio=2.73x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.637, Ratio=2.73x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.624, Ratio=2.69x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.638, Ratio=2.74x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.652, Ratio=2.81x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.635, Ratio=2.69x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.635, Ratio=2.80x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.637, Ratio=2.73x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.634, Ratio=2.73x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.617, Ratio=2.62x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.667, Ratio=2.94x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.639, Ratio=2.67x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.624, Ratio=2.68x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.634, Ratio=2.71x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.649, Ratio=2.74x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.656, Ratio=2.82x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.644, Ratio=2.73x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.644, Ratio=2.73x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.650, Ratio=2.80x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.614, Ratio=2.59x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.671, Ratio=2.81x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.638, Ratio=2.63x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.640, Ratio=2.74x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.639, Ratio=2.71x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.628, Ratio=2.76x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.647, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.637, Ratio=2.68x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.624, Ratio=2.64x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.626, Ratio=2.65x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.660, Ratio=2.80x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.630, Ratio=2.69x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.645, Ratio=2.69x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.627, Ratio=2.63x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.639, Ratio=2.69x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.636, Ratio=2.72x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.644, Ratio=2.78x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.637, Ratio=2.72x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.643, Ratio=2.72x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.636, Ratio=2.65x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.646, Ratio=2.76x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.624, Ratio=2.69x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.618, Ratio=2.65x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.635, Ratio=2.70x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.644, Ratio=2.72x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.615, Ratio=2.66x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.612, Ratio=2.57x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.626, Ratio=2.71x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.654, Ratio=2.88x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.640, Ratio=2.75x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.633, Ratio=2.63x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.637, Ratio=2.72x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.639, Ratio=2.70x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.645, Ratio=2.72x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.635, Ratio=2.67x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.617, Ratio=2.63x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.653, Ratio=2.79x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.631, Ratio=2.65x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.639, Ratio=2.68x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.652, Ratio=2.76x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.618, Ratio=2.65x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.625, Ratio=2.66x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.649, Ratio=2.80x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.639, Ratio=2.71x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.652, Ratio=2.79x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.623, Ratio=2.68x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.634, Ratio=2.72x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.635, Ratio=2.80x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.644, Ratio=2.76x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.633, Ratio=2.71x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.606, Ratio=2.58x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.629, Ratio=2.67x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.652, Ratio=2.77x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.644, Ratio=2.75x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.646, Ratio=2.73x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.625, Ratio=2.67x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.636, Ratio=2.66x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.654, Ratio=2.85x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.630, Ratio=2.64x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.646, Ratio=2.85x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.654, Ratio=2.86x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.630, Ratio=2.72x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.619, Ratio=2.63x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.620, Ratio=2.60x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.648, Ratio=2.72x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.651, Ratio=2.76x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.637, Ratio=2.74x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.627, Ratio=2.71x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.72x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.620, Ratio=2.63x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.637, Ratio=2.67x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.642, Ratio=2.79x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.630, Ratio=2.68x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.644, Ratio=2.78x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.622, Ratio=2.62x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.624, Ratio=2.73x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.645, Ratio=2.73x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.600, Ratio=2.60x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.635, Ratio=2.72x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.620, Ratio=2.61x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.634, Ratio=2.62x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.646, Ratio=2.77x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.607, Ratio=2.58x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.646, Ratio=2.75x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.635, Ratio=2.75x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.652, Ratio=2.80x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.616, Ratio=2.65x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.642, Ratio=2.76x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.629, Ratio=2.71x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.632, Ratio=2.68x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.625, Ratio=2.73x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.632, Ratio=2.77x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.623, Ratio=2.69x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.616, Ratio=2.60x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.626, Ratio=2.68x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.645, Ratio=2.78x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.646, Ratio=2.80x, Gap=-3.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.626, Ratio=2.59x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.666, Ratio=2.81x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.634, Ratio=2.68x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.635, Ratio=2.65x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.630, Ratio=2.66x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.640, Ratio=2.75x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.646, Ratio=2.76x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.626, Ratio=2.66x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.635, Ratio=2.72x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.630, Ratio=2.66x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.641, Ratio=2.71x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.638, Ratio=2.73x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.619, Ratio=2.59x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.665, Ratio=2.86x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.631, Ratio=2.71x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.634, Ratio=2.66x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.627, Ratio=2.65x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.635, Ratio=2.72x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.650, Ratio=2.77x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.608, Ratio=2.61x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.628, Ratio=2.68x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.649, Ratio=2.89x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.644, Ratio=2.79x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.640, Ratio=2.72x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.647, Ratio=2.78x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.637, Ratio=2.76x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.627, Ratio=2.68x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.632, Ratio=2.70x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.649, Ratio=2.81x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.634, Ratio=2.74x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.628, Ratio=2.65x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.617, Ratio=2.59x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.641, Ratio=2.76x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.628, Ratio=2.65x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.629, Ratio=2.67x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.654, Ratio=2.77x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.644, Ratio=2.78x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.620, Ratio=2.62x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.628, Ratio=2.68x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.637, Ratio=2.68x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.641, Ratio=2.79x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.651, Ratio=2.86x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.647, Ratio=2.78x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.602, Ratio=2.65x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.631, Ratio=2.72x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.652, Ratio=2.79x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.645, Ratio=2.74x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.628, Ratio=2.68x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.641, Ratio=2.66x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.625, Ratio=2.73x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.597, Ratio=2.58x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.650, Ratio=2.75x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.609, Ratio=2.62x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.643, Ratio=2.75x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.633, Ratio=2.67x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.616, Ratio=2.63x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.634, Ratio=2.73x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.636, Ratio=2.67x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.648, Ratio=2.78x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.645, Ratio=2.75x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.670, Ratio=2.80x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.636, Ratio=2.74x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.626, Ratio=2.72x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.635, Ratio=2.72x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.633, Ratio=2.75x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.634, Ratio=2.68x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.646, Ratio=2.73x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.611, Ratio=2.65x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.637, Ratio=2.70x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.628, Ratio=2.75x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.649, Ratio=2.85x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.622, Ratio=2.62x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.657, Ratio=2.78x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.630, Ratio=2.63x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.620, Ratio=2.60x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.616, Ratio=2.70x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.652, Ratio=2.71x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.647, Ratio=2.78x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.610, Ratio=2.64x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.640, Ratio=2.72x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.652, Ratio=2.79x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.637, Ratio=2.68x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.601, Ratio=2.55x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.642, Ratio=2.77x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.643, Ratio=2.75x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.636, Ratio=2.72x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.619, Ratio=2.59x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.639, Ratio=2.72x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.654, Ratio=2.82x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.622, Ratio=2.70x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.617, Ratio=2.59x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.616, Ratio=2.64x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.616, Ratio=2.64x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.643, Ratio=2.76x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.642, Ratio=2.74x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.627, Ratio=2.71x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.671, Ratio=2.94x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.617, Ratio=2.64x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.621, Ratio=2.65x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.647, Ratio=2.73x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.644, Ratio=2.77x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.640, Ratio=2.76x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.619, Ratio=2.64x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.611, Ratio=2.68x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.623, Ratio=2.66x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.663, Ratio=2.80x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.630, Ratio=2.68x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.620, Ratio=2.66x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.638, Ratio=2.74x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.638, Ratio=2.77x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.641, Ratio=2.68x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.656, Ratio=2.84x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.627, Ratio=2.69x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.631, Ratio=2.68x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.613, Ratio=2.59x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.652, Ratio=2.81x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.635, Ratio=2.64x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.633, Ratio=2.69x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.639, Ratio=2.77x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.659, Ratio=2.79x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.620, Ratio=2.68x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.644, Ratio=2.72x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.621, Ratio=2.68x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.643, Ratio=2.72x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.658, Ratio=2.70x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.631, Ratio=2.77x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.636, Ratio=2.76x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.628, Ratio=2.70x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.651, Ratio=2.78x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.624, Ratio=2.75x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.634, Ratio=2.72x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.625, Ratio=2.71x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.609, Ratio=2.66x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.617, Ratio=2.61x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.643, Ratio=2.77x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.622, Ratio=2.66x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.651, Ratio=2.74x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.653, Ratio=2.75x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.622, Ratio=2.60x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.608, Ratio=2.59x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.618, Ratio=2.70x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.640, Ratio=2.72x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.641, Ratio=2.81x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.634, Ratio=2.67x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.648, Ratio=2.74x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.628, Ratio=2.67x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.639, Ratio=2.69x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.644, Ratio=2.76x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.635, Ratio=2.73x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.634, Ratio=2.70x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.656, Ratio=2.81x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.661, Ratio=2.80x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.658, Ratio=2.79x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.659, Ratio=2.75x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.645, Ratio=2.79x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.645, Ratio=2.74x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.641, Ratio=2.73x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.659, Ratio=2.79x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.647, Ratio=2.76x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.629, Ratio=2.66x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.646, Ratio=2.77x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.634, Ratio=2.73x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.639, Ratio=2.73x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.634, Ratio=2.75x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.650, Ratio=2.75x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.627, Ratio=2.69x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.640, Ratio=2.80x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.646, Ratio=2.81x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.658, Ratio=2.81x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.637, Ratio=2.64x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.633, Ratio=2.72x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.639, Ratio=2.74x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.644, Ratio=2.75x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.623, Ratio=2.65x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.642, Ratio=2.71x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.626, Ratio=2.70x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.644, Ratio=2.78x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.673, Ratio=2.87x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.609, Ratio=2.63x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.646, Ratio=2.73x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.613, Ratio=2.59x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.609, Ratio=2.65x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.647, Ratio=2.76x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.636, Ratio=2.73x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.645, Ratio=2.79x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.624, Ratio=2.71x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.633, Ratio=2.70x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.599, Ratio=2.52x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.658, Ratio=2.80x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.627, Ratio=2.66x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.643, Ratio=2.74x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.644, Ratio=2.74x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.639, Ratio=2.73x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.627, Ratio=2.69x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.645, Ratio=2.71x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.645, Ratio=2.78x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.622, Ratio=2.71x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.654, Ratio=2.86x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.641, Ratio=2.72x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.659, Ratio=2.83x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.609, Ratio=2.56x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.635, Ratio=2.70x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.617, Ratio=2.63x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.648, Ratio=2.77x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.619, Ratio=2.67x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.631, Ratio=2.70x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.644, Ratio=2.83x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.636, Ratio=2.81x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.658, Ratio=2.80x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.631, Ratio=2.81x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.625, Ratio=2.72x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.667, Ratio=2.91x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.691, Ratio=3.03x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.650, Ratio=2.75x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.646, Ratio=2.69x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.656, Ratio=2.82x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.653, Ratio=2.84x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.632, Ratio=2.65x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.611, Ratio=2.67x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.606, Ratio=2.59x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.664, Ratio=2.89x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.623, Ratio=2.65x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.660, Ratio=2.81x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.652, Ratio=2.78x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.625, Ratio=2.67x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.646, Ratio=2.73x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.646, Ratio=2.66x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.631, Ratio=2.66x, Gap=-3.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.628, Ratio=2.69x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.631, Ratio=2.68x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.622, Ratio=2.68x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.639, Ratio=2.69x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.652, Ratio=2.81x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.646, Ratio=2.69x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.644, Ratio=2.69x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.647, Ratio=2.73x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.619, Ratio=2.62x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.631, Ratio=2.76x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.624, Ratio=2.64x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.645, Ratio=2.78x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.654, Ratio=2.86x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.654, Ratio=2.79x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.624, Ratio=2.72x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.617, Ratio=2.68x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.627, Ratio=2.70x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.610, Ratio=2.61x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.683, Ratio=2.94x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.639, Ratio=2.69x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.631, Ratio=2.67x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.658, Ratio=2.75x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.640, Ratio=2.80x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.618, Ratio=2.65x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.638, Ratio=2.72x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.640, Ratio=2.77x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.637, Ratio=2.73x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.630, Ratio=2.69x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.656, Ratio=2.86x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.657, Ratio=2.84x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.643, Ratio=2.71x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.644, Ratio=2.76x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.625, Ratio=2.63x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.642, Ratio=2.81x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.669, Ratio=2.86x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.648, Ratio=2.73x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.634, Ratio=2.63x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.640, Ratio=2.70x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.651, Ratio=2.68x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.651, Ratio=2.77x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.631, Ratio=2.69x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.652, Ratio=2.76x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.613, Ratio=2.66x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.658, Ratio=2.77x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.627, Ratio=2.69x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.647, Ratio=2.80x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.647, Ratio=2.73x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.635, Ratio=2.74x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.632, Ratio=2.64x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.628, Ratio=2.73x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.649, Ratio=2.74x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.631, Ratio=2.68x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.628, Ratio=2.73x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.615, Ratio=2.60x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.651, Ratio=2.84x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.638, Ratio=2.74x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.627, Ratio=2.67x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.639, Ratio=2.76x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.625, Ratio=2.68x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.641, Ratio=2.73x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.625, Ratio=2.70x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.658, Ratio=2.85x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.628, Ratio=2.64x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.630, Ratio=2.70x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.638, Ratio=2.68x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.656, Ratio=2.86x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.617, Ratio=2.57x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.636, Ratio=2.76x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.643, Ratio=2.79x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.624, Ratio=2.64x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.665, Ratio=2.80x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.658, Ratio=2.77x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.644, Ratio=2.74x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.651, Ratio=2.72x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.629, Ratio=2.71x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.637, Ratio=2.72x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.664, Ratio=2.87x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.641, Ratio=2.71x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.633, Ratio=2.70x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.628, Ratio=2.63x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.644, Ratio=2.72x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.654, Ratio=2.73x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.644, Ratio=2.74x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.637, Ratio=2.73x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.610, Ratio=2.53x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.640, Ratio=2.68x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.634, Ratio=2.73x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.640, Ratio=2.72x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.636, Ratio=2.76x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.633, Ratio=2.78x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.637, Ratio=2.78x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.646, Ratio=2.81x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.655, Ratio=2.76x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.642, Ratio=2.77x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.637, Ratio=2.74x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.647, Ratio=2.77x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.639, Ratio=2.71x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.661, Ratio=2.77x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.621, Ratio=2.68x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.637, Ratio=2.70x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.638, Ratio=2.65x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.633, Ratio=2.77x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.652, Ratio=2.81x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.635, Ratio=2.72x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.642, Ratio=2.74x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.637, Ratio=2.77x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.649, Ratio=2.71x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.637, Ratio=2.74x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.638, Ratio=2.83x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.642, Ratio=2.70x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.644, Ratio=2.72x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.613, Ratio=2.60x, Gap=-3.421

============================================================
Epoch 4/20 completed in 39.7s
Train: Loss=1.2344 (C:1.2344, R:0.0105) Ratio=2.49x
Val:   Loss=1.1896 (C:1.1896, R:0.0105) Ratio=2.91x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1896)
============================================================

Epoch 5 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.625, Ratio=2.62x, Gap=-4.200
Batch   0/537: Loss=1.2152 (C:1.2152, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.623, Ratio=2.59x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.632, Ratio=2.64x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.636, Ratio=2.68x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.651, Ratio=2.64x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.654, Ratio=2.75x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.626, Ratio=2.57x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.638, Ratio=2.68x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.635, Ratio=2.64x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.639, Ratio=2.75x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.654, Ratio=2.78x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.625, Ratio=2.67x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.622, Ratio=2.56x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.628, Ratio=2.70x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.623, Ratio=2.61x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.604, Ratio=2.55x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.633, Ratio=2.70x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.619, Ratio=2.65x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.640, Ratio=2.61x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.624, Ratio=2.54x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.634, Ratio=2.60x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.636, Ratio=2.70x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.638, Ratio=2.69x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.642, Ratio=2.67x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.661, Ratio=2.70x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.629, Ratio=2.64x, Gap=-3.777
Batch  25/537: Loss=1.2100 (C:1.2100, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.624, Ratio=2.67x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.602, Ratio=2.49x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.638, Ratio=2.75x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.620, Ratio=2.63x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.647, Ratio=2.71x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.608, Ratio=2.52x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.625, Ratio=2.72x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.614, Ratio=2.58x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.623, Ratio=2.63x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.625, Ratio=2.60x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.617, Ratio=2.63x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.627, Ratio=2.66x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.632, Ratio=2.60x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.624, Ratio=2.61x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.636, Ratio=2.61x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.629, Ratio=2.64x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.632, Ratio=2.71x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.652, Ratio=2.69x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.648, Ratio=2.74x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.637, Ratio=2.67x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.634, Ratio=2.68x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.635, Ratio=2.55x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.621, Ratio=2.59x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.630, Ratio=2.63x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.610, Ratio=2.56x, Gap=-3.855
Batch  50/537: Loss=1.2322 (C:1.2322, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.624, Ratio=2.66x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.596, Ratio=2.52x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.641, Ratio=2.71x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.663, Ratio=2.61x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.641, Ratio=2.60x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.637, Ratio=2.60x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.625, Ratio=2.64x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.645, Ratio=2.70x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.639, Ratio=2.62x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.636, Ratio=2.68x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.627, Ratio=2.60x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.617, Ratio=2.55x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.592, Ratio=2.54x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.614, Ratio=2.67x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.628, Ratio=2.62x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.609, Ratio=2.60x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.637, Ratio=2.67x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.626, Ratio=2.61x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.623, Ratio=2.58x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.636, Ratio=2.69x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.607, Ratio=2.54x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.632, Ratio=2.61x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.602, Ratio=2.55x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.658, Ratio=2.71x, Gap=-3.890
Batch  75/537: Loss=1.1888 (C:1.1888, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.628, Ratio=2.70x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.621, Ratio=2.61x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.657, Ratio=2.72x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.614, Ratio=2.65x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.624, Ratio=2.61x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.622, Ratio=2.67x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.597, Ratio=2.61x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.625, Ratio=2.62x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.629, Ratio=2.64x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.631, Ratio=2.60x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.636, Ratio=2.64x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.615, Ratio=2.61x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.649, Ratio=2.70x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.651, Neg=1.624, Ratio=2.49x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.643, Ratio=2.67x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.632, Ratio=2.64x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.637, Ratio=2.62x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.640, Ratio=2.63x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.608, Ratio=2.53x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.629, Ratio=2.66x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.647, Neg=1.614, Ratio=2.49x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.621, Ratio=2.64x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.613, Ratio=2.63x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.607, Ratio=2.55x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.620, Ratio=2.58x, Gap=-3.777
Batch 100/537: Loss=1.2252 (C:1.2252, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.616, Ratio=2.62x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.635, Ratio=2.71x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.618, Ratio=2.62x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.626, Ratio=2.61x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.644, Ratio=2.69x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.642, Ratio=2.60x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.642, Ratio=2.60x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.649, Ratio=2.61x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.624, Ratio=2.57x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.649, Ratio=2.70x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.626, Ratio=2.61x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.629, Ratio=2.53x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.63x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.657, Ratio=2.79x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.602, Ratio=2.56x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.647, Ratio=2.73x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.622, Ratio=2.59x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.662, Ratio=2.73x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.620, Ratio=2.60x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.617, Ratio=2.59x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.632, Ratio=2.63x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.641, Ratio=2.65x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.620, Ratio=2.59x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.635, Ratio=2.56x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.666, Ratio=2.80x, Gap=-4.036
Batch 125/537: Loss=1.1644 (C:1.1644, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.636, Ratio=2.61x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.641, Ratio=2.69x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.632, Ratio=2.60x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.621, Ratio=2.65x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.635, Ratio=2.65x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.615, Ratio=2.52x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.622, Ratio=2.63x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.625, Ratio=2.66x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.598, Ratio=2.59x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.614, Ratio=2.62x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.632, Ratio=2.76x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.613, Ratio=2.53x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.615, Ratio=2.58x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.615, Ratio=2.66x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.631, Ratio=2.58x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.649, Neg=1.609, Ratio=2.48x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.636, Ratio=2.63x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.634, Ratio=2.65x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.623, Ratio=2.52x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.655, Ratio=2.70x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.623, Ratio=2.65x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.636, Ratio=2.64x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.639, Ratio=2.69x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.622, Ratio=2.64x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.631, Ratio=2.68x, Gap=-3.683
Batch 150/537: Loss=1.1969 (C:1.1969, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.624, Ratio=2.56x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.615, Ratio=2.58x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.623, Ratio=2.68x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.621, Ratio=2.58x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.633, Ratio=2.65x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.622, Ratio=2.64x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.643, Ratio=2.65x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.635, Ratio=2.57x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.634, Ratio=2.66x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.642, Ratio=2.68x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.653, Ratio=2.66x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.625, Ratio=2.66x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.649, Ratio=2.67x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.613, Ratio=2.59x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.638, Ratio=2.65x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.603, Ratio=2.56x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.646, Ratio=2.74x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.623, Ratio=2.64x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.611, Ratio=2.61x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.632, Ratio=2.62x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.609, Ratio=2.54x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.622, Ratio=2.68x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.634, Ratio=2.72x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.629, Ratio=2.57x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.618, Ratio=2.64x, Gap=-3.825
Batch 175/537: Loss=1.2082 (C:1.2082, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.626, Ratio=2.72x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.616, Ratio=2.56x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.633, Ratio=2.67x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.623, Ratio=2.57x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.645, Ratio=2.68x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.655, Ratio=2.66x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.642, Ratio=2.69x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.653, Ratio=2.61x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.638, Ratio=2.63x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.645, Ratio=2.71x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.628, Ratio=2.60x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.629, Ratio=2.62x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.644, Ratio=2.62x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.641, Neg=1.618, Ratio=2.52x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.615, Ratio=2.55x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.623, Ratio=2.54x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.639, Ratio=2.67x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.624, Ratio=2.54x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.637, Ratio=2.66x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.610, Ratio=2.60x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.620, Ratio=2.55x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.624, Ratio=2.66x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.618, Ratio=2.56x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.622, Ratio=2.57x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.652, Ratio=2.76x, Gap=-4.031
Batch 200/537: Loss=1.1778 (C:1.1778, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.629, Ratio=2.62x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.627, Ratio=2.62x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.633, Ratio=2.68x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.632, Ratio=2.77x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.624, Ratio=2.58x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.649, Ratio=2.73x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.629, Ratio=2.65x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.627, Ratio=2.66x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.621, Ratio=2.59x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.612, Ratio=2.59x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.627, Ratio=2.67x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.622, Ratio=2.66x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.617, Ratio=2.59x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.643, Ratio=2.69x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.630, Ratio=2.64x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.636, Ratio=2.65x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.623, Ratio=2.63x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.640, Ratio=2.68x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.631, Ratio=2.53x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.642, Ratio=2.62x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.620, Ratio=2.61x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.633, Ratio=2.67x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.634, Ratio=2.67x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.639, Ratio=2.63x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.605, Ratio=2.52x, Gap=-4.167
Batch 225/537: Loss=1.2475 (C:1.2475, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.613, Ratio=2.55x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.617, Ratio=2.59x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.641, Ratio=2.67x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.628, Ratio=2.65x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.607, Ratio=2.56x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.647, Ratio=2.67x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.641, Ratio=2.63x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.641, Ratio=2.64x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.643, Ratio=2.71x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.614, Ratio=2.52x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.642, Ratio=2.72x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.617, Ratio=2.60x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.648, Ratio=2.66x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.650, Ratio=2.75x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.615, Ratio=2.67x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.625, Ratio=2.56x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.654, Ratio=2.72x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.625, Ratio=2.60x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.638, Ratio=2.61x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.641, Ratio=2.67x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.638, Ratio=2.77x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.650, Ratio=2.67x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.626, Ratio=2.64x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.607, Ratio=2.50x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.609, Ratio=2.59x, Gap=-3.550
Batch 250/537: Loss=1.2259 (C:1.2259, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.608, Ratio=2.57x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.632, Ratio=2.69x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.609, Ratio=2.64x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.618, Ratio=2.65x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.599, Ratio=2.56x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.619, Ratio=2.59x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.627, Ratio=2.66x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.619, Ratio=2.63x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.653, Ratio=2.70x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.628, Ratio=2.55x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.643, Ratio=2.67x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.641, Ratio=2.66x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.615, Ratio=2.61x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.630, Ratio=2.61x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.606, Ratio=2.57x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.624, Ratio=2.69x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.628, Ratio=2.60x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.654, Ratio=2.74x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.631, Ratio=2.56x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.599, Ratio=2.47x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.611, Ratio=2.62x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.643, Ratio=2.66x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.612, Ratio=2.57x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.649, Ratio=2.59x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.626, Ratio=2.52x, Gap=-3.742
Batch 275/537: Loss=1.2465 (C:1.2465, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.626, Ratio=2.60x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.637, Ratio=2.66x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.627, Ratio=2.64x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.645, Ratio=2.67x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.644, Ratio=2.72x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.634, Ratio=2.57x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.633, Ratio=2.60x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.650, Ratio=2.72x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.630, Ratio=2.56x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.650, Ratio=2.70x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.631, Ratio=2.65x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.648, Neg=1.617, Ratio=2.50x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.635, Ratio=2.71x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.617, Ratio=2.62x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.635, Ratio=2.68x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.634, Ratio=2.73x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.641, Ratio=2.72x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.650, Ratio=2.74x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.650, Neg=1.613, Ratio=2.48x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.647, Ratio=2.72x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.614, Ratio=2.55x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.625, Ratio=2.61x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.633, Ratio=2.67x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.630, Ratio=2.73x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.619, Ratio=2.62x, Gap=-3.973
Batch 300/537: Loss=1.2156 (C:1.2156, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.624, Ratio=2.58x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.619, Ratio=2.54x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.649, Ratio=2.69x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.638, Ratio=2.63x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.651, Ratio=2.72x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.628, Ratio=2.55x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.633, Ratio=2.65x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.609, Ratio=2.55x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.626, Ratio=2.57x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.649, Ratio=2.70x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.631, Ratio=2.74x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.611, Ratio=2.59x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.606, Ratio=2.53x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.622, Ratio=2.66x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.603, Ratio=2.58x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.596, Ratio=2.58x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.628, Ratio=2.59x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.616, Ratio=2.59x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.612, Ratio=2.55x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.642, Ratio=2.66x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.640, Ratio=2.61x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.637, Ratio=2.60x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.652, Ratio=2.65x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.636, Ratio=2.60x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.600, Ratio=2.52x, Gap=-3.686
Batch 325/537: Loss=1.2460 (C:1.2460, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.602, Ratio=2.52x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.639, Ratio=2.69x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.626, Ratio=2.58x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.623, Ratio=2.57x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.592, Ratio=2.52x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.599, Ratio=2.60x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.619, Ratio=2.69x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.631, Ratio=2.60x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.633, Ratio=2.68x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.619, Ratio=2.55x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.622, Ratio=2.54x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.631, Ratio=2.56x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.642, Ratio=2.64x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.655, Neg=1.626, Ratio=2.48x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.637, Ratio=2.64x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.631, Ratio=2.66x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.621, Ratio=2.60x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.612, Ratio=2.57x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.605, Ratio=2.49x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.597, Ratio=2.52x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.607, Ratio=2.58x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.625, Ratio=2.64x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.646, Ratio=2.83x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.670, Ratio=2.76x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.662, Ratio=2.69x, Gap=-3.864
Batch 350/537: Loss=1.1968 (C:1.1968, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.622, Ratio=2.61x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.627, Ratio=2.58x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.615, Ratio=2.57x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.630, Ratio=2.66x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.596, Ratio=2.55x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.641, Ratio=2.67x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.647, Ratio=2.75x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.621, Ratio=2.63x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.636, Ratio=2.69x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.611, Ratio=2.63x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.621, Ratio=2.69x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.624, Ratio=2.60x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.636, Ratio=2.63x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.620, Ratio=2.58x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.640, Ratio=2.59x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.630, Ratio=2.58x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.626, Ratio=2.62x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.613, Ratio=2.55x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.652, Ratio=2.66x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.619, Ratio=2.66x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.634, Ratio=2.69x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.644, Ratio=2.69x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.628, Ratio=2.62x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.622, Ratio=2.62x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.627, Ratio=2.61x, Gap=-3.767
Batch 375/537: Loss=1.2178 (C:1.2178, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.586, Ratio=2.50x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.617, Ratio=2.65x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.615, Ratio=2.65x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.614, Ratio=2.66x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.633, Ratio=2.64x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.630, Ratio=2.58x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.616, Ratio=2.55x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.645, Ratio=2.69x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.640, Ratio=2.64x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.675, Ratio=2.69x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.616, Ratio=2.56x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.625, Ratio=2.60x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.647, Ratio=2.70x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.624, Ratio=2.64x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.626, Ratio=2.65x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.605, Ratio=2.57x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.615, Ratio=2.58x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.611, Ratio=2.69x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.637, Ratio=2.70x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.594, Ratio=2.58x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.620, Ratio=2.55x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.611, Ratio=2.54x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.638, Ratio=2.60x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.625, Ratio=2.61x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.624, Ratio=2.56x, Gap=-3.776
Batch 400/537: Loss=1.2325 (C:1.2325, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.627, Ratio=2.69x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.637, Ratio=2.63x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.676, Ratio=2.77x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.622, Ratio=2.60x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.652, Ratio=2.70x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.640, Ratio=2.56x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.647, Ratio=2.59x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.610, Ratio=2.51x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.620, Ratio=2.59x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.585, Ratio=2.49x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.617, Ratio=2.64x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.628, Ratio=2.67x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.636, Ratio=2.66x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.625, Ratio=2.63x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.638, Ratio=2.70x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.614, Ratio=2.57x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.615, Ratio=2.58x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.609, Ratio=2.59x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.618, Ratio=2.64x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.620, Ratio=2.64x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.621, Ratio=2.62x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.642, Neg=1.614, Ratio=2.51x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.644, Ratio=2.70x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.629, Ratio=2.60x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.667, Ratio=2.74x, Gap=-3.986
Batch 425/537: Loss=1.1810 (C:1.1810, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.643, Ratio=2.61x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.649, Ratio=2.71x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.634, Ratio=2.61x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.611, Ratio=2.50x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.626, Ratio=2.65x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.636, Ratio=2.60x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.71x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.623, Ratio=2.57x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.597, Ratio=2.51x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.634, Ratio=2.67x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.636, Ratio=2.67x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.635, Ratio=2.72x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.629, Ratio=2.62x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.609, Ratio=2.55x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.645, Ratio=2.72x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.647, Ratio=2.64x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.622, Ratio=2.54x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.635, Ratio=2.56x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.614, Ratio=2.58x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.641, Ratio=2.65x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.625, Ratio=2.62x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.631, Ratio=2.61x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.645, Ratio=2.69x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.650, Ratio=2.65x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.632, Ratio=2.61x, Gap=-3.985
Batch 450/537: Loss=1.2177 (C:1.2177, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.659, Neg=1.582, Ratio=2.40x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.628, Ratio=2.70x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.590, Ratio=2.59x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.595, Ratio=2.51x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.621, Ratio=2.65x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.629, Ratio=2.64x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.629, Ratio=2.62x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.625, Ratio=2.62x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.639, Ratio=2.69x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.639, Ratio=2.65x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.641, Ratio=2.66x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.654, Ratio=2.69x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.632, Ratio=2.63x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.623, Ratio=2.53x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.642, Ratio=2.70x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.647, Ratio=2.66x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.634, Ratio=2.61x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.638, Ratio=2.61x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.645, Ratio=2.65x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.633, Ratio=2.68x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.630, Ratio=2.67x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.638, Neg=1.642, Ratio=2.57x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.627, Ratio=2.64x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.638, Ratio=2.64x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.617, Ratio=2.53x, Gap=-3.884
Batch 475/537: Loss=1.2426 (C:1.2426, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.662, Ratio=2.70x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.643, Ratio=2.70x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.641, Ratio=2.65x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.623, Ratio=2.58x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.635, Ratio=2.64x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.636, Ratio=2.66x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.628, Ratio=2.57x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.628, Ratio=2.63x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.642, Ratio=2.68x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.637, Ratio=2.64x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.635, Ratio=2.65x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.629, Ratio=2.58x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.637, Ratio=2.73x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.630, Ratio=2.66x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.622, Ratio=2.58x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.630, Ratio=2.66x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.657, Ratio=2.76x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.638, Ratio=2.67x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.641, Ratio=2.67x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.628, Ratio=2.67x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.632, Ratio=2.64x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.619, Ratio=2.64x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.615, Ratio=2.61x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.610, Ratio=2.49x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.623, Ratio=2.64x, Gap=-4.103
Batch 500/537: Loss=1.2132 (C:1.2132, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.632, Ratio=2.68x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.630, Ratio=2.65x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.652, Neg=1.606, Ratio=2.46x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.618, Ratio=2.63x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.640, Ratio=2.72x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.640, Neg=1.619, Ratio=2.53x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.636, Ratio=2.62x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.637, Ratio=2.61x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.624, Ratio=2.60x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.653, Ratio=2.67x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.646, Neg=1.621, Ratio=2.51x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.618, Ratio=2.61x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.628, Ratio=2.57x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.615, Ratio=2.63x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.642, Ratio=2.65x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.624, Ratio=2.59x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.621, Ratio=2.68x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.632, Ratio=2.71x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.605, Ratio=2.58x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.618, Ratio=2.56x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.617, Ratio=2.60x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.637, Neg=1.653, Ratio=2.59x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.661, Ratio=2.73x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.620, Ratio=2.57x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.640, Ratio=2.62x, Gap=-4.025
Batch 525/537: Loss=1.2159 (C:1.2159, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.626, Ratio=2.64x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.641, Ratio=2.64x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.623, Ratio=2.61x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.647, Ratio=2.74x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.648, Ratio=2.68x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.625, Ratio=2.63x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.636, Ratio=2.66x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.626, Ratio=2.60x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.626, Ratio=2.66x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.623, Ratio=2.69x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.644, Ratio=2.69x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.634, Ratio=2.71x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.656, Ratio=2.85x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.665, Ratio=2.99x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.634, Ratio=2.77x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.654, Ratio=2.79x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.644, Ratio=2.79x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.639, Ratio=2.79x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.644, Ratio=2.86x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.637, Ratio=2.79x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.654, Ratio=2.88x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.624, Ratio=2.77x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.651, Ratio=2.83x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.649, Ratio=2.86x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.639, Ratio=2.77x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.648, Ratio=2.86x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.634, Ratio=2.75x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.656, Ratio=2.86x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.623, Ratio=2.62x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.643, Ratio=2.79x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.648, Ratio=2.87x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.627, Ratio=2.68x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.642, Ratio=2.80x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.658, Ratio=2.83x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.648, Ratio=2.87x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.665, Ratio=2.88x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.642, Ratio=2.74x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.630, Ratio=2.76x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.642, Ratio=2.79x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.642, Ratio=2.82x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.639, Ratio=2.76x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.646, Ratio=2.76x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.628, Ratio=2.75x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.643, Ratio=2.77x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.648, Ratio=2.81x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.618, Ratio=2.61x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.632, Ratio=2.79x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.646, Ratio=2.85x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.649, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.631, Ratio=2.68x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.638, Ratio=2.76x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.635, Ratio=2.76x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.642, Ratio=2.83x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.639, Ratio=2.83x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.650, Ratio=2.81x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.660, Ratio=2.96x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.630, Ratio=2.75x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.646, Ratio=2.83x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.657, Ratio=2.83x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.636, Ratio=2.80x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.655, Ratio=2.88x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.647, Ratio=2.77x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.653, Ratio=2.81x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.651, Ratio=2.94x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.636, Ratio=2.80x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.661, Ratio=2.93x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.639, Ratio=2.74x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.655, Ratio=2.84x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.617, Ratio=2.60x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.637, Ratio=2.75x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.633, Ratio=2.73x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.627, Ratio=2.76x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.635, Ratio=2.79x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.632, Ratio=2.79x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.635, Ratio=2.83x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.651, Ratio=2.85x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.656, Ratio=2.76x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.624, Ratio=2.75x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.631, Ratio=2.77x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.642, Ratio=2.78x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.651, Ratio=2.82x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.635, Ratio=2.75x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.639, Ratio=2.75x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.661, Ratio=2.89x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.633, Ratio=2.70x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.634, Ratio=2.80x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.642, Ratio=2.79x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.627, Ratio=2.72x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.648, Ratio=2.86x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.617, Ratio=2.66x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.640, Ratio=2.75x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.649, Ratio=2.83x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.662, Ratio=2.90x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.634, Ratio=2.71x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.652, Ratio=2.70x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.648, Ratio=2.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.644, Ratio=2.80x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.635, Ratio=2.76x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.647, Ratio=2.81x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.659, Ratio=2.87x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.628, Ratio=2.76x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.639, Ratio=2.82x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.639, Ratio=2.75x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.626, Ratio=2.72x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.659, Ratio=2.90x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.641, Ratio=2.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.634, Ratio=2.82x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.643, Ratio=2.79x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.635, Ratio=2.75x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.630, Ratio=2.72x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.637, Ratio=2.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.639, Ratio=2.85x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.656, Ratio=2.85x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.643, Ratio=2.80x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.621, Ratio=2.67x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.603, Ratio=2.58x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.655, Ratio=2.83x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.632, Ratio=2.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.631, Ratio=2.73x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.645, Ratio=2.81x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.624, Ratio=2.75x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.627, Ratio=2.75x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.637, Ratio=2.73x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.624, Ratio=2.75x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.648, Ratio=2.87x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.650, Ratio=2.84x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.665, Ratio=2.89x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.640, Ratio=2.85x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.612, Ratio=2.72x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.641, Ratio=2.83x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.628, Ratio=2.67x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.613, Ratio=2.71x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.643, Ratio=2.81x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.638, Ratio=2.74x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.659, Ratio=2.93x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.630, Ratio=2.74x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.642, Ratio=2.81x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.643, Ratio=2.75x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.642, Ratio=2.78x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.625, Ratio=2.73x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.638, Ratio=2.79x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.646, Ratio=2.86x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.637, Ratio=2.80x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.665, Ratio=2.87x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.668, Ratio=2.95x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.648, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.645, Ratio=2.81x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.652, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.638, Ratio=2.68x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.619, Ratio=2.71x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.627, Ratio=2.83x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.648, Ratio=2.81x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.643, Ratio=2.82x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.651, Ratio=2.79x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.635, Ratio=2.65x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.618, Ratio=2.78x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.627, Ratio=2.76x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.625, Ratio=2.68x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.633, Ratio=2.81x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.638, Ratio=2.78x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.651, Ratio=2.78x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.617, Ratio=2.65x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.662, Ratio=2.88x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.672, Ratio=2.97x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.647, Ratio=2.83x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.636, Ratio=2.75x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.635, Ratio=2.76x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.642, Ratio=2.81x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.661, Ratio=2.96x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.636, Ratio=2.76x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.659, Ratio=2.85x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.643, Ratio=2.81x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.646, Ratio=2.86x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.621, Ratio=2.70x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.627, Ratio=2.73x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.634, Ratio=2.70x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.651, Ratio=2.86x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.615, Ratio=2.56x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.643, Ratio=2.91x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.640, Ratio=2.81x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.625, Ratio=2.66x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.627, Ratio=2.71x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.659, Ratio=2.82x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.620, Ratio=2.66x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.638, Ratio=2.75x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.644, Ratio=2.83x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.625, Ratio=2.77x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.644, Ratio=2.81x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.655, Ratio=2.92x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.637, Ratio=2.82x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.633, Ratio=2.72x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.651, Ratio=2.86x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.635, Ratio=2.79x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.624, Ratio=2.77x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.643, Ratio=2.83x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.616, Ratio=2.70x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.626, Ratio=2.73x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.654, Ratio=2.83x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.648, Ratio=2.78x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.622, Ratio=2.71x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.612, Ratio=2.74x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.607, Ratio=2.56x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.662, Ratio=2.83x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.640, Ratio=2.73x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.633, Ratio=2.77x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.669, Ratio=2.85x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.629, Ratio=2.68x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.643, Ratio=2.80x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.650, Ratio=2.78x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.633, Ratio=2.75x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.643, Ratio=2.77x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.644, Ratio=2.85x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.623, Ratio=2.74x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.644, Ratio=2.81x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.606, Ratio=2.66x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.632, Ratio=2.70x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.627, Ratio=2.74x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.666, Ratio=2.87x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.646, Ratio=2.78x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.616, Ratio=2.71x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.628, Ratio=2.79x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.643, Ratio=2.80x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.633, Ratio=2.83x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.634, Ratio=2.72x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.653, Ratio=2.84x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.644, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.642, Ratio=2.69x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.648, Ratio=2.83x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.635, Ratio=2.76x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.611, Ratio=2.63x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.667, Ratio=2.93x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.657, Ratio=2.85x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.629, Ratio=2.80x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.649, Ratio=2.85x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.633, Ratio=2.75x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.655, Ratio=2.79x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.630, Ratio=2.65x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.635, Ratio=2.81x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.648, Ratio=2.81x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.618, Ratio=2.76x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.630, Ratio=2.72x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.647, Ratio=2.73x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.663, Ratio=2.92x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.668, Ratio=2.94x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.653, Ratio=2.92x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.637, Ratio=2.78x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.642, Ratio=2.86x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.645, Ratio=2.85x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.646, Ratio=2.83x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.639, Ratio=2.73x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.633, Ratio=2.72x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.631, Ratio=2.65x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.624, Ratio=2.73x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.656, Ratio=2.78x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.623, Ratio=2.70x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.645, Ratio=2.73x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.650, Ratio=2.89x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.629, Ratio=2.69x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.650, Ratio=2.85x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.644, Ratio=2.76x, Gap=-3.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.632, Ratio=2.74x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.642, Ratio=2.74x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.632, Ratio=2.72x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.644, Ratio=2.80x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.646, Ratio=2.88x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.649, Ratio=2.79x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.660, Ratio=2.92x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.672, Ratio=3.01x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.646, Ratio=2.84x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.650, Ratio=2.87x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.656, Ratio=2.92x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.631, Ratio=2.75x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.639, Ratio=2.74x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.619, Ratio=2.65x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.647, Ratio=2.80x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.616, Ratio=2.63x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.643, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.654, Ratio=2.82x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.634, Ratio=2.82x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.630, Ratio=2.78x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.645, Ratio=2.82x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.631, Ratio=2.86x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.630, Ratio=2.76x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.629, Ratio=2.79x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.629, Ratio=2.78x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.645, Ratio=2.77x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.628, Ratio=2.73x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.622, Ratio=2.70x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.629, Ratio=2.69x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.636, Ratio=2.72x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.641, Ratio=2.72x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.646, Ratio=2.78x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.626, Ratio=2.75x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.639, Ratio=2.74x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.637, Ratio=2.79x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.628, Ratio=2.79x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.627, Ratio=2.72x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.646, Ratio=2.78x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.642, Ratio=2.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.637, Ratio=2.76x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.649, Ratio=2.79x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.632, Ratio=2.72x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.643, Ratio=2.72x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.641, Ratio=2.71x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.643, Ratio=2.76x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.611, Ratio=2.70x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.641, Ratio=2.81x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.628, Ratio=2.70x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.631, Ratio=2.78x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.632, Ratio=2.71x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.660, Ratio=2.85x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.630, Ratio=2.75x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.646, Ratio=2.83x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.620, Ratio=2.68x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.641, Ratio=2.77x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.665, Ratio=2.81x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.621, Ratio=2.68x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.635, Ratio=2.74x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.625, Ratio=2.74x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.639, Ratio=2.81x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.658, Ratio=2.82x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.645, Ratio=2.81x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.666, Ratio=2.90x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.630, Ratio=2.69x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.636, Ratio=2.72x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.645, Ratio=2.72x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.608, Ratio=2.65x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.643, Ratio=2.80x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.630, Ratio=2.72x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.655, Ratio=2.84x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.644, Ratio=2.73x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.625, Ratio=2.71x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.660, Ratio=2.89x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.628, Ratio=2.73x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.631, Ratio=2.81x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.627, Ratio=2.74x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.612, Ratio=2.66x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.638, Ratio=2.78x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.639, Ratio=2.77x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.637, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.623, Ratio=2.78x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.649, Ratio=2.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.624, Ratio=2.73x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.637, Ratio=2.82x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.642, Ratio=2.75x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.625, Ratio=2.82x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.618, Ratio=2.69x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.647, Ratio=2.80x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.636, Ratio=2.75x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.632, Ratio=2.70x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.643, Ratio=2.74x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.631, Ratio=2.71x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.649, Ratio=2.85x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.626, Ratio=2.71x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.626, Ratio=2.65x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.637, Ratio=2.75x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.629, Ratio=2.83x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.629, Ratio=2.71x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.625, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.650, Ratio=2.80x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.616, Ratio=2.62x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.622, Ratio=2.71x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.652, Ratio=2.85x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.649, Ratio=2.86x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.646, Ratio=2.77x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.643, Ratio=2.85x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.620, Ratio=2.77x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.650, Ratio=2.80x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.642, Ratio=2.79x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.624, Ratio=2.72x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.648, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.643, Ratio=2.79x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.651, Ratio=2.78x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.636, Ratio=2.77x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.622, Ratio=2.71x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.644, Ratio=2.75x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.642, Ratio=2.76x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.645, Ratio=2.82x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.648, Ratio=2.84x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.628, Ratio=2.76x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.654, Ratio=2.80x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.641, Ratio=2.79x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.621, Ratio=2.73x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.652, Ratio=2.85x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.654, Ratio=2.80x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.634, Ratio=2.73x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.642, Ratio=2.78x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.630, Ratio=2.74x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.666, Ratio=2.90x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.625, Ratio=2.71x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.630, Ratio=2.77x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.617, Ratio=2.65x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.634, Ratio=2.85x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.72x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.637, Ratio=2.69x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.647, Ratio=2.75x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.662, Ratio=2.86x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.645, Ratio=2.89x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.618, Ratio=2.65x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.640, Ratio=2.77x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.632, Ratio=2.79x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.647, Ratio=2.82x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.663, Ratio=2.87x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.641, Ratio=2.80x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.625, Ratio=2.76x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.638, Ratio=2.74x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.648, Ratio=2.81x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.626, Ratio=2.74x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.612, Ratio=2.71x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.631, Ratio=2.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.633, Ratio=2.71x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.647, Ratio=2.84x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.620, Ratio=2.75x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.645, Ratio=2.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.643, Ratio=2.77x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.627, Ratio=2.72x, Gap=-3.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.633, Ratio=2.78x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.646, Ratio=2.85x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.647, Ratio=2.83x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.641, Ratio=2.76x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.637, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.647, Ratio=2.83x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.650, Ratio=2.88x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.635, Ratio=2.69x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.635, Ratio=2.82x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.623, Ratio=2.66x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.649, Ratio=2.80x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.614, Ratio=2.67x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.604, Ratio=2.61x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.641, Ratio=2.76x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.632, Ratio=2.74x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.642, Ratio=2.78x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.639, Ratio=2.78x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.628, Ratio=2.67x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.646, Ratio=2.85x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.619, Ratio=2.73x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.642, Ratio=2.78x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.632, Ratio=2.76x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.642, Ratio=2.72x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.632, Ratio=2.78x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.627, Ratio=2.79x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.632, Ratio=2.65x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.637, Ratio=2.74x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.656, Ratio=2.81x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.650, Ratio=2.76x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.649, Ratio=2.86x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.639, Ratio=2.78x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.624, Ratio=2.61x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.643, Ratio=2.81x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.623, Ratio=2.72x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.649, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.618, Ratio=2.69x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.617, Ratio=2.72x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.635, Ratio=2.73x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.648, Ratio=2.78x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.635, Ratio=2.82x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.652, Ratio=2.86x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.634, Ratio=2.82x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.652, Ratio=2.81x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.651, Ratio=2.78x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.661, Ratio=2.89x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.646, Ratio=2.82x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.658, Ratio=2.88x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.662, Ratio=2.87x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.637, Ratio=2.78x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.670, Ratio=2.91x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.649, Ratio=2.88x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.623, Ratio=2.78x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.638, Ratio=2.79x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.641, Ratio=2.77x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.634, Ratio=2.75x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.648, Ratio=2.80x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.648, Ratio=2.79x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.638, Ratio=2.71x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.643, Ratio=2.90x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.643, Ratio=2.89x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.659, Ratio=2.83x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.646, Ratio=2.81x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.628, Ratio=2.84x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.621, Ratio=2.68x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.638, Ratio=2.79x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.637, Ratio=2.72x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.620, Ratio=2.68x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.615, Ratio=2.72x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.641, Ratio=2.79x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.641, Ratio=2.85x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.634, Ratio=2.75x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.660, Ratio=2.81x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.653, Ratio=2.77x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.640, Ratio=2.81x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.642, Ratio=2.74x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.622, Ratio=2.69x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.657, Ratio=2.92x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.657, Ratio=2.86x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.636, Ratio=2.84x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.647, Ratio=2.79x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.632, Ratio=2.82x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.659, Ratio=2.80x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.639, Ratio=2.77x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.646, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.658, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.647, Ratio=2.81x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.647, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.629, Ratio=2.73x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.647, Ratio=2.80x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.640, Ratio=2.71x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.647, Ratio=2.81x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.634, Ratio=2.75x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.645, Ratio=2.81x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.642, Ratio=2.82x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.645, Ratio=2.85x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.665, Ratio=2.86x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.630, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.646, Ratio=2.74x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.660, Ratio=2.86x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.656, Ratio=2.81x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.639, Ratio=2.76x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.652, Ratio=2.85x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.616, Ratio=2.68x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.625, Ratio=2.76x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.617, Ratio=2.66x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.635, Ratio=2.79x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.663, Ratio=2.87x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.641, Ratio=2.76x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.629, Ratio=2.67x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.640, Ratio=2.80x, Gap=-3.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.639, Ratio=2.74x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.632, Ratio=2.75x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.640, Ratio=2.84x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.625, Ratio=2.71x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.647, Ratio=2.82x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.648, Ratio=2.81x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.637, Ratio=2.78x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.650, Ratio=2.82x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.631, Ratio=2.74x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.619, Ratio=2.62x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.649, Ratio=2.86x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.629, Ratio=2.75x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.627, Ratio=2.69x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.628, Ratio=2.77x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.649, Ratio=2.83x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.635, Ratio=2.78x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.639, Ratio=2.82x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.642, Ratio=2.80x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.638, Ratio=2.76x, Gap=-3.661

============================================================
Epoch 5/20 completed in 32.9s
Train: Loss=1.2137 (C:1.2137, R:0.0105) Ratio=2.71x
Val:   Loss=1.1741 (C:1.1741, R:0.0105) Ratio=3.09x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1741)
Checkpoint saved at epoch 5
============================================================

Epoch 6 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.636, Ratio=2.73x, Gap=-3.712
Batch   0/537: Loss=1.1857 (C:1.1857, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.656, Ratio=2.80x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.675, Ratio=2.86x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.631, Ratio=2.73x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.636, Ratio=2.66x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.622, Ratio=2.58x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.661, Ratio=2.77x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.650, Ratio=2.62x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.659, Ratio=2.81x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.651, Ratio=2.77x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.626, Ratio=2.58x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.625, Ratio=2.67x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.640, Ratio=2.67x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.625, Ratio=2.68x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.636, Ratio=2.70x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.653, Ratio=2.70x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.669, Ratio=2.86x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.634, Ratio=2.70x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.639, Ratio=2.65x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.656, Ratio=2.79x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.649, Ratio=2.69x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.666, Ratio=2.75x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.639, Ratio=2.68x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.655, Ratio=2.75x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.640, Ratio=2.72x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.654, Ratio=2.71x, Gap=-3.929
Batch  25/537: Loss=1.1905 (C:1.1905, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.644, Ratio=2.82x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.650, Ratio=2.74x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.630, Ratio=2.67x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.628, Ratio=2.73x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.640, Ratio=2.64x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.650, Ratio=2.71x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.610, Ratio=2.58x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.629, Ratio=2.64x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.641, Ratio=2.76x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.626, Ratio=2.65x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.627, Ratio=2.65x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.637, Ratio=2.60x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.669, Ratio=2.76x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.642, Ratio=2.73x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.615, Ratio=2.59x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.638, Ratio=2.69x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.617, Ratio=2.63x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.636, Ratio=2.81x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.637, Ratio=2.62x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.649, Ratio=2.78x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.659, Ratio=2.77x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.645, Ratio=2.67x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.647, Ratio=2.65x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.620, Ratio=2.56x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.632, Ratio=2.62x, Gap=-3.852
Batch  50/537: Loss=1.2163 (C:1.2163, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.634, Ratio=2.62x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.615, Ratio=2.58x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.655, Ratio=2.76x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.661, Ratio=2.84x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.642, Ratio=2.75x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.627, Ratio=2.76x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.655, Ratio=2.79x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.646, Ratio=2.69x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.631, Ratio=2.66x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.650, Ratio=2.74x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.646, Ratio=2.78x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.662, Ratio=2.81x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.636, Ratio=2.62x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.627, Ratio=2.59x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.645, Ratio=2.66x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.652, Ratio=2.76x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.620, Ratio=2.65x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.655, Ratio=2.72x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.638, Ratio=2.66x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.628, Ratio=2.59x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.638, Ratio=2.62x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.646, Ratio=2.66x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.642, Ratio=2.62x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.639, Ratio=2.70x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.620, Ratio=2.62x, Gap=-3.780
Batch  75/537: Loss=1.2152 (C:1.2152, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.635, Ratio=2.75x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.651, Ratio=2.78x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.656, Ratio=2.72x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.640, Ratio=2.64x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.611, Ratio=2.65x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.626, Ratio=2.71x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.624, Ratio=2.65x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.647, Ratio=2.72x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.641, Ratio=2.63x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.657, Ratio=2.67x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.644, Neg=1.625, Ratio=2.52x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.671, Ratio=2.76x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.639, Ratio=2.71x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.643, Ratio=2.68x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.664, Ratio=2.70x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.638, Ratio=2.69x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.633, Ratio=2.74x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.636, Ratio=2.76x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.636, Ratio=2.70x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.599, Ratio=2.53x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.638, Ratio=2.73x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.64x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.669, Ratio=2.77x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.652, Ratio=2.73x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.638, Ratio=2.69x, Gap=-3.694
Batch 100/537: Loss=1.1972 (C:1.1972, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.632, Ratio=2.65x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.645, Ratio=2.73x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.640, Ratio=2.68x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.623, Ratio=2.66x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.628, Ratio=2.63x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.636, Ratio=2.63x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.645, Ratio=2.71x, Gap=-4.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.645, Ratio=2.69x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.642, Ratio=2.69x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.677, Ratio=2.82x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.625, Ratio=2.61x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.669, Ratio=2.83x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.643, Ratio=2.69x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.670, Ratio=2.82x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.612, Ratio=2.64x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.631, Ratio=2.65x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.673, Ratio=2.82x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.630, Ratio=2.62x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.642, Ratio=2.70x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.631, Ratio=2.62x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.610, Ratio=2.61x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.644, Ratio=2.74x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.647, Ratio=2.84x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.629, Ratio=2.68x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.637, Ratio=2.71x, Gap=-3.747
Batch 125/537: Loss=1.1875 (C:1.1875, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.630, Ratio=2.74x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.659, Ratio=2.87x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.626, Ratio=2.62x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.621, Ratio=2.66x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.629, Ratio=2.60x, Gap=-4.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.616, Ratio=2.62x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.631, Ratio=2.65x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.648, Ratio=2.68x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.674, Ratio=2.79x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.647, Ratio=2.56x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.656, Ratio=2.66x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.679, Ratio=2.81x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.670, Ratio=2.73x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.635, Ratio=2.65x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.629, Ratio=2.60x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.636, Ratio=2.66x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.644, Ratio=2.76x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.631, Ratio=2.74x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.620, Ratio=2.65x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.631, Ratio=2.67x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.645, Ratio=2.79x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.623, Ratio=2.60x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.631, Ratio=2.64x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.638, Ratio=2.76x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.624, Ratio=2.67x, Gap=-3.715
Batch 150/537: Loss=1.2012 (C:1.2012, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.629, Ratio=2.61x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.646, Ratio=2.75x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.651, Ratio=2.74x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.643, Ratio=2.74x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.640, Ratio=2.68x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.668, Ratio=2.70x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.633, Ratio=2.66x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.654, Ratio=2.67x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.637, Ratio=2.60x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.649, Ratio=2.65x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.636, Ratio=2.62x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.636, Ratio=2.67x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.637, Ratio=2.76x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.642, Ratio=2.72x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.640, Ratio=2.69x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.618, Ratio=2.59x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.643, Ratio=2.72x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.630, Ratio=2.65x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.632, Ratio=2.66x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.637, Ratio=2.67x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.643, Ratio=2.66x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.643, Ratio=2.73x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.620, Ratio=2.60x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.638, Ratio=2.68x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.642, Ratio=2.69x, Gap=-4.137
Batch 175/537: Loss=1.1973 (C:1.1973, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.637, Ratio=2.62x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.650, Ratio=2.73x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.625, Ratio=2.57x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.645, Ratio=2.69x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.632, Ratio=2.66x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.627, Ratio=2.65x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.642, Ratio=2.63x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.662, Ratio=2.75x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.637, Ratio=2.67x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.658, Ratio=2.71x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.639, Ratio=2.63x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.644, Ratio=2.77x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.630, Ratio=2.66x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.631, Ratio=2.60x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.625, Ratio=2.62x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.635, Ratio=2.68x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.672, Ratio=2.80x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.628, Ratio=2.61x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.643, Ratio=2.69x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.641, Ratio=2.67x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.629, Ratio=2.70x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.630, Ratio=2.63x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.653, Ratio=2.72x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.633, Ratio=2.65x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.641, Ratio=2.68x, Gap=-3.915
Batch 200/537: Loss=1.1967 (C:1.1967, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.648, Ratio=2.66x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.639, Ratio=2.74x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.657, Ratio=2.74x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.621, Ratio=2.65x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.71x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.608, Ratio=2.60x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.607, Ratio=2.55x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.651, Ratio=2.68x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.615, Ratio=2.65x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.641, Ratio=2.67x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.638, Ratio=2.69x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.661, Ratio=2.75x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.52x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.622, Ratio=2.59x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.628, Ratio=2.65x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.663, Ratio=2.72x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.621, Ratio=2.59x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.675, Ratio=2.82x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.608, Ratio=2.59x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.638, Ratio=2.64x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.613, Ratio=2.58x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.636, Neg=1.623, Ratio=2.55x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.619, Ratio=2.62x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.625, Ratio=2.64x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.635, Ratio=2.74x, Gap=-3.839
Batch 225/537: Loss=1.1818 (C:1.1818, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.628, Ratio=2.67x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.607, Ratio=2.51x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.632, Ratio=2.66x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.650, Ratio=2.66x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.653, Ratio=2.66x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.620, Ratio=2.64x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.655, Ratio=2.71x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.619, Ratio=2.60x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.649, Ratio=2.74x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.658, Ratio=2.75x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.612, Ratio=2.62x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.623, Ratio=2.60x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.639, Ratio=2.72x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.644, Ratio=2.70x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.649, Ratio=2.76x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.662, Ratio=2.79x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.636, Ratio=2.67x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.634, Neg=1.632, Ratio=2.57x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.660, Ratio=2.73x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.638, Ratio=2.61x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.647, Ratio=2.63x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.664, Ratio=2.77x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.626, Ratio=2.64x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.616, Ratio=2.66x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.632, Ratio=2.60x, Gap=-3.652
Batch 250/537: Loss=1.2208 (C:1.2208, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.620, Ratio=2.60x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.630, Ratio=2.71x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.639, Ratio=2.72x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.646, Ratio=2.70x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.633, Ratio=2.73x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.638, Ratio=2.61x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.659, Ratio=2.72x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.667, Ratio=2.79x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.647, Ratio=2.67x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.643, Ratio=2.73x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.647, Ratio=2.77x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.617, Ratio=2.59x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.632, Ratio=2.69x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.637, Ratio=2.66x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.623, Ratio=2.64x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.63x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.616, Ratio=2.58x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.629, Ratio=2.70x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.635, Ratio=2.62x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.673, Ratio=2.80x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.642, Ratio=2.76x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.617, Ratio=2.65x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.638, Ratio=2.67x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.613, Ratio=2.64x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-4.013
Batch 275/537: Loss=1.1910 (C:1.1910, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.608, Ratio=2.60x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.625, Ratio=2.65x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.632, Ratio=2.71x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.622, Ratio=2.60x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.645, Ratio=2.65x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.668, Ratio=2.84x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.629, Ratio=2.64x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.660, Ratio=2.76x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.631, Ratio=2.57x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.666, Ratio=2.75x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.632, Neg=1.634, Ratio=2.58x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.653, Neg=1.628, Ratio=2.49x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.613, Ratio=2.56x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.632, Ratio=2.64x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.643, Ratio=2.67x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.639, Ratio=2.67x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.654, Ratio=2.78x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.645, Ratio=2.67x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.644, Ratio=2.79x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.643, Ratio=2.68x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.614, Ratio=2.61x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.622, Ratio=2.70x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.635, Ratio=2.76x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.617, Ratio=2.69x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.630, Ratio=2.64x, Gap=-3.901
Batch 300/537: Loss=1.2090 (C:1.2090, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.630, Ratio=2.68x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.613, Ratio=2.61x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.617, Ratio=2.70x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.653, Ratio=2.77x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.650, Ratio=2.80x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.658, Ratio=2.68x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.647, Ratio=2.70x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.624, Ratio=2.66x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.659, Ratio=2.74x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.626, Ratio=2.61x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.627, Ratio=2.61x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.648, Ratio=2.65x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.63x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.657, Ratio=2.71x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.639, Ratio=2.69x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.628, Ratio=2.68x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.651, Ratio=2.63x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.638, Ratio=2.71x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.640, Ratio=2.65x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.640, Ratio=2.76x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.626, Ratio=2.64x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.638, Ratio=2.71x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.643, Ratio=2.79x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.647, Ratio=2.73x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.644, Ratio=2.75x, Gap=-3.773
Batch 325/537: Loss=1.1789 (C:1.1789, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.633, Ratio=2.70x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.632, Ratio=2.65x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.623, Ratio=2.63x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.639, Ratio=2.68x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.646, Ratio=2.66x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.662, Ratio=2.71x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.628, Ratio=2.70x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.614, Ratio=2.60x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.620, Ratio=2.63x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.656, Ratio=2.74x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.622, Ratio=2.63x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.630, Ratio=2.70x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.649, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.650, Ratio=2.71x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.659, Ratio=2.84x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.649, Ratio=2.70x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.650, Ratio=2.70x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.639, Ratio=2.65x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.656, Ratio=2.78x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.637, Ratio=2.68x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.628, Ratio=2.64x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.650, Ratio=2.74x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.618, Ratio=2.61x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.633, Ratio=2.78x, Gap=-3.501
Batch 350/537: Loss=1.1727 (C:1.1727, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.644, Ratio=2.71x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.650, Ratio=2.70x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.654, Ratio=2.68x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.663, Ratio=2.72x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.627, Ratio=2.62x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.627, Ratio=2.66x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.666, Ratio=2.77x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.643, Ratio=2.70x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.642, Ratio=2.68x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.665, Ratio=2.74x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.635, Neg=1.622, Ratio=2.55x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.625, Ratio=2.60x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.617, Ratio=2.61x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.632, Ratio=2.69x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.642, Ratio=2.69x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.657, Ratio=2.74x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.630, Ratio=2.68x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.629, Ratio=2.68x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.637, Ratio=2.71x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.638, Ratio=2.72x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.649, Ratio=2.72x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.643, Ratio=2.68x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.652, Ratio=2.71x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.666, Ratio=2.71x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.638, Ratio=2.69x, Gap=-3.883
Batch 375/537: Loss=1.1956 (C:1.1956, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.660, Ratio=2.79x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.643, Ratio=2.61x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.614, Ratio=2.62x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.632, Ratio=2.64x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.625, Ratio=2.59x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.646, Ratio=2.73x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.613, Ratio=2.56x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.625, Ratio=2.68x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.629, Ratio=2.71x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.641, Ratio=2.74x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.629, Ratio=2.64x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.623, Ratio=2.68x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.624, Ratio=2.63x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.625, Ratio=2.62x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.629, Ratio=2.61x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.650, Ratio=2.68x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.639, Ratio=2.67x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.632, Ratio=2.74x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.670, Ratio=2.80x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.628, Ratio=2.65x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.637, Ratio=2.69x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.640, Ratio=2.62x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.621, Ratio=2.63x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.630, Neg=1.629, Ratio=2.58x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.644, Ratio=2.64x, Gap=-3.636
Batch 400/537: Loss=1.2108 (C:1.2108, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.669, Ratio=2.76x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.641, Ratio=2.61x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.651, Ratio=2.69x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.653, Ratio=2.74x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.620, Ratio=2.62x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.647, Ratio=2.68x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.618, Neg=1.624, Ratio=2.63x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.634, Ratio=2.70x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.639, Ratio=2.70x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.636, Ratio=2.68x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.626, Ratio=2.64x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.659, Ratio=2.72x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.636, Ratio=2.67x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.653, Ratio=2.65x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.636, Ratio=2.70x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.648, Ratio=2.75x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.667, Ratio=2.79x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.643, Ratio=2.71x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.641, Ratio=2.72x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.640, Ratio=2.65x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.667, Ratio=2.85x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.628, Neg=1.615, Ratio=2.57x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.646, Ratio=2.78x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.619, Ratio=2.70x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.656, Ratio=2.75x, Gap=-3.732
Batch 425/537: Loss=1.1806 (C:1.1806, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.618, Ratio=2.65x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.640, Ratio=2.72x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.619, Ratio=2.59x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.637, Ratio=2.64x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.656, Ratio=2.72x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.646, Ratio=2.64x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.632, Ratio=2.65x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.641, Ratio=2.73x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.643, Ratio=2.68x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.627, Ratio=2.65x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.650, Ratio=2.64x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.626, Ratio=2.63x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.622, Ratio=2.60x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.631, Ratio=2.65x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.626, Ratio=2.60x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.671, Ratio=2.77x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.647, Ratio=2.70x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.621, Ratio=2.61x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.637, Ratio=2.70x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.639, Ratio=2.65x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.617, Ratio=2.67x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.639, Ratio=2.73x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.612, Ratio=2.56x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.629, Ratio=2.65x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.630, Ratio=2.69x, Gap=-3.771
Batch 450/537: Loss=1.1946 (C:1.1946, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.638, Ratio=2.76x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.651, Ratio=2.74x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.662, Ratio=2.86x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.612, Ratio=2.59x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.636, Ratio=2.69x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.625, Ratio=2.58x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.654, Ratio=2.73x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.644, Ratio=2.72x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.641, Ratio=2.68x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.673, Ratio=2.78x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.665, Ratio=2.71x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.658, Ratio=2.70x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.644, Ratio=2.68x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.633, Neg=1.644, Ratio=2.60x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.630, Ratio=2.62x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.634, Ratio=2.61x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.640, Ratio=2.68x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.622, Ratio=2.76x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.623, Ratio=2.62x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.664, Ratio=2.82x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.624, Ratio=2.64x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.645, Ratio=2.75x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.654, Ratio=2.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.648, Ratio=2.76x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.636, Ratio=2.65x, Gap=-4.018
Batch 475/537: Loss=1.2056 (C:1.2056, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.633, Ratio=2.65x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.655, Ratio=2.72x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.633, Ratio=2.60x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.659, Ratio=2.75x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.625, Neg=1.645, Ratio=2.63x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.661, Ratio=2.75x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.621, Neg=1.641, Ratio=2.64x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.637, Ratio=2.72x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.645, Ratio=2.72x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.643, Ratio=2.76x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.646, Ratio=2.77x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.613, Ratio=2.59x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.615, Ratio=2.59x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.631, Neg=1.627, Ratio=2.58x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.636, Ratio=2.65x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.653, Ratio=2.69x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.670, Ratio=2.74x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.683, Ratio=2.80x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.627, Neg=1.643, Ratio=2.62x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.643, Ratio=2.69x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.646, Ratio=2.68x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.639, Neg=1.615, Ratio=2.53x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.628, Ratio=2.70x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.612, Ratio=2.67x, Gap=-3.611
Batch 500/537: Loss=1.2033 (C:1.2033, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.638, Ratio=2.72x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.645, Ratio=2.77x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.628, Ratio=2.71x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.629, Neg=1.612, Ratio=2.56x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.643, Neg=1.601, Ratio=2.49x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.638, Ratio=2.69x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.653, Ratio=2.75x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.624, Ratio=2.60x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.622, Neg=1.618, Ratio=2.60x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.622, Ratio=2.62x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.623, Ratio=2.59x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.638, Ratio=2.66x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.656, Ratio=2.75x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.650, Ratio=2.71x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.660, Neg=1.616, Ratio=2.45x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.620, Neg=1.639, Ratio=2.64x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.657, Ratio=2.76x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.654, Ratio=2.79x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.624, Neg=1.649, Ratio=2.64x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.620, Ratio=2.65x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.619, Neg=1.649, Ratio=2.67x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.626, Neg=1.625, Ratio=2.59x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.658, Ratio=2.77x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.650, Ratio=2.68x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.633, Ratio=2.70x, Gap=-3.738
Batch 525/537: Loss=1.1913 (C:1.1913, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.628, Ratio=2.66x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.637, Ratio=2.71x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.652, Ratio=2.75x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.617, Ratio=2.62x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.647, Ratio=2.76x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.617, Neg=1.645, Ratio=2.67x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.623, Ratio=2.65x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.652, Ratio=2.83x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.643, Ratio=2.67x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.639, Ratio=2.68x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.654, Ratio=2.69x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.672, Ratio=2.95x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.636, Ratio=2.75x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.669, Ratio=2.89x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.656, Ratio=2.81x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.645, Ratio=2.84x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.688, Ratio=3.01x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.625, Ratio=2.74x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.653, Ratio=2.72x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.652, Ratio=2.70x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.653, Ratio=2.80x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.636, Ratio=2.69x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.647, Ratio=2.77x, Gap=-3.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.623, Neg=1.624, Ratio=2.61x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.649, Ratio=2.81x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.668, Ratio=2.93x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.672, Ratio=2.98x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.656, Ratio=2.85x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.657, Ratio=2.81x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.641, Ratio=2.77x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.644, Ratio=2.70x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.656, Ratio=2.87x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.663, Ratio=2.77x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.648, Ratio=2.78x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.651, Ratio=2.81x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.667, Ratio=2.85x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.657, Ratio=2.78x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.647, Ratio=2.74x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.665, Ratio=2.86x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.660, Ratio=2.86x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.661, Ratio=2.91x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.645, Ratio=2.78x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.658, Ratio=2.84x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.675, Ratio=2.88x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.645, Ratio=2.68x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.690, Ratio=3.02x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.654, Ratio=2.82x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.624, Ratio=2.66x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.657, Ratio=2.84x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.680, Ratio=2.96x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.650, Ratio=2.83x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.650, Ratio=2.81x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.646, Ratio=2.82x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.655, Ratio=2.88x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.681, Ratio=3.01x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.670, Ratio=2.95x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.657, Ratio=2.82x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.665, Ratio=2.89x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.652, Ratio=2.92x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.654, Ratio=2.79x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.668, Ratio=2.86x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.666, Ratio=2.97x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.657, Ratio=2.82x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.641, Ratio=2.72x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.658, Ratio=2.81x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.655, Ratio=2.89x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.661, Ratio=2.93x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.638, Ratio=2.75x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.649, Ratio=2.76x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.643, Ratio=2.76x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.629, Ratio=2.72x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.670, Ratio=2.93x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.653, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.648, Ratio=2.72x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.640, Ratio=2.81x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.650, Ratio=2.75x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.672, Ratio=2.96x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.659, Ratio=2.87x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.638, Ratio=2.79x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.685, Ratio=2.98x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.667, Ratio=2.89x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.650, Ratio=2.79x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.664, Ratio=2.89x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.658, Ratio=2.81x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.655, Ratio=2.76x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.666, Ratio=2.87x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.671, Ratio=2.87x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.656, Ratio=2.80x, Gap=-3.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.650, Ratio=2.77x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.646, Ratio=2.73x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.672, Ratio=2.86x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.673, Ratio=2.90x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.665, Ratio=2.82x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.654, Ratio=2.80x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.656, Ratio=2.82x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.640, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.658, Ratio=2.77x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.657, Ratio=2.85x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.652, Ratio=2.88x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.648, Ratio=2.74x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.675, Ratio=2.95x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.655, Ratio=2.91x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.657, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.650, Ratio=2.84x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.662, Ratio=2.84x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.660, Ratio=2.85x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.664, Ratio=2.81x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.660, Ratio=2.82x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.659, Ratio=2.80x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.666, Ratio=2.84x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.673, Ratio=2.92x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.665, Ratio=2.89x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.639, Ratio=2.82x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.645, Ratio=2.74x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.633, Ratio=2.80x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.656, Ratio=2.83x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.657, Ratio=2.78x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.653, Ratio=2.84x, Gap=-3.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.661, Ratio=2.81x, Gap=-3.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.645, Ratio=2.77x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.652, Ratio=2.89x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.678, Ratio=2.89x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.656, Ratio=2.84x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.649, Ratio=2.82x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.668, Ratio=2.88x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.637, Ratio=2.74x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.664, Ratio=2.79x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.609, Neg=1.643, Ratio=2.70x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.639, Ratio=2.78x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.676, Ratio=2.93x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.634, Ratio=2.77x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.701, Ratio=3.04x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.645, Ratio=2.72x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.663, Ratio=2.88x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.653, Ratio=2.79x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.655, Ratio=2.81x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.651, Ratio=2.92x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.656, Ratio=2.84x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.665, Ratio=2.86x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.642, Ratio=2.79x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.655, Ratio=2.81x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.655, Ratio=2.81x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.666, Ratio=2.90x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.647, Ratio=2.81x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.651, Ratio=2.79x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.668, Ratio=2.87x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.639, Ratio=2.71x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.654, Ratio=2.89x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.653, Ratio=2.80x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.630, Ratio=2.72x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.647, Ratio=2.77x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.661, Ratio=2.85x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.639, Ratio=2.72x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.663, Ratio=2.80x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.667, Ratio=2.84x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.691, Ratio=2.95x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.650, Ratio=2.90x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.647, Ratio=2.77x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.664, Ratio=2.86x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.660, Ratio=2.83x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.653, Ratio=2.86x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.650, Ratio=2.78x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.684, Ratio=2.90x, Gap=-3.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.652, Ratio=2.85x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.661, Ratio=2.94x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.668, Ratio=2.86x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.657, Ratio=2.84x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.662, Ratio=2.93x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.661, Ratio=2.84x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.690, Ratio=2.99x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.641, Ratio=2.84x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.649, Ratio=2.83x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.663, Ratio=2.86x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.670, Ratio=3.01x, Gap=-3.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.633, Ratio=2.71x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.653, Ratio=2.79x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.628, Ratio=2.70x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.653, Ratio=2.78x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.661, Ratio=2.91x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.669, Ratio=2.85x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.651, Ratio=2.76x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.672, Ratio=2.84x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.661, Ratio=2.88x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.673, Ratio=2.97x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.614, Neg=1.626, Ratio=2.65x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.652, Ratio=2.83x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.643, Ratio=2.83x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.651, Ratio=2.80x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.658, Ratio=2.88x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.652, Ratio=2.85x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.639, Ratio=2.75x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.676, Ratio=2.90x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.639, Ratio=2.75x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.640, Ratio=2.73x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.645, Ratio=2.78x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.612, Neg=1.634, Ratio=2.67x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.648, Ratio=2.81x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.642, Ratio=2.71x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.641, Ratio=2.71x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.642, Ratio=2.77x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.665, Ratio=2.86x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.647, Ratio=2.82x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.660, Ratio=2.89x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.648, Ratio=2.79x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.666, Ratio=2.91x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.676, Ratio=2.90x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.667, Ratio=2.97x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.648, Ratio=2.75x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.663, Ratio=2.87x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.639, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.669, Ratio=2.81x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.628, Ratio=2.72x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.653, Ratio=2.89x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.640, Ratio=2.73x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.656, Ratio=2.78x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.647, Ratio=2.75x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.657, Ratio=2.84x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.661, Ratio=2.87x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.670, Ratio=2.87x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.668, Ratio=2.83x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.664, Ratio=2.84x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.656, Ratio=2.77x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.674, Ratio=2.91x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.663, Ratio=2.86x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.669, Ratio=2.86x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.658, Ratio=2.85x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.649, Ratio=2.75x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.622, Ratio=2.77x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.658, Ratio=2.78x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.639, Ratio=2.84x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.654, Ratio=2.81x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.643, Ratio=2.73x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.652, Ratio=2.79x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.661, Ratio=2.88x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.654, Ratio=2.82x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.654, Ratio=2.88x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.655, Ratio=2.82x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.632, Ratio=2.76x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.640, Ratio=2.69x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.664, Ratio=2.88x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.636, Ratio=2.70x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.645, Ratio=2.78x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.662, Ratio=2.81x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.664, Ratio=2.87x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.674, Ratio=2.87x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.659, Ratio=2.88x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.636, Ratio=2.76x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.616, Neg=1.641, Ratio=2.66x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.637, Ratio=2.71x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.660, Ratio=2.82x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.656, Ratio=2.81x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.653, Ratio=2.81x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.666, Ratio=2.81x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.637, Ratio=2.80x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.651, Ratio=2.76x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.643, Ratio=2.72x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.655, Ratio=2.82x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.641, Ratio=2.87x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.652, Ratio=2.81x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.645, Ratio=2.72x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.666, Ratio=2.88x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.648, Ratio=2.77x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.661, Ratio=2.85x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.671, Ratio=2.91x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.630, Ratio=2.75x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.655, Ratio=2.86x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.658, Ratio=2.83x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.645, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.659, Ratio=2.91x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.669, Ratio=2.92x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.648, Ratio=2.78x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.647, Ratio=2.76x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.644, Ratio=2.74x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.657, Ratio=2.81x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.677, Ratio=2.85x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.657, Ratio=2.90x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.637, Ratio=2.73x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.654, Ratio=2.80x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.639, Ratio=2.73x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.655, Ratio=2.85x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.652, Ratio=2.82x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.648, Ratio=2.73x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.663, Ratio=2.82x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.655, Ratio=2.80x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.651, Ratio=2.81x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.679, Ratio=2.92x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.671, Ratio=2.92x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.638, Ratio=2.76x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.653, Ratio=2.90x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.668, Ratio=2.91x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.626, Ratio=2.69x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.668, Ratio=2.86x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.662, Ratio=2.90x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.667, Ratio=2.81x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.663, Ratio=2.94x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.661, Ratio=2.89x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.646, Ratio=2.73x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.647, Ratio=2.89x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.649, Ratio=2.79x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.654, Ratio=2.94x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.655, Ratio=2.81x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.667, Ratio=2.86x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.688, Ratio=2.96x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.661, Ratio=2.87x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.656, Ratio=2.89x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.615, Neg=1.639, Ratio=2.67x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.668, Ratio=2.83x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.665, Ratio=2.83x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.653, Ratio=2.91x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.673, Ratio=2.94x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.666, Ratio=2.82x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.652, Ratio=2.84x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.647, Ratio=2.78x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.652, Ratio=2.82x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.656, Ratio=2.83x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.647, Ratio=2.87x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.646, Ratio=2.81x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.661, Ratio=2.87x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.668, Ratio=2.99x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.658, Ratio=2.84x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.672, Ratio=2.84x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.654, Ratio=2.80x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.649, Ratio=2.84x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.654, Ratio=2.93x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.672, Ratio=2.91x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.658, Ratio=2.84x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.638, Ratio=2.72x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.638, Ratio=2.79x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.657, Ratio=2.88x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.648, Ratio=2.79x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.657, Ratio=2.87x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.641, Ratio=2.76x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.662, Ratio=2.81x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.643, Ratio=2.82x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.659, Ratio=2.87x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.652, Ratio=2.78x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.627, Ratio=2.73x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.669, Ratio=2.95x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.636, Ratio=2.85x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.657, Ratio=2.92x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.671, Ratio=2.96x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.667, Ratio=2.87x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.650, Ratio=2.71x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.648, Ratio=2.78x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.682, Ratio=2.91x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.675, Ratio=2.88x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.662, Ratio=2.88x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.653, Ratio=2.76x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.656, Ratio=2.79x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.671, Ratio=2.90x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.665, Ratio=2.85x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.647, Ratio=2.83x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.643, Ratio=2.73x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.671, Ratio=2.87x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.641, Ratio=2.82x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.657, Ratio=2.75x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.638, Ratio=2.79x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.667, Ratio=2.89x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.663, Ratio=2.89x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.680, Ratio=2.93x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.645, Ratio=2.79x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.643, Ratio=2.77x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.652, Ratio=2.85x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.637, Ratio=2.80x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.653, Ratio=2.75x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.666, Ratio=2.80x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.646, Ratio=2.75x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.653, Ratio=2.83x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.631, Ratio=2.73x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.657, Ratio=2.85x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.665, Ratio=2.92x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.681, Ratio=2.92x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.635, Ratio=2.81x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.653, Ratio=2.84x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.665, Ratio=2.97x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.632, Ratio=2.73x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.678, Ratio=2.93x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.600, Neg=1.651, Ratio=2.75x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.667, Ratio=2.95x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.664, Ratio=2.90x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.655, Ratio=2.88x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.632, Ratio=2.73x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.649, Ratio=2.79x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.690, Ratio=2.98x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.657, Ratio=2.80x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.667, Ratio=2.88x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.669, Ratio=2.91x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.656, Ratio=2.86x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.660, Ratio=2.92x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.630, Ratio=2.75x, Gap=-3.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.661, Ratio=2.88x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.664, Ratio=2.80x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.658, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.669, Ratio=2.92x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.668, Ratio=2.85x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.670, Ratio=2.90x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.644, Ratio=2.83x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.656, Ratio=2.81x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.662, Ratio=2.87x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.602, Neg=1.634, Ratio=2.71x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.645, Ratio=2.80x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.673, Ratio=2.97x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.664, Ratio=2.86x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.658, Ratio=2.95x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.646, Ratio=2.71x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.668, Ratio=2.89x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.645, Ratio=2.77x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.653, Ratio=2.89x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.647, Ratio=2.78x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.639, Ratio=2.69x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.677, Ratio=2.95x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.605, Neg=1.633, Ratio=2.70x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.664, Ratio=2.80x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.649, Ratio=2.78x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.663, Ratio=2.81x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.654, Ratio=2.84x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.637, Ratio=2.80x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.656, Ratio=2.87x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.654, Ratio=2.84x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.642, Ratio=2.83x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.660, Ratio=2.84x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.655, Ratio=2.77x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.661, Ratio=2.82x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.673, Ratio=3.02x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.664, Ratio=2.84x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.660, Ratio=2.81x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.647, Ratio=2.81x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.660, Ratio=2.88x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.661, Ratio=2.87x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.670, Ratio=2.93x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.647, Ratio=2.78x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.678, Ratio=2.95x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.628, Ratio=2.68x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.684, Ratio=2.89x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.650, Ratio=2.82x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.650, Ratio=2.84x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.645, Ratio=2.78x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.657, Ratio=2.89x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.655, Ratio=2.77x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.664, Ratio=2.83x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.638, Ratio=2.76x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.633, Ratio=2.80x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.607, Neg=1.634, Ratio=2.69x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.626, Ratio=2.77x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.642, Ratio=2.83x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.652, Ratio=2.87x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.662, Ratio=2.87x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.661, Ratio=2.80x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.651, Ratio=2.88x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.640, Ratio=2.71x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.652, Ratio=2.82x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.643, Ratio=2.81x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.654, Ratio=2.78x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.610, Neg=1.653, Ratio=2.71x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.678, Ratio=2.88x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.661, Ratio=2.80x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.657, Ratio=2.81x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.662, Ratio=2.92x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.662, Ratio=2.81x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.642, Ratio=2.79x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.649, Ratio=2.85x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.692, Ratio=3.03x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.647, Ratio=2.82x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.599, Neg=1.639, Ratio=2.73x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.620, Ratio=2.73x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.655, Ratio=2.77x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.668, Ratio=2.86x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.651, Ratio=2.84x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.649, Ratio=2.82x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.627, Ratio=2.77x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.645, Ratio=2.78x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.601, Neg=1.651, Ratio=2.75x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.643, Ratio=2.72x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.659, Ratio=2.86x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.669, Ratio=2.86x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.647, Ratio=2.77x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.648, Ratio=2.82x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.670, Ratio=2.89x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.661, Ratio=2.89x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.658, Ratio=2.75x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.674, Ratio=2.88x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.640, Ratio=2.79x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.613, Neg=1.630, Ratio=2.66x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.649, Ratio=2.78x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.644, Ratio=2.76x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.670, Ratio=2.90x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.673, Ratio=2.88x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.663, Ratio=2.85x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.664, Ratio=2.90x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.645, Ratio=2.78x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.661, Ratio=2.81x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.595, Neg=1.657, Ratio=2.79x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.644, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.668, Ratio=2.87x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.657, Ratio=2.91x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.640, Ratio=2.81x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.668, Ratio=2.89x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.648, Ratio=2.77x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.678, Ratio=2.95x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.650, Ratio=2.80x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.660, Ratio=2.86x, Gap=-3.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.671, Ratio=2.88x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.628, Ratio=2.73x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.666, Ratio=2.82x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.652, Ratio=2.93x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.653, Ratio=2.91x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.677, Ratio=2.97x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.666, Ratio=2.82x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.663, Ratio=2.83x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.660, Ratio=2.90x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.653, Ratio=2.85x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.663, Ratio=2.79x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.653, Ratio=2.77x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.664, Ratio=2.83x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.667, Ratio=2.93x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.668, Ratio=2.90x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.589, Neg=1.668, Ratio=2.83x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.669, Ratio=2.89x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.608, Neg=1.641, Ratio=2.70x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.603, Neg=1.634, Ratio=2.71x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.672, Ratio=2.94x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.665, Ratio=2.89x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.649, Ratio=2.79x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.660, Ratio=2.85x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.674, Ratio=2.94x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.647, Ratio=2.75x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.655, Ratio=2.86x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.594, Neg=1.644, Ratio=2.77x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.670, Ratio=2.85x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.597, Neg=1.637, Ratio=2.74x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.636, Ratio=2.73x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.655, Ratio=2.82x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.672, Ratio=2.90x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.604, Neg=1.626, Ratio=2.69x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.654, Ratio=2.77x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.674, Ratio=2.86x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.627, Ratio=2.72x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.606, Neg=1.634, Ratio=2.70x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.659, Ratio=2.82x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.653, Ratio=2.86x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.659, Ratio=2.81x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.669, Ratio=2.89x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.596, Neg=1.658, Ratio=2.78x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.673, Ratio=2.94x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.598, Neg=1.641, Ratio=2.75x, Gap=-3.715

============================================================
Epoch 6/20 completed in 32.8s
Train: Loss=1.1984 (C:1.1984, R:0.0105) Ratio=2.83x
Val:   Loss=1.1615 (C:1.1615, R:0.0105) Ratio=3.25x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.1615)
============================================================

🌍 Updating global dataset at epoch 7
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.535 ± 0.582
    Neg distances: 1.738 ± 0.901
    Separation ratio: 3.25x
    Gap: -3.697
    ✅ Excellent global separation!

Epoch 7 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-4.336
Batch   0/537: Loss=1.0512 (C:1.0512, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.735, Ratio=3.09x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.725, Ratio=3.07x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.757, Ratio=3.21x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.746, Ratio=3.12x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.752, Ratio=3.16x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.759, Ratio=3.28x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.753, Ratio=3.21x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.751, Ratio=3.16x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.777, Ratio=3.30x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.763, Ratio=3.19x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.741, Ratio=2.98x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.744, Ratio=3.09x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.728, Ratio=3.04x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.772, Ratio=3.23x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.729, Ratio=3.02x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.770, Ratio=3.38x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.765, Ratio=3.25x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.749, Ratio=3.10x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.752, Ratio=3.16x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.751, Ratio=3.19x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.31x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.734, Ratio=3.06x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.742, Ratio=3.23x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.758, Ratio=3.12x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.722, Ratio=2.98x, Gap=-4.064
Batch  25/537: Loss=1.1215 (C:1.1215, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.745, Ratio=3.18x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.744, Ratio=3.05x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.740, Ratio=3.06x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.772, Ratio=3.18x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.760, Ratio=3.13x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.752, Ratio=3.20x, Gap=-4.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.737, Ratio=3.02x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.728, Ratio=3.05x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.751, Ratio=3.10x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.734, Ratio=3.06x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.732, Ratio=3.09x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.728, Ratio=3.15x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.750, Ratio=3.11x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.742, Ratio=3.11x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.736, Ratio=3.02x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.736, Ratio=3.05x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.737, Ratio=3.05x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.733, Ratio=3.03x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.756, Ratio=3.12x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.737, Ratio=3.08x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.749, Ratio=3.15x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.721, Ratio=2.98x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.759, Ratio=3.05x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.743, Ratio=3.06x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.729, Ratio=3.01x, Gap=-3.731
Batch  50/537: Loss=1.1139 (C:1.1139, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.742, Ratio=3.06x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.740, Ratio=3.12x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.728, Ratio=3.04x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.732, Ratio=3.06x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.712, Ratio=2.97x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.731, Ratio=3.04x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.749, Ratio=3.18x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.762, Ratio=3.22x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.726, Ratio=3.01x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.748, Ratio=3.10x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.782, Ratio=3.43x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.743, Ratio=3.07x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.740, Ratio=3.15x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.733, Ratio=3.07x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.762, Ratio=3.21x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.746, Ratio=3.09x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.738, Ratio=3.15x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.743, Ratio=3.15x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.742, Ratio=3.12x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.748, Ratio=3.18x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.753, Ratio=3.11x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.762, Ratio=3.17x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.741, Ratio=3.14x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.747, Ratio=3.10x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.779, Ratio=3.33x, Gap=-3.872
Batch  75/537: Loss=1.0466 (C:1.0466, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.733, Ratio=3.09x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.714, Ratio=2.97x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.751, Ratio=3.18x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.759, Ratio=3.14x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.748, Ratio=3.14x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.753, Ratio=3.01x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.735, Ratio=3.08x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.611, Neg=1.705, Ratio=2.79x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.731, Ratio=3.02x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.749, Ratio=3.22x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.710, Ratio=2.97x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.763, Ratio=3.28x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.772, Ratio=3.27x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.764, Ratio=3.24x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.734, Ratio=3.13x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.743, Ratio=3.04x, Gap=-4.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.712, Ratio=3.08x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.730, Ratio=3.06x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.758, Ratio=3.26x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.592, Neg=1.730, Ratio=2.92x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.727, Ratio=2.96x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.743, Ratio=3.08x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.733, Ratio=3.01x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.750, Ratio=3.24x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.735, Ratio=3.21x, Gap=-3.453
Batch 100/537: Loss=1.0705 (C:1.0705, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.715, Ratio=2.98x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.771, Ratio=3.28x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.714, Ratio=3.06x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.750, Ratio=3.23x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.736, Ratio=3.07x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.739, Ratio=3.05x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.770, Ratio=3.22x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.762, Ratio=3.13x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.735, Ratio=2.95x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.743, Ratio=3.15x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.765, Ratio=3.16x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.778, Ratio=3.27x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.749, Ratio=3.10x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.729, Ratio=3.03x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.746, Ratio=3.20x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.777, Ratio=3.30x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.749, Ratio=3.11x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.772, Ratio=3.29x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.755, Ratio=3.15x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.757, Ratio=3.16x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.715, Ratio=3.06x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.768, Ratio=3.23x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.740, Ratio=3.00x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.758, Ratio=3.19x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.738, Ratio=3.16x, Gap=-3.930
Batch 125/537: Loss=1.0797 (C:1.0797, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.742, Ratio=3.11x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.726, Ratio=2.96x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.749, Ratio=3.05x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.768, Ratio=3.14x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.760, Ratio=3.13x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.761, Ratio=3.15x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.751, Ratio=3.11x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.739, Ratio=2.98x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.740, Ratio=3.05x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.728, Ratio=2.99x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.741, Ratio=3.16x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.747, Ratio=3.13x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.755, Ratio=3.17x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.757, Ratio=3.21x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.744, Ratio=3.07x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.751, Ratio=3.08x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.748, Ratio=3.22x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.736, Ratio=3.11x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.731, Ratio=3.10x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.748, Ratio=3.05x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.736, Ratio=3.12x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.748, Ratio=3.22x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.738, Ratio=2.99x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.743, Ratio=3.10x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.749, Ratio=3.09x, Gap=-3.733
Batch 150/537: Loss=1.0959 (C:1.0959, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.748, Ratio=3.17x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.746, Ratio=3.04x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.737, Ratio=3.03x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.734, Ratio=3.09x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.736, Ratio=2.96x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.741, Ratio=3.17x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.753, Ratio=3.20x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.751, Ratio=3.17x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.760, Ratio=3.25x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.727, Ratio=3.08x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.733, Ratio=3.05x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.740, Ratio=3.13x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.723, Ratio=3.01x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.751, Ratio=3.16x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.733, Ratio=3.06x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.733, Ratio=3.14x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.735, Ratio=2.98x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.731, Ratio=3.09x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.758, Ratio=3.18x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.743, Ratio=3.17x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.745, Ratio=3.07x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.721, Ratio=2.96x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.736, Ratio=3.10x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.739, Ratio=3.12x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.760, Ratio=3.22x, Gap=-4.102
Batch 175/537: Loss=1.0688 (C:1.0688, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.727, Ratio=3.06x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.713, Ratio=2.94x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.749, Ratio=3.14x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.753, Ratio=3.07x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.748, Ratio=3.14x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.711, Ratio=2.98x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.736, Ratio=2.99x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.750, Ratio=3.10x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.768, Ratio=3.24x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.738, Ratio=3.00x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.724, Ratio=3.04x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.593, Neg=1.741, Ratio=2.93x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.727, Ratio=3.03x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.731, Ratio=2.98x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.729, Ratio=3.00x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.729, Ratio=3.05x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.725, Ratio=3.12x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.734, Ratio=3.14x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.716, Ratio=2.97x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.746, Ratio=3.23x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.741, Ratio=3.13x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.747, Ratio=3.17x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.749, Ratio=3.14x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.727, Ratio=3.03x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.731, Ratio=3.07x, Gap=-3.792
Batch 200/537: Loss=1.0999 (C:1.0999, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.746, Ratio=3.14x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.736, Ratio=2.96x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.740, Ratio=3.11x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.734, Ratio=2.95x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.752, Ratio=3.19x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.757, Ratio=3.15x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.757, Ratio=3.16x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.745, Ratio=3.12x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.728, Ratio=3.12x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.717, Ratio=3.00x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.31x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.711, Ratio=3.01x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.742, Ratio=3.05x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.758, Ratio=3.27x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.747, Ratio=3.11x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.743, Ratio=3.08x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.735, Ratio=3.01x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.751, Ratio=3.14x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.765, Ratio=3.19x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.752, Ratio=3.03x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.745, Ratio=3.11x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.749, Ratio=3.19x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.758, Ratio=3.16x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.718, Ratio=3.01x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.733, Ratio=3.26x, Gap=-3.816
Batch 225/537: Loss=1.0612 (C:1.0612, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.732, Ratio=3.08x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.716, Ratio=2.98x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.732, Ratio=3.07x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.749, Ratio=3.20x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.710, Ratio=2.95x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.749, Ratio=3.11x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.774, Ratio=3.19x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.747, Ratio=3.13x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.729, Ratio=3.00x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.758, Ratio=3.16x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.769, Ratio=3.27x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.745, Ratio=3.08x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.741, Ratio=3.07x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.751, Ratio=3.13x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.736, Ratio=3.15x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.727, Ratio=2.99x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.752, Ratio=3.24x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.725, Ratio=3.02x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.729, Ratio=3.12x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.753, Ratio=3.13x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.732, Ratio=3.04x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.732, Ratio=3.11x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.735, Ratio=3.09x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.744, Ratio=3.06x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.733, Ratio=3.07x, Gap=-3.833
Batch 250/537: Loss=1.1000 (C:1.1000, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.767, Ratio=3.20x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.746, Ratio=3.17x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.750, Ratio=3.09x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.730, Ratio=2.96x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.726, Ratio=2.99x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.765, Ratio=3.17x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.733, Ratio=3.17x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.756, Ratio=3.09x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.751, Ratio=3.17x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.730, Ratio=3.01x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.730, Ratio=2.97x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.731, Ratio=3.01x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.756, Ratio=3.11x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.738, Ratio=3.07x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.758, Ratio=3.19x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.733, Ratio=2.99x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.747, Ratio=3.15x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.748, Ratio=3.08x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.755, Ratio=3.16x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.738, Ratio=3.13x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.737, Ratio=3.15x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.746, Ratio=3.18x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.744, Ratio=3.15x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.744, Ratio=3.07x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.746, Ratio=3.16x, Gap=-3.812
Batch 275/537: Loss=1.0818 (C:1.0818, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.762, Ratio=3.12x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.744, Ratio=3.10x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.741, Ratio=3.03x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.737, Ratio=3.10x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.726, Ratio=3.00x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.745, Ratio=3.27x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.725, Ratio=3.08x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.738, Ratio=3.10x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.733, Ratio=3.12x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.727, Ratio=3.17x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.757, Ratio=3.24x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.733, Ratio=3.20x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.732, Ratio=3.16x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.748, Ratio=3.09x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.718, Ratio=3.02x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.749, Ratio=3.05x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.747, Ratio=3.20x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.734, Ratio=3.04x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.742, Ratio=3.09x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.738, Ratio=3.03x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.734, Ratio=3.08x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.763, Ratio=3.18x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.742, Ratio=3.06x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.728, Ratio=3.07x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.740, Ratio=3.18x, Gap=-3.796
Batch 300/537: Loss=1.0761 (C:1.0761, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.733, Ratio=3.02x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.736, Ratio=3.18x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.752, Ratio=3.21x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.742, Ratio=3.09x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.738, Ratio=3.11x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.711, Ratio=2.95x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.746, Ratio=3.20x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.747, Ratio=3.16x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.766, Ratio=3.27x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.759, Ratio=3.06x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.759, Ratio=3.10x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.747, Ratio=3.04x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.770, Ratio=3.19x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.744, Ratio=3.09x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.766, Ratio=3.16x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.729, Ratio=3.03x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.725, Ratio=3.05x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.757, Ratio=3.28x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.739, Ratio=3.12x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.726, Ratio=3.06x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.733, Ratio=3.12x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.728, Ratio=3.09x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.716, Ratio=3.02x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.744, Ratio=3.11x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.727, Ratio=3.03x, Gap=-3.900
Batch 325/537: Loss=1.1097 (C:1.1097, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.737, Ratio=3.02x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.753, Ratio=3.11x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.756, Ratio=3.15x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.759, Ratio=3.11x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.742, Ratio=2.99x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.755, Ratio=3.21x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.765, Ratio=3.18x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.755, Ratio=3.04x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.738, Ratio=3.10x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.726, Ratio=2.97x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.720, Ratio=2.97x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.732, Ratio=3.13x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.722, Ratio=2.99x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.723, Ratio=3.01x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.743, Ratio=3.14x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.749, Ratio=3.15x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.731, Ratio=3.08x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.727, Ratio=3.01x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.748, Ratio=3.15x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.742, Ratio=3.14x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.744, Ratio=3.17x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.777, Ratio=3.31x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.731, Ratio=2.98x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.741, Ratio=3.13x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.728, Ratio=3.02x, Gap=-4.040
Batch 350/537: Loss=1.1130 (C:1.1130, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.12x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.727, Ratio=3.05x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.738, Ratio=3.13x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.726, Ratio=3.03x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.737, Ratio=3.15x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.745, Ratio=3.09x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.712, Ratio=2.92x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.748, Ratio=3.11x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.748, Ratio=3.12x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.736, Ratio=3.04x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.719, Ratio=3.00x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.719, Ratio=2.94x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.732, Ratio=3.07x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.730, Ratio=2.98x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.766, Ratio=3.17x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.726, Ratio=2.97x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.740, Ratio=2.98x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.748, Ratio=3.08x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.762, Ratio=3.14x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.751, Ratio=3.15x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.731, Ratio=3.13x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.733, Ratio=3.09x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.729, Ratio=2.97x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.762, Ratio=3.39x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.697, Ratio=2.91x, Gap=-3.991
Batch 375/537: Loss=1.1413 (C:1.1413, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.743, Ratio=3.13x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.734, Ratio=3.10x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.720, Ratio=3.06x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.737, Ratio=3.03x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.736, Ratio=3.09x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.739, Ratio=3.16x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.719, Ratio=2.91x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.750, Ratio=3.02x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.757, Ratio=3.19x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.750, Ratio=3.17x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.756, Ratio=3.18x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.757, Ratio=3.12x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.591, Neg=1.726, Ratio=2.92x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.739, Ratio=3.08x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.731, Ratio=3.09x, Gap=-4.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.738, Ratio=3.10x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.721, Ratio=2.99x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.733, Ratio=3.09x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.752, Ratio=3.28x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.730, Ratio=2.96x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.731, Ratio=3.11x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.743, Ratio=3.14x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.754, Ratio=3.09x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.759, Ratio=3.22x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.735, Ratio=3.12x, Gap=-3.877
Batch 400/537: Loss=1.0887 (C:1.0887, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.738, Ratio=3.07x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.747, Ratio=3.15x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.737, Ratio=3.01x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.752, Ratio=3.13x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.747, Ratio=3.08x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.722, Ratio=2.97x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.727, Ratio=2.95x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.742, Ratio=3.01x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.735, Ratio=3.00x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.739, Ratio=3.07x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.732, Ratio=3.16x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.731, Ratio=2.97x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.737, Ratio=3.13x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.745, Ratio=3.07x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.740, Ratio=3.10x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.717, Ratio=2.96x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.745, Ratio=3.15x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.744, Ratio=3.03x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.764, Ratio=3.23x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.738, Ratio=3.07x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.746, Ratio=3.18x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.733, Ratio=3.03x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.738, Ratio=3.17x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.772, Ratio=3.21x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.729, Ratio=3.10x, Gap=-4.097
Batch 425/537: Loss=1.0964 (C:1.0964, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.756, Ratio=3.21x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.736, Ratio=3.14x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.734, Ratio=3.02x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.730, Ratio=3.05x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.728, Ratio=3.05x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.745, Ratio=3.11x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.744, Ratio=3.19x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.732, Ratio=3.13x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.729, Ratio=3.06x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.727, Ratio=3.09x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.585, Neg=1.724, Ratio=2.95x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.746, Ratio=3.17x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.729, Ratio=3.08x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.715, Ratio=2.94x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.731, Ratio=3.05x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.753, Ratio=3.16x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.740, Ratio=3.09x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.759, Ratio=3.13x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.749, Ratio=3.06x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.749, Ratio=3.06x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.739, Ratio=3.08x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.743, Ratio=3.17x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.769, Ratio=3.12x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.739, Ratio=3.07x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.761, Ratio=3.09x, Gap=-3.742
Batch 450/537: Loss=1.0933 (C:1.0933, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.738, Ratio=3.03x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.736, Ratio=3.06x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.792, Ratio=3.33x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.768, Ratio=3.20x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.744, Ratio=3.06x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.727, Ratio=3.07x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.758, Ratio=3.20x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.743, Ratio=3.09x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.747, Ratio=3.10x, Gap=-4.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.731, Ratio=3.05x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.730, Ratio=3.10x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.751, Ratio=3.08x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.729, Ratio=3.03x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.769, Ratio=3.20x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.747, Ratio=3.03x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.757, Ratio=3.10x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.586, Neg=1.732, Ratio=2.96x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.740, Ratio=3.06x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.739, Ratio=3.08x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.740, Ratio=3.12x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.721, Ratio=3.04x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.721, Ratio=3.10x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.588, Neg=1.721, Ratio=2.93x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.732, Ratio=3.02x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.720, Ratio=3.07x, Gap=-3.915
Batch 475/537: Loss=1.1004 (C:1.1004, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.745, Ratio=3.23x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.705, Ratio=2.94x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.725, Ratio=2.98x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.758, Ratio=3.16x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.737, Ratio=3.07x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.745, Ratio=3.22x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.732, Ratio=3.04x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.718, Ratio=3.06x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.730, Ratio=3.05x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.718, Ratio=2.98x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.723, Ratio=3.01x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.757, Ratio=3.14x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.752, Ratio=3.17x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.752, Ratio=3.13x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.749, Ratio=3.05x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.732, Ratio=3.01x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.740, Ratio=3.09x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.735, Ratio=3.06x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.744, Ratio=3.16x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.735, Ratio=3.02x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.754, Ratio=3.28x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.755, Ratio=3.06x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.748, Ratio=3.04x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.760, Ratio=3.11x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.738, Ratio=3.08x, Gap=-3.800
Batch 500/537: Loss=1.0995 (C:1.0995, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.749, Ratio=3.12x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.754, Ratio=3.10x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.590, Neg=1.737, Ratio=2.94x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.734, Ratio=2.97x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.752, Ratio=3.22x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.743, Ratio=3.04x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.735, Ratio=3.09x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.724, Ratio=3.06x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.746, Ratio=3.19x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.731, Ratio=3.03x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.723, Ratio=3.01x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.718, Ratio=2.99x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.724, Ratio=3.00x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.712, Ratio=3.03x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.709, Ratio=2.96x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.755, Ratio=3.16x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.728, Ratio=3.08x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.714, Ratio=2.95x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.763, Ratio=3.21x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.737, Ratio=3.09x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.738, Ratio=3.10x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.740, Ratio=3.04x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.734, Ratio=3.12x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.726, Ratio=3.05x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.725, Ratio=3.00x, Gap=-3.606
Batch 525/537: Loss=1.1191 (C:1.1191, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.754, Ratio=3.12x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.720, Ratio=3.06x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.724, Ratio=2.99x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.752, Ratio=3.19x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.733, Ratio=3.09x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.734, Ratio=3.14x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.760, Ratio=3.25x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.749, Ratio=3.09x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.745, Ratio=3.06x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.742, Ratio=3.07x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.751, Ratio=3.02x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.757, Ratio=3.39x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.735, Ratio=3.16x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.781, Ratio=3.40x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.745, Ratio=3.33x, Gap=-3.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.754, Ratio=3.21x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.763, Ratio=3.33x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.775, Ratio=3.47x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.754, Ratio=3.40x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.759, Ratio=3.29x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.744, Ratio=3.29x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.772, Ratio=3.39x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.770, Ratio=3.38x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.752, Ratio=3.26x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.739, Ratio=3.20x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.757, Ratio=3.32x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.744, Ratio=3.23x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.747, Ratio=3.17x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.758, Ratio=3.28x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.759, Ratio=3.28x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.752, Ratio=3.37x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.753, Ratio=3.36x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.738, Ratio=3.25x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.758, Ratio=3.30x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.741, Ratio=3.23x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.772, Ratio=3.45x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.769, Ratio=3.33x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.740, Ratio=3.19x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.754, Ratio=3.29x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.785, Ratio=3.40x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.759, Ratio=3.35x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.772, Ratio=3.41x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.774, Ratio=3.46x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.747, Ratio=3.25x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.788, Ratio=3.41x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.740, Ratio=3.23x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.746, Ratio=3.15x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.750, Ratio=3.22x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.760, Ratio=3.38x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.753, Ratio=3.35x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.752, Ratio=3.15x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.763, Ratio=3.39x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.758, Ratio=3.30x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.747, Ratio=3.39x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.738, Ratio=3.22x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.758, Ratio=3.23x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.760, Ratio=3.39x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.743, Ratio=3.17x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.766, Ratio=3.35x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.751, Ratio=3.30x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.735, Ratio=3.21x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.761, Ratio=3.40x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.733, Ratio=3.15x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.760, Ratio=3.39x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.762, Ratio=3.18x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.771, Ratio=3.39x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.740, Ratio=3.24x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.717, Ratio=3.06x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.760, Ratio=3.39x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.741, Ratio=3.25x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.736, Ratio=3.29x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.744, Ratio=3.38x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.751, Ratio=3.32x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.748, Ratio=3.25x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.758, Ratio=3.20x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.743, Ratio=3.19x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.766, Ratio=3.42x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.748, Ratio=3.25x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.765, Ratio=3.35x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.738, Ratio=3.27x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.745, Ratio=3.45x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.748, Ratio=3.33x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.763, Ratio=3.35x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.780, Ratio=3.51x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.754, Ratio=3.26x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.764, Ratio=3.41x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.758, Ratio=3.20x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.749, Ratio=3.36x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.733, Ratio=3.19x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.738, Ratio=3.21x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.758, Ratio=3.40x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.734, Ratio=3.14x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.765, Ratio=3.38x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.780, Ratio=3.51x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.769, Ratio=3.29x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.751, Ratio=3.25x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.750, Ratio=3.21x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.759, Ratio=3.29x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.774, Ratio=3.44x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.761, Ratio=3.42x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.752, Ratio=3.29x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.759, Ratio=3.30x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.755, Ratio=3.24x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.754, Ratio=3.25x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.742, Ratio=3.27x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.732, Ratio=3.18x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.754, Ratio=3.34x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.727, Ratio=3.14x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.750, Ratio=3.32x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.765, Ratio=3.28x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.752, Ratio=3.24x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.764, Ratio=3.38x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.748, Ratio=3.28x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.747, Ratio=3.32x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.753, Ratio=3.23x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.732, Ratio=3.11x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.772, Ratio=3.51x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.741, Ratio=3.25x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.761, Ratio=3.42x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.783, Ratio=3.39x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.751, Ratio=3.28x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.742, Ratio=3.17x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.728, Ratio=3.22x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.765, Ratio=3.39x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.772, Ratio=3.32x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.738, Ratio=3.10x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.766, Ratio=3.42x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.741, Ratio=3.19x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.741, Ratio=3.19x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.757, Ratio=3.34x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.753, Ratio=3.24x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.748, Ratio=3.32x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.736, Ratio=3.18x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.747, Ratio=3.26x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.758, Ratio=3.45x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.749, Ratio=3.20x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.772, Ratio=3.36x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.752, Ratio=3.22x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.746, Ratio=3.18x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.761, Ratio=3.41x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.748, Ratio=3.27x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.745, Ratio=3.30x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.783, Ratio=3.52x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.765, Ratio=3.45x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.743, Ratio=3.27x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.746, Ratio=3.28x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.752, Ratio=3.22x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.752, Ratio=3.35x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.775, Ratio=3.39x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.745, Ratio=3.24x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.744, Ratio=3.16x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.733, Ratio=3.21x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.776, Ratio=3.29x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.750, Ratio=3.27x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.769, Ratio=3.32x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.729, Ratio=3.15x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.752, Ratio=3.32x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.718, Ratio=3.08x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.744, Ratio=3.18x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.772, Ratio=3.44x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.772, Ratio=3.40x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.745, Ratio=3.22x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.784, Ratio=3.43x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.753, Ratio=3.36x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.762, Ratio=3.34x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.762, Ratio=3.31x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.746, Ratio=3.24x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.747, Ratio=3.22x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.738, Ratio=3.23x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.760, Ratio=3.29x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.751, Ratio=3.31x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.756, Ratio=3.29x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.756, Ratio=3.31x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.783, Ratio=3.47x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.769, Ratio=3.38x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.758, Ratio=3.42x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.762, Ratio=3.28x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.756, Ratio=3.32x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.736, Ratio=3.18x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.760, Ratio=3.33x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.792, Ratio=3.54x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.748, Ratio=3.29x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.770, Ratio=3.32x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.735, Ratio=3.27x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.733, Ratio=3.15x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.769, Ratio=3.34x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.750, Ratio=3.17x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.747, Ratio=3.19x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.752, Ratio=3.25x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.756, Ratio=3.28x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.758, Ratio=3.36x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.748, Ratio=3.33x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.31x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.747, Ratio=3.23x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.741, Ratio=3.21x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.768, Ratio=3.45x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.739, Ratio=3.18x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.752, Ratio=3.28x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.728, Ratio=3.06x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.773, Ratio=3.36x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.731, Ratio=3.19x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.769, Ratio=3.36x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.752, Ratio=3.29x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.752, Ratio=3.25x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.777, Ratio=3.41x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.744, Ratio=3.19x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.752, Ratio=3.27x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.759, Ratio=3.25x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.756, Ratio=3.27x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.734, Ratio=3.18x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.750, Ratio=3.19x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.735, Ratio=3.24x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.736, Ratio=3.28x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.751, Ratio=3.30x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.748, Ratio=3.22x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.759, Ratio=3.29x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.763, Ratio=3.35x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.752, Ratio=3.27x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.736, Ratio=3.31x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.768, Ratio=3.39x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.781, Ratio=3.45x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.763, Ratio=3.43x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.753, Ratio=3.20x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.758, Ratio=3.32x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.743, Ratio=3.21x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.761, Ratio=3.28x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.749, Ratio=3.21x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.753, Ratio=3.35x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.756, Ratio=3.31x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.749, Ratio=3.26x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.750, Ratio=3.27x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.792, Ratio=3.54x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.761, Ratio=3.42x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.745, Ratio=3.17x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.753, Ratio=3.21x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.733, Ratio=3.11x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.751, Ratio=3.43x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.757, Ratio=3.40x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.772, Ratio=3.42x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.738, Ratio=3.27x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.737, Ratio=3.25x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.765, Ratio=3.36x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.767, Ratio=3.34x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.770, Ratio=3.28x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.741, Ratio=3.21x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.755, Ratio=3.27x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.742, Ratio=3.17x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.751, Ratio=3.27x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.740, Ratio=3.20x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.748, Ratio=3.32x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.735, Ratio=3.27x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.741, Ratio=3.26x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.764, Ratio=3.33x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.771, Ratio=3.24x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.756, Ratio=3.21x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.736, Ratio=3.21x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.744, Ratio=3.18x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.763, Ratio=3.39x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.735, Ratio=3.24x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.765, Ratio=3.34x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.754, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.756, Ratio=3.26x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.783, Ratio=3.46x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.748, Ratio=3.20x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.734, Ratio=3.14x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.761, Ratio=3.30x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.765, Ratio=3.34x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.737, Ratio=3.30x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.766, Ratio=3.26x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.739, Ratio=3.21x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.750, Ratio=3.47x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.761, Ratio=3.34x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.759, Ratio=3.23x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.767, Ratio=3.39x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.775, Ratio=3.47x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.764, Ratio=3.42x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.748, Ratio=3.15x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.756, Ratio=3.19x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.758, Ratio=3.34x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.755, Ratio=3.19x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.794, Ratio=3.62x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.756, Ratio=3.27x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.756, Ratio=3.20x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.752, Ratio=3.19x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.754, Ratio=3.30x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.751, Ratio=3.28x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.754, Ratio=3.26x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.765, Ratio=3.32x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.754, Ratio=3.25x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.744, Ratio=3.30x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.750, Ratio=3.27x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.740, Ratio=3.18x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.746, Ratio=3.21x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.747, Ratio=3.19x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.743, Ratio=3.27x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.765, Ratio=3.39x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.743, Ratio=3.23x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.730, Ratio=3.23x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.758, Ratio=3.26x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.728, Ratio=3.15x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.763, Ratio=3.38x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.747, Ratio=3.39x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.761, Ratio=3.32x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.751, Ratio=3.23x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.752, Ratio=3.32x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.744, Ratio=3.28x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.768, Ratio=3.36x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.769, Ratio=3.35x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.749, Ratio=3.24x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.750, Ratio=3.34x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.768, Ratio=3.32x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.762, Ratio=3.45x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.769, Ratio=3.32x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.778, Ratio=3.49x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.753, Ratio=3.19x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.758, Ratio=3.22x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.768, Ratio=3.48x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.770, Ratio=3.34x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.756, Ratio=3.24x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.738, Ratio=3.17x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.746, Ratio=3.24x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.749, Ratio=3.33x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.741, Ratio=3.27x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.761, Ratio=3.34x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.751, Ratio=3.23x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.740, Ratio=3.32x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.749, Ratio=3.29x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.758, Ratio=3.31x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.39x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.759, Ratio=3.33x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.786, Ratio=3.47x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.735, Ratio=3.13x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.765, Ratio=3.33x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.770, Ratio=3.39x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.762, Ratio=3.37x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.739, Ratio=3.22x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.758, Ratio=3.34x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.763, Ratio=3.40x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.737, Ratio=3.21x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.739, Ratio=3.17x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.747, Ratio=3.38x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.772, Ratio=3.35x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.751, Ratio=3.23x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.742, Ratio=3.27x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.795, Ratio=3.56x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.761, Ratio=3.46x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.781, Ratio=3.44x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.768, Ratio=3.35x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.764, Ratio=3.28x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.751, Ratio=3.36x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.752, Ratio=3.37x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.736, Ratio=3.33x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.742, Ratio=3.36x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.737, Ratio=3.21x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.748, Ratio=3.32x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.724, Ratio=3.13x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.766, Ratio=3.50x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.753, Ratio=3.25x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.738, Ratio=3.32x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.755, Ratio=3.32x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.756, Ratio=3.28x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.774, Ratio=3.43x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.766, Ratio=3.37x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.762, Ratio=3.47x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.755, Ratio=3.29x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.740, Ratio=3.17x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.734, Ratio=3.14x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.753, Ratio=3.28x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.752, Ratio=3.24x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.757, Ratio=3.32x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.759, Ratio=3.36x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.771, Ratio=3.40x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.770, Ratio=3.34x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.742, Ratio=3.16x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.743, Ratio=3.25x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.760, Ratio=3.31x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.756, Ratio=3.30x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.753, Ratio=3.33x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.760, Ratio=3.25x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.749, Ratio=3.26x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.748, Ratio=3.22x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.776, Ratio=3.52x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.759, Ratio=3.27x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.740, Ratio=3.29x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.753, Ratio=3.26x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.730, Ratio=3.12x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.722, Ratio=3.08x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.769, Ratio=3.36x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.749, Ratio=3.36x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.763, Ratio=3.28x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.765, Ratio=3.39x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.733, Ratio=3.14x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.773, Ratio=3.41x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.755, Ratio=3.38x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.766, Ratio=3.36x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.769, Ratio=3.40x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.772, Ratio=3.54x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.748, Ratio=3.29x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.745, Ratio=3.18x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.757, Ratio=3.33x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.730, Ratio=3.26x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.753, Ratio=3.39x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.755, Ratio=3.24x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.745, Ratio=3.15x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.733, Ratio=3.11x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.754, Ratio=3.35x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.754, Ratio=3.26x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.766, Ratio=3.37x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.763, Ratio=3.41x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.749, Ratio=3.34x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.757, Ratio=3.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.745, Ratio=3.24x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.765, Ratio=3.31x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.741, Ratio=3.24x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.765, Ratio=3.37x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.780, Ratio=3.52x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.767, Ratio=3.27x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.738, Ratio=3.28x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.761, Ratio=3.40x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.765, Ratio=3.29x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.761, Ratio=3.23x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.760, Ratio=3.40x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.764, Ratio=3.36x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.758, Ratio=3.39x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.775, Ratio=3.45x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.775, Ratio=3.34x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.752, Ratio=3.29x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.772, Ratio=3.38x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.762, Ratio=3.24x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.757, Ratio=3.26x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.764, Ratio=3.48x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.776, Ratio=3.39x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.752, Ratio=3.31x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.772, Ratio=3.44x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.761, Ratio=3.26x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.734, Ratio=3.15x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.761, Ratio=3.39x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.757, Ratio=3.30x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.747, Ratio=3.26x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.724, Ratio=3.10x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.736, Ratio=3.20x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.737, Ratio=3.07x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.765, Ratio=3.40x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.751, Ratio=3.26x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.742, Ratio=3.29x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.763, Ratio=3.30x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.743, Ratio=3.17x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.782, Ratio=3.50x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.776, Ratio=3.36x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.767, Ratio=3.38x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.767, Ratio=3.36x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.727, Ratio=3.23x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.760, Ratio=3.29x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.735, Ratio=3.21x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.735, Ratio=3.16x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.737, Ratio=3.19x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.762, Ratio=3.33x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.762, Ratio=3.46x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.744, Ratio=3.36x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.740, Ratio=3.16x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.733, Ratio=3.13x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.764, Ratio=3.31x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.739, Ratio=3.19x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.757, Ratio=3.31x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.769, Ratio=3.35x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.749, Ratio=3.26x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.743, Ratio=3.23x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.738, Ratio=3.22x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.765, Ratio=3.34x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.754, Ratio=3.25x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.763, Ratio=3.30x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.741, Ratio=3.36x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.747, Ratio=3.22x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.746, Ratio=3.33x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.767, Ratio=3.35x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.746, Ratio=3.25x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.777, Ratio=3.46x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.750, Ratio=3.39x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.746, Ratio=3.18x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.755, Ratio=3.31x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.743, Ratio=3.22x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.773, Ratio=3.40x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.768, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.770, Ratio=3.41x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.737, Ratio=3.11x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.734, Ratio=3.20x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.763, Ratio=3.31x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.755, Ratio=3.36x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.44x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.772, Ratio=3.39x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.768, Ratio=3.42x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.782, Ratio=3.58x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.760, Ratio=3.25x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.723, Ratio=3.20x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.748, Ratio=3.21x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.745, Ratio=3.17x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.741, Ratio=3.19x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.717, Ratio=3.03x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.754, Ratio=3.24x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.33x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.779, Ratio=3.45x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.730, Ratio=3.14x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.752, Ratio=3.31x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.754, Ratio=3.28x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.752, Ratio=3.29x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.750, Ratio=3.29x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.745, Ratio=3.19x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.771, Ratio=3.36x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.772, Ratio=3.44x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.31x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.759, Ratio=3.37x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.745, Ratio=3.20x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.740, Ratio=3.20x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.759, Ratio=3.37x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.729, Ratio=3.13x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.750, Ratio=3.35x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.765, Ratio=3.46x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.756, Ratio=3.34x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.740, Ratio=3.20x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.747, Ratio=3.26x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.761, Ratio=3.33x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.753, Ratio=3.22x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.741, Ratio=3.22x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.721, Ratio=3.18x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.741, Ratio=3.13x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.734, Ratio=3.14x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.758, Ratio=3.26x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.797, Ratio=3.55x, Gap=-3.643

============================================================
Epoch 7/20 completed in 39.3s
Train: Loss=1.0942 (C:1.0942, R:0.0105) Ratio=2.91x
Val:   Loss=1.0540 (C:1.0540, R:0.0105) Ratio=3.40x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.0540)
============================================================

Epoch 8 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.753, Ratio=3.13x, Gap=-3.883
Batch   0/537: Loss=1.0863 (C:1.0863, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.742, Ratio=3.14x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.744, Ratio=3.22x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.757, Ratio=3.15x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.748, Ratio=3.23x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.738, Ratio=3.14x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.747, Ratio=3.14x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.768, Ratio=3.25x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.751, Ratio=3.11x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.778, Ratio=3.32x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.740, Ratio=3.11x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.757, Ratio=3.11x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.769, Ratio=3.30x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.744, Ratio=3.04x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.743, Ratio=3.17x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.763, Ratio=3.21x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.724, Ratio=3.07x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.751, Ratio=3.15x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.723, Ratio=3.08x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.791, Ratio=3.43x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.767, Ratio=3.17x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.758, Ratio=3.13x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.783, Ratio=3.41x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.759, Ratio=3.27x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.770, Ratio=3.22x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.759, Ratio=3.30x, Gap=-3.921
Batch  25/537: Loss=1.0500 (C:1.0500, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.748, Ratio=3.23x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.766, Ratio=3.18x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.744, Ratio=3.16x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.744, Ratio=3.18x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.709, Ratio=3.06x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.739, Ratio=3.19x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.747, Ratio=3.11x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.744, Ratio=3.04x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.778, Ratio=3.22x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.715, Ratio=3.06x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.734, Ratio=3.02x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.746, Ratio=3.14x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.759, Ratio=3.24x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.717, Ratio=3.04x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.750, Ratio=3.19x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.744, Ratio=3.22x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.752, Ratio=3.15x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.753, Ratio=3.07x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.768, Ratio=3.24x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.740, Ratio=3.10x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.749, Ratio=3.11x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.767, Ratio=3.25x, Gap=-4.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.746, Ratio=3.05x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.738, Ratio=3.09x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.740, Ratio=3.13x, Gap=-3.668
Batch  50/537: Loss=1.0850 (C:1.0850, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.740, Ratio=3.17x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.749, Ratio=3.11x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.739, Ratio=3.17x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.744, Ratio=3.27x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.727, Ratio=3.08x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.728, Ratio=3.11x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.754, Ratio=3.18x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.741, Ratio=3.05x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.737, Ratio=3.19x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.730, Ratio=3.06x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.756, Ratio=3.24x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.730, Ratio=3.05x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.739, Ratio=3.16x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.759, Ratio=3.16x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.751, Ratio=3.20x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.755, Ratio=3.31x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.771, Ratio=3.21x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.774, Ratio=3.24x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.746, Ratio=3.22x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.767, Ratio=3.28x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.730, Ratio=3.03x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.772, Ratio=3.17x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.765, Ratio=3.24x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.753, Ratio=3.12x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.741, Ratio=3.05x, Gap=-4.030
Batch  75/537: Loss=1.1039 (C:1.1039, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.743, Ratio=3.22x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.748, Ratio=3.10x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.770, Ratio=3.23x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.778, Ratio=3.44x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.742, Ratio=3.06x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.722, Ratio=2.98x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.776, Ratio=3.31x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.753, Ratio=3.13x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.743, Ratio=3.15x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.729, Ratio=2.98x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.746, Ratio=3.13x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.761, Ratio=3.18x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.758, Ratio=3.28x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.776, Ratio=3.23x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.756, Ratio=3.18x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.736, Ratio=3.19x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.754, Ratio=3.23x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.749, Ratio=3.05x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.727, Ratio=3.13x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.756, Ratio=3.19x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.742, Ratio=3.04x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.727, Ratio=2.99x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.752, Ratio=3.18x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.722, Ratio=2.99x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.734, Ratio=3.00x, Gap=-3.786
Batch 100/537: Loss=1.1146 (C:1.1146, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.778, Ratio=3.31x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.742, Ratio=3.03x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.703, Ratio=2.94x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.760, Ratio=3.16x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.731, Ratio=3.07x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.733, Ratio=3.14x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.770, Ratio=3.28x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.778, Ratio=3.25x, Gap=-4.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.768, Ratio=3.25x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.744, Ratio=3.13x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.752, Ratio=3.12x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.728, Ratio=3.03x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.758, Ratio=3.21x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.738, Ratio=3.09x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.754, Ratio=3.15x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.744, Ratio=3.18x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.766, Ratio=3.24x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.725, Ratio=3.05x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.757, Ratio=3.23x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.752, Ratio=3.23x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.749, Ratio=3.15x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.740, Ratio=3.06x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.721, Ratio=3.03x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.761, Ratio=3.23x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.771, Ratio=3.32x, Gap=-3.913
Batch 125/537: Loss=1.0441 (C:1.0441, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.757, Ratio=3.21x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.750, Ratio=3.31x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.712, Ratio=3.00x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.759, Ratio=3.37x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.739, Ratio=3.06x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.776, Ratio=3.35x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.739, Ratio=3.00x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.758, Ratio=3.23x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.754, Ratio=3.17x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.747, Ratio=3.10x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.13x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.751, Ratio=3.11x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.742, Ratio=3.08x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.750, Ratio=3.27x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.780, Ratio=3.31x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.759, Ratio=3.17x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.743, Ratio=3.22x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.765, Ratio=3.17x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.749, Ratio=3.18x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.741, Ratio=3.01x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.747, Ratio=3.12x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.765, Ratio=3.18x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.719, Ratio=2.98x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.750, Ratio=3.05x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.736, Ratio=3.05x, Gap=-3.936
Batch 150/537: Loss=1.1050 (C:1.1050, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.774, Ratio=3.35x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.747, Ratio=3.18x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.761, Ratio=3.17x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.777, Ratio=3.24x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.738, Ratio=3.17x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.747, Ratio=3.17x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.765, Ratio=3.13x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.728, Ratio=3.04x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.764, Ratio=3.21x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.754, Ratio=3.23x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.750, Ratio=3.21x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.738, Ratio=3.04x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.755, Ratio=3.13x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.741, Ratio=3.14x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.759, Ratio=3.19x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.751, Ratio=3.25x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.758, Ratio=3.21x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.13x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.740, Ratio=3.08x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.748, Ratio=3.15x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.745, Ratio=3.13x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.748, Ratio=3.16x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.747, Ratio=3.14x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.738, Ratio=3.04x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.765, Ratio=3.18x, Gap=-4.126
Batch 175/537: Loss=1.0735 (C:1.0735, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.745, Ratio=3.12x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.755, Ratio=3.24x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.749, Ratio=3.10x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.749, Ratio=3.07x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.769, Ratio=3.16x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.750, Ratio=3.18x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.726, Ratio=3.05x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.756, Ratio=3.18x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.736, Ratio=3.09x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.746, Ratio=3.22x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.738, Ratio=3.13x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.31x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.735, Ratio=3.09x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.744, Ratio=3.20x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.715, Ratio=3.10x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.752, Ratio=3.18x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.763, Ratio=3.23x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.752, Ratio=3.05x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.748, Ratio=3.14x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.765, Ratio=3.19x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.749, Ratio=3.19x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.759, Ratio=3.14x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.774, Ratio=3.19x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.741, Ratio=3.11x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.768, Ratio=3.24x, Gap=-4.134
Batch 200/537: Loss=1.0622 (C:1.0622, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.723, Ratio=3.01x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.715, Ratio=3.00x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.740, Ratio=3.09x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.753, Ratio=3.15x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.736, Ratio=3.05x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.745, Ratio=3.15x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.757, Ratio=3.17x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.741, Ratio=3.09x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.728, Ratio=3.00x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.746, Ratio=3.05x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.732, Ratio=3.14x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.742, Ratio=3.13x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.748, Ratio=3.06x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.751, Ratio=3.13x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.734, Ratio=3.11x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.772, Ratio=3.14x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.726, Ratio=2.98x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.758, Ratio=3.22x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.750, Ratio=3.15x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.741, Ratio=3.05x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.761, Ratio=3.12x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.775, Ratio=3.20x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.746, Ratio=3.19x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.728, Ratio=3.00x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.748, Ratio=3.13x, Gap=-3.703
Batch 225/537: Loss=1.0871 (C:1.0871, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.747, Ratio=3.11x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.743, Ratio=3.10x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.748, Ratio=3.08x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.751, Ratio=3.20x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.740, Ratio=3.07x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.766, Ratio=3.21x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.716, Ratio=3.04x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.754, Ratio=3.20x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.764, Ratio=3.24x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.752, Ratio=3.21x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.758, Ratio=3.29x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.734, Ratio=3.07x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.754, Ratio=3.20x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.737, Ratio=3.09x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.738, Ratio=3.05x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.738, Ratio=3.12x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.756, Ratio=3.19x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.769, Ratio=3.20x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.735, Ratio=3.02x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.756, Ratio=3.11x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.737, Ratio=3.14x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.756, Ratio=3.22x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.723, Ratio=3.05x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.745, Ratio=3.16x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.756, Ratio=3.22x, Gap=-3.745
Batch 250/537: Loss=1.0675 (C:1.0675, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.757, Ratio=3.17x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.777, Ratio=3.20x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.744, Ratio=3.10x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.744, Ratio=3.05x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.787, Ratio=3.32x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.740, Ratio=3.13x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.735, Ratio=3.09x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.744, Ratio=3.15x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.753, Ratio=3.19x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.730, Ratio=3.10x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.716, Ratio=3.04x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.747, Ratio=3.09x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.714, Ratio=3.00x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.753, Ratio=3.29x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.737, Ratio=3.11x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.582, Neg=1.727, Ratio=2.97x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.754, Ratio=3.20x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.759, Ratio=3.20x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.749, Ratio=3.12x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.754, Ratio=3.23x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.754, Ratio=3.17x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.741, Ratio=3.18x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.772, Ratio=3.13x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.754, Ratio=3.11x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.732, Ratio=3.00x, Gap=-3.772
Batch 275/537: Loss=1.1154 (C:1.1154, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.754, Ratio=3.12x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.738, Ratio=3.05x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.750, Ratio=3.09x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.742, Ratio=3.07x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.760, Ratio=3.23x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.738, Ratio=3.12x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.726, Ratio=3.06x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.734, Ratio=3.00x, Gap=-4.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.725, Ratio=3.15x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.730, Ratio=3.07x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.733, Ratio=3.10x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.770, Ratio=3.25x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.757, Ratio=3.21x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.773, Ratio=3.26x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.768, Ratio=3.20x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.748, Ratio=3.08x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.743, Ratio=3.09x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.771, Ratio=3.20x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.741, Ratio=3.04x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.762, Ratio=3.22x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.739, Ratio=3.13x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.739, Ratio=3.03x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.748, Ratio=3.13x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.758, Ratio=3.19x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.759, Ratio=3.19x, Gap=-3.865
Batch 300/537: Loss=1.0728 (C:1.0728, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.746, Ratio=3.14x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.757, Ratio=3.17x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.746, Ratio=3.18x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.746, Ratio=3.07x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.752, Ratio=3.12x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.734, Ratio=3.13x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.761, Ratio=3.22x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.741, Ratio=3.06x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.729, Ratio=3.01x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.745, Ratio=3.09x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.760, Ratio=3.16x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.778, Ratio=3.20x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.749, Ratio=3.11x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.760, Ratio=3.14x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.748, Ratio=3.15x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.760, Ratio=3.24x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.748, Ratio=3.20x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.742, Ratio=3.18x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.737, Ratio=3.10x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.750, Ratio=3.10x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.13x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.730, Ratio=3.00x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.742, Ratio=2.97x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.751, Ratio=3.19x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.744, Ratio=3.11x, Gap=-3.813
Batch 325/537: Loss=1.0919 (C:1.0919, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.754, Ratio=3.16x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.748, Ratio=3.13x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.768, Ratio=3.18x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.749, Ratio=3.19x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.737, Ratio=3.04x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.762, Ratio=3.13x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.740, Ratio=3.13x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.747, Ratio=3.09x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.729, Ratio=3.15x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.748, Ratio=3.23x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.740, Ratio=3.10x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.769, Ratio=3.26x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.759, Ratio=3.21x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.753, Ratio=3.17x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.728, Ratio=3.02x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.751, Ratio=3.18x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.719, Ratio=2.97x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.730, Ratio=3.07x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.738, Ratio=3.11x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.750, Ratio=3.23x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.717, Ratio=3.02x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.742, Ratio=3.11x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.720, Ratio=3.06x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.753, Ratio=3.12x, Gap=-3.962
Batch 350/537: Loss=1.0880 (C:1.0880, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.757, Ratio=3.18x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.745, Ratio=3.10x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.762, Ratio=3.22x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.742, Ratio=3.16x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.739, Ratio=3.04x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.760, Ratio=3.07x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.749, Ratio=3.09x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.770, Ratio=3.29x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.735, Ratio=3.05x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.732, Ratio=3.01x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.773, Ratio=3.26x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.731, Ratio=2.99x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.763, Ratio=3.21x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.757, Ratio=3.18x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.749, Ratio=3.08x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.730, Ratio=3.06x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.737, Ratio=3.13x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.738, Ratio=2.97x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.718, Ratio=3.06x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.736, Ratio=3.18x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.748, Ratio=3.11x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.742, Ratio=3.08x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.747, Ratio=3.08x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.735, Ratio=3.06x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.740, Ratio=3.04x, Gap=-3.819
Batch 375/537: Loss=1.1046 (C:1.1046, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.768, Ratio=3.16x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.737, Ratio=3.02x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.763, Ratio=3.22x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.751, Ratio=3.13x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.764, Ratio=3.26x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.728, Ratio=3.17x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.722, Ratio=3.04x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.726, Ratio=3.03x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.740, Ratio=3.07x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.733, Ratio=3.00x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.725, Ratio=3.01x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.764, Ratio=3.32x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.749, Ratio=3.20x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.758, Ratio=3.18x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.759, Ratio=3.23x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.729, Ratio=3.02x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.721, Ratio=3.05x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.734, Ratio=3.10x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.746, Ratio=3.11x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.739, Ratio=3.00x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.752, Ratio=3.23x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.731, Ratio=3.04x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.761, Ratio=3.17x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.739, Ratio=3.13x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.758, Ratio=3.30x, Gap=-3.826
Batch 400/537: Loss=1.0502 (C:1.0502, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.723, Ratio=3.02x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.732, Ratio=3.14x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.727, Ratio=2.96x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.707, Ratio=2.93x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.734, Ratio=3.05x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.748, Ratio=3.17x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.741, Ratio=3.21x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.762, Ratio=3.09x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.749, Ratio=3.12x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.782, Ratio=3.35x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.758, Ratio=3.18x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.737, Ratio=3.16x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.739, Ratio=2.98x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.779, Ratio=3.30x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.759, Ratio=3.01x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.749, Ratio=3.21x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.736, Ratio=3.06x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.579, Neg=1.730, Ratio=2.99x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.751, Ratio=3.06x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.731, Ratio=3.10x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.747, Ratio=3.16x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.725, Ratio=3.05x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.753, Ratio=3.12x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.753, Ratio=3.26x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.754, Ratio=3.16x, Gap=-3.992
Batch 425/537: Loss=1.0821 (C:1.0821, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.755, Ratio=3.17x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.745, Ratio=3.20x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.725, Ratio=3.02x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.744, Ratio=3.13x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.728, Ratio=3.04x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.759, Ratio=3.34x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.757, Ratio=3.20x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.742, Ratio=3.26x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.721, Ratio=3.02x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.748, Ratio=3.12x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.754, Ratio=3.02x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.757, Ratio=3.17x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.734, Ratio=2.98x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.743, Ratio=3.04x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.734, Ratio=3.08x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.757, Ratio=3.18x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.757, Ratio=3.17x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.737, Ratio=3.13x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.718, Ratio=2.99x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.735, Ratio=3.09x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.741, Ratio=3.09x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.746, Ratio=3.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.729, Ratio=3.00x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.764, Ratio=3.25x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.732, Ratio=3.06x, Gap=-3.817
Batch 450/537: Loss=1.1000 (C:1.1000, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.736, Ratio=3.01x, Gap=-4.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.752, Ratio=3.06x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.752, Ratio=3.13x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.741, Ratio=3.04x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.740, Ratio=3.10x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.754, Ratio=3.18x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.727, Ratio=3.02x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.767, Ratio=3.28x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.734, Ratio=3.17x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.766, Ratio=3.31x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.728, Ratio=3.07x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.730, Ratio=3.03x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.725, Ratio=2.99x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.728, Ratio=3.17x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.749, Ratio=3.26x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.730, Ratio=3.20x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.781, Ratio=3.26x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.746, Ratio=3.16x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.760, Ratio=3.12x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.750, Ratio=3.13x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.733, Ratio=3.00x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.739, Ratio=3.06x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.738, Ratio=3.06x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.755, Ratio=3.11x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.754, Ratio=3.09x, Gap=-4.000
Batch 475/537: Loss=1.0956 (C:1.0956, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.739, Ratio=3.14x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.738, Ratio=3.01x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.752, Ratio=3.15x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.736, Ratio=3.07x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.755, Ratio=3.12x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.581, Neg=1.731, Ratio=2.98x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.759, Ratio=3.23x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.777, Ratio=3.28x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.736, Ratio=3.04x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.745, Ratio=3.15x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.731, Ratio=3.07x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.747, Ratio=3.20x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.718, Ratio=3.01x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.732, Ratio=3.00x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.763, Ratio=3.11x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.734, Ratio=3.11x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.739, Ratio=3.11x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.764, Ratio=3.22x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.756, Ratio=3.18x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.752, Ratio=3.12x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.752, Ratio=3.08x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.759, Ratio=3.22x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.764, Ratio=3.24x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.765, Ratio=3.17x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.741, Ratio=3.07x, Gap=-3.766
Batch 500/537: Loss=1.1009 (C:1.1009, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.759, Ratio=3.16x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.768, Ratio=3.28x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.741, Ratio=3.09x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.734, Ratio=2.98x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.758, Ratio=3.29x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.749, Ratio=3.08x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.749, Ratio=3.17x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.729, Ratio=3.00x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.740, Ratio=3.16x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.716, Ratio=3.04x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.743, Ratio=3.20x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.757, Ratio=3.26x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.752, Ratio=3.23x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.734, Ratio=3.11x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.735, Ratio=3.06x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.783, Ratio=3.29x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.743, Ratio=3.04x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.742, Ratio=3.16x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.739, Ratio=3.06x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.745, Ratio=3.08x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.578, Neg=1.739, Ratio=3.01x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.735, Ratio=3.08x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.735, Ratio=3.06x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.740, Ratio=3.06x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.758, Ratio=3.21x, Gap=-3.880
Batch 525/537: Loss=1.0684 (C:1.0684, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.759, Ratio=3.26x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.749, Ratio=3.20x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.760, Ratio=3.25x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.758, Ratio=3.21x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.774, Ratio=3.27x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.13x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.753, Ratio=3.07x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.751, Ratio=3.21x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.732, Ratio=3.01x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.747, Ratio=3.07x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.738, Ratio=3.10x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.762, Ratio=3.37x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.758, Ratio=3.25x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.733, Ratio=3.15x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.758, Ratio=3.28x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.761, Ratio=3.34x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.746, Ratio=3.23x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.758, Ratio=3.36x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.745, Ratio=3.20x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.759, Ratio=3.40x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.776, Ratio=3.46x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.772, Ratio=3.45x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.755, Ratio=3.37x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.770, Ratio=3.37x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.746, Ratio=3.29x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.765, Ratio=3.41x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.754, Ratio=3.32x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.754, Ratio=3.33x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.759, Ratio=3.35x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.766, Ratio=3.28x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.767, Ratio=3.41x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.750, Ratio=3.29x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.43x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.759, Ratio=3.34x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.770, Ratio=3.46x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.761, Ratio=3.29x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.767, Ratio=3.46x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.778, Ratio=3.43x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.769, Ratio=3.36x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.758, Ratio=3.32x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.754, Ratio=3.31x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.760, Ratio=3.47x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.760, Ratio=3.44x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.745, Ratio=3.28x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.760, Ratio=3.26x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.764, Ratio=3.35x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.769, Ratio=3.38x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.754, Ratio=3.30x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.769, Ratio=3.33x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.738, Ratio=3.28x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.747, Ratio=3.22x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.754, Ratio=3.31x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.768, Ratio=3.42x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.744, Ratio=3.26x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.770, Ratio=3.40x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.755, Ratio=3.19x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.759, Ratio=3.32x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.781, Ratio=3.54x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.777, Ratio=3.41x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.780, Ratio=3.56x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.756, Ratio=3.23x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.773, Ratio=3.37x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.754, Ratio=3.30x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.747, Ratio=3.23x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.784, Ratio=3.46x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.753, Ratio=3.32x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.755, Ratio=3.31x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.753, Ratio=3.18x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.736, Ratio=3.26x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.779, Ratio=3.45x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.772, Ratio=3.42x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.791, Ratio=3.53x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.759, Ratio=3.34x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.726, Ratio=3.22x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.770, Ratio=3.38x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.779, Ratio=3.44x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.787, Ratio=3.56x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.771, Ratio=3.43x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.765, Ratio=3.36x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.761, Ratio=3.39x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.748, Ratio=3.24x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.744, Ratio=3.26x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.768, Ratio=3.47x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.768, Ratio=3.30x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.751, Ratio=3.32x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.768, Ratio=3.41x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.747, Ratio=3.24x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.748, Ratio=3.32x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.768, Ratio=3.47x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.762, Ratio=3.42x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.755, Ratio=3.28x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.755, Ratio=3.29x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.779, Ratio=3.50x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.740, Ratio=3.20x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.768, Ratio=3.39x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.761, Ratio=3.35x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.776, Ratio=3.39x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.746, Ratio=3.33x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.768, Ratio=3.43x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.770, Ratio=3.43x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.775, Ratio=3.40x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.788, Ratio=3.52x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.774, Ratio=3.51x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.749, Ratio=3.27x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.772, Ratio=3.38x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.756, Ratio=3.26x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.751, Ratio=3.27x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.752, Ratio=3.22x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.739, Ratio=3.17x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.766, Ratio=3.34x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.771, Ratio=3.37x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.771, Ratio=3.43x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.752, Ratio=3.29x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.743, Ratio=3.21x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.764, Ratio=3.35x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.739, Ratio=3.23x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.767, Ratio=3.38x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.789, Ratio=3.53x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.748, Ratio=3.22x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.776, Ratio=3.31x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.756, Ratio=3.23x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.760, Ratio=3.22x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.777, Ratio=3.36x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.756, Ratio=3.31x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.756, Ratio=3.31x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.761, Ratio=3.33x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.762, Ratio=3.44x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.760, Ratio=3.30x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.41x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.776, Ratio=3.42x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.763, Ratio=3.38x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.777, Ratio=3.50x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.752, Ratio=3.28x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.755, Ratio=3.41x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.762, Ratio=3.44x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.773, Ratio=3.50x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.754, Ratio=3.26x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.764, Ratio=3.45x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.762, Ratio=3.39x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.775, Ratio=3.44x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.758, Ratio=3.22x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.777, Ratio=3.34x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.761, Ratio=3.46x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.767, Ratio=3.42x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.761, Ratio=3.28x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.748, Ratio=3.21x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.757, Ratio=3.24x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.772, Ratio=3.42x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.787, Ratio=3.60x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.761, Ratio=3.43x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.762, Ratio=3.29x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.769, Ratio=3.33x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.772, Ratio=3.36x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.766, Ratio=3.45x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.757, Ratio=3.31x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.770, Ratio=3.44x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.767, Ratio=3.34x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.748, Ratio=3.17x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.778, Ratio=3.50x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.759, Ratio=3.37x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.778, Ratio=3.43x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.746, Ratio=3.29x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.779, Ratio=3.48x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.768, Ratio=3.29x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.776, Ratio=3.53x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.765, Ratio=3.25x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.787, Ratio=3.43x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.752, Ratio=3.23x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.758, Ratio=3.26x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.754, Ratio=3.29x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.768, Ratio=3.41x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.769, Ratio=3.35x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.742, Ratio=3.30x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.768, Ratio=3.37x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.771, Ratio=3.43x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.748, Ratio=3.24x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.766, Ratio=3.20x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.750, Ratio=3.23x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.773, Ratio=3.44x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.743, Ratio=3.26x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.741, Ratio=3.15x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.751, Ratio=3.17x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.759, Ratio=3.28x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.756, Ratio=3.24x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.786, Ratio=3.41x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.767, Ratio=3.33x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.748, Ratio=3.17x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.781, Ratio=3.50x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.752, Ratio=3.40x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.790, Ratio=3.44x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.766, Ratio=3.33x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.780, Ratio=3.51x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.31x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.753, Ratio=3.34x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.760, Ratio=3.36x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.776, Ratio=3.44x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.763, Ratio=3.32x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.779, Ratio=3.44x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.736, Ratio=3.13x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.767, Ratio=3.36x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.735, Ratio=3.18x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.759, Ratio=3.27x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.784, Ratio=3.53x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.777, Ratio=3.49x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.771, Ratio=3.38x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.745, Ratio=3.32x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.767, Ratio=3.41x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.786, Ratio=3.49x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.781, Ratio=3.47x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.769, Ratio=3.42x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.776, Ratio=3.38x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.763, Ratio=3.49x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.741, Ratio=3.24x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.768, Ratio=3.31x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.761, Ratio=3.46x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.762, Ratio=3.34x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.746, Ratio=3.22x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.765, Ratio=3.45x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.783, Ratio=3.42x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.762, Ratio=3.41x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.758, Ratio=3.35x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.754, Ratio=3.28x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.753, Ratio=3.19x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.751, Ratio=3.31x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.766, Ratio=3.38x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.751, Ratio=3.21x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.746, Ratio=3.27x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.760, Ratio=3.42x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.760, Ratio=3.17x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.751, Ratio=3.33x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.736, Ratio=3.32x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.751, Ratio=3.19x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.753, Ratio=3.34x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.759, Ratio=3.35x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.758, Ratio=3.21x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.755, Ratio=3.33x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.748, Ratio=3.14x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.749, Ratio=3.32x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.775, Ratio=3.51x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.758, Ratio=3.33x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.716, Ratio=3.12x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.743, Ratio=3.28x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.757, Ratio=3.32x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.755, Ratio=3.32x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.770, Ratio=3.36x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.766, Ratio=3.49x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.770, Ratio=3.46x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.748, Ratio=3.26x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.740, Ratio=3.26x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.746, Ratio=3.24x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.754, Ratio=3.28x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.756, Ratio=3.31x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.751, Ratio=3.32x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.729, Ratio=3.15x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.757, Ratio=3.28x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.781, Ratio=3.51x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.773, Ratio=3.42x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.764, Ratio=3.38x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.744, Ratio=3.25x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.742, Ratio=3.41x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.39x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.762, Ratio=3.25x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.762, Ratio=3.37x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.759, Ratio=3.34x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.754, Ratio=3.27x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.745, Ratio=3.35x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.771, Ratio=3.38x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.775, Ratio=3.45x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.779, Ratio=3.49x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.783, Ratio=3.40x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.767, Ratio=3.39x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.760, Ratio=3.40x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.750, Ratio=3.24x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.761, Ratio=3.38x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.742, Ratio=3.28x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.752, Ratio=3.29x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.753, Ratio=3.32x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.747, Ratio=3.33x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.762, Ratio=3.38x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.761, Ratio=3.24x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.755, Ratio=3.32x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.721, Ratio=3.08x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.763, Ratio=3.37x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.770, Ratio=3.47x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.759, Ratio=3.23x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.764, Ratio=3.44x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.742, Ratio=3.18x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.763, Ratio=3.35x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.763, Ratio=3.29x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.769, Ratio=3.44x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.774, Ratio=3.54x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.792, Ratio=3.51x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.42x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.772, Ratio=3.37x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.779, Ratio=3.39x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.736, Ratio=3.27x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.756, Ratio=3.33x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.759, Ratio=3.33x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.770, Ratio=3.30x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.751, Ratio=3.33x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.773, Ratio=3.40x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.783, Ratio=3.59x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.772, Ratio=3.46x, Gap=-3.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.782, Ratio=3.58x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.762, Ratio=3.34x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.735, Ratio=3.17x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.770, Ratio=3.46x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.743, Ratio=3.24x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.797, Ratio=3.59x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.745, Ratio=3.29x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.755, Ratio=3.30x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.770, Ratio=3.47x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.769, Ratio=3.43x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.754, Ratio=3.25x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.749, Ratio=3.21x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.31x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.758, Ratio=3.37x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.40x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.740, Ratio=3.17x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.768, Ratio=3.43x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.772, Ratio=3.42x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.758, Ratio=3.32x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.759, Ratio=3.28x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.767, Ratio=3.34x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.759, Ratio=3.41x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.774, Ratio=3.45x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.760, Ratio=3.28x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.771, Ratio=3.49x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.802, Ratio=3.67x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.758, Ratio=3.31x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.762, Ratio=3.43x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.744, Ratio=3.15x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.754, Ratio=3.28x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.773, Ratio=3.41x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.748, Ratio=3.31x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.768, Ratio=3.40x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.756, Ratio=3.43x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.778, Ratio=3.48x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.761, Ratio=3.47x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.755, Ratio=3.28x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.765, Ratio=3.38x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.758, Ratio=3.37x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.761, Ratio=3.37x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.771, Ratio=3.43x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.773, Ratio=3.46x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.747, Ratio=3.25x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.806, Ratio=3.52x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.764, Ratio=3.28x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.757, Ratio=3.26x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.755, Ratio=3.30x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.738, Ratio=3.27x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.767, Ratio=3.46x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.752, Ratio=3.33x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.740, Ratio=3.25x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.772, Ratio=3.34x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.768, Ratio=3.31x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.775, Ratio=3.45x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.757, Ratio=3.26x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.779, Ratio=3.52x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.759, Ratio=3.42x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.768, Ratio=3.36x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.744, Ratio=3.31x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.773, Ratio=3.54x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.761, Ratio=3.41x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.758, Ratio=3.36x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.753, Ratio=3.28x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.767, Ratio=3.39x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.760, Ratio=3.31x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.783, Ratio=3.52x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.765, Ratio=3.35x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.739, Ratio=3.17x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.777, Ratio=3.54x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.762, Ratio=3.32x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.755, Ratio=3.35x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.755, Ratio=3.40x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.746, Ratio=3.25x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.771, Ratio=3.34x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.746, Ratio=3.24x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.744, Ratio=3.26x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.750, Ratio=3.31x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.752, Ratio=3.34x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.745, Ratio=3.30x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.757, Ratio=3.35x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.774, Ratio=3.44x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.762, Ratio=3.36x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.760, Ratio=3.27x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.755, Ratio=3.24x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.770, Ratio=3.39x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.754, Ratio=3.22x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.776, Ratio=3.41x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.776, Ratio=3.32x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.781, Ratio=3.57x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.755, Ratio=3.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.766, Ratio=3.34x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.772, Ratio=3.42x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.769, Ratio=3.43x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.790, Ratio=3.68x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.758, Ratio=3.36x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.770, Ratio=3.37x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.747, Ratio=3.29x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.761, Ratio=3.29x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.765, Ratio=3.34x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.771, Ratio=3.38x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.734, Ratio=3.19x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.787, Ratio=3.50x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.763, Ratio=3.24x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.769, Ratio=3.39x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.757, Ratio=3.30x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.739, Ratio=3.15x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.755, Ratio=3.35x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.738, Ratio=3.21x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.754, Ratio=3.29x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.771, Ratio=3.44x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.763, Ratio=3.41x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.760, Ratio=3.37x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.750, Ratio=3.30x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.769, Ratio=3.43x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.728, Ratio=3.15x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.764, Ratio=3.41x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.763, Ratio=3.40x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.769, Ratio=3.46x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.750, Ratio=3.28x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.756, Ratio=3.32x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.747, Ratio=3.22x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.767, Ratio=3.34x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.752, Ratio=3.25x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.756, Ratio=3.18x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.788, Ratio=3.45x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.758, Ratio=3.45x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.749, Ratio=3.23x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.780, Ratio=3.32x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.767, Ratio=3.22x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.784, Ratio=3.38x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.796, Ratio=3.57x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.789, Ratio=3.50x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.776, Ratio=3.43x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.761, Ratio=3.24x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.735, Ratio=3.13x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.755, Ratio=3.39x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.749, Ratio=3.26x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.773, Ratio=3.45x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.751, Ratio=3.26x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.743, Ratio=3.29x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.784, Ratio=3.44x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.755, Ratio=3.33x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.745, Ratio=3.26x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.768, Ratio=3.46x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.778, Ratio=3.40x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.776, Ratio=3.59x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.761, Ratio=3.30x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.773, Ratio=3.36x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.772, Ratio=3.39x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.771, Ratio=3.43x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.781, Ratio=3.59x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.778, Ratio=3.48x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.767, Ratio=3.31x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.749, Ratio=3.26x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.784, Ratio=3.39x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.777, Ratio=3.40x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.787, Ratio=3.59x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.756, Ratio=3.35x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.769, Ratio=3.40x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.755, Ratio=3.37x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.755, Ratio=3.27x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.769, Ratio=3.45x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.792, Ratio=3.61x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.783, Ratio=3.53x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.769, Ratio=3.23x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.751, Ratio=3.35x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.774, Ratio=3.35x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.769, Ratio=3.38x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.755, Ratio=3.33x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.773, Ratio=3.46x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.769, Ratio=3.24x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.765, Ratio=3.39x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.789, Ratio=3.58x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.757, Ratio=3.22x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.768, Ratio=3.49x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.747, Ratio=3.27x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.768, Ratio=3.37x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.762, Ratio=3.38x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.760, Ratio=3.37x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.761, Ratio=3.38x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.757, Ratio=3.30x, Gap=-3.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.768, Ratio=3.42x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.761, Ratio=3.44x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.733, Ratio=3.18x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.779, Ratio=3.53x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.781, Ratio=3.42x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.732, Ratio=3.21x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.775, Ratio=3.34x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.768, Ratio=3.35x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.740, Ratio=3.14x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.786, Ratio=3.45x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.750, Ratio=3.30x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.773, Ratio=3.41x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.758, Ratio=3.26x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.767, Ratio=3.36x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.773, Ratio=3.43x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.776, Ratio=3.38x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.778, Ratio=3.46x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.753, Ratio=3.38x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.754, Ratio=3.30x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.731, Ratio=3.12x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.775, Ratio=3.32x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.748, Ratio=3.30x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.732, Ratio=3.21x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.753, Ratio=3.33x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.743, Ratio=3.28x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.767, Ratio=3.39x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.766, Ratio=3.36x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.771, Ratio=3.50x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.741, Ratio=3.25x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.762, Ratio=3.41x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.761, Ratio=3.32x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.781, Ratio=3.59x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.756, Ratio=3.32x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.759, Ratio=3.30x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.751, Ratio=3.21x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.775, Ratio=3.43x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.777, Ratio=3.39x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.33x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.752, Ratio=3.25x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.777, Ratio=3.48x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.782, Ratio=3.46x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.742, Ratio=3.31x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.750, Ratio=3.14x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.755, Ratio=3.36x, Gap=-3.798

============================================================
Epoch 8/20 completed in 32.0s
Train: Loss=1.0855 (C:1.0855, R:0.0105) Ratio=2.99x
Val:   Loss=1.0437 (C:1.0437, R:0.0105) Ratio=3.54x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.0437)
============================================================

Epoch 9 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.755, Ratio=3.30x, Gap=-3.922
Batch   0/537: Loss=1.0500 (C:1.0500, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.746, Ratio=3.25x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.739, Ratio=3.14x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.742, Ratio=3.11x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.760, Ratio=3.24x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.738, Ratio=3.07x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.720, Ratio=3.02x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.750, Ratio=3.08x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.743, Ratio=3.10x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.752, Ratio=3.20x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.768, Ratio=3.29x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.770, Ratio=3.27x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.749, Ratio=3.17x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.781, Ratio=3.34x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.753, Ratio=3.18x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.777, Ratio=3.35x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.577, Neg=1.747, Ratio=3.03x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.749, Ratio=3.20x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.774, Ratio=3.25x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.764, Ratio=3.32x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.750, Ratio=3.21x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.761, Ratio=3.33x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.739, Ratio=3.17x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.757, Ratio=3.20x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.764, Ratio=3.26x, Gap=-4.050
Batch  25/537: Loss=1.0572 (C:1.0572, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.761, Ratio=3.25x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.752, Ratio=3.06x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.765, Ratio=3.22x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.754, Ratio=3.18x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.751, Ratio=3.14x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.761, Ratio=3.27x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.743, Ratio=3.14x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.773, Ratio=3.35x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.763, Ratio=3.25x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.749, Ratio=3.17x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.762, Ratio=3.26x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.758, Ratio=3.22x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.773, Ratio=3.33x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.771, Ratio=3.35x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.729, Ratio=3.05x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.744, Ratio=3.14x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.749, Ratio=3.22x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.755, Ratio=3.28x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.745, Ratio=3.18x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.750, Ratio=3.15x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.741, Ratio=3.08x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.750, Ratio=3.17x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.743, Ratio=3.03x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.735, Ratio=3.08x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.768, Ratio=3.22x, Gap=-3.964
Batch  50/537: Loss=1.0637 (C:1.0637, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.771, Ratio=3.45x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.766, Ratio=3.17x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.764, Ratio=3.16x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.758, Ratio=3.17x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.760, Ratio=3.24x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.740, Ratio=3.17x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.730, Ratio=3.22x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.746, Ratio=3.19x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.742, Ratio=3.08x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.756, Ratio=3.19x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.757, Ratio=3.21x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.762, Ratio=3.23x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.766, Ratio=3.27x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.761, Ratio=3.19x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.741, Ratio=3.11x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.748, Ratio=3.16x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.752, Ratio=3.12x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.775, Ratio=3.23x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.751, Ratio=3.23x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.754, Ratio=3.16x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.749, Ratio=3.20x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.767, Ratio=3.41x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.758, Ratio=3.26x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.762, Ratio=3.32x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.754, Ratio=3.22x, Gap=-3.891
Batch  75/537: Loss=1.0673 (C:1.0673, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.739, Ratio=3.12x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.755, Ratio=3.27x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.767, Ratio=3.26x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.755, Ratio=3.13x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.580, Neg=1.736, Ratio=2.99x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.760, Ratio=3.09x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.774, Ratio=3.23x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.759, Ratio=3.17x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.773, Ratio=3.29x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.743, Ratio=3.14x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.742, Ratio=3.20x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.755, Ratio=3.28x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.767, Ratio=3.24x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.747, Ratio=3.20x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.781, Ratio=3.30x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.761, Ratio=3.22x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.746, Ratio=3.20x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.737, Ratio=3.15x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.755, Ratio=3.20x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.742, Ratio=3.08x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.757, Ratio=3.17x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.741, Ratio=3.06x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.754, Ratio=3.17x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.773, Ratio=3.24x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.573, Neg=1.715, Ratio=3.00x, Gap=-3.774
Batch 100/537: Loss=1.1196 (C:1.1196, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.733, Ratio=3.29x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.743, Ratio=3.28x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.737, Ratio=3.08x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.741, Ratio=3.09x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.747, Ratio=3.13x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.742, Ratio=3.07x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.729, Ratio=3.00x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.772, Ratio=3.23x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.764, Ratio=3.26x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.730, Ratio=3.07x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.760, Ratio=3.26x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.741, Ratio=3.11x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.740, Ratio=3.09x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.751, Ratio=3.17x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.738, Ratio=3.14x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.753, Ratio=3.23x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.765, Ratio=3.27x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.741, Ratio=3.08x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.763, Ratio=3.23x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.758, Ratio=3.20x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.743, Ratio=3.13x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.737, Ratio=3.05x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.783, Ratio=3.19x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.772, Ratio=3.27x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.760, Ratio=3.29x, Gap=-3.788
Batch 125/537: Loss=1.0553 (C:1.0553, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.757, Ratio=3.15x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.770, Ratio=3.27x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.761, Ratio=3.22x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.785, Ratio=3.36x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.769, Ratio=3.24x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.746, Ratio=3.15x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.748, Ratio=3.20x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.748, Ratio=3.22x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.727, Ratio=3.08x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.725, Ratio=3.14x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.736, Ratio=3.08x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.744, Ratio=3.16x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.755, Ratio=3.23x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.734, Ratio=3.07x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.739, Ratio=3.17x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.764, Ratio=3.25x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.747, Ratio=3.16x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.756, Ratio=3.20x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.740, Ratio=3.12x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.769, Ratio=3.20x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.763, Ratio=3.21x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.583, Neg=1.743, Ratio=2.99x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.753, Ratio=3.16x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.766, Ratio=3.12x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.738, Ratio=3.19x, Gap=-3.678
Batch 150/537: Loss=1.0752 (C:1.0752, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.753, Ratio=3.19x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.787, Ratio=3.40x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.775, Ratio=3.31x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.763, Ratio=3.14x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.759, Ratio=3.24x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.745, Ratio=3.12x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.740, Ratio=3.08x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.758, Ratio=3.27x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.748, Ratio=3.13x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.747, Ratio=3.11x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.757, Ratio=3.20x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.780, Ratio=3.38x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.742, Ratio=3.08x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.754, Ratio=3.12x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.740, Ratio=3.13x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.766, Ratio=3.34x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.743, Ratio=3.10x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.765, Ratio=3.20x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.732, Ratio=3.01x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.750, Ratio=3.17x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.735, Ratio=3.11x, Gap=-4.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.767, Ratio=3.22x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.743, Ratio=3.14x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.778, Ratio=3.32x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.750, Ratio=3.14x, Gap=-3.589
Batch 175/537: Loss=1.0843 (C:1.0843, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.760, Ratio=3.19x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.734, Ratio=3.07x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.751, Ratio=3.11x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.745, Ratio=3.14x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.756, Ratio=3.21x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.745, Ratio=3.16x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.759, Ratio=3.23x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.740, Ratio=3.12x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.756, Ratio=3.23x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.740, Ratio=3.09x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.745, Ratio=3.21x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.751, Ratio=3.24x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.740, Ratio=3.13x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.751, Ratio=3.11x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.764, Ratio=3.34x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.762, Ratio=3.20x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.770, Ratio=3.21x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.768, Ratio=3.18x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.759, Ratio=3.12x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.778, Ratio=3.36x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.761, Ratio=3.17x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.767, Ratio=3.18x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.757, Ratio=3.24x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.752, Ratio=3.17x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.750, Ratio=3.21x, Gap=-3.723
Batch 200/537: Loss=1.0730 (C:1.0730, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.750, Ratio=3.28x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.738, Ratio=3.18x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.755, Ratio=3.21x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.755, Ratio=3.13x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.746, Ratio=3.08x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.762, Ratio=3.10x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.754, Ratio=3.10x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.775, Ratio=3.24x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.774, Ratio=3.22x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.739, Ratio=3.13x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.763, Ratio=3.18x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.764, Ratio=3.19x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.753, Ratio=3.25x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.753, Ratio=3.27x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.752, Ratio=3.16x, Gap=-4.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.731, Ratio=3.12x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.755, Ratio=3.26x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.777, Ratio=3.41x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.760, Ratio=3.32x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.751, Ratio=3.18x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.798, Ratio=3.57x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.751, Ratio=3.25x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.749, Ratio=3.12x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.768, Ratio=3.23x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.743, Ratio=3.10x, Gap=-4.001
Batch 225/537: Loss=1.0947 (C:1.0947, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.768, Ratio=3.17x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.751, Ratio=3.16x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.744, Ratio=3.06x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.747, Ratio=3.23x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.764, Ratio=3.27x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.767, Ratio=3.34x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.766, Ratio=3.30x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.740, Ratio=3.22x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.762, Ratio=3.23x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.769, Ratio=3.22x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.747, Ratio=3.07x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.757, Ratio=3.10x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.738, Ratio=3.02x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.766, Ratio=3.23x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.773, Ratio=3.19x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.737, Ratio=3.07x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.732, Ratio=3.01x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.745, Ratio=3.09x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.742, Ratio=3.09x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.766, Ratio=3.23x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.748, Ratio=3.09x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.744, Ratio=3.17x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.756, Ratio=3.21x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.771, Ratio=3.24x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.748, Ratio=3.13x, Gap=-3.743
Batch 250/537: Loss=1.0878 (C:1.0878, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.768, Ratio=3.22x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.763, Ratio=3.20x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.745, Ratio=3.13x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.745, Ratio=3.13x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.770, Ratio=3.24x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.739, Ratio=3.20x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.796, Ratio=3.44x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.728, Ratio=3.15x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.767, Ratio=3.26x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.739, Ratio=3.07x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.729, Ratio=3.12x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.742, Ratio=3.15x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.749, Ratio=3.17x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.754, Ratio=3.30x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.737, Ratio=3.10x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.737, Ratio=3.08x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.743, Ratio=3.19x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.761, Ratio=3.28x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.757, Ratio=3.11x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.719, Ratio=3.05x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.770, Ratio=3.32x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.755, Ratio=3.11x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.761, Ratio=3.12x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.737, Ratio=3.07x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.746, Ratio=3.09x, Gap=-4.047
Batch 275/537: Loss=1.0980 (C:1.0980, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.757, Ratio=3.19x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.736, Ratio=3.05x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.755, Ratio=3.18x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.763, Ratio=3.20x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.775, Ratio=3.26x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.746, Ratio=3.04x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.746, Ratio=3.31x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.764, Ratio=3.20x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.776, Ratio=3.33x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.734, Ratio=3.04x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.771, Ratio=3.35x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.757, Ratio=3.20x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.746, Ratio=3.08x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.744, Ratio=3.10x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.742, Ratio=3.14x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.750, Ratio=3.14x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.574, Neg=1.756, Ratio=3.06x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.753, Ratio=3.12x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.765, Ratio=3.18x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.773, Ratio=3.33x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.781, Ratio=3.37x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.774, Ratio=3.21x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.757, Ratio=3.22x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.746, Ratio=3.07x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.759, Ratio=3.17x, Gap=-4.306
Batch 300/537: Loss=1.0767 (C:1.0767, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.761, Ratio=3.18x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.734, Ratio=3.13x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.747, Ratio=3.19x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.723, Ratio=3.02x, Gap=-4.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.764, Ratio=3.32x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.756, Ratio=3.24x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.733, Ratio=3.11x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.742, Ratio=3.13x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.754, Ratio=3.21x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.737, Ratio=3.15x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.742, Ratio=3.12x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.764, Ratio=3.27x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.758, Ratio=3.12x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.772, Ratio=3.28x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.745, Ratio=3.10x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.760, Ratio=3.20x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.774, Ratio=3.25x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.767, Ratio=3.20x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.765, Ratio=3.13x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.743, Ratio=3.02x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.787, Ratio=3.45x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.751, Ratio=3.04x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.764, Ratio=3.22x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.772, Ratio=3.28x, Gap=-4.021
Batch 325/537: Loss=1.0544 (C:1.0544, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.775, Ratio=3.30x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.733, Ratio=3.14x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.739, Ratio=3.14x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.747, Ratio=3.12x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.763, Ratio=3.18x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.751, Ratio=3.19x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.746, Ratio=3.18x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.758, Ratio=3.26x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.746, Ratio=3.18x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.757, Ratio=3.17x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.754, Ratio=3.20x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.736, Ratio=3.04x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.775, Ratio=3.33x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.765, Ratio=3.29x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.770, Ratio=3.26x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.734, Ratio=3.01x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.740, Ratio=3.07x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.771, Ratio=3.21x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.754, Ratio=3.26x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.790, Ratio=3.25x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.758, Ratio=3.16x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.758, Ratio=3.21x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.746, Ratio=3.07x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.777, Ratio=3.38x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.728, Ratio=3.04x, Gap=-4.030
Batch 350/537: Loss=1.1040 (C:1.1040, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.741, Ratio=3.13x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.787, Ratio=3.32x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.739, Ratio=3.12x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.758, Ratio=3.28x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.765, Ratio=3.24x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.718, Ratio=3.03x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.747, Ratio=3.27x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.738, Ratio=3.08x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.747, Ratio=3.09x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.752, Ratio=3.16x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.764, Ratio=3.26x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.764, Ratio=3.30x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.739, Ratio=3.10x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.753, Ratio=3.17x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.757, Ratio=3.20x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.754, Ratio=3.20x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.734, Ratio=3.14x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.749, Ratio=3.17x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.757, Ratio=3.23x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.734, Ratio=3.16x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.759, Ratio=3.20x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.751, Ratio=3.21x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.761, Ratio=3.35x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.739, Ratio=3.06x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.766, Ratio=3.35x, Gap=-4.330
Batch 375/537: Loss=1.0433 (C:1.0433, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.765, Ratio=3.12x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.754, Ratio=3.19x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.757, Ratio=3.24x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.754, Ratio=3.11x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.759, Ratio=3.25x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.737, Ratio=3.24x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.741, Ratio=3.13x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.756, Ratio=3.26x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.778, Ratio=3.19x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.785, Ratio=3.17x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.732, Ratio=3.09x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.772, Ratio=3.23x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.758, Ratio=3.16x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.758, Ratio=3.16x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.744, Ratio=3.13x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.764, Ratio=3.25x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.756, Ratio=3.15x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.749, Ratio=3.16x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.773, Ratio=3.31x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.728, Ratio=3.08x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.744, Ratio=3.16x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.737, Ratio=3.14x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.746, Ratio=3.15x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.762, Ratio=3.23x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.747, Ratio=3.13x, Gap=-3.748
Batch 400/537: Loss=1.0853 (C:1.0853, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.765, Ratio=3.16x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.759, Ratio=3.20x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.761, Ratio=3.22x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.758, Ratio=3.16x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.741, Ratio=3.13x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.766, Ratio=3.30x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.735, Ratio=3.09x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.758, Ratio=3.11x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.745, Ratio=3.16x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.741, Ratio=3.05x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.739, Ratio=3.12x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.752, Ratio=3.19x, Gap=-3.875
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.749, Ratio=3.16x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.707, Ratio=2.92x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.760, Ratio=3.24x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.734, Ratio=3.18x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.740, Ratio=3.07x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.744, Ratio=3.12x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.767, Ratio=3.24x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.773, Ratio=3.29x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.745, Ratio=3.10x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.769, Ratio=3.25x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.727, Ratio=3.04x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.764, Ratio=3.30x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.753, Ratio=3.11x, Gap=-3.804
Batch 425/537: Loss=1.0915 (C:1.0915, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.756, Ratio=3.15x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.751, Ratio=3.11x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.752, Ratio=3.18x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.769, Ratio=3.21x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.763, Ratio=3.28x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.759, Ratio=3.20x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.756, Ratio=3.19x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.730, Ratio=3.07x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.729, Ratio=3.05x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.713, Ratio=2.94x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.735, Ratio=3.10x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.767, Ratio=3.21x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.760, Ratio=3.19x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.744, Ratio=3.16x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.734, Ratio=3.05x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.746, Ratio=3.11x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.751, Ratio=3.15x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.747, Ratio=3.24x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.748, Ratio=3.12x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.765, Ratio=3.21x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.760, Ratio=3.24x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.746, Ratio=3.21x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.766, Ratio=3.23x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.732, Ratio=3.13x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.766, Ratio=3.13x, Gap=-3.938
Batch 450/537: Loss=1.0840 (C:1.0840, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.750, Ratio=3.08x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.757, Ratio=3.14x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.753, Ratio=3.31x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.761, Ratio=3.20x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.734, Ratio=3.14x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.760, Ratio=3.30x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.743, Ratio=3.13x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.763, Ratio=3.29x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.737, Ratio=3.09x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.783, Ratio=3.35x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.741, Ratio=3.14x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.751, Ratio=3.21x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.767, Ratio=3.18x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.748, Ratio=3.22x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.774, Ratio=3.31x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.774, Ratio=3.19x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.753, Ratio=3.16x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.757, Ratio=3.18x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.750, Ratio=3.13x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.731, Ratio=3.12x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.759, Ratio=3.21x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.755, Ratio=3.20x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.779, Ratio=3.28x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.739, Ratio=3.10x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.755, Ratio=3.20x, Gap=-4.304
Batch 475/537: Loss=1.0704 (C:1.0704, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.724, Ratio=3.13x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.754, Ratio=3.22x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.766, Ratio=3.25x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.765, Ratio=3.24x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.769, Ratio=3.25x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.752, Ratio=3.25x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.762, Ratio=3.23x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.778, Ratio=3.36x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.584, Neg=1.744, Ratio=2.99x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.767, Ratio=3.16x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.779, Ratio=3.30x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.779, Ratio=3.36x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.587, Neg=1.741, Ratio=2.97x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.745, Ratio=3.10x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.749, Ratio=3.15x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.737, Ratio=3.08x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.733, Ratio=3.13x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.576, Neg=1.758, Ratio=3.05x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.745, Ratio=3.05x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.772, Ratio=3.28x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.731, Ratio=3.13x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.718, Ratio=3.07x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.728, Ratio=3.03x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.747, Ratio=3.17x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.735, Ratio=3.13x, Gap=-3.952
Batch 500/537: Loss=1.0860 (C:1.0860, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.738, Ratio=3.08x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.743, Ratio=3.14x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.725, Ratio=3.05x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.725, Ratio=3.02x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.771, Ratio=3.23x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.759, Ratio=3.25x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.767, Ratio=3.20x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.766, Ratio=3.19x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.775, Ratio=3.28x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.752, Ratio=3.21x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.758, Ratio=3.18x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.765, Ratio=3.17x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.754, Ratio=3.13x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.748, Ratio=3.22x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.744, Ratio=3.09x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.748, Ratio=3.10x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.739, Ratio=3.12x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.763, Ratio=3.24x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.731, Ratio=3.04x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.766, Ratio=3.27x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.761, Ratio=3.16x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.747, Ratio=3.16x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.750, Ratio=3.16x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.746, Ratio=3.15x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.736, Ratio=3.03x, Gap=-3.869
Batch 525/537: Loss=1.1107 (C:1.1107, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.747, Ratio=3.09x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.764, Ratio=3.21x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.743, Ratio=3.11x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.780, Ratio=3.30x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.766, Ratio=3.26x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.752, Ratio=3.21x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.750, Ratio=3.17x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.762, Ratio=3.23x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.757, Ratio=3.22x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.736, Ratio=3.09x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.733, Ratio=3.04x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.767, Ratio=3.41x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.34x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.749, Ratio=3.30x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.759, Ratio=3.46x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.776, Ratio=3.41x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.768, Ratio=3.37x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.762, Ratio=3.36x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.727, Ratio=3.22x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.781, Ratio=3.59x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.762, Ratio=3.43x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.768, Ratio=3.47x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.757, Ratio=3.36x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.777, Ratio=3.58x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.753, Ratio=3.27x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.755, Ratio=3.35x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.788, Ratio=3.54x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.757, Ratio=3.40x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.760, Ratio=3.43x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.762, Ratio=3.46x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.762, Ratio=3.26x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.750, Ratio=3.30x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.754, Ratio=3.31x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.773, Ratio=3.39x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.768, Ratio=3.53x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.736, Ratio=3.22x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.771, Ratio=3.42x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.764, Ratio=3.38x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.757, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.756, Ratio=3.27x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.756, Ratio=3.30x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.768, Ratio=3.40x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.758, Ratio=3.27x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.764, Ratio=3.37x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.760, Ratio=3.44x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.766, Ratio=3.38x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.773, Ratio=3.45x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.768, Ratio=3.34x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.752, Ratio=3.40x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.769, Ratio=3.48x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.765, Ratio=3.47x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.34x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.775, Ratio=3.45x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.764, Ratio=3.38x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.748, Ratio=3.31x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.773, Ratio=3.33x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.787, Ratio=3.62x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.760, Ratio=3.48x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.798, Ratio=3.54x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.767, Ratio=3.50x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.785, Ratio=3.46x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.792, Ratio=3.65x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.788, Ratio=3.59x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.759, Ratio=3.32x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.740, Ratio=3.22x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.752, Ratio=3.33x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.749, Ratio=3.26x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.792, Ratio=3.62x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.768, Ratio=3.49x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.33x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.745, Ratio=3.33x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.756, Ratio=3.39x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.759, Ratio=3.27x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.767, Ratio=3.50x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.770, Ratio=3.50x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.750, Ratio=3.31x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.762, Ratio=3.40x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.753, Ratio=3.37x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.784, Ratio=3.56x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.764, Ratio=3.44x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.766, Ratio=3.45x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.765, Ratio=3.47x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.759, Ratio=3.36x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.753, Ratio=3.39x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.778, Ratio=3.43x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.754, Ratio=3.48x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.758, Ratio=3.28x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.759, Ratio=3.45x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.776, Ratio=3.53x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.764, Ratio=3.31x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.761, Ratio=3.40x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.771, Ratio=3.47x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.776, Ratio=3.46x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.750, Ratio=3.25x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.759, Ratio=3.41x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.729, Ratio=3.22x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.747, Ratio=3.28x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.794, Ratio=3.65x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.734, Ratio=3.20x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.760, Ratio=3.38x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.781, Ratio=3.53x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.781, Ratio=3.46x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.761, Ratio=3.41x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.758, Ratio=3.37x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.756, Ratio=3.32x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.776, Ratio=3.34x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.766, Ratio=3.46x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.769, Ratio=3.42x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.759, Ratio=3.39x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.760, Ratio=3.39x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.753, Ratio=3.31x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.737, Ratio=3.26x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.756, Ratio=3.33x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.747, Ratio=3.27x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.751, Ratio=3.37x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.756, Ratio=3.31x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.756, Ratio=3.41x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.773, Ratio=3.45x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.784, Ratio=3.56x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.792, Ratio=3.51x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.735, Ratio=3.18x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.760, Ratio=3.41x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.741, Ratio=3.26x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.731, Ratio=3.24x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.755, Ratio=3.27x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.747, Ratio=3.29x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.756, Ratio=3.44x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.766, Ratio=3.38x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.751, Ratio=3.36x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.766, Ratio=3.31x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.761, Ratio=3.34x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.779, Ratio=3.56x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.767, Ratio=3.43x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.762, Ratio=3.41x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.760, Ratio=3.29x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.785, Ratio=3.53x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.751, Ratio=3.23x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.771, Ratio=3.33x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.781, Ratio=3.51x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.770, Ratio=3.44x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.756, Ratio=3.37x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.759, Ratio=3.39x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.765, Ratio=3.54x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.761, Ratio=3.43x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.750, Ratio=3.30x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.772, Ratio=3.49x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.44x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.778, Ratio=3.43x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.748, Ratio=3.32x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.756, Ratio=3.40x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.770, Ratio=3.40x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.753, Ratio=3.32x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.779, Ratio=3.51x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.753, Ratio=3.37x, Gap=-3.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.747, Ratio=3.38x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.771, Ratio=3.46x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.771, Ratio=3.51x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.767, Ratio=3.45x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.774, Ratio=3.59x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.770, Ratio=3.35x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.783, Ratio=3.50x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.771, Ratio=3.39x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.769, Ratio=3.43x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.769, Ratio=3.41x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.734, Ratio=3.24x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.793, Ratio=3.59x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.769, Ratio=3.45x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.769, Ratio=3.49x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.768, Ratio=3.30x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.765, Ratio=3.47x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.765, Ratio=3.47x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.776, Ratio=3.56x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.767, Ratio=3.35x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.751, Ratio=3.34x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.762, Ratio=3.46x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.758, Ratio=3.28x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.739, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.782, Ratio=3.53x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.772, Ratio=3.50x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.753, Ratio=3.28x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.740, Ratio=3.34x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.780, Ratio=3.53x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.751, Ratio=3.28x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.767, Ratio=3.42x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.769, Ratio=3.58x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.759, Ratio=3.45x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.796, Ratio=3.54x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.763, Ratio=3.52x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.771, Ratio=3.59x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.756, Ratio=3.46x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.757, Ratio=3.43x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.767, Ratio=3.39x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.770, Ratio=3.40x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.767, Ratio=3.44x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.799, Ratio=3.64x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.784, Ratio=3.54x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.775, Ratio=3.48x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.758, Ratio=3.41x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.766, Ratio=3.45x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.782, Ratio=3.59x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.752, Ratio=3.33x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.754, Ratio=3.34x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.777, Ratio=3.45x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.744, Ratio=3.39x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.756, Ratio=3.30x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.760, Ratio=3.24x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.772, Ratio=3.48x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.744, Ratio=3.22x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.797, Ratio=3.57x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.757, Ratio=3.36x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.790, Ratio=3.67x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.774, Ratio=3.44x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.782, Ratio=3.51x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.770, Ratio=3.37x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.781, Ratio=3.48x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.778, Ratio=3.44x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.763, Ratio=3.27x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.758, Ratio=3.41x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.740, Ratio=3.17x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.44x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.758, Ratio=3.38x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.775, Ratio=3.61x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.769, Ratio=3.59x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.742, Ratio=3.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.741, Ratio=3.22x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.726, Ratio=3.28x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.778, Ratio=3.48x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.752, Ratio=3.28x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.765, Ratio=3.43x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.751, Ratio=3.26x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.770, Ratio=3.45x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.747, Ratio=3.33x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.768, Ratio=3.49x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.754, Ratio=3.29x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.762, Ratio=3.35x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.753, Ratio=3.35x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.758, Ratio=3.34x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.729, Ratio=3.26x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.768, Ratio=3.37x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.749, Ratio=3.29x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.754, Ratio=3.35x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.739, Ratio=3.20x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.753, Ratio=3.39x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.754, Ratio=3.36x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.752, Ratio=3.37x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.760, Ratio=3.42x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.746, Ratio=3.30x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.736, Ratio=3.20x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.764, Ratio=3.39x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.759, Ratio=3.44x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.757, Ratio=3.27x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.772, Ratio=3.39x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.750, Ratio=3.24x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.773, Ratio=3.38x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.769, Ratio=3.45x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.749, Ratio=3.36x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.758, Ratio=3.28x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.751, Ratio=3.25x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.789, Ratio=3.69x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.757, Ratio=3.37x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.741, Ratio=3.26x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.801, Ratio=3.56x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.760, Ratio=3.45x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.771, Ratio=3.38x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.750, Ratio=3.41x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.744, Ratio=3.30x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.741, Ratio=3.30x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.777, Ratio=3.53x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.743, Ratio=3.23x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.771, Ratio=3.55x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.764, Ratio=3.42x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.749, Ratio=3.36x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.758, Ratio=3.42x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.754, Ratio=3.41x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.772, Ratio=3.54x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.767, Ratio=3.45x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.764, Ratio=3.32x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.771, Ratio=3.49x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.749, Ratio=3.42x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.774, Ratio=3.45x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.757, Ratio=3.32x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.780, Ratio=3.56x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.762, Ratio=3.39x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.739, Ratio=3.24x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.741, Ratio=3.37x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.779, Ratio=3.56x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.764, Ratio=3.42x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.765, Ratio=3.43x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.747, Ratio=3.32x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.768, Ratio=3.51x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.783, Ratio=3.47x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.776, Ratio=3.52x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.780, Ratio=3.57x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.759, Ratio=3.44x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.739, Ratio=3.35x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.763, Ratio=3.36x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.781, Ratio=3.67x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.763, Ratio=3.44x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.772, Ratio=3.40x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.774, Ratio=3.50x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.763, Ratio=3.45x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.779, Ratio=3.46x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.750, Ratio=3.22x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.746, Ratio=3.28x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.779, Ratio=3.49x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.785, Ratio=3.52x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.749, Ratio=3.26x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.781, Ratio=3.48x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.763, Ratio=3.39x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.775, Ratio=3.37x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.757, Ratio=3.36x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.752, Ratio=3.26x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.758, Ratio=3.40x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.780, Ratio=3.53x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.755, Ratio=3.35x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.770, Ratio=3.35x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.771, Ratio=3.41x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.776, Ratio=3.58x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.764, Ratio=3.36x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.775, Ratio=3.48x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.756, Ratio=3.34x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.772, Ratio=3.52x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.758, Ratio=3.23x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.771, Ratio=3.44x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.773, Ratio=3.54x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.748, Ratio=3.39x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.771, Ratio=3.47x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.763, Ratio=3.40x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.767, Ratio=3.39x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.771, Ratio=3.45x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.757, Ratio=3.39x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.771, Ratio=3.54x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.770, Ratio=3.48x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.757, Ratio=3.35x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.749, Ratio=3.30x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.787, Ratio=3.66x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.753, Ratio=3.34x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.758, Ratio=3.46x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.743, Ratio=3.26x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.749, Ratio=3.27x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.755, Ratio=3.31x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.30x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.783, Ratio=3.60x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.764, Ratio=3.49x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.759, Ratio=3.37x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.755, Ratio=3.30x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.750, Ratio=3.34x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.772, Ratio=3.38x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.761, Ratio=3.40x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.752, Ratio=3.32x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.776, Ratio=3.40x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.772, Ratio=3.38x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.754, Ratio=3.29x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.752, Ratio=3.30x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.756, Ratio=3.28x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.772, Ratio=3.58x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.760, Ratio=3.34x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.759, Ratio=3.33x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.785, Ratio=3.55x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.762, Ratio=3.44x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.768, Ratio=3.43x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.779, Ratio=3.53x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.768, Ratio=3.41x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.735, Ratio=3.20x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.754, Ratio=3.41x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.754, Ratio=3.32x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.787, Ratio=3.56x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.793, Ratio=3.62x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.774, Ratio=3.41x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.755, Ratio=3.32x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.762, Ratio=3.35x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.758, Ratio=3.34x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.756, Ratio=3.43x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.769, Ratio=3.46x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.776, Ratio=3.58x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.761, Ratio=3.37x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.764, Ratio=3.52x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.772, Ratio=3.43x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.750, Ratio=3.28x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.749, Ratio=3.24x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.782, Ratio=3.40x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.758, Ratio=3.39x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.754, Ratio=3.34x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.748, Ratio=3.31x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.763, Ratio=3.37x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.751, Ratio=3.20x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.764, Ratio=3.33x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.754, Ratio=3.31x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.757, Ratio=3.29x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.755, Ratio=3.33x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.765, Ratio=3.34x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.762, Ratio=3.43x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.782, Ratio=3.50x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.760, Ratio=3.50x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.769, Ratio=3.44x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.778, Ratio=3.45x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.768, Ratio=3.50x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.771, Ratio=3.36x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.748, Ratio=3.25x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.741, Ratio=3.37x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.760, Ratio=3.43x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.762, Ratio=3.32x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.779, Ratio=3.43x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.775, Ratio=3.54x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.788, Ratio=3.54x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.767, Ratio=3.30x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.760, Ratio=3.42x, Gap=-3.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.769, Ratio=3.45x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.768, Ratio=3.28x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.770, Ratio=3.45x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.761, Ratio=3.33x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.752, Ratio=3.45x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.746, Ratio=3.25x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.779, Ratio=3.39x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.756, Ratio=3.32x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.750, Ratio=3.26x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.768, Ratio=3.43x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.765, Ratio=3.34x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.755, Ratio=3.34x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.763, Ratio=3.38x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.748, Ratio=3.25x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.778, Ratio=3.48x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.763, Ratio=3.36x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.764, Ratio=3.27x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.770, Ratio=3.47x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.793, Ratio=3.63x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.780, Ratio=3.49x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.775, Ratio=3.42x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.767, Ratio=3.31x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.775, Ratio=3.55x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.780, Ratio=3.46x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.765, Ratio=3.31x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.742, Ratio=3.23x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.772, Ratio=3.48x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.776, Ratio=3.54x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.747, Ratio=3.26x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.751, Ratio=3.27x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.776, Ratio=3.55x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.772, Ratio=3.38x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.792, Ratio=3.64x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.741, Ratio=3.34x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.773, Ratio=3.46x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.754, Ratio=3.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.750, Ratio=3.31x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.768, Ratio=3.53x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.776, Ratio=3.69x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.762, Ratio=3.52x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.758, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.779, Ratio=3.54x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.766, Ratio=3.44x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.746, Ratio=3.35x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.768, Ratio=3.39x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.772, Ratio=3.34x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.749, Ratio=3.22x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.783, Ratio=3.50x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.756, Ratio=3.32x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.760, Ratio=3.37x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.748, Ratio=3.27x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.761, Ratio=3.50x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.775, Ratio=3.43x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.747, Ratio=3.31x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.774, Ratio=3.39x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.770, Ratio=3.45x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.746, Ratio=3.28x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.762, Ratio=3.36x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.791, Ratio=3.53x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.767, Ratio=3.34x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.740, Ratio=3.29x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.773, Ratio=3.45x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.760, Ratio=3.39x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.771, Ratio=3.50x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.762, Ratio=3.35x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.754, Ratio=3.35x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.777, Ratio=3.48x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.740, Ratio=3.17x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.760, Ratio=3.37x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.776, Ratio=3.50x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.774, Ratio=3.40x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.742, Ratio=3.19x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.765, Ratio=3.37x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.753, Ratio=3.36x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.772, Ratio=3.44x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.773, Ratio=3.48x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.746, Ratio=3.33x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.739, Ratio=3.19x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.746, Ratio=3.31x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.756, Ratio=3.42x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.746, Ratio=3.27x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.775, Ratio=3.38x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.764, Ratio=3.40x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.752, Ratio=3.33x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.782, Ratio=3.54x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.770, Ratio=3.47x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.755, Ratio=3.39x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.768, Ratio=3.38x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.802, Ratio=3.70x, Gap=-3.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.773, Ratio=3.44x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.752, Ratio=3.32x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.758, Ratio=3.37x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.760, Ratio=3.37x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.765, Ratio=3.43x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.764, Ratio=3.36x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.749, Ratio=3.27x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.780, Ratio=3.45x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.807, Ratio=3.66x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.767, Ratio=3.44x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.759, Ratio=3.34x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.775, Ratio=3.47x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.750, Ratio=3.22x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.754, Ratio=3.41x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.761, Ratio=3.32x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.775, Ratio=3.42x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.790, Ratio=3.54x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.761, Ratio=3.44x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.765, Ratio=3.45x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.753, Ratio=3.33x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.754, Ratio=3.39x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.764, Ratio=3.33x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.780, Ratio=3.53x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.759, Ratio=3.38x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.775, Ratio=3.57x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.764, Ratio=3.30x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.764, Ratio=3.36x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.761, Ratio=3.34x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.754, Ratio=3.37x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.766, Ratio=3.43x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.763, Ratio=3.42x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.768, Ratio=3.43x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.763, Ratio=3.35x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.776, Ratio=3.36x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.744, Ratio=3.25x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.775, Ratio=3.46x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.752, Ratio=3.29x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.772, Ratio=3.59x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.736, Ratio=3.21x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.756, Ratio=3.43x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.747, Ratio=3.32x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.753, Ratio=3.34x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.758, Ratio=3.31x, Gap=-3.707

============================================================
Epoch 9/20 completed in 31.5s
Train: Loss=1.0761 (C:1.0761, R:0.0105) Ratio=3.09x
Val:   Loss=1.0347 (C:1.0347, R:0.0105) Ratio=3.68x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 1.0347)
============================================================

🌍 Updating global dataset at epoch 10
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.508 ± 0.564
    Neg distances: 1.773 ± 0.898
    Separation ratio: 3.49x
    Gap: -3.493
    ✅ Excellent global separation!

Epoch 10 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.771, Ratio=3.36x, Gap=-3.718
Batch   0/537: Loss=1.0397 (C:1.0397, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.775, Ratio=3.35x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.796, Ratio=3.48x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.772, Ratio=3.34x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.808, Ratio=3.53x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.814, Ratio=3.43x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.787, Ratio=3.32x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.801, Ratio=3.47x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.821, Ratio=3.47x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.828, Ratio=3.53x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.808, Ratio=3.35x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.808, Ratio=3.49x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.779, Ratio=3.21x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.782, Ratio=3.28x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.798, Ratio=3.42x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.794, Ratio=3.22x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.816, Ratio=3.43x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.39x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.792, Ratio=3.42x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.785, Ratio=3.20x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.778, Ratio=3.34x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.803, Ratio=3.42x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.789, Ratio=3.29x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.760, Ratio=3.12x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.787, Ratio=3.27x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.804, Ratio=3.51x, Gap=-3.756
Batch  25/537: Loss=1.0092 (C:1.0092, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.774, Ratio=3.16x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.789, Ratio=3.35x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.811, Ratio=3.43x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.774, Ratio=3.28x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.784, Ratio=3.23x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.810, Ratio=3.44x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.776, Ratio=3.20x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.789, Ratio=3.26x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.796, Ratio=3.40x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.794, Ratio=3.35x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.794, Ratio=3.37x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.795, Ratio=3.47x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.807, Ratio=3.40x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.782, Ratio=3.34x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.808, Ratio=3.39x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.823, Ratio=3.60x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.808, Ratio=3.44x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.802, Ratio=3.31x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.806, Ratio=3.53x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.795, Ratio=3.42x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.785, Ratio=3.35x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.795, Ratio=3.37x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.811, Ratio=3.40x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.793, Ratio=3.29x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.794, Ratio=3.38x, Gap=-3.897
Batch  50/537: Loss=1.0322 (C:1.0322, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.807, Ratio=3.39x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.816, Ratio=3.46x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.807, Ratio=3.39x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.766, Ratio=3.16x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.815, Ratio=3.52x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.797, Ratio=3.23x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.810, Ratio=3.36x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.798, Ratio=3.36x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.801, Ratio=3.41x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.792, Ratio=3.45x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.757, Ratio=3.17x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.799, Ratio=3.37x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.784, Ratio=3.38x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.793, Ratio=3.46x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.785, Ratio=3.38x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.820, Ratio=3.59x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.770, Ratio=3.24x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.799, Ratio=3.24x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.798, Ratio=3.36x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.806, Ratio=3.42x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.831, Ratio=3.58x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.820, Ratio=3.42x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.810, Ratio=3.35x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.782, Ratio=3.28x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.803, Ratio=3.42x, Gap=-3.780
Batch  75/537: Loss=1.0227 (C:1.0227, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.811, Ratio=3.54x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.806, Ratio=3.45x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.790, Ratio=3.34x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.782, Ratio=3.30x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.813, Ratio=3.46x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.806, Ratio=3.46x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.813, Ratio=3.40x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.792, Ratio=3.25x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.820, Ratio=3.56x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.784, Ratio=3.36x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.811, Ratio=3.41x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.796, Ratio=3.38x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.800, Ratio=3.27x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.792, Ratio=3.21x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.798, Ratio=3.35x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.803, Ratio=3.29x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.824, Ratio=3.39x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.809, Ratio=3.42x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.822, Ratio=3.44x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.799, Ratio=3.48x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.789, Ratio=3.34x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.785, Ratio=3.30x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.779, Ratio=3.28x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.788, Ratio=3.44x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.772, Ratio=3.32x, Gap=-4.040
Batch 100/537: Loss=1.0477 (C:1.0477, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.830, Ratio=3.65x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.790, Ratio=3.41x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.783, Ratio=3.23x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.798, Ratio=3.37x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.796, Ratio=3.34x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.804, Ratio=3.37x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.799, Ratio=3.28x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.802, Ratio=3.30x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.806, Ratio=3.44x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.819, Ratio=3.49x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.790, Ratio=3.41x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.794, Ratio=3.29x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.815, Ratio=3.45x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.792, Ratio=3.31x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.789, Ratio=3.34x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.792, Ratio=3.24x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.762, Ratio=3.25x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.799, Ratio=3.34x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.778, Ratio=3.28x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.800, Ratio=3.39x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.821, Ratio=3.60x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.811, Ratio=3.49x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.786, Ratio=3.33x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.782, Ratio=3.30x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.791, Ratio=3.34x, Gap=-3.885
Batch 125/537: Loss=1.0406 (C:1.0406, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.806, Ratio=3.34x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.795, Ratio=3.50x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.764, Ratio=3.24x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.806, Ratio=3.46x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.808, Ratio=3.38x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.813, Ratio=3.50x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.815, Ratio=3.44x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.802, Ratio=3.31x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.800, Ratio=3.33x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.803, Ratio=3.39x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.814, Ratio=3.33x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.804, Ratio=3.39x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.796, Ratio=3.34x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.830, Ratio=3.54x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.789, Ratio=3.41x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.801, Ratio=3.29x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.795, Ratio=3.33x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.792, Ratio=3.30x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.792, Ratio=3.24x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.770, Ratio=3.19x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.781, Ratio=3.39x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.783, Ratio=3.39x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.798, Ratio=3.37x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.794, Ratio=3.45x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.804, Ratio=3.53x, Gap=-4.192
Batch 150/537: Loss=1.0086 (C:1.0086, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.788, Ratio=3.33x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.776, Ratio=3.25x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.816, Ratio=3.54x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.786, Ratio=3.23x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.802, Ratio=3.36x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.791, Ratio=3.26x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.796, Ratio=3.39x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.571, Neg=1.784, Ratio=3.13x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.780, Ratio=3.34x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.781, Ratio=3.20x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.802, Ratio=3.39x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.792, Ratio=3.41x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.776, Ratio=3.21x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.789, Ratio=3.21x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.797, Ratio=3.36x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.810, Ratio=3.32x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.820, Ratio=3.40x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.793, Ratio=3.47x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.810, Ratio=3.49x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.800, Ratio=3.40x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.811, Ratio=3.55x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.797, Ratio=3.32x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.787, Ratio=3.28x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.821, Ratio=3.34x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.792, Ratio=3.31x, Gap=-3.914
Batch 175/537: Loss=1.0457 (C:1.0457, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.784, Ratio=3.22x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.806, Ratio=3.39x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.785, Ratio=3.26x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.819, Ratio=3.57x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.790, Ratio=3.37x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.781, Ratio=3.26x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.780, Ratio=3.42x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.786, Ratio=3.31x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.812, Ratio=3.48x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.796, Ratio=3.36x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.757, Ratio=3.13x, Gap=-3.778
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.807, Ratio=3.57x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.778, Ratio=3.30x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.788, Ratio=3.25x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.798, Ratio=3.36x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.821, Ratio=3.35x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.818, Ratio=3.39x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.800, Ratio=3.37x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.782, Ratio=3.19x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.794, Ratio=3.32x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.796, Ratio=3.33x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.801, Ratio=3.42x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.787, Ratio=3.33x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.796, Ratio=3.33x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.791, Ratio=3.36x, Gap=-4.101
Batch 200/537: Loss=1.0354 (C:1.0354, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.772, Ratio=3.20x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.785, Ratio=3.36x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.810, Ratio=3.40x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.793, Ratio=3.31x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.796, Ratio=3.25x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.775, Ratio=3.24x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.789, Ratio=3.34x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.774, Ratio=3.17x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.803, Ratio=3.37x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.797, Ratio=3.23x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.803, Ratio=3.30x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.788, Ratio=3.30x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.800, Ratio=3.26x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.808, Ratio=3.52x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.799, Ratio=3.41x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.801, Ratio=3.47x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.811, Ratio=3.34x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.799, Ratio=3.35x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.801, Ratio=3.32x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.796, Ratio=3.25x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.802, Ratio=3.30x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.814, Ratio=3.39x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.793, Ratio=3.36x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.799, Ratio=3.32x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.819, Ratio=3.44x, Gap=-3.833
Batch 225/537: Loss=1.0210 (C:1.0210, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.800, Ratio=3.35x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.761, Ratio=3.22x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.803, Ratio=3.22x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.808, Ratio=3.42x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.793, Ratio=3.39x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.807, Ratio=3.39x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.773, Ratio=3.31x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.779, Ratio=3.25x, Gap=-3.800
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.778, Ratio=3.23x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.789, Ratio=3.32x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.787, Ratio=3.29x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.826, Ratio=3.45x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.796, Ratio=3.31x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.777, Ratio=3.22x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.810, Ratio=3.22x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.796, Ratio=3.41x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.795, Ratio=3.30x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.788, Ratio=3.37x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.787, Ratio=3.31x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.801, Ratio=3.38x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.796, Ratio=3.46x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.790, Ratio=3.18x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.776, Ratio=3.28x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.775, Ratio=3.32x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.793, Ratio=3.36x, Gap=-4.295
Batch 250/537: Loss=1.0366 (C:1.0366, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.808, Ratio=3.28x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.826, Ratio=3.56x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.794, Ratio=3.29x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.811, Ratio=3.57x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.795, Ratio=3.24x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.783, Ratio=3.27x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.814, Ratio=3.38x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.814, Ratio=3.39x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.790, Ratio=3.34x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.784, Ratio=3.28x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.778, Ratio=3.25x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.773, Ratio=3.22x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.813, Ratio=3.53x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.806, Ratio=3.50x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.778, Ratio=3.35x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.790, Ratio=3.41x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.816, Ratio=3.58x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.814, Ratio=3.48x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.785, Ratio=3.21x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.799, Ratio=3.32x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.813, Ratio=3.46x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.819, Ratio=3.45x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.805, Ratio=3.25x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.795, Ratio=3.26x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.822, Ratio=3.29x, Gap=-4.202
Batch 275/537: Loss=1.0489 (C:1.0489, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.785, Ratio=3.35x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.801, Ratio=3.42x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.808, Ratio=3.35x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.779, Ratio=3.27x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.789, Ratio=3.35x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.801, Ratio=3.45x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.804, Ratio=3.38x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.779, Ratio=3.36x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.781, Ratio=3.28x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.780, Ratio=3.40x, Gap=-4.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.806, Ratio=3.40x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.796, Ratio=3.33x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.799, Ratio=3.33x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.796, Ratio=3.28x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.804, Ratio=3.45x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.802, Ratio=3.40x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.789, Ratio=3.24x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.803, Ratio=3.39x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.799, Ratio=3.42x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.800, Ratio=3.48x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.809, Ratio=3.36x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.828, Ratio=3.54x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.828, Ratio=3.57x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.788, Ratio=3.20x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.813, Ratio=3.46x, Gap=-4.121
Batch 300/537: Loss=1.0161 (C:1.0161, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.772, Ratio=3.19x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.802, Ratio=3.42x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.814, Ratio=3.32x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.801, Ratio=3.34x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.789, Ratio=3.20x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.802, Ratio=3.46x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.806, Ratio=3.42x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.776, Ratio=3.32x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.794, Ratio=3.36x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.794, Ratio=3.34x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.792, Ratio=3.34x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.820, Ratio=3.40x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.828, Ratio=3.54x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.789, Ratio=3.32x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.804, Ratio=3.37x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.782, Ratio=3.25x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.796, Ratio=3.31x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.770, Ratio=3.23x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.795, Ratio=3.46x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.773, Ratio=3.24x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.787, Ratio=3.32x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.801, Ratio=3.40x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.770, Ratio=3.31x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.772, Ratio=3.21x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.796, Ratio=3.37x, Gap=-4.227
Batch 325/537: Loss=1.0348 (C:1.0348, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.793, Ratio=3.34x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.790, Ratio=3.33x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.809, Ratio=3.39x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.795, Ratio=3.24x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.805, Ratio=3.41x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.802, Ratio=3.36x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.804, Ratio=3.25x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.794, Ratio=3.35x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.803, Ratio=3.29x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.812, Ratio=3.34x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.776, Ratio=3.16x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.794, Ratio=3.41x, Gap=-4.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.793, Ratio=3.33x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.786, Ratio=3.21x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.781, Ratio=3.20x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.785, Ratio=3.48x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.780, Ratio=3.22x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.791, Ratio=3.38x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.819, Ratio=3.51x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.783, Ratio=3.18x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.786, Ratio=3.23x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.784, Ratio=3.27x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.784, Ratio=3.32x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.765, Ratio=3.18x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.787, Ratio=3.35x, Gap=-3.784
Batch 350/537: Loss=1.0370 (C:1.0370, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.804, Ratio=3.34x, Gap=-4.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.786, Ratio=3.38x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.773, Ratio=3.12x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.802, Ratio=3.38x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.793, Ratio=3.38x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.806, Ratio=3.45x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.804, Ratio=3.31x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.806, Ratio=3.30x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.780, Ratio=3.22x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.797, Ratio=3.28x, Gap=-5.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.772, Ratio=3.25x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.791, Ratio=3.25x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.777, Ratio=3.19x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.791, Ratio=3.39x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.799, Ratio=3.44x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.818, Ratio=3.45x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.777, Ratio=3.21x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.814, Ratio=3.44x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.801, Ratio=3.38x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.785, Ratio=3.21x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.791, Ratio=3.30x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.794, Ratio=3.44x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.806, Ratio=3.27x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.812, Ratio=3.48x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.799, Ratio=3.41x, Gap=-4.170
Batch 375/537: Loss=1.0273 (C:1.0273, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.834, Ratio=3.54x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.801, Ratio=3.42x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.38x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.805, Ratio=3.39x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.788, Ratio=3.39x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.803, Ratio=3.45x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.803, Ratio=3.31x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.842, Ratio=3.66x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.793, Ratio=3.32x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.800, Ratio=3.35x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.795, Ratio=3.36x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.805, Ratio=3.43x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.795, Ratio=3.26x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.801, Ratio=3.39x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.792, Ratio=3.24x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.792, Ratio=3.27x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.824, Ratio=3.51x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.797, Ratio=3.43x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.781, Ratio=3.22x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.802, Ratio=3.40x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.806, Ratio=3.36x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.768, Ratio=3.24x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.778, Ratio=3.19x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.777, Ratio=3.29x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.796, Ratio=3.39x, Gap=-4.082
Batch 400/537: Loss=1.0290 (C:1.0290, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.798, Ratio=3.32x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.802, Ratio=3.36x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.778, Ratio=3.20x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.805, Ratio=3.49x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.791, Ratio=3.32x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.786, Ratio=3.34x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.809, Ratio=3.46x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.784, Ratio=3.28x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.803, Ratio=3.43x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.782, Ratio=3.10x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.826, Ratio=3.37x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.804, Ratio=3.34x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.780, Ratio=3.25x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.809, Ratio=3.40x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.785, Ratio=3.32x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.793, Ratio=3.29x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.820, Ratio=3.52x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.837, Ratio=3.62x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.803, Ratio=3.25x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.802, Ratio=3.35x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.783, Ratio=3.17x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.790, Ratio=3.27x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.793, Ratio=3.33x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.826, Ratio=3.54x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.798, Ratio=3.44x, Gap=-3.807
Batch 425/537: Loss=1.0243 (C:1.0243, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.787, Ratio=3.36x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.785, Ratio=3.42x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.789, Ratio=3.32x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.566, Neg=1.758, Ratio=3.11x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.803, Ratio=3.32x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.788, Ratio=3.28x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.783, Ratio=3.22x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.792, Ratio=3.19x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.830, Ratio=3.51x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.820, Ratio=3.44x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.796, Ratio=3.39x, Gap=-3.922
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.790, Ratio=3.28x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.813, Ratio=3.34x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.794, Ratio=3.32x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.801, Ratio=3.34x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.569, Neg=1.772, Ratio=3.11x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.791, Ratio=3.35x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.768, Ratio=3.21x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.782, Ratio=3.22x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.790, Ratio=3.31x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.771, Ratio=3.28x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.779, Ratio=3.21x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.785, Ratio=3.23x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.794, Ratio=3.30x, Gap=-4.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.796, Ratio=3.35x, Gap=-3.981
Batch 450/537: Loss=1.0390 (C:1.0390, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.813, Ratio=3.45x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.780, Ratio=3.33x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.784, Ratio=3.24x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.796, Ratio=3.34x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.815, Ratio=3.48x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.810, Ratio=3.43x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.796, Ratio=3.42x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.771, Ratio=3.27x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.800, Ratio=3.39x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.791, Ratio=3.25x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.564, Neg=1.787, Ratio=3.17x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.810, Ratio=3.43x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.807, Ratio=3.44x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.804, Ratio=3.28x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.795, Ratio=3.48x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.800, Ratio=3.39x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.792, Ratio=3.35x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.783, Ratio=3.30x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.750, Ratio=3.04x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.791, Ratio=3.27x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.784, Ratio=3.30x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.794, Ratio=3.29x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.800, Ratio=3.34x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.802, Ratio=3.28x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.784, Ratio=3.32x, Gap=-3.960
Batch 475/537: Loss=1.0443 (C:1.0443, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.796, Ratio=3.28x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.808, Ratio=3.38x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.801, Ratio=3.35x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.785, Ratio=3.23x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.783, Ratio=3.21x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.802, Ratio=3.25x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.803, Ratio=3.46x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.769, Ratio=3.20x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.813, Ratio=3.49x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.814, Ratio=3.46x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.792, Ratio=3.40x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.788, Ratio=3.38x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.773, Ratio=3.24x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.800, Ratio=3.35x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.766, Ratio=3.22x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.784, Ratio=3.33x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.787, Ratio=3.32x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.787, Ratio=3.28x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.777, Ratio=3.21x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.783, Ratio=3.30x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.801, Ratio=3.31x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.783, Ratio=3.21x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.784, Ratio=3.21x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.798, Ratio=3.35x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.816, Ratio=3.42x, Gap=-4.173
Batch 500/537: Loss=1.0232 (C:1.0232, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.819, Ratio=3.40x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.792, Ratio=3.26x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.778, Ratio=3.27x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.817, Ratio=3.39x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.797, Ratio=3.30x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.803, Ratio=3.54x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.793, Ratio=3.19x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.806, Ratio=3.50x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.785, Ratio=3.22x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.797, Ratio=3.41x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.790, Ratio=3.28x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.774, Ratio=3.28x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.795, Ratio=3.32x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.786, Ratio=3.26x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.798, Ratio=3.27x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.786, Ratio=3.18x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.784, Ratio=3.18x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.780, Ratio=3.23x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.799, Ratio=3.21x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.572, Neg=1.782, Ratio=3.11x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.786, Ratio=3.21x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.798, Ratio=3.33x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.792, Ratio=3.34x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.794, Ratio=3.35x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.792, Ratio=3.48x, Gap=-3.839
Batch 525/537: Loss=1.0142 (C:1.0142, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.792, Ratio=3.30x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.792, Ratio=3.34x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.787, Ratio=3.25x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.807, Ratio=3.42x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.817, Ratio=3.34x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.782, Ratio=3.20x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.808, Ratio=3.28x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.781, Ratio=3.21x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.785, Ratio=3.27x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.793, Ratio=3.38x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.792, Ratio=3.35x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.804, Ratio=3.64x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.819, Ratio=3.70x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.810, Ratio=3.63x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.829, Ratio=3.73x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.835, Ratio=3.89x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.816, Ratio=3.62x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.811, Ratio=3.65x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.794, Ratio=3.40x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.817, Ratio=3.71x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.807, Ratio=3.60x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.819, Ratio=3.65x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.809, Ratio=3.65x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.816, Ratio=3.62x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.815, Ratio=3.77x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.828, Ratio=3.75x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.813, Ratio=3.61x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.804, Ratio=3.55x, Gap=-3.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.800, Ratio=3.45x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.798, Ratio=3.61x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.817, Ratio=3.69x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.790, Ratio=3.62x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.788, Ratio=3.35x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.816, Ratio=3.62x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.793, Ratio=3.51x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.810, Ratio=3.68x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.815, Ratio=3.62x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.811, Ratio=3.70x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.804, Ratio=3.61x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.806, Ratio=3.53x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.813, Ratio=3.61x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.805, Ratio=3.63x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.835, Ratio=3.73x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.807, Ratio=3.56x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.803, Ratio=3.58x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.795, Ratio=3.56x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.798, Ratio=3.58x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.825, Ratio=3.71x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.805, Ratio=3.68x, Gap=-3.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.796, Ratio=3.56x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.801, Ratio=3.48x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.804, Ratio=3.49x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.797, Ratio=3.48x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.815, Ratio=3.63x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.801, Ratio=3.49x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.65x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.786, Ratio=3.44x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.820, Ratio=3.62x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.796, Ratio=3.46x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.829, Ratio=3.73x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.809, Ratio=3.74x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.812, Ratio=3.69x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.809, Ratio=3.64x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.811, Ratio=3.55x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.824, Ratio=3.72x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.829, Ratio=3.68x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.797, Ratio=3.53x, Gap=-3.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.801, Ratio=3.54x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.816, Ratio=3.47x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.801, Ratio=3.49x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.812, Ratio=3.59x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.814, Ratio=3.68x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.808, Ratio=3.50x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.801, Ratio=3.51x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.820, Ratio=3.54x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.790, Ratio=3.46x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.814, Ratio=3.65x, Gap=-3.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.825, Ratio=3.70x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.793, Ratio=3.48x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.828, Ratio=3.71x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.809, Ratio=3.79x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.798, Ratio=3.53x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.788, Ratio=3.46x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.803, Ratio=3.61x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.802, Ratio=3.52x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.806, Ratio=3.67x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.64x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.790, Ratio=3.44x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.776, Ratio=3.45x, Gap=-3.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.781, Ratio=3.44x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.802, Ratio=3.60x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.824, Ratio=3.69x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.782, Ratio=3.35x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.810, Ratio=3.57x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.803, Ratio=3.57x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.821, Ratio=3.59x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.799, Ratio=3.48x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.804, Ratio=3.72x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.794, Ratio=3.51x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.828, Ratio=3.75x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.809, Ratio=3.53x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.826, Ratio=3.84x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.799, Ratio=3.50x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.801, Ratio=3.46x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.814, Ratio=3.64x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.813, Ratio=3.71x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.820, Ratio=3.63x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.817, Ratio=3.66x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.794, Ratio=3.46x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.831, Ratio=3.73x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.809, Ratio=3.59x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.54x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.814, Ratio=3.76x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.790, Ratio=3.51x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.804, Ratio=3.64x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.816, Ratio=3.66x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.795, Ratio=3.50x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.825, Ratio=3.56x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.798, Ratio=3.57x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.835, Ratio=3.75x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.795, Ratio=3.66x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.824, Ratio=3.69x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.830, Ratio=3.72x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.818, Ratio=3.65x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.800, Ratio=3.47x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.824, Ratio=3.80x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.816, Ratio=3.63x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.821, Ratio=3.55x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.817, Ratio=3.74x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.826, Ratio=3.71x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.812, Ratio=3.67x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.816, Ratio=3.55x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.802, Ratio=3.60x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.822, Ratio=3.68x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.832, Ratio=3.76x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.808, Ratio=3.55x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.802, Ratio=3.60x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.804, Ratio=3.62x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.787, Ratio=3.48x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.813, Ratio=3.57x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.817, Ratio=3.54x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.840, Ratio=3.85x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.810, Ratio=3.74x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.800, Ratio=3.40x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.807, Ratio=3.52x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.795, Ratio=3.55x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.810, Ratio=3.57x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.815, Ratio=3.60x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.805, Ratio=3.64x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.812, Ratio=3.57x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.806, Ratio=3.63x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.809, Ratio=3.50x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.821, Ratio=3.58x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.816, Ratio=3.67x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.827, Ratio=3.63x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.803, Ratio=3.53x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.819, Ratio=3.67x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.800, Ratio=3.52x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.792, Ratio=3.52x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.811, Ratio=3.67x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.780, Ratio=3.48x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.814, Ratio=3.68x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.799, Ratio=3.56x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.802, Ratio=3.41x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.801, Ratio=3.48x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.810, Ratio=3.54x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.822, Ratio=3.57x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.814, Ratio=3.71x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.824, Ratio=3.66x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.790, Ratio=3.39x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.819, Ratio=3.79x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.796, Ratio=3.44x, Gap=-3.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.828, Ratio=3.71x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.797, Ratio=3.53x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.820, Ratio=3.64x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.795, Ratio=3.58x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.816, Ratio=3.66x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.802, Ratio=3.51x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.808, Ratio=3.74x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.808, Ratio=3.53x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.806, Ratio=3.57x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.785, Ratio=3.48x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.803, Ratio=3.55x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.801, Ratio=3.60x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.811, Ratio=3.71x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.825, Ratio=3.66x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.787, Ratio=3.44x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.834, Ratio=3.81x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.813, Ratio=3.70x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.825, Ratio=3.64x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.801, Ratio=3.48x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.804, Ratio=3.48x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.792, Ratio=3.52x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.805, Ratio=3.62x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.790, Ratio=3.40x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.790, Ratio=3.46x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.832, Ratio=3.82x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.810, Ratio=3.66x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.808, Ratio=3.55x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.805, Ratio=3.46x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.802, Ratio=3.60x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.798, Ratio=3.51x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.816, Ratio=3.54x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.825, Ratio=3.76x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.796, Ratio=3.50x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.821, Ratio=3.73x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.813, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.816, Ratio=3.55x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.830, Ratio=3.70x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.817, Ratio=3.64x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.791, Ratio=3.53x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.811, Ratio=3.58x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.842, Ratio=3.81x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.818, Ratio=3.63x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.789, Ratio=3.52x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.805, Ratio=3.51x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.794, Ratio=3.59x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.795, Ratio=3.50x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.822, Ratio=3.82x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.813, Ratio=3.52x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.795, Ratio=3.45x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.820, Ratio=3.61x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.815, Ratio=3.58x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.827, Ratio=3.77x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.794, Ratio=3.47x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.797, Ratio=3.50x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.819, Ratio=3.71x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.790, Ratio=3.42x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.821, Ratio=3.77x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.797, Ratio=3.57x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.793, Ratio=3.46x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.801, Ratio=3.64x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.804, Ratio=3.49x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.798, Ratio=3.55x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.789, Ratio=3.46x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.783, Ratio=3.38x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.810, Ratio=3.69x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.821, Ratio=3.73x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.777, Ratio=3.31x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.838, Ratio=3.77x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.817, Ratio=3.61x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.805, Ratio=3.55x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.789, Ratio=3.49x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.791, Ratio=3.43x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.818, Ratio=3.69x, Gap=-3.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.798, Ratio=3.47x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.813, Ratio=3.60x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.800, Ratio=3.55x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.797, Ratio=3.50x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.799, Ratio=3.58x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.831, Ratio=3.75x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.790, Ratio=3.49x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.804, Ratio=3.56x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.810, Ratio=3.54x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.820, Ratio=3.55x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.824, Ratio=3.53x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.804, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.800, Ratio=3.50x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.800, Ratio=3.52x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.819, Ratio=3.71x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.791, Ratio=3.58x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.806, Ratio=3.69x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.805, Ratio=3.65x, Gap=-3.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.808, Ratio=3.58x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.783, Ratio=3.53x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.825, Ratio=3.80x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.806, Ratio=3.56x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.791, Ratio=3.51x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.803, Ratio=3.56x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.801, Ratio=3.67x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.815, Ratio=3.61x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.826, Ratio=3.68x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.796, Ratio=3.54x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.810, Ratio=3.63x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.814, Ratio=3.59x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.818, Ratio=3.56x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.808, Ratio=3.47x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.827, Ratio=3.62x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.797, Ratio=3.44x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.825, Ratio=3.71x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.812, Ratio=3.48x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.821, Ratio=3.64x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.825, Ratio=3.80x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.816, Ratio=3.77x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.798, Ratio=3.58x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.825, Ratio=3.75x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.812, Ratio=3.63x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.794, Ratio=3.45x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.798, Ratio=3.49x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.817, Ratio=3.65x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.814, Ratio=3.79x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.794, Ratio=3.48x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.810, Ratio=3.66x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.805, Ratio=3.60x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.789, Ratio=3.43x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.825, Ratio=3.61x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.837, Ratio=3.80x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.822, Ratio=3.70x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.821, Ratio=3.79x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.810, Ratio=3.57x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.808, Ratio=3.68x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.813, Ratio=3.63x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.825, Ratio=3.66x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.816, Ratio=3.62x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.834, Ratio=3.80x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.819, Ratio=3.80x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.816, Ratio=3.65x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.53x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.810, Ratio=3.49x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.801, Ratio=3.55x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.813, Ratio=3.70x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.798, Ratio=3.44x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.806, Ratio=3.48x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.813, Ratio=3.57x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.805, Ratio=3.57x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.791, Ratio=3.49x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.810, Ratio=3.60x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.822, Ratio=3.51x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.817, Ratio=3.67x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.801, Ratio=3.40x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.800, Ratio=3.60x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.811, Ratio=3.53x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.818, Ratio=3.64x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.823, Ratio=3.70x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.796, Ratio=3.47x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.796, Ratio=3.53x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.830, Ratio=3.60x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.798, Ratio=3.42x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.783, Ratio=3.41x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.813, Ratio=3.57x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.843, Ratio=3.81x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.801, Ratio=3.48x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.777, Ratio=3.35x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.840, Ratio=3.89x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.813, Ratio=3.64x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.803, Ratio=3.46x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.783, Ratio=3.54x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.806, Ratio=3.54x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.823, Ratio=3.59x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.802, Ratio=3.69x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.801, Ratio=3.55x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.802, Ratio=3.45x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.813, Ratio=3.63x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.815, Ratio=3.73x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.800, Ratio=3.47x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.796, Ratio=3.50x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.818, Ratio=3.55x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.808, Ratio=3.63x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.816, Ratio=3.63x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.833, Ratio=3.88x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.828, Ratio=3.70x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.798, Ratio=3.50x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.829, Ratio=3.78x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.799, Ratio=3.62x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.808, Ratio=3.47x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.831, Ratio=3.63x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.794, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.829, Ratio=3.72x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.808, Ratio=3.57x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.787, Ratio=3.40x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.805, Ratio=3.53x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.831, Ratio=3.85x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.794, Ratio=3.48x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.792, Ratio=3.43x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.798, Ratio=3.49x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.818, Ratio=3.59x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.796, Ratio=3.40x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.795, Ratio=3.54x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.786, Ratio=3.48x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.793, Ratio=3.37x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.794, Ratio=3.61x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.802, Ratio=3.52x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.815, Ratio=3.69x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.785, Ratio=3.44x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.798, Ratio=3.56x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.815, Ratio=3.55x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.815, Ratio=3.74x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.815, Ratio=3.58x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.805, Ratio=3.65x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.811, Ratio=3.60x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.800, Ratio=3.63x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.795, Ratio=3.50x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.824, Ratio=3.64x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.791, Ratio=3.45x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.823, Ratio=3.69x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.803, Ratio=3.51x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.805, Ratio=3.50x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.807, Ratio=3.57x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.796, Ratio=3.58x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.816, Ratio=3.60x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.811, Ratio=3.61x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.796, Ratio=3.63x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.788, Ratio=3.40x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.818, Ratio=3.65x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.800, Ratio=3.48x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.829, Ratio=3.85x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.815, Ratio=3.61x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.793, Ratio=3.53x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.785, Ratio=3.37x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.806, Ratio=3.61x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.799, Ratio=3.42x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.822, Ratio=3.85x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.826, Ratio=3.71x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.829, Ratio=3.64x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.803, Ratio=3.67x, Gap=-3.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.792, Ratio=3.52x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.795, Ratio=3.54x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.819, Ratio=3.66x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.784, Ratio=3.46x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.813, Ratio=3.58x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.788, Ratio=3.47x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.797, Ratio=3.50x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.775, Ratio=3.39x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.828, Ratio=3.64x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.792, Ratio=3.57x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.789, Ratio=3.50x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.822, Ratio=3.59x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.791, Ratio=3.54x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.802, Ratio=3.60x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.818, Ratio=3.71x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.790, Ratio=3.39x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.814, Ratio=3.58x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.826, Ratio=3.62x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.835, Ratio=3.74x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.805, Ratio=3.54x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.804, Ratio=3.51x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.835, Ratio=3.85x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.820, Ratio=3.70x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.822, Ratio=3.69x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.801, Ratio=3.49x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.789, Ratio=3.47x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.798, Ratio=3.49x, Gap=-3.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.827, Ratio=3.70x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.811, Ratio=3.53x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.790, Ratio=3.57x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.811, Ratio=3.56x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.801, Ratio=3.58x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.807, Ratio=3.53x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.817, Ratio=3.66x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.802, Ratio=3.56x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.818, Ratio=3.58x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.811, Ratio=3.58x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.810, Ratio=3.61x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.808, Ratio=3.67x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.815, Ratio=3.72x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.840, Ratio=3.86x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.784, Ratio=3.50x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.795, Ratio=3.58x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.814, Ratio=3.47x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.834, Ratio=3.78x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.799, Ratio=3.50x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.813, Ratio=3.72x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.802, Ratio=3.60x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.784, Ratio=3.37x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.790, Ratio=3.63x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.818, Ratio=3.55x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.775, Ratio=3.39x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.807, Ratio=3.60x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.797, Ratio=3.48x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.802, Ratio=3.50x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.818, Ratio=3.57x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.816, Ratio=3.58x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.812, Ratio=3.69x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.837, Ratio=3.69x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.796, Ratio=3.46x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.813, Ratio=3.62x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.809, Ratio=3.75x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.808, Ratio=3.62x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.812, Ratio=3.66x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.828, Ratio=3.75x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.814, Ratio=3.58x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.794, Ratio=3.57x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.790, Ratio=3.63x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.802, Ratio=3.53x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.817, Ratio=3.57x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.805, Ratio=3.60x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.822, Ratio=3.66x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.810, Ratio=3.53x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.807, Ratio=3.60x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.798, Ratio=3.65x, Gap=-3.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.803, Ratio=3.55x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.811, Ratio=3.60x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.796, Ratio=3.57x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.812, Ratio=3.68x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.803, Ratio=3.56x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.777, Ratio=3.36x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.787, Ratio=3.42x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.825, Ratio=3.71x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.819, Ratio=3.72x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.807, Ratio=3.60x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.820, Ratio=3.60x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.844, Ratio=3.71x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.818, Ratio=3.62x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.806, Ratio=3.56x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.827, Ratio=3.67x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.796, Ratio=3.39x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.805, Ratio=3.57x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.806, Ratio=3.62x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.798, Ratio=3.44x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.821, Ratio=3.64x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.805, Ratio=3.66x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.788, Ratio=3.45x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.786, Ratio=3.38x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.804, Ratio=3.57x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.812, Ratio=3.59x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.810, Ratio=3.71x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.792, Ratio=3.37x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.795, Ratio=3.47x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.783, Ratio=3.38x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.804, Ratio=3.62x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.787, Ratio=3.51x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.806, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.792, Ratio=3.45x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.815, Ratio=3.53x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.825, Ratio=3.58x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.808, Ratio=3.56x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.792, Ratio=3.52x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.831, Ratio=3.86x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.820, Ratio=3.78x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.845, Ratio=3.91x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.786, Ratio=3.48x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.801, Ratio=3.55x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.811, Ratio=3.55x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.803, Ratio=3.62x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.808, Ratio=3.59x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.827, Ratio=3.71x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.806, Ratio=3.58x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.816, Ratio=3.57x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.826, Ratio=3.71x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.810, Ratio=3.60x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.818, Ratio=3.64x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.799, Ratio=3.50x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.788, Ratio=3.46x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.812, Ratio=3.64x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.814, Ratio=3.67x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.816, Ratio=3.70x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.795, Ratio=3.37x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.810, Ratio=3.49x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.796, Ratio=3.47x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.817, Ratio=3.57x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.819, Ratio=3.67x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.837, Ratio=3.80x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.816, Ratio=3.61x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.804, Ratio=3.49x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.800, Ratio=3.53x, Gap=-3.493

============================================================
Epoch 10/20 completed in 37.8s
Train: Loss=1.0399 (C:1.0399, R:0.0105) Ratio=3.23x
Val:   Loss=0.9960 (C:0.9960, R:0.0105) Ratio=3.79x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.9960)
Checkpoint saved at epoch 10
============================================================

Epoch 11 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.796, Ratio=3.37x, Gap=-3.898
Batch   0/537: Loss=1.0354 (C:1.0354, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.806, Ratio=3.46x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.801, Ratio=3.57x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.806, Ratio=3.42x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.791, Ratio=3.26x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.782, Ratio=3.28x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.793, Ratio=3.22x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.804, Ratio=3.42x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.825, Ratio=3.46x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.792, Ratio=3.39x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.799, Ratio=3.38x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.811, Ratio=3.57x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.799, Ratio=3.40x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.809, Ratio=3.46x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.802, Ratio=3.33x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.822, Ratio=3.56x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.800, Ratio=3.52x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.53x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.798, Ratio=3.37x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.818, Ratio=3.54x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.779, Ratio=3.25x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.812, Ratio=3.59x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.811, Ratio=3.44x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.809, Ratio=3.56x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.814, Ratio=3.38x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.827, Ratio=3.58x, Gap=-4.396
Batch  25/537: Loss=0.9927 (C:0.9927, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.806, Ratio=3.39x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.812, Ratio=3.46x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.811, Ratio=3.24x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.819, Ratio=3.50x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.806, Ratio=3.37x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.782, Ratio=3.31x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.761, Ratio=3.29x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.810, Ratio=3.44x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.798, Ratio=3.50x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.787, Ratio=3.34x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.810, Ratio=3.42x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.793, Ratio=3.27x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.785, Ratio=3.33x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.801, Ratio=3.46x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.788, Ratio=3.38x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.803, Ratio=3.47x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.798, Ratio=3.34x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.813, Ratio=3.41x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.793, Ratio=3.27x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.822, Ratio=3.53x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.818, Ratio=3.37x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.783, Ratio=3.32x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.805, Ratio=3.27x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.791, Ratio=3.42x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.796, Ratio=3.43x, Gap=-4.469
Batch  50/537: Loss=1.0215 (C:1.0215, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.786, Ratio=3.41x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.809, Ratio=3.40x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.824, Ratio=3.39x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.807, Ratio=3.39x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.799, Ratio=3.40x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.832, Ratio=3.53x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.797, Ratio=3.38x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.803, Ratio=3.44x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.787, Ratio=3.37x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.787, Ratio=3.32x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.804, Ratio=3.40x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.570, Neg=1.787, Ratio=3.14x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.807, Ratio=3.28x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.799, Ratio=3.35x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.821, Ratio=3.53x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.802, Ratio=3.39x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.783, Ratio=3.44x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.807, Ratio=3.37x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.807, Ratio=3.34x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.841, Ratio=3.52x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.795, Ratio=3.32x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.835, Ratio=3.45x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.825, Ratio=3.62x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.792, Ratio=3.29x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.824, Ratio=3.46x, Gap=-3.965
Batch  75/537: Loss=1.0146 (C:1.0146, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.805, Ratio=3.45x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.811, Ratio=3.35x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.797, Ratio=3.37x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.836, Ratio=3.59x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.819, Ratio=3.40x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.786, Ratio=3.30x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.788, Ratio=3.32x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.803, Ratio=3.41x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.796, Ratio=3.43x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.811, Ratio=3.45x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.799, Ratio=3.26x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.791, Ratio=3.35x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.799, Ratio=3.42x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.795, Ratio=3.36x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.790, Ratio=3.30x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.788, Ratio=3.33x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.778, Ratio=3.22x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.795, Ratio=3.44x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.800, Ratio=3.45x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.783, Ratio=3.27x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.807, Ratio=3.39x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.802, Ratio=3.38x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.805, Ratio=3.31x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.827, Ratio=3.40x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.808, Ratio=3.29x, Gap=-3.970
Batch 100/537: Loss=1.0514 (C:1.0514, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.805, Ratio=3.35x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.776, Ratio=3.30x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.826, Ratio=3.45x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.787, Ratio=3.33x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.793, Ratio=3.32x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.804, Ratio=3.56x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.787, Ratio=3.31x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.807, Ratio=3.38x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.808, Ratio=3.58x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.791, Ratio=3.33x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.833, Ratio=3.60x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.805, Ratio=3.26x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.774, Ratio=3.21x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.814, Ratio=3.44x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.812, Ratio=3.38x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.831, Ratio=3.43x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.804, Ratio=3.39x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.767, Ratio=3.27x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.806, Ratio=3.39x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.782, Ratio=3.30x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.791, Ratio=3.27x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.786, Ratio=3.25x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.789, Ratio=3.28x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.806, Ratio=3.43x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.822, Ratio=3.55x, Gap=-3.874
Batch 125/537: Loss=0.9976 (C:0.9976, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.809, Ratio=3.48x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.767, Ratio=3.25x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.38x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.814, Ratio=3.48x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.784, Ratio=3.26x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.815, Ratio=3.43x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.823, Ratio=3.58x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.783, Ratio=3.26x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.802, Ratio=3.42x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.806, Ratio=3.34x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.777, Ratio=3.34x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.798, Ratio=3.39x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.788, Ratio=3.26x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.790, Ratio=3.35x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.813, Ratio=3.44x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.818, Ratio=3.52x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.816, Ratio=3.42x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.793, Ratio=3.31x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.809, Ratio=3.51x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.817, Ratio=3.52x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.800, Ratio=3.38x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.799, Ratio=3.38x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.809, Ratio=3.57x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.792, Ratio=3.43x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.792, Ratio=3.38x, Gap=-4.005
Batch 150/537: Loss=1.0293 (C:1.0293, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.818, Ratio=3.53x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.815, Ratio=3.40x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.787, Ratio=3.23x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.784, Ratio=3.26x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.815, Ratio=3.44x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.805, Ratio=3.30x, Gap=-3.783
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.795, Ratio=3.28x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.803, Ratio=3.45x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.809, Ratio=3.33x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.783, Ratio=3.39x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.807, Ratio=3.39x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.792, Ratio=3.41x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.797, Ratio=3.34x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.782, Ratio=3.34x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.801, Ratio=3.49x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.801, Ratio=3.34x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.814, Ratio=3.43x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.801, Ratio=3.37x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.791, Ratio=3.30x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.804, Ratio=3.36x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.780, Ratio=3.25x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.808, Ratio=3.50x, Gap=-4.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.817, Ratio=3.44x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.816, Ratio=3.45x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.804, Ratio=3.36x, Gap=-4.049
Batch 175/537: Loss=1.0372 (C:1.0372, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.801, Ratio=3.37x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.809, Ratio=3.43x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.808, Ratio=3.36x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.38x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.802, Ratio=3.34x, Gap=-3.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.791, Ratio=3.41x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.802, Ratio=3.46x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.803, Ratio=3.42x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.805, Ratio=3.35x, Gap=-5.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.814, Ratio=3.55x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.766, Ratio=3.29x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.785, Ratio=3.27x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.773, Ratio=3.21x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.816, Ratio=3.47x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.771, Ratio=3.23x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.791, Ratio=3.37x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.782, Ratio=3.29x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.803, Ratio=3.30x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.796, Ratio=3.32x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.801, Ratio=3.40x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.790, Ratio=3.30x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.795, Ratio=3.35x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.799, Ratio=3.33x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.800, Ratio=3.40x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.795, Ratio=3.27x, Gap=-3.958
Batch 200/537: Loss=1.0531 (C:1.0531, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.780, Ratio=3.31x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.815, Ratio=3.55x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.813, Ratio=3.33x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.800, Ratio=3.29x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.814, Ratio=3.40x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.826, Ratio=3.46x, Gap=-4.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.813, Ratio=3.43x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.807, Ratio=3.39x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.783, Ratio=3.30x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.815, Ratio=3.55x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.799, Ratio=3.47x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.804, Ratio=3.36x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.775, Ratio=3.34x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.816, Ratio=3.44x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.811, Ratio=3.37x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.808, Ratio=3.35x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.782, Ratio=3.35x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.787, Ratio=3.30x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.804, Ratio=3.41x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.835, Ratio=3.59x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.792, Ratio=3.26x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.815, Ratio=3.47x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.817, Ratio=3.40x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.812, Ratio=3.48x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.798, Ratio=3.47x, Gap=-3.833
Batch 225/537: Loss=1.0152 (C:1.0152, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.813, Ratio=3.47x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.806, Ratio=3.44x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.815, Ratio=3.46x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.802, Ratio=3.32x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.817, Ratio=3.48x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.799, Ratio=3.27x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.781, Ratio=3.31x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.801, Ratio=3.33x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.785, Ratio=3.26x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.830, Ratio=3.59x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.804, Ratio=3.38x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.788, Ratio=3.24x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.791, Ratio=3.29x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.807, Ratio=3.50x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.793, Ratio=3.24x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.794, Ratio=3.32x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.800, Ratio=3.32x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.794, Ratio=3.37x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.814, Ratio=3.42x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.787, Ratio=3.36x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.790, Ratio=3.43x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.38x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.799, Ratio=3.42x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.799, Ratio=3.28x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.778, Ratio=3.18x, Gap=-4.002
Batch 250/537: Loss=1.0715 (C:1.0715, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.805, Ratio=3.47x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.808, Ratio=3.34x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.799, Ratio=3.29x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.799, Ratio=3.38x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.801, Ratio=3.31x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.805, Ratio=3.42x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.804, Ratio=3.36x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.788, Ratio=3.28x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.789, Ratio=3.28x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.810, Ratio=3.44x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.802, Ratio=3.34x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.804, Ratio=3.47x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.820, Ratio=3.47x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.795, Ratio=3.24x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.824, Ratio=3.46x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.794, Ratio=3.38x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.560, Neg=1.793, Ratio=3.20x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.794, Ratio=3.40x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.788, Ratio=3.43x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.816, Ratio=3.36x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.821, Ratio=3.43x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.787, Ratio=3.34x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.786, Ratio=3.38x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.805, Ratio=3.38x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.794, Ratio=3.34x, Gap=-3.930
Batch 275/537: Loss=1.0390 (C:1.0390, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.799, Ratio=3.34x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.806, Ratio=3.58x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.782, Ratio=3.27x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.808, Ratio=3.38x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.798, Ratio=3.30x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.806, Ratio=3.41x, Gap=-3.802
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.809, Ratio=3.29x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.793, Ratio=3.35x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.809, Ratio=3.42x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.819, Ratio=3.51x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.771, Ratio=3.17x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.777, Ratio=3.29x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.823, Ratio=3.47x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.773, Ratio=3.25x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.804, Ratio=3.34x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.798, Ratio=3.47x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.822, Ratio=3.48x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.803, Ratio=3.45x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.809, Ratio=3.48x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.812, Ratio=3.48x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.798, Ratio=3.30x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.812, Ratio=3.46x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.809, Ratio=3.46x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.792, Ratio=3.44x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.814, Ratio=3.44x, Gap=-4.008
Batch 300/537: Loss=1.0186 (C:1.0186, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.822, Ratio=3.39x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.804, Ratio=3.26x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.818, Ratio=3.42x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.820, Ratio=3.54x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.811, Ratio=3.48x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.797, Ratio=3.33x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.803, Ratio=3.35x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.804, Ratio=3.37x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.808, Ratio=3.49x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.819, Ratio=3.54x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.790, Ratio=3.40x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.785, Ratio=3.39x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.783, Ratio=3.35x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.799, Ratio=3.41x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.799, Ratio=3.41x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.813, Ratio=3.46x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.802, Ratio=3.34x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.805, Ratio=3.41x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.809, Ratio=3.51x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.789, Ratio=3.22x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.769, Ratio=3.19x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.804, Ratio=3.37x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.821, Ratio=3.52x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.800, Ratio=3.23x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.777, Ratio=3.20x, Gap=-4.024
Batch 325/537: Loss=1.0670 (C:1.0670, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.558, Neg=1.790, Ratio=3.21x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.818, Ratio=3.42x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.800, Ratio=3.31x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.767, Ratio=3.20x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.829, Ratio=3.45x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.778, Ratio=3.31x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.781, Ratio=3.21x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.801, Ratio=3.31x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.819, Ratio=3.52x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.808, Ratio=3.35x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.822, Ratio=3.45x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.768, Ratio=3.16x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.787, Ratio=3.34x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.796, Ratio=3.38x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.815, Ratio=3.60x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.803, Ratio=3.34x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.822, Ratio=3.58x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.806, Ratio=3.38x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.813, Ratio=3.56x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.786, Ratio=3.39x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.786, Ratio=3.31x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.818, Ratio=3.48x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.799, Ratio=3.35x, Gap=-4.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.805, Ratio=3.35x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.818, Ratio=3.47x, Gap=-3.823
Batch 350/537: Loss=1.0148 (C:1.0148, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.820, Ratio=3.57x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.802, Ratio=3.31x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.790, Ratio=3.26x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.795, Ratio=3.26x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.835, Ratio=3.47x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.813, Ratio=3.40x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.795, Ratio=3.24x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.817, Ratio=3.38x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.796, Ratio=3.31x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.815, Ratio=3.41x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.787, Ratio=3.33x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.779, Ratio=3.37x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.773, Ratio=3.13x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.810, Ratio=3.56x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.807, Ratio=3.40x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.798, Ratio=3.41x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.784, Ratio=3.27x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.755, Ratio=3.17x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.791, Ratio=3.35x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.783, Ratio=3.30x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.807, Ratio=3.47x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.795, Ratio=3.24x, Gap=-4.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.787, Ratio=3.32x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.786, Ratio=3.24x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.790, Ratio=3.33x, Gap=-4.515
Batch 375/537: Loss=1.0429 (C:1.0429, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.798, Ratio=3.41x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.810, Ratio=3.37x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.775, Ratio=3.18x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.819, Ratio=3.42x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.777, Ratio=3.23x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.794, Ratio=3.27x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.798, Ratio=3.38x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.794, Ratio=3.27x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.797, Ratio=3.33x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.790, Ratio=3.35x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.806, Ratio=3.38x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.816, Ratio=3.39x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.775, Ratio=3.20x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.801, Ratio=3.43x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.814, Ratio=3.33x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.809, Ratio=3.36x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.782, Ratio=3.26x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.800, Ratio=3.39x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.791, Ratio=3.42x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.820, Ratio=3.41x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.795, Ratio=3.40x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.820, Ratio=3.52x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.800, Ratio=3.46x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.793, Ratio=3.30x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.809, Ratio=3.38x, Gap=-3.998
Batch 400/537: Loss=1.0310 (C:1.0310, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.796, Ratio=3.34x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.783, Ratio=3.31x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.803, Ratio=3.38x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.813, Ratio=3.42x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.798, Ratio=3.29x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.774, Ratio=3.27x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.803, Ratio=3.41x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.783, Ratio=3.24x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.796, Ratio=3.39x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.812, Ratio=3.44x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.807, Ratio=3.43x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.788, Ratio=3.33x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.791, Ratio=3.31x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.801, Ratio=3.35x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.800, Ratio=3.27x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.803, Ratio=3.28x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.797, Ratio=3.41x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.782, Ratio=3.29x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.799, Ratio=3.53x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.790, Ratio=3.28x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.797, Ratio=3.37x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.809, Ratio=3.47x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.785, Ratio=3.30x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.786, Ratio=3.35x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.795, Ratio=3.38x, Gap=-4.202
Batch 425/537: Loss=1.0301 (C:1.0301, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.799, Ratio=3.25x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.801, Ratio=3.30x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.829, Ratio=3.52x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.779, Ratio=3.29x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.799, Ratio=3.37x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.794, Ratio=3.30x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.794, Ratio=3.45x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.799, Ratio=3.44x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.785, Ratio=3.36x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.799, Ratio=3.37x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.784, Ratio=3.47x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.807, Ratio=3.35x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.799, Ratio=3.26x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.800, Ratio=3.36x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.812, Ratio=3.51x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.806, Ratio=3.41x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.788, Ratio=3.37x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.793, Ratio=3.29x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.809, Ratio=3.27x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.812, Ratio=3.40x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.815, Ratio=3.45x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.806, Ratio=3.33x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.775, Ratio=3.18x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.814, Ratio=3.48x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.802, Ratio=3.41x, Gap=-3.789
Batch 450/537: Loss=1.0266 (C:1.0266, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.794, Ratio=3.38x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.789, Ratio=3.28x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.801, Ratio=3.25x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.790, Ratio=3.39x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.803, Ratio=3.37x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.787, Ratio=3.35x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.785, Ratio=3.24x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.801, Ratio=3.36x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.797, Ratio=3.34x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.793, Ratio=3.28x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.802, Ratio=3.42x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.822, Ratio=3.48x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.811, Ratio=3.41x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.824, Ratio=3.52x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.801, Ratio=3.36x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.786, Ratio=3.28x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.565, Neg=1.770, Ratio=3.13x, Gap=-4.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.802, Ratio=3.30x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.796, Ratio=3.36x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.797, Ratio=3.28x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.795, Ratio=3.28x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.798, Ratio=3.37x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.815, Ratio=3.48x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.810, Ratio=3.46x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.819, Ratio=3.62x, Gap=-3.892
Batch 475/537: Loss=0.9870 (C:0.9870, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.806, Ratio=3.38x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.784, Ratio=3.40x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.828, Ratio=3.50x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.796, Ratio=3.38x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.796, Ratio=3.39x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.783, Ratio=3.26x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.813, Ratio=3.41x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.784, Ratio=3.28x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.784, Ratio=3.25x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.773, Ratio=3.28x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.800, Ratio=3.35x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.799, Ratio=3.32x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.803, Ratio=3.29x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.801, Ratio=3.31x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.793, Ratio=3.25x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.795, Ratio=3.29x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.796, Ratio=3.42x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.800, Ratio=3.38x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.789, Ratio=3.36x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.795, Ratio=3.25x, Gap=-4.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.788, Ratio=3.22x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.801, Ratio=3.27x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.562, Neg=1.785, Ratio=3.18x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.782, Ratio=3.26x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.803, Ratio=3.49x, Gap=-4.068
Batch 500/537: Loss=1.0107 (C:1.0107, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.801, Ratio=3.40x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.789, Ratio=3.34x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.789, Ratio=3.31x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.817, Ratio=3.52x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.785, Ratio=3.39x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.798, Ratio=3.27x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.815, Ratio=3.54x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.793, Ratio=3.31x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.793, Ratio=3.37x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.778, Ratio=3.34x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.799, Ratio=3.35x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.802, Ratio=3.40x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.793, Ratio=3.43x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.833, Ratio=3.55x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.822, Ratio=3.39x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.815, Ratio=3.34x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.795, Ratio=3.32x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.825, Ratio=3.46x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.834, Ratio=3.62x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.796, Ratio=3.33x, Gap=-3.980
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.806, Ratio=3.45x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.811, Ratio=3.41x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.787, Ratio=3.40x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.793, Ratio=3.42x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.803, Ratio=3.34x, Gap=-4.301
Batch 525/537: Loss=1.0397 (C:1.0397, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.782, Ratio=3.32x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.802, Ratio=3.42x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.828, Ratio=3.53x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.777, Ratio=3.27x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.818, Ratio=3.34x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.791, Ratio=3.29x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.791, Ratio=3.36x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.795, Ratio=3.42x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.802, Ratio=3.31x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.809, Ratio=3.38x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.813, Ratio=3.33x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.822, Ratio=3.72x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.818, Ratio=3.66x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.804, Ratio=3.62x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.809, Ratio=3.60x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.823, Ratio=3.68x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.819, Ratio=3.52x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.806, Ratio=3.61x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.832, Ratio=3.66x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.795, Ratio=3.48x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.823, Ratio=3.78x, Gap=-3.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.824, Ratio=3.65x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.828, Ratio=3.75x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.818, Ratio=3.55x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.805, Ratio=3.52x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.824, Ratio=3.68x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.827, Ratio=3.73x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.817, Ratio=3.63x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.815, Ratio=3.58x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.827, Ratio=3.53x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.845, Ratio=3.89x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.832, Ratio=3.76x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.821, Ratio=3.63x, Gap=-3.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.825, Ratio=3.69x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.804, Ratio=3.41x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.836, Ratio=3.90x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.804, Ratio=3.46x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.811, Ratio=3.59x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.824, Ratio=3.55x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.835, Ratio=3.74x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.818, Ratio=3.51x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.805, Ratio=3.48x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.827, Ratio=3.87x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.818, Ratio=3.64x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.808, Ratio=3.50x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.823, Ratio=3.64x, Gap=-3.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.818, Ratio=3.64x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.815, Ratio=3.65x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.806, Ratio=3.68x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.821, Ratio=3.69x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.838, Ratio=3.79x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.830, Ratio=3.74x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.820, Ratio=3.58x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.808, Ratio=3.50x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.835, Ratio=3.80x, Gap=-3.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.846, Ratio=3.89x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.806, Ratio=3.51x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.821, Ratio=3.80x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.842, Ratio=3.81x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.806, Ratio=3.54x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.818, Ratio=3.59x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.808, Ratio=3.59x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.821, Ratio=3.73x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.836, Ratio=3.78x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.815, Ratio=3.57x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.833, Ratio=3.80x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.804, Ratio=3.40x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.804, Ratio=3.50x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.821, Ratio=3.57x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.808, Ratio=3.56x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.809, Ratio=3.43x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.809, Ratio=3.54x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.806, Ratio=3.45x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.808, Ratio=3.56x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.806, Ratio=3.52x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.828, Ratio=3.65x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.843, Ratio=3.68x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.799, Ratio=3.50x, Gap=-3.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.819, Ratio=3.73x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.820, Ratio=3.72x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.796, Ratio=3.60x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.813, Ratio=3.53x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.824, Ratio=3.67x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.823, Ratio=3.72x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.820, Ratio=3.69x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.825, Ratio=3.79x, Gap=-3.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.825, Ratio=3.60x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.831, Ratio=3.79x, Gap=-3.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.821, Ratio=3.57x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.823, Ratio=3.64x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.839, Ratio=3.72x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.820, Ratio=3.63x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.800, Ratio=3.61x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.828, Ratio=3.66x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.812, Ratio=3.63x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.849, Ratio=3.90x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.821, Ratio=3.73x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.799, Ratio=3.56x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.820, Ratio=3.76x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.827, Ratio=3.64x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.803, Ratio=3.46x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.816, Ratio=3.59x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.817, Ratio=3.59x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.806, Ratio=3.62x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.825, Ratio=3.83x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.830, Ratio=3.67x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.831, Ratio=3.75x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.827, Ratio=3.74x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.785, Ratio=3.42x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.840, Ratio=3.74x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.813, Ratio=3.60x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.808, Ratio=3.59x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.830, Ratio=3.66x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.805, Ratio=3.56x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.794, Ratio=3.55x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.823, Ratio=3.73x, Gap=-3.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.812, Ratio=3.63x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.827, Ratio=3.74x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.819, Ratio=3.59x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.822, Ratio=3.66x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.821, Ratio=3.74x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.828, Ratio=3.83x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.816, Ratio=3.66x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.826, Ratio=3.74x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.842, Ratio=3.89x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.832, Ratio=3.66x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.833, Ratio=3.87x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.828, Ratio=3.79x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.802, Ratio=3.50x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.805, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.824, Ratio=3.62x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.844, Ratio=3.82x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.831, Ratio=3.72x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.816, Ratio=3.69x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.804, Ratio=3.50x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.818, Ratio=3.56x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.841, Ratio=3.67x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.824, Ratio=3.70x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.819, Ratio=3.58x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.837, Ratio=3.78x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.820, Ratio=3.64x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.815, Ratio=3.60x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.809, Ratio=3.61x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.813, Ratio=3.57x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.832, Ratio=3.76x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.804, Ratio=3.59x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.802, Ratio=3.50x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.836, Ratio=3.80x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.845, Ratio=3.89x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.807, Ratio=3.54x, Gap=-3.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.806, Ratio=3.56x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.828, Ratio=3.72x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.823, Ratio=3.67x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.813, Ratio=3.67x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.821, Ratio=3.68x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.799, Ratio=3.47x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.831, Ratio=3.66x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.818, Ratio=3.65x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.837, Ratio=3.66x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.830, Ratio=3.82x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.805, Ratio=3.49x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.835, Ratio=3.83x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.809, Ratio=3.57x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.827, Ratio=3.68x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.810, Ratio=3.59x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.781, Ratio=3.41x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.814, Ratio=3.62x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.811, Ratio=3.69x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.811, Ratio=3.61x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.812, Ratio=3.61x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.807, Ratio=3.52x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.830, Ratio=3.67x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.802, Ratio=3.52x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.822, Ratio=3.69x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.806, Ratio=3.56x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.822, Ratio=3.53x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.821, Ratio=3.73x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.805, Ratio=3.59x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.800, Ratio=3.59x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.836, Ratio=3.68x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.817, Ratio=3.64x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.825, Ratio=3.67x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.817, Ratio=3.67x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.829, Ratio=3.76x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.804, Ratio=3.61x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.806, Ratio=3.66x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.834, Ratio=3.75x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.842, Ratio=3.89x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.814, Ratio=3.58x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.811, Ratio=3.59x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.840, Ratio=3.68x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.816, Ratio=3.66x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.822, Ratio=3.65x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.825, Ratio=3.76x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.821, Ratio=3.67x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.826, Ratio=3.68x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.832, Ratio=3.64x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.820, Ratio=3.61x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.826, Ratio=3.65x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.822, Ratio=3.64x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.790, Ratio=3.37x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.784, Ratio=3.45x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.828, Ratio=3.81x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.820, Ratio=3.76x, Gap=-3.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.806, Ratio=3.55x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.822, Ratio=3.66x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.815, Ratio=3.63x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.824, Ratio=3.75x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.841, Ratio=3.74x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.819, Ratio=3.65x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.793, Ratio=3.48x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.807, Ratio=3.62x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.820, Ratio=3.67x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.819, Ratio=3.66x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.803, Ratio=3.49x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.837, Ratio=3.88x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.827, Ratio=3.71x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.828, Ratio=3.79x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.826, Ratio=3.81x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.821, Ratio=3.74x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.826, Ratio=3.71x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.835, Ratio=3.82x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.827, Ratio=3.78x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.814, Ratio=3.71x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.839, Ratio=3.75x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.816, Ratio=3.57x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.817, Ratio=3.66x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.825, Ratio=3.66x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.816, Ratio=3.67x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.810, Ratio=3.54x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.828, Ratio=3.83x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.829, Ratio=3.71x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.805, Ratio=3.64x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.810, Ratio=3.67x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.816, Ratio=3.55x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.807, Ratio=3.41x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.824, Ratio=3.68x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.816, Ratio=3.63x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.827, Ratio=3.85x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.802, Ratio=3.52x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.816, Ratio=3.65x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.815, Ratio=3.70x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.820, Ratio=3.74x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.825, Ratio=3.74x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.836, Ratio=3.83x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.799, Ratio=3.34x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.821, Ratio=3.64x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.839, Ratio=3.89x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.827, Ratio=3.74x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.833, Ratio=3.83x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.834, Ratio=3.68x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.804, Ratio=3.49x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.803, Ratio=3.49x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.843, Ratio=3.92x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.834, Ratio=3.64x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.827, Ratio=3.63x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.808, Ratio=3.61x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.815, Ratio=3.60x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.828, Ratio=3.55x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.822, Ratio=3.65x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.808, Ratio=3.52x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.832, Ratio=3.73x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.808, Ratio=3.66x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.816, Ratio=3.70x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.847, Ratio=3.89x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.799, Ratio=3.55x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.815, Ratio=3.65x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.806, Ratio=3.57x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.795, Ratio=3.50x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.827, Ratio=3.67x, Gap=-3.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.795, Ratio=3.49x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.840, Ratio=3.75x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.804, Ratio=3.60x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.820, Ratio=3.82x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.805, Ratio=3.70x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.808, Ratio=3.53x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.822, Ratio=3.58x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.819, Ratio=3.58x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.799, Ratio=3.58x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.802, Ratio=3.54x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.819, Ratio=3.59x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.835, Ratio=3.80x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.828, Ratio=3.65x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.833, Ratio=3.86x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.810, Ratio=3.57x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.810, Ratio=3.62x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.823, Ratio=3.66x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.807, Ratio=3.56x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.820, Ratio=3.55x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.796, Ratio=3.46x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.821, Ratio=3.68x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.813, Ratio=3.62x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.836, Ratio=3.79x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.824, Ratio=3.68x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.778, Ratio=3.41x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.825, Ratio=3.69x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.843, Ratio=3.77x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.814, Ratio=3.60x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.825, Ratio=3.63x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.815, Ratio=3.63x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.839, Ratio=3.78x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.806, Ratio=3.47x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.814, Ratio=3.54x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.809, Ratio=3.51x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.823, Ratio=3.75x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.810, Ratio=3.61x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.809, Ratio=3.51x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.811, Ratio=3.58x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.811, Ratio=3.53x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.831, Ratio=3.79x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.805, Ratio=3.50x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.834, Ratio=3.78x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.820, Ratio=3.61x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.812, Ratio=3.50x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.813, Ratio=3.50x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.807, Ratio=3.43x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.823, Ratio=3.56x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.823, Ratio=3.75x, Gap=-3.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.830, Ratio=3.67x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.808, Ratio=3.75x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.811, Ratio=3.59x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.813, Ratio=3.66x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.819, Ratio=3.66x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.815, Ratio=3.61x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.833, Ratio=3.68x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.807, Ratio=3.65x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.817, Ratio=3.61x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.815, Ratio=3.55x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.846, Ratio=3.79x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.819, Ratio=3.66x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.821, Ratio=3.63x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.813, Ratio=3.59x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.824, Ratio=3.50x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.838, Ratio=3.57x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.812, Ratio=3.50x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.819, Ratio=3.69x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.823, Ratio=3.69x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.810, Ratio=3.47x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.833, Ratio=3.69x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.807, Ratio=3.63x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.806, Ratio=3.56x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.824, Ratio=3.55x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.807, Ratio=3.59x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.810, Ratio=3.64x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.816, Ratio=3.67x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.815, Ratio=3.59x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.803, Ratio=3.51x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.820, Ratio=3.59x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.815, Ratio=3.64x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.830, Ratio=3.75x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.825, Ratio=3.56x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.847, Ratio=3.78x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.805, Ratio=3.42x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.822, Ratio=3.61x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.818, Ratio=3.67x, Gap=-3.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.811, Ratio=3.66x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.821, Ratio=3.62x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.822, Ratio=3.75x, Gap=-3.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.821, Ratio=3.79x, Gap=-3.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.812, Ratio=3.60x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.831, Ratio=3.76x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.793, Ratio=3.49x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.799, Ratio=3.45x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.811, Ratio=3.60x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.827, Ratio=3.70x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.830, Ratio=3.71x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.801, Ratio=3.55x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.821, Ratio=3.66x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.828, Ratio=3.61x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.831, Ratio=3.64x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.802, Ratio=3.50x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.821, Ratio=3.62x, Gap=-3.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.819, Ratio=3.73x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.803, Ratio=3.53x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.800, Ratio=3.44x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.826, Ratio=3.67x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.794, Ratio=3.59x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.823, Ratio=3.67x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.820, Ratio=3.67x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.790, Ratio=3.42x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.821, Ratio=3.75x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.825, Ratio=3.71x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.817, Ratio=3.57x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.802, Ratio=3.57x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.802, Ratio=3.49x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.839, Ratio=3.76x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.808, Ratio=3.53x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.824, Ratio=3.58x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.795, Ratio=3.45x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.834, Ratio=3.81x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.813, Ratio=3.60x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.823, Ratio=3.76x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.830, Ratio=3.71x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.826, Ratio=3.74x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.816, Ratio=3.52x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.826, Ratio=3.70x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.816, Ratio=3.68x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.822, Ratio=3.70x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.834, Ratio=3.75x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.815, Ratio=3.58x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.819, Ratio=3.60x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.811, Ratio=3.63x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.831, Ratio=3.73x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.806, Ratio=3.41x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.807, Ratio=3.50x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.802, Ratio=3.63x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.818, Ratio=3.60x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.799, Ratio=3.59x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.820, Ratio=3.53x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.817, Ratio=3.56x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.794, Ratio=3.46x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.809, Ratio=3.71x, Gap=-3.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.805, Ratio=3.48x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.836, Ratio=3.60x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.808, Ratio=3.53x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.812, Ratio=3.62x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.819, Ratio=3.65x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.795, Ratio=3.47x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.813, Ratio=3.64x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.815, Ratio=3.60x, Gap=-3.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.811, Ratio=3.61x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.823, Ratio=3.68x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.825, Ratio=3.81x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.819, Ratio=3.69x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.805, Ratio=3.52x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.823, Ratio=3.69x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.810, Ratio=3.58x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.816, Ratio=3.61x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.829, Ratio=3.68x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.808, Ratio=3.60x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.825, Ratio=3.71x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.814, Ratio=3.69x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.820, Ratio=3.56x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.825, Ratio=3.66x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.813, Ratio=3.70x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.823, Ratio=3.65x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.830, Ratio=3.68x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.818, Ratio=3.79x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.809, Ratio=3.59x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.802, Ratio=3.43x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.813, Ratio=3.61x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.832, Ratio=3.77x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.830, Ratio=3.72x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.809, Ratio=3.52x, Gap=-3.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.799, Ratio=3.51x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.819, Ratio=3.60x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.825, Ratio=3.63x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.813, Ratio=3.69x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.803, Ratio=3.48x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.845, Ratio=3.88x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.826, Ratio=3.65x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.838, Ratio=3.75x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.824, Ratio=3.72x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.846, Ratio=3.85x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.837, Ratio=3.75x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.818, Ratio=3.76x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.821, Ratio=3.56x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.810, Ratio=3.48x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.829, Ratio=3.70x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.808, Ratio=3.69x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.823, Ratio=3.63x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.806, Ratio=3.48x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.819, Ratio=3.56x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.802, Ratio=3.45x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.65x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.801, Ratio=3.58x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.837, Ratio=3.80x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.817, Ratio=3.54x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.827, Ratio=3.83x, Gap=-3.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.849, Ratio=3.77x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.805, Ratio=3.58x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.824, Ratio=3.71x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.797, Ratio=3.51x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.831, Ratio=3.71x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.808, Ratio=3.59x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.809, Ratio=3.55x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.820, Ratio=3.73x, Gap=-3.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.816, Ratio=3.63x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.822, Ratio=3.73x, Gap=-3.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.815, Ratio=3.62x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.805, Ratio=3.49x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.815, Ratio=3.57x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.820, Ratio=3.59x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.821, Ratio=3.76x, Gap=-3.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.65x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.818, Ratio=3.70x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.811, Ratio=3.72x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.822, Ratio=3.56x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.803, Ratio=3.51x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.808, Ratio=3.62x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.825, Ratio=3.55x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.805, Ratio=3.55x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.795, Ratio=3.43x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.820, Ratio=3.63x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.821, Ratio=3.76x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.798, Ratio=3.50x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.832, Ratio=3.76x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.814, Ratio=3.59x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.819, Ratio=3.60x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.814, Ratio=3.61x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.836, Ratio=3.71x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.828, Ratio=3.63x, Gap=-3.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.815, Ratio=3.74x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.836, Ratio=3.69x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.827, Ratio=3.64x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.817, Ratio=3.59x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.806, Ratio=3.59x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.815, Ratio=3.68x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.819, Ratio=3.66x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.807, Ratio=3.54x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.817, Ratio=3.66x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.823, Ratio=3.68x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.820, Ratio=3.64x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.812, Ratio=3.66x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.821, Ratio=3.60x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.819, Ratio=3.75x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.804, Ratio=3.70x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.820, Ratio=3.71x, Gap=-3.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.824, Ratio=3.67x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.822, Ratio=3.63x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.831, Ratio=3.81x, Gap=-3.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.809, Ratio=3.54x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.834, Ratio=3.71x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.828, Ratio=3.70x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.820, Ratio=3.58x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.841, Ratio=3.68x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.817, Ratio=3.67x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.819, Ratio=3.62x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.823, Ratio=3.68x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.809, Ratio=3.58x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.819, Ratio=3.48x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.831, Ratio=3.76x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.808, Ratio=3.41x, Gap=-3.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.808, Ratio=3.52x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.821, Ratio=3.78x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.818, Ratio=3.66x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.834, Ratio=3.75x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.834, Ratio=3.71x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.791, Ratio=3.40x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.799, Ratio=3.60x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.814, Ratio=3.63x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.827, Ratio=3.68x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.820, Ratio=3.60x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.827, Ratio=3.69x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.813, Ratio=3.58x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.813, Ratio=3.59x, Gap=-3.459

============================================================
Epoch 11/20 completed in 31.9s
Train: Loss=1.0333 (C:1.0333, R:0.0105) Ratio=3.27x
Val:   Loss=0.9866 (C:0.9866, R:0.0105) Ratio=3.93x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.9866)
============================================================

Epoch 12 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.829, Ratio=3.47x, Gap=-4.003
Batch   0/537: Loss=1.0113 (C:1.0113, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.814, Ratio=3.50x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.842, Ratio=3.58x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.817, Ratio=3.42x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.823, Ratio=3.51x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.838, Ratio=3.72x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.832, Ratio=3.46x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.783, Ratio=3.32x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.807, Ratio=3.41x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.794, Ratio=3.42x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.809, Ratio=3.53x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.833, Ratio=3.68x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.795, Ratio=3.38x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.800, Ratio=3.37x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.838, Ratio=3.67x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.827, Ratio=3.49x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.814, Ratio=3.35x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.807, Ratio=3.47x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.820, Ratio=3.43x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.816, Ratio=3.49x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.809, Ratio=3.48x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.809, Ratio=3.29x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.804, Ratio=3.42x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.795, Ratio=3.41x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.798, Ratio=3.46x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.786, Ratio=3.30x, Gap=-3.657
Batch  25/537: Loss=1.0490 (C:1.0490, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.801, Ratio=3.30x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.811, Ratio=3.38x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.818, Ratio=3.43x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.798, Ratio=3.35x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.798, Ratio=3.52x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.802, Ratio=3.48x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.803, Ratio=3.39x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.814, Ratio=3.44x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.812, Ratio=3.29x, Gap=-4.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.801, Ratio=3.28x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.799, Ratio=3.28x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.816, Ratio=3.43x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.811, Ratio=3.33x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.802, Ratio=3.34x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.821, Ratio=3.54x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.813, Ratio=3.34x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.792, Ratio=3.27x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.818, Ratio=3.57x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.804, Ratio=3.45x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.798, Ratio=3.36x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.810, Ratio=3.51x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.797, Ratio=3.41x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.810, Ratio=3.51x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.815, Ratio=3.51x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.796, Ratio=3.38x, Gap=-4.002
Batch  50/537: Loss=1.0338 (C:1.0338, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.828, Ratio=3.54x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.790, Ratio=3.34x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.801, Ratio=3.30x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.799, Ratio=3.28x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.784, Ratio=3.21x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.798, Ratio=3.39x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.830, Ratio=3.53x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.815, Ratio=3.42x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.798, Ratio=3.27x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.813, Ratio=3.44x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.819, Ratio=3.56x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.819, Ratio=3.48x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.830, Ratio=3.51x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.803, Ratio=3.40x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.795, Ratio=3.31x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.800, Ratio=3.34x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.786, Ratio=3.30x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.805, Ratio=3.51x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.830, Ratio=3.53x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.811, Ratio=3.49x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.825, Ratio=3.49x, Gap=-3.837
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.800, Ratio=3.45x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.817, Ratio=3.50x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.800, Ratio=3.41x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.792, Ratio=3.26x, Gap=-4.251
Batch  75/537: Loss=1.0569 (C:1.0569, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.810, Ratio=3.36x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.785, Ratio=3.31x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.828, Ratio=3.62x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.817, Ratio=3.53x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.812, Ratio=3.44x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.816, Ratio=3.46x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.812, Ratio=3.48x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.804, Ratio=3.44x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.802, Ratio=3.42x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.799, Ratio=3.34x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.784, Ratio=3.23x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.815, Ratio=3.48x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.800, Ratio=3.42x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.819, Ratio=3.42x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.813, Ratio=3.36x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.835, Ratio=3.58x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.808, Ratio=3.48x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.788, Ratio=3.33x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.785, Ratio=3.37x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.801, Ratio=3.27x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.563, Neg=1.752, Ratio=3.11x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.802, Ratio=3.42x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.818, Ratio=3.42x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.806, Ratio=3.43x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.789, Ratio=3.25x, Gap=-4.083
Batch 100/537: Loss=1.0565 (C:1.0565, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.810, Ratio=3.45x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.826, Ratio=3.61x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.820, Ratio=3.55x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.789, Ratio=3.30x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.802, Ratio=3.31x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.799, Ratio=3.33x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.787, Ratio=3.30x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.819, Ratio=3.38x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.807, Ratio=3.50x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.801, Ratio=3.38x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.787, Ratio=3.30x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.819, Ratio=3.48x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.782, Ratio=3.24x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.806, Ratio=3.44x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.794, Ratio=3.32x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.788, Ratio=3.43x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.810, Ratio=3.34x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.817, Ratio=3.40x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.808, Ratio=3.41x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.795, Ratio=3.40x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.801, Ratio=3.47x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.807, Ratio=3.52x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.786, Ratio=3.30x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.807, Ratio=3.43x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.809, Ratio=3.43x, Gap=-3.873
Batch 125/537: Loss=1.0221 (C:1.0221, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.795, Ratio=3.28x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.815, Ratio=3.44x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.808, Ratio=3.43x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.815, Ratio=3.49x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.821, Ratio=3.46x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.835, Ratio=3.62x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.801, Ratio=3.36x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.812, Ratio=3.50x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.817, Ratio=3.40x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.794, Ratio=3.43x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.796, Ratio=3.42x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.786, Ratio=3.35x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.818, Ratio=3.46x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.813, Ratio=3.43x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.819, Ratio=3.41x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.807, Ratio=3.33x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.824, Ratio=3.49x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.808, Ratio=3.44x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.810, Ratio=3.42x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.827, Ratio=3.52x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.830, Ratio=3.63x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.809, Ratio=3.40x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.788, Ratio=3.26x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.787, Ratio=3.31x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.779, Ratio=3.27x, Gap=-4.048
Batch 150/537: Loss=1.0561 (C:1.0561, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.806, Ratio=3.41x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.820, Ratio=3.53x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.796, Ratio=3.39x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.820, Ratio=3.45x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.831, Ratio=3.52x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.819, Ratio=3.56x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.850, Ratio=3.70x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.812, Ratio=3.44x, Gap=-3.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.810, Ratio=3.40x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.816, Ratio=3.51x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.806, Ratio=3.42x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.840, Ratio=3.53x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.807, Ratio=3.47x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.784, Ratio=3.34x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.794, Ratio=3.27x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.793, Ratio=3.31x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.822, Ratio=3.55x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.789, Ratio=3.31x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.774, Ratio=3.19x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.793, Ratio=3.47x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.799, Ratio=3.44x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.786, Ratio=3.31x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.819, Ratio=3.50x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.806, Ratio=3.31x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.794, Ratio=3.43x, Gap=-3.750
Batch 175/537: Loss=1.0196 (C:1.0196, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.813, Ratio=3.53x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.809, Ratio=3.45x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.843, Ratio=3.58x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.812, Ratio=3.43x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.802, Ratio=3.41x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.803, Ratio=3.44x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.819, Ratio=3.63x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.827, Ratio=3.51x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.803, Ratio=3.44x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.799, Ratio=3.30x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.812, Ratio=3.51x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.814, Ratio=3.47x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.825, Ratio=3.54x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.801, Ratio=3.43x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.818, Ratio=3.44x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.826, Ratio=3.48x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.787, Ratio=3.23x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.814, Ratio=3.43x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.829, Ratio=3.59x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.815, Ratio=3.47x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.808, Ratio=3.59x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.808, Ratio=3.44x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.825, Ratio=3.51x, Gap=-4.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.795, Ratio=3.40x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.803, Ratio=3.51x, Gap=-3.837
Batch 200/537: Loss=1.0075 (C:1.0075, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.800, Ratio=3.31x, Gap=-3.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.813, Ratio=3.49x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.806, Ratio=3.39x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.822, Ratio=3.56x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.819, Ratio=3.48x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.814, Ratio=3.35x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.821, Ratio=3.51x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.818, Ratio=3.45x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.816, Ratio=3.41x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.791, Ratio=3.36x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.800, Ratio=3.32x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.798, Ratio=3.31x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.814, Ratio=3.53x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.818, Ratio=3.57x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.793, Ratio=3.30x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.813, Ratio=3.46x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.826, Ratio=3.61x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.804, Ratio=3.42x, Gap=-4.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.784, Ratio=3.33x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.786, Ratio=3.29x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.814, Ratio=3.49x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.811, Ratio=3.49x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.798, Ratio=3.36x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.786, Ratio=3.37x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.815, Ratio=3.60x, Gap=-4.013
Batch 225/537: Loss=0.9915 (C:0.9915, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.798, Ratio=3.30x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.788, Ratio=3.38x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.820, Ratio=3.54x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.801, Ratio=3.36x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.807, Ratio=3.39x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.806, Ratio=3.34x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.805, Ratio=3.30x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.804, Ratio=3.50x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.800, Ratio=3.32x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.808, Ratio=3.40x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.822, Ratio=3.50x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.805, Ratio=3.42x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.794, Ratio=3.35x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.822, Ratio=3.40x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.814, Ratio=3.46x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.791, Ratio=3.38x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.793, Ratio=3.27x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.794, Ratio=3.37x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.804, Ratio=3.31x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.817, Ratio=3.52x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.773, Ratio=3.23x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.790, Ratio=3.35x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.813, Ratio=3.50x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.813, Ratio=3.41x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.792, Ratio=3.47x, Gap=-3.977
Batch 250/537: Loss=1.0156 (C:1.0156, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.791, Ratio=3.21x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.813, Ratio=3.38x, Gap=-4.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.800, Ratio=3.29x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.823, Ratio=3.53x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.787, Ratio=3.25x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.800, Ratio=3.28x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.807, Ratio=3.33x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.814, Ratio=3.49x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.813, Ratio=3.44x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.791, Ratio=3.33x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.816, Ratio=3.44x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.793, Ratio=3.35x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.811, Ratio=3.44x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.833, Ratio=3.64x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.779, Ratio=3.26x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.827, Ratio=3.55x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.817, Ratio=3.54x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.817, Ratio=3.50x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.805, Ratio=3.40x, Gap=-3.855
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.794, Ratio=3.37x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.575, Neg=1.784, Ratio=3.10x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.801, Ratio=3.44x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.789, Ratio=3.33x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.813, Ratio=3.41x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.817, Ratio=3.55x, Gap=-3.911
Batch 275/537: Loss=1.0005 (C:1.0005, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.799, Ratio=3.31x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.819, Ratio=3.41x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.791, Ratio=3.37x, Gap=-3.816
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.806, Ratio=3.36x, Gap=-3.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.801, Ratio=3.35x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.835, Ratio=3.53x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.826, Ratio=3.52x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.792, Ratio=3.26x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.810, Ratio=3.49x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.785, Ratio=3.36x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.813, Ratio=3.45x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.818, Ratio=3.36x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.816, Ratio=3.51x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.815, Ratio=3.63x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.816, Ratio=3.37x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.810, Ratio=3.31x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.827, Ratio=3.63x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.810, Ratio=3.47x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.808, Ratio=3.42x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.815, Ratio=3.41x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.798, Ratio=3.41x, Gap=-3.797
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.790, Ratio=3.23x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.803, Ratio=3.41x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.793, Ratio=3.28x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.807, Ratio=3.38x, Gap=-4.104
Batch 300/537: Loss=1.0312 (C:1.0312, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.814, Ratio=3.34x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.810, Ratio=3.33x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.836, Ratio=3.56x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.808, Ratio=3.36x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.819, Ratio=3.52x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.822, Ratio=3.55x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.820, Ratio=3.44x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.798, Ratio=3.42x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.813, Ratio=3.45x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.793, Ratio=3.36x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.795, Ratio=3.54x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.815, Ratio=3.38x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.803, Ratio=3.45x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.826, Ratio=3.65x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.798, Ratio=3.48x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.830, Ratio=3.51x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.559, Neg=1.794, Ratio=3.21x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.800, Ratio=3.27x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.796, Ratio=3.43x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.786, Ratio=3.34x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.795, Ratio=3.34x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.788, Ratio=3.41x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.795, Ratio=3.35x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.803, Ratio=3.34x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.819, Ratio=3.40x, Gap=-4.229
Batch 325/537: Loss=1.0302 (C:1.0302, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.825, Ratio=3.43x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.798, Ratio=3.48x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.806, Ratio=3.43x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.796, Ratio=3.36x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.797, Ratio=3.45x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.814, Ratio=3.51x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.780, Ratio=3.34x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.567, Neg=1.784, Ratio=3.15x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.830, Ratio=3.42x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.796, Ratio=3.31x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.827, Ratio=3.46x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.810, Ratio=3.41x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.795, Ratio=3.35x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.808, Ratio=3.38x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.773, Ratio=3.24x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.800, Ratio=3.41x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.820, Ratio=3.51x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.829, Ratio=3.62x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.823, Ratio=3.44x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.824, Ratio=3.59x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.794, Ratio=3.39x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.788, Ratio=3.32x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.789, Ratio=3.30x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.808, Ratio=3.46x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.817, Ratio=3.48x, Gap=-4.061
Batch 350/537: Loss=1.0125 (C:1.0125, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.813, Ratio=3.47x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.802, Ratio=3.44x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.810, Ratio=3.45x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.819, Ratio=3.51x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.835, Ratio=3.63x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.784, Ratio=3.30x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.805, Ratio=3.45x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.804, Ratio=3.37x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.813, Ratio=3.54x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.791, Ratio=3.34x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.820, Ratio=3.52x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.803, Ratio=3.37x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.798, Ratio=3.36x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.811, Ratio=3.39x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.831, Ratio=3.58x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.794, Ratio=3.33x, Gap=-3.905
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.827, Ratio=3.55x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.810, Ratio=3.38x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.810, Ratio=3.44x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.820, Ratio=3.43x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.828, Ratio=3.62x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.802, Ratio=3.43x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.810, Ratio=3.40x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.824, Ratio=3.50x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.796, Ratio=3.50x, Gap=-3.861
Batch 375/537: Loss=1.0100 (C:1.0100, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.568, Neg=1.765, Ratio=3.11x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.803, Ratio=3.29x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.818, Ratio=3.46x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.793, Ratio=3.44x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.810, Ratio=3.51x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.802, Ratio=3.48x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.787, Ratio=3.34x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.808, Ratio=3.42x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.832, Ratio=3.62x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.784, Ratio=3.26x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.785, Ratio=3.27x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.800, Ratio=3.39x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.795, Ratio=3.40x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.820, Ratio=3.47x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.809, Ratio=3.44x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.836, Ratio=3.55x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.808, Ratio=3.43x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.820, Ratio=3.44x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.797, Ratio=3.32x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.801, Ratio=3.32x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.814, Ratio=3.47x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.807, Ratio=3.46x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.806, Ratio=3.39x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.775, Ratio=3.27x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.765, Ratio=3.32x, Gap=-3.606
Batch 400/537: Loss=1.0457 (C:1.0457, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.797, Ratio=3.40x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.814, Ratio=3.40x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.781, Ratio=3.33x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.816, Ratio=3.43x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.796, Ratio=3.32x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.810, Ratio=3.36x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.804, Ratio=3.43x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.815, Ratio=3.46x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.799, Ratio=3.36x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.780, Ratio=3.24x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.776, Ratio=3.22x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.800, Ratio=3.43x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.790, Ratio=3.34x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.804, Ratio=3.42x, Gap=-3.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.791, Ratio=3.34x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.794, Ratio=3.29x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.771, Ratio=3.31x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.796, Ratio=3.40x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.791, Ratio=3.26x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.800, Ratio=3.34x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.795, Ratio=3.30x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.823, Ratio=3.57x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.800, Ratio=3.32x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.813, Ratio=3.47x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.809, Ratio=3.37x, Gap=-4.121
Batch 425/537: Loss=1.0325 (C:1.0325, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.797, Ratio=3.36x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.785, Ratio=3.29x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.788, Ratio=3.27x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.818, Ratio=3.51x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.803, Ratio=3.26x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.803, Ratio=3.35x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.813, Ratio=3.55x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.807, Ratio=3.34x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.785, Ratio=3.23x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.794, Ratio=3.32x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.810, Ratio=3.45x, Gap=-3.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.792, Ratio=3.25x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.833, Ratio=3.62x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.799, Ratio=3.28x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.802, Ratio=3.39x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.785, Ratio=3.21x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.801, Ratio=3.40x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.795, Ratio=3.28x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.807, Ratio=3.42x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.795, Ratio=3.31x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.801, Ratio=3.54x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.791, Ratio=3.45x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.804, Ratio=3.36x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.808, Ratio=3.37x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.811, Ratio=3.39x, Gap=-4.099
Batch 450/537: Loss=1.0289 (C:1.0289, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.776, Ratio=3.24x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.796, Ratio=3.26x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.822, Ratio=3.43x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.837, Ratio=3.67x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.844, Ratio=3.65x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.816, Ratio=3.45x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.805, Ratio=3.39x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.788, Ratio=3.30x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.785, Ratio=3.33x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.818, Ratio=3.53x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.561, Neg=1.775, Ratio=3.17x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.809, Ratio=3.33x, Gap=-3.819
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.821, Ratio=3.47x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.554, Neg=1.788, Ratio=3.23x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.816, Ratio=3.44x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.783, Ratio=3.27x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.793, Ratio=3.36x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.826, Ratio=3.53x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.830, Ratio=3.52x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.792, Ratio=3.32x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.822, Ratio=3.45x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.801, Ratio=3.28x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.813, Ratio=3.43x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.763, Ratio=3.19x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.797, Ratio=3.43x, Gap=-3.836
Batch 475/537: Loss=1.0216 (C:1.0216, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.790, Ratio=3.37x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.785, Ratio=3.29x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.786, Ratio=3.38x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.805, Ratio=3.38x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.548, Neg=1.810, Ratio=3.31x, Gap=-3.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.812, Ratio=3.54x, Gap=-3.926
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.795, Ratio=3.44x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.818, Ratio=3.44x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.820, Ratio=3.55x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.809, Ratio=3.41x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.814, Ratio=3.37x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.797, Ratio=3.34x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.820, Ratio=3.56x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.798, Ratio=3.30x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.807, Ratio=3.49x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.808, Ratio=3.32x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.812, Ratio=3.42x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.816, Ratio=3.60x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.782, Ratio=3.30x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.811, Ratio=3.36x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.811, Ratio=3.49x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.801, Ratio=3.56x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.806, Ratio=3.40x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.799, Ratio=3.34x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.791, Ratio=3.29x, Gap=-4.263
Batch 500/537: Loss=1.0501 (C:1.0501, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.807, Ratio=3.47x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.813, Ratio=3.47x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.804, Ratio=3.38x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.818, Ratio=3.50x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.807, Ratio=3.42x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.795, Ratio=3.37x, Gap=-5.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.804, Ratio=3.40x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.800, Ratio=3.30x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.784, Ratio=3.30x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.807, Ratio=3.36x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.811, Ratio=3.42x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.787, Ratio=3.29x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.557, Neg=1.795, Ratio=3.22x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.818, Ratio=3.56x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.821, Ratio=3.49x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.790, Ratio=3.31x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.782, Ratio=3.21x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.555, Neg=1.794, Ratio=3.24x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.782, Ratio=3.38x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.793, Ratio=3.47x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.803, Ratio=3.37x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.821, Ratio=3.48x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.790, Ratio=3.26x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.803, Ratio=3.47x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.801, Ratio=3.40x, Gap=-4.311
Batch 525/537: Loss=1.0287 (C:1.0287, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.799, Ratio=3.46x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.783, Ratio=3.38x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.795, Ratio=3.26x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.812, Ratio=3.56x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.804, Ratio=3.43x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.802, Ratio=3.47x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.795, Ratio=3.33x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.796, Ratio=3.34x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.793, Ratio=3.42x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.848, Ratio=3.51x, Gap=-4.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.805, Ratio=3.44x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.805, Ratio=3.57x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.822, Ratio=3.67x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.817, Ratio=3.60x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.818, Ratio=3.80x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.819, Ratio=3.61x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.818, Ratio=3.55x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.824, Ratio=3.60x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.823, Ratio=3.71x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.804, Ratio=3.57x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.799, Ratio=3.47x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.831, Ratio=3.77x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.829, Ratio=3.65x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.812, Ratio=3.68x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.830, Ratio=3.83x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.828, Ratio=3.79x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.800, Ratio=3.60x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.807, Ratio=3.57x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.840, Ratio=3.84x, Gap=-3.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.825, Ratio=3.63x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.831, Ratio=3.76x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.817, Ratio=3.73x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.804, Ratio=3.48x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.815, Ratio=3.60x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.65x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.816, Ratio=3.66x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.830, Ratio=3.73x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.823, Ratio=3.65x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.848, Ratio=3.88x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.808, Ratio=3.59x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.836, Ratio=3.88x, Gap=-3.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.822, Ratio=3.63x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.833, Ratio=3.76x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.823, Ratio=3.62x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.802, Ratio=3.54x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.817, Ratio=3.62x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.826, Ratio=3.78x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.827, Ratio=3.76x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.819, Ratio=3.69x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.814, Ratio=3.50x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.818, Ratio=3.51x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.852, Ratio=3.78x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.817, Ratio=3.64x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.818, Ratio=3.51x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.831, Ratio=3.65x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.810, Ratio=3.76x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.816, Ratio=3.62x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.841, Ratio=3.68x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.821, Ratio=3.66x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.853, Ratio=3.92x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.813, Ratio=3.61x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.836, Ratio=3.81x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.823, Ratio=3.66x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.810, Ratio=3.65x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.831, Ratio=3.72x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.818, Ratio=3.50x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.809, Ratio=3.55x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.821, Ratio=3.68x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.820, Ratio=3.71x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.791, Ratio=3.40x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.832, Ratio=3.89x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.807, Ratio=3.44x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.812, Ratio=3.75x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.833, Ratio=3.65x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.822, Ratio=3.66x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.845, Ratio=3.84x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.839, Ratio=3.72x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.824, Ratio=3.67x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.840, Ratio=3.87x, Gap=-3.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.829, Ratio=3.74x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.824, Ratio=3.57x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.834, Ratio=3.83x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.816, Ratio=3.57x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.847, Ratio=3.82x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.823, Ratio=3.66x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.831, Ratio=3.54x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.806, Ratio=3.58x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.839, Ratio=3.92x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.803, Ratio=3.42x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.835, Ratio=3.80x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.807, Ratio=3.60x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.821, Ratio=3.66x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.811, Ratio=3.65x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.818, Ratio=3.74x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.832, Ratio=3.77x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.826, Ratio=3.81x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.824, Ratio=3.81x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.838, Ratio=3.78x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.829, Ratio=3.82x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.818, Ratio=3.55x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.814, Ratio=3.58x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.834, Ratio=3.79x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.827, Ratio=3.71x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.846, Ratio=3.85x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.840, Ratio=3.80x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.819, Ratio=3.57x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.829, Ratio=3.70x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.817, Ratio=3.67x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.821, Ratio=3.60x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.827, Ratio=3.78x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.799, Ratio=3.60x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.842, Ratio=3.81x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.819, Ratio=3.42x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.836, Ratio=3.83x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.841, Ratio=3.75x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.805, Ratio=3.53x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.843, Ratio=3.89x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.803, Ratio=3.66x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.854, Ratio=3.91x, Gap=-3.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.808, Ratio=3.47x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.817, Ratio=3.52x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.819, Ratio=3.76x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.829, Ratio=3.83x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.813, Ratio=3.58x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.811, Ratio=3.51x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.815, Ratio=3.70x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.843, Ratio=3.78x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.800, Ratio=3.53x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.822, Ratio=3.57x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.846, Ratio=3.69x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.820, Ratio=3.75x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.832, Ratio=3.74x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.827, Ratio=3.81x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.841, Ratio=3.78x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.831, Ratio=3.65x, Gap=-3.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.808, Ratio=3.56x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.851, Ratio=3.81x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.841, Ratio=3.75x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.836, Ratio=3.78x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.801, Ratio=3.52x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.814, Ratio=3.64x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.817, Ratio=3.70x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.836, Ratio=3.79x, Gap=-3.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.829, Ratio=3.69x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.804, Ratio=3.36x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.820, Ratio=3.68x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.833, Ratio=3.76x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.824, Ratio=3.61x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.828, Ratio=3.74x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.823, Ratio=3.74x, Gap=-3.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.828, Ratio=3.73x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.802, Ratio=3.40x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.821, Ratio=3.70x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.822, Ratio=3.68x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.840, Ratio=3.77x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.819, Ratio=3.58x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.803, Ratio=3.56x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.826, Ratio=3.64x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.829, Ratio=3.66x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.836, Ratio=3.79x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.814, Ratio=3.58x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.797, Ratio=3.57x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.828, Ratio=3.64x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.812, Ratio=3.42x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.808, Ratio=3.69x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.808, Ratio=3.57x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.816, Ratio=3.65x, Gap=-3.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.821, Ratio=3.69x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.819, Ratio=3.64x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.818, Ratio=3.59x, Gap=-3.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.820, Ratio=3.74x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.818, Ratio=3.68x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.814, Ratio=3.59x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.842, Ratio=3.77x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.837, Ratio=3.70x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.831, Ratio=3.79x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.828, Ratio=3.76x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.827, Ratio=3.65x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.826, Ratio=3.78x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.823, Ratio=3.60x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.825, Ratio=3.89x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.829, Ratio=3.72x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.827, Ratio=3.72x, Gap=-3.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.802, Ratio=3.44x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.817, Ratio=3.55x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.838, Ratio=3.86x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.827, Ratio=3.79x, Gap=-3.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.827, Ratio=3.75x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.827, Ratio=3.52x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.811, Ratio=3.62x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.834, Ratio=3.92x, Gap=-3.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.845, Ratio=3.83x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.818, Ratio=3.60x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.823, Ratio=3.62x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.821, Ratio=3.68x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.821, Ratio=3.65x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.805, Ratio=3.51x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.821, Ratio=3.60x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.825, Ratio=3.64x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.816, Ratio=3.55x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.834, Ratio=3.80x, Gap=-3.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.828, Ratio=3.62x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.837, Ratio=3.80x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.832, Ratio=3.69x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.811, Ratio=3.65x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.804, Ratio=3.60x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.827, Ratio=3.68x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.836, Ratio=3.64x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.827, Ratio=3.75x, Gap=-3.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.821, Ratio=3.76x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.822, Ratio=3.67x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.817, Ratio=3.68x, Gap=-3.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.820, Ratio=3.56x, Gap=-3.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.846, Ratio=3.87x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.822, Ratio=3.69x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.815, Ratio=3.66x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.835, Ratio=3.60x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.834, Ratio=3.68x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.815, Ratio=3.60x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.812, Ratio=3.59x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.829, Ratio=3.65x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.823, Ratio=3.68x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.831, Ratio=3.81x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.827, Ratio=3.71x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.833, Ratio=3.79x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.814, Ratio=3.55x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.795, Ratio=3.62x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.861, Ratio=3.92x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.813, Ratio=3.72x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.829, Ratio=3.80x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.820, Ratio=3.51x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.822, Ratio=3.68x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.810, Ratio=3.49x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.839, Ratio=3.83x, Gap=-3.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.812, Ratio=3.62x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.826, Ratio=3.68x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.828, Ratio=3.75x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.810, Ratio=3.55x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.815, Ratio=3.55x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.857, Ratio=4.08x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.820, Ratio=3.71x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.822, Ratio=3.66x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.809, Ratio=3.69x, Gap=-3.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.827, Ratio=3.70x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.822, Ratio=3.47x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.819, Ratio=3.58x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.805, Ratio=3.53x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.823, Ratio=3.75x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.828, Ratio=3.66x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.831, Ratio=3.61x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.827, Ratio=3.65x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.829, Ratio=3.70x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.817, Ratio=3.55x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.829, Ratio=3.60x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.834, Ratio=3.96x, Gap=-3.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.809, Ratio=3.54x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.817, Ratio=3.71x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.824, Ratio=3.77x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.814, Ratio=3.68x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.797, Ratio=3.54x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.810, Ratio=3.39x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.836, Ratio=3.65x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.823, Ratio=3.59x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.816, Ratio=3.80x, Gap=-3.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.839, Ratio=3.89x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.816, Ratio=3.58x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.843, Ratio=3.81x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.827, Ratio=3.65x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.840, Ratio=3.82x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.814, Ratio=3.72x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.844, Ratio=3.76x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.824, Ratio=3.79x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.839, Ratio=3.77x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.833, Ratio=3.71x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.819, Ratio=3.62x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.815, Ratio=3.78x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.814, Ratio=3.67x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.810, Ratio=3.63x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.795, Ratio=3.65x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.825, Ratio=3.69x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.813, Ratio=3.59x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.824, Ratio=3.67x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.816, Ratio=3.67x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.812, Ratio=3.59x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.841, Ratio=3.60x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.843, Ratio=3.95x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.834, Ratio=3.62x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.817, Ratio=3.46x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.832, Ratio=3.83x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.809, Ratio=3.50x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.818, Ratio=3.52x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.819, Ratio=3.51x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.839, Ratio=3.77x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.821, Ratio=3.70x, Gap=-3.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.834, Ratio=3.66x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.819, Ratio=3.65x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.826, Ratio=3.90x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.836, Ratio=3.73x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.832, Ratio=3.69x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.808, Ratio=3.39x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.821, Ratio=3.66x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.818, Ratio=3.71x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.823, Ratio=3.73x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.813, Ratio=3.61x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.837, Ratio=3.72x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.827, Ratio=3.64x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.813, Ratio=3.59x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.828, Ratio=3.72x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.815, Ratio=3.67x, Gap=-3.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.824, Ratio=3.64x, Gap=-3.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.818, Ratio=3.71x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.832, Ratio=3.77x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.834, Ratio=3.68x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.813, Ratio=3.67x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.823, Ratio=3.72x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.835, Ratio=3.86x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.818, Ratio=3.69x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.828, Ratio=3.66x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.823, Ratio=3.69x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.835, Ratio=3.70x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.835, Ratio=3.67x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.819, Ratio=3.51x, Gap=-3.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.820, Ratio=3.71x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.818, Ratio=3.65x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.817, Ratio=3.68x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.820, Ratio=3.69x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.838, Ratio=3.77x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.802, Ratio=3.52x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.815, Ratio=3.66x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.797, Ratio=3.49x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.823, Ratio=3.90x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.824, Ratio=3.66x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.807, Ratio=3.55x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.838, Ratio=3.72x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.811, Ratio=3.64x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.825, Ratio=3.72x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.823, Ratio=3.61x, Gap=-3.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.847, Ratio=3.78x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.833, Ratio=3.65x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.837, Ratio=3.74x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.825, Ratio=3.72x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.826, Ratio=3.60x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.845, Ratio=3.78x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.830, Ratio=3.74x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.817, Ratio=3.53x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.826, Ratio=3.78x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.828, Ratio=3.67x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.830, Ratio=3.77x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.808, Ratio=3.49x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.827, Ratio=3.69x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.860, Ratio=4.00x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.814, Ratio=3.55x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.833, Ratio=3.72x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.834, Ratio=3.68x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.825, Ratio=3.63x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.819, Ratio=3.66x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.819, Ratio=3.64x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.821, Ratio=3.76x, Gap=-3.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.806, Ratio=3.57x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.820, Ratio=3.63x, Gap=-3.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.802, Ratio=3.53x, Gap=-3.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.805, Ratio=3.55x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.818, Ratio=3.75x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.821, Ratio=3.71x, Gap=-3.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.822, Ratio=3.69x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.797, Ratio=3.55x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.842, Ratio=3.84x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.828, Ratio=3.75x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.830, Ratio=3.76x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.810, Ratio=3.61x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.831, Ratio=3.81x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.823, Ratio=3.73x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.811, Ratio=3.47x, Gap=-3.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.823, Ratio=3.64x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.803, Ratio=3.56x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.814, Ratio=3.64x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.818, Ratio=3.56x, Gap=-3.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.806, Ratio=3.59x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.819, Ratio=3.54x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.817, Ratio=3.64x, Gap=-3.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.822, Ratio=3.72x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.846, Ratio=3.81x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.805, Ratio=3.53x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.797, Ratio=3.51x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.838, Ratio=3.78x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.804, Ratio=3.68x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.809, Ratio=3.55x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.831, Ratio=3.73x, Gap=-3.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.845, Ratio=3.95x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.843, Ratio=3.89x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.817, Ratio=3.55x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.836, Ratio=3.75x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.826, Ratio=3.60x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.840, Ratio=3.84x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.837, Ratio=3.74x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.821, Ratio=3.62x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.855, Ratio=3.76x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.820, Ratio=3.64x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.853, Ratio=3.93x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.829, Ratio=3.79x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.835, Ratio=3.76x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.827, Ratio=3.66x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.825, Ratio=3.69x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.804, Ratio=3.66x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.820, Ratio=3.62x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.815, Ratio=3.62x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.817, Ratio=3.60x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.810, Ratio=3.69x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.830, Ratio=3.73x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.829, Ratio=3.64x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.812, Ratio=3.61x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.840, Ratio=3.77x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.828, Ratio=3.71x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.840, Ratio=3.86x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.826, Ratio=3.66x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.822, Ratio=3.65x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.831, Ratio=3.77x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.812, Ratio=3.55x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.825, Ratio=3.83x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.816, Ratio=3.52x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.811, Ratio=3.61x, Gap=-3.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.816, Ratio=3.59x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.839, Ratio=3.75x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.842, Ratio=3.86x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.831, Ratio=3.66x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.806, Ratio=3.54x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.823, Ratio=3.67x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.797, Ratio=3.50x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.829, Ratio=3.73x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.831, Ratio=3.73x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.806, Ratio=3.51x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.847, Ratio=3.78x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.832, Ratio=3.66x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.823, Ratio=3.63x, Gap=-3.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.838, Ratio=3.72x, Gap=-3.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.811, Ratio=3.58x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.815, Ratio=3.63x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.827, Ratio=3.70x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.842, Ratio=3.87x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.805, Ratio=3.64x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.834, Ratio=3.74x, Gap=-3.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.828, Ratio=3.68x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.821, Ratio=3.62x, Gap=-3.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.834, Ratio=3.65x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.830, Ratio=3.66x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.820, Ratio=3.76x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.803, Ratio=3.52x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.844, Ratio=3.79x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.827, Ratio=3.74x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.830, Ratio=3.64x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.818, Ratio=3.59x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.826, Ratio=3.67x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.822, Ratio=3.70x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.805, Ratio=3.50x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.805, Ratio=3.51x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.815, Ratio=3.53x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.800, Ratio=3.58x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.820, Ratio=3.79x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.821, Ratio=3.72x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.827, Ratio=3.69x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.810, Ratio=3.49x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.832, Ratio=3.75x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.845, Ratio=3.90x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.832, Ratio=3.76x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.799, Ratio=3.59x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.819, Ratio=3.63x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.841, Ratio=3.80x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.818, Ratio=3.60x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.831, Ratio=3.66x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.822, Ratio=3.58x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.829, Ratio=3.66x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.840, Ratio=3.79x, Gap=-3.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.838, Ratio=3.80x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.822, Ratio=3.62x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.808, Ratio=3.56x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.798, Ratio=3.44x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.795, Ratio=3.53x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.842, Ratio=3.79x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.832, Ratio=3.81x, Gap=-3.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.828, Ratio=3.68x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.806, Ratio=3.53x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.815, Ratio=3.62x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.864, Ratio=4.02x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.822, Ratio=3.69x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.831, Ratio=3.83x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.816, Ratio=3.55x, Gap=-3.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.848, Ratio=3.95x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.825, Ratio=3.74x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.834, Ratio=3.66x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.821, Ratio=3.55x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.811, Ratio=3.60x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.818, Ratio=3.62x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.811, Ratio=3.52x, Gap=-3.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.849, Ratio=3.85x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.816, Ratio=3.51x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.817, Ratio=3.60x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.813, Ratio=3.57x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.825, Ratio=3.67x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.823, Ratio=3.59x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.827, Ratio=3.66x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.808, Ratio=3.48x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.827, Ratio=3.72x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.826, Ratio=3.59x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.815, Ratio=3.58x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.823, Ratio=3.68x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.840, Ratio=3.94x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.792, Ratio=3.46x, Gap=-3.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.824, Ratio=3.71x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.820, Ratio=3.60x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.830, Ratio=3.75x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.833, Ratio=3.73x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.810, Ratio=3.54x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.808, Ratio=3.59x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.815, Ratio=3.65x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.817, Ratio=3.65x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.841, Ratio=3.82x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.837, Ratio=3.70x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.824, Ratio=3.74x, Gap=-3.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.829, Ratio=3.60x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.816, Ratio=3.51x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.839, Ratio=3.81x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.825, Ratio=3.69x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.810, Ratio=3.63x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.822, Ratio=3.67x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.820, Ratio=3.65x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.826, Ratio=3.68x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.811, Ratio=3.61x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.804, Ratio=3.58x, Gap=-3.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.798, Ratio=3.53x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.807, Ratio=3.52x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.838, Ratio=3.67x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.837, Ratio=3.85x, Gap=-3.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.826, Ratio=3.65x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.816, Ratio=3.58x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.817, Ratio=3.56x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.825, Ratio=3.61x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.815, Ratio=3.58x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.808, Ratio=3.58x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.838, Ratio=3.82x, Gap=-3.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.833, Ratio=3.79x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.839, Ratio=3.72x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.847, Ratio=3.86x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.820, Ratio=3.68x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.823, Ratio=3.63x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.807, Ratio=3.56x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.811, Ratio=3.65x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.837, Ratio=3.65x, Gap=-3.352

============================================================
Epoch 12/20 completed in 31.6s
Train: Loss=1.0262 (C:1.0262, R:0.0105) Ratio=3.33x
Val:   Loss=0.9805 (C:0.9805, R:0.0105) Ratio=4.05x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.9805)
============================================================

🌍 Updating global dataset at epoch 13
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.468 ± 0.555
    Neg distances: 1.893 ± 0.922
    Separation ratio: 4.05x
    Gap: -3.473
    ✅ Excellent global separation!

Epoch 13 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.890, Ratio=3.82x, Gap=-3.983
Batch   0/537: Loss=0.9487 (C:0.9487, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.902, Ratio=3.79x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.883, Ratio=3.75x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.896, Ratio=3.68x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.920, Ratio=3.95x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.918, Ratio=3.96x, Gap=-3.857
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.895, Ratio=3.68x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.896, Ratio=3.70x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.905, Ratio=3.66x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.932, Ratio=4.10x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.967, Ratio=3.97x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.916, Ratio=3.71x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.925, Ratio=3.72x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.918, Ratio=3.84x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.919, Ratio=3.77x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.910, Ratio=3.73x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.907, Ratio=3.78x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.907, Ratio=3.74x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.938, Ratio=4.15x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.895, Ratio=3.77x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.924, Ratio=3.82x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.901, Ratio=3.66x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.895, Ratio=3.77x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.899, Ratio=3.73x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.927, Ratio=3.76x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.913, Ratio=3.85x, Gap=-4.421
Batch  25/537: Loss=0.9389 (C:0.9389, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.888, Ratio=3.54x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.909, Ratio=3.81x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.894, Ratio=3.68x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.914, Ratio=3.81x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.905, Ratio=3.77x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.907, Ratio=3.78x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.916, Ratio=3.73x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.901, Ratio=3.74x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.928, Ratio=3.80x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.913, Ratio=3.76x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.903, Ratio=3.64x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.889, Ratio=3.69x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.888, Ratio=3.51x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.914, Ratio=3.86x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.914, Ratio=3.84x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.904, Ratio=3.67x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.918, Ratio=3.82x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.889, Ratio=3.69x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.943, Ratio=4.01x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.920, Ratio=3.81x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.922, Ratio=3.85x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.883, Ratio=3.59x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.916, Ratio=3.88x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.906, Ratio=3.65x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.916, Ratio=3.64x, Gap=-3.966
Batch  50/537: Loss=0.9726 (C:0.9726, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.907, Ratio=3.79x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.899, Ratio=3.60x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.882, Ratio=3.59x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.896, Ratio=3.60x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.916, Ratio=3.82x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.897, Ratio=3.61x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.923, Ratio=3.78x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.895, Ratio=3.63x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.922, Ratio=3.92x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.892, Ratio=3.51x, Gap=-4.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.920, Ratio=3.84x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.904, Ratio=3.69x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.888, Ratio=3.51x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.901, Ratio=3.73x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.926, Ratio=3.88x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.915, Ratio=3.79x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.906, Ratio=3.66x, Gap=-4.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.904, Ratio=3.71x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.903, Ratio=3.66x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.901, Ratio=3.68x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.921, Ratio=3.94x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.884, Ratio=3.60x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.905, Ratio=3.79x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.942, Ratio=4.01x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.905, Ratio=3.49x, Gap=-3.907
Batch  75/537: Loss=1.0012 (C:1.0012, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.910, Ratio=3.70x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.921, Ratio=3.85x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.889, Ratio=3.67x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.918, Ratio=3.68x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.916, Ratio=3.86x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.905, Ratio=3.66x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.927, Ratio=3.94x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.895, Ratio=3.67x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.928, Ratio=3.90x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.909, Ratio=3.80x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.933, Ratio=3.89x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.894, Ratio=3.71x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.902, Ratio=3.68x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.905, Ratio=3.71x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.903, Ratio=3.62x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.900, Ratio=3.77x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.884, Ratio=3.74x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.907, Ratio=3.87x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.897, Ratio=3.69x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.917, Ratio=3.75x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.919, Ratio=3.79x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.927, Ratio=3.93x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.904, Ratio=3.74x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.919, Ratio=3.64x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.902, Ratio=3.61x, Gap=-4.121
Batch 100/537: Loss=0.9825 (C:0.9825, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.874, Ratio=3.55x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.911, Ratio=3.78x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.886, Ratio=3.60x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.930, Ratio=3.87x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.902, Ratio=3.73x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.916, Ratio=3.82x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.894, Ratio=3.60x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.908, Ratio=3.84x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.896, Ratio=3.69x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.924, Ratio=3.75x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.894, Ratio=3.67x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.891, Ratio=3.60x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.906, Ratio=3.71x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.899, Ratio=3.69x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.903, Ratio=3.70x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.907, Ratio=3.78x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.914, Ratio=3.70x, Gap=-3.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.901, Ratio=3.67x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.890, Ratio=3.71x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.909, Ratio=3.70x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.899, Ratio=3.61x, Gap=-3.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.912, Ratio=3.76x, Gap=-4.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.901, Ratio=3.56x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.899, Ratio=3.72x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.896, Ratio=3.65x, Gap=-3.798
Batch 125/537: Loss=0.9764 (C:0.9764, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.911, Ratio=3.76x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.905, Ratio=3.79x, Gap=-3.918
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.894, Ratio=3.76x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.926, Ratio=3.80x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.918, Ratio=3.73x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.900, Ratio=3.70x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.905, Ratio=3.78x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.922, Ratio=3.91x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.922, Ratio=3.74x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.914, Ratio=3.91x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.908, Ratio=3.77x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.901, Ratio=3.65x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.923, Ratio=3.71x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.912, Ratio=3.87x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.901, Ratio=3.65x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.918, Ratio=3.62x, Gap=-4.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.908, Ratio=3.67x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.913, Ratio=3.80x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.894, Ratio=3.67x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.897, Ratio=3.62x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.890, Ratio=3.58x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.901, Ratio=3.71x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.904, Ratio=3.70x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.907, Ratio=3.94x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.908, Ratio=3.66x, Gap=-4.584
Batch 150/537: Loss=0.9734 (C:0.9734, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.891, Ratio=3.59x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.919, Ratio=3.94x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.914, Ratio=3.80x, Gap=-3.934
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.934, Ratio=3.83x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.936, Ratio=3.79x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.913, Ratio=3.70x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.905, Ratio=3.63x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.911, Ratio=3.59x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.897, Ratio=3.73x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.910, Ratio=3.83x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.923, Ratio=3.77x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.921, Ratio=3.85x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.893, Ratio=3.83x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.893, Ratio=3.70x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.898, Ratio=3.57x, Gap=-4.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.905, Ratio=3.74x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.917, Ratio=3.76x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.881, Ratio=3.61x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.922, Ratio=3.76x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.915, Ratio=3.79x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.909, Ratio=3.80x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.898, Ratio=3.65x, Gap=-4.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.891, Ratio=3.58x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.891, Ratio=3.77x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.927, Ratio=3.79x, Gap=-4.393
Batch 175/537: Loss=0.9496 (C:0.9496, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.905, Ratio=3.66x, Gap=-4.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.889, Ratio=3.69x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.911, Ratio=3.69x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.884, Ratio=3.47x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.907, Ratio=3.61x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.915, Ratio=3.89x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.882, Ratio=3.53x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.942, Ratio=3.86x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.895, Ratio=3.72x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.925, Ratio=3.95x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.886, Ratio=3.58x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.930, Ratio=3.85x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.891, Ratio=3.69x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.897, Ratio=3.67x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.898, Ratio=3.82x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.882, Ratio=3.62x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.926, Ratio=3.89x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.903, Ratio=3.86x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.893, Ratio=3.74x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.908, Ratio=3.73x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.885, Ratio=3.62x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.900, Ratio=3.74x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.905, Ratio=3.67x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.926, Ratio=3.84x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.927, Ratio=3.82x, Gap=-3.795
Batch 200/537: Loss=0.9425 (C:0.9425, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.902, Ratio=3.51x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.904, Ratio=3.67x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.894, Ratio=3.72x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.902, Ratio=3.74x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.912, Ratio=3.74x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.894, Ratio=3.64x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.913, Ratio=3.68x, Gap=-3.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.918, Ratio=3.63x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.920, Ratio=3.80x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.942, Ratio=4.07x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.903, Ratio=3.61x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.902, Ratio=3.66x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.921, Ratio=3.66x, Gap=-4.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.928, Ratio=3.82x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.913, Ratio=3.64x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.915, Ratio=3.74x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.913, Ratio=3.92x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.900, Ratio=3.69x, Gap=-4.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.915, Ratio=3.83x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.880, Ratio=3.54x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.873, Ratio=3.60x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.896, Ratio=3.57x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.889, Ratio=3.65x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.553, Neg=1.892, Ratio=3.42x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.901, Ratio=3.62x, Gap=-3.880
Batch 225/537: Loss=0.9797 (C:0.9797, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.899, Ratio=3.64x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.923, Ratio=3.85x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.896, Ratio=3.54x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.900, Ratio=3.59x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.903, Ratio=3.63x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.911, Ratio=3.71x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.902, Ratio=3.74x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.916, Ratio=3.82x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.889, Ratio=3.59x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.890, Ratio=3.68x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.914, Ratio=3.69x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.883, Ratio=3.64x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.921, Ratio=3.73x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.909, Ratio=3.77x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.881, Ratio=3.67x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.881, Ratio=3.54x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.902, Ratio=3.67x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.917, Ratio=3.76x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.935, Ratio=3.84x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.885, Ratio=3.47x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.923, Ratio=3.74x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.935, Ratio=3.92x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.905, Ratio=3.77x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.896, Ratio=3.72x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.932, Ratio=3.93x, Gap=-4.305
Batch 250/537: Loss=0.9255 (C:0.9255, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.919, Ratio=3.83x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.879, Ratio=3.48x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.913, Ratio=3.85x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.914, Ratio=3.85x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.917, Ratio=3.84x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.917, Ratio=3.67x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.915, Ratio=3.73x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.910, Ratio=3.85x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.922, Ratio=3.71x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.905, Ratio=3.57x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.921, Ratio=3.84x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.893, Ratio=3.57x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.903, Ratio=3.73x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.901, Ratio=3.82x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.909, Ratio=3.73x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.898, Ratio=3.73x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.900, Ratio=3.76x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.886, Ratio=3.54x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.888, Ratio=3.67x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.914, Ratio=3.66x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.896, Ratio=3.67x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.912, Ratio=3.62x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.896, Ratio=3.74x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.888, Ratio=3.51x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.925, Ratio=3.93x, Gap=-3.765
Batch 275/537: Loss=0.9279 (C:0.9279, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.878, Ratio=3.52x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.901, Ratio=3.69x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.916, Ratio=3.79x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.917, Ratio=3.74x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.923, Ratio=3.84x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.905, Ratio=3.70x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.909, Ratio=3.70x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.910, Ratio=3.72x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.920, Ratio=3.77x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.898, Ratio=3.67x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.897, Ratio=3.76x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.889, Ratio=3.55x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.898, Ratio=3.80x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.919, Ratio=3.81x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.908, Ratio=3.81x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.894, Ratio=3.63x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.916, Ratio=3.72x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.879, Ratio=3.68x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.943, Ratio=3.85x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.892, Ratio=3.61x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.884, Ratio=3.56x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.916, Ratio=3.79x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.925, Ratio=3.70x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.895, Ratio=3.69x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.905, Ratio=3.56x, Gap=-4.431
Batch 300/537: Loss=0.9869 (C:0.9869, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.552, Neg=1.876, Ratio=3.40x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.907, Ratio=3.75x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.903, Ratio=3.64x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.898, Ratio=3.57x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.954, Ratio=3.91x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.921, Ratio=3.81x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.908, Ratio=3.63x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.900, Ratio=3.72x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.921, Ratio=3.78x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.905, Ratio=3.80x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.887, Ratio=3.57x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.894, Ratio=3.65x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.895, Ratio=3.71x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.894, Ratio=3.74x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.896, Ratio=3.85x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.894, Ratio=3.68x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.902, Ratio=3.75x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.900, Ratio=3.63x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.917, Ratio=3.68x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.899, Ratio=3.69x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.925, Ratio=3.78x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.908, Ratio=3.70x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.926, Ratio=3.84x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.924, Ratio=3.86x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.917, Ratio=3.75x, Gap=-4.055
Batch 325/537: Loss=0.9569 (C:0.9569, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.876, Ratio=3.55x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.888, Ratio=3.81x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.892, Ratio=3.74x, Gap=-4.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.901, Ratio=3.71x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.893, Ratio=3.64x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.907, Ratio=3.58x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.923, Ratio=3.81x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.908, Ratio=3.65x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.901, Ratio=3.61x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.917, Ratio=3.84x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.919, Ratio=3.79x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.919, Ratio=3.80x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.906, Ratio=3.66x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.868, Ratio=3.51x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.927, Ratio=3.86x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.915, Ratio=3.66x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.922, Ratio=3.86x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.917, Ratio=3.82x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.901, Ratio=3.70x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.923, Ratio=3.78x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.898, Ratio=3.64x, Gap=-4.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.911, Ratio=3.72x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.918, Ratio=3.81x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.931, Ratio=3.82x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.930, Ratio=3.94x, Gap=-3.897
Batch 350/537: Loss=0.9274 (C:0.9274, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.889, Ratio=3.67x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.883, Ratio=3.52x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.929, Ratio=3.89x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.915, Ratio=3.82x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.895, Ratio=3.61x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.918, Ratio=3.90x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.915, Ratio=3.70x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.898, Ratio=3.76x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.899, Ratio=3.70x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.911, Ratio=3.69x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.903, Ratio=3.77x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.895, Ratio=3.65x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.911, Ratio=3.65x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.915, Ratio=3.74x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.909, Ratio=3.74x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.912, Ratio=3.77x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.900, Ratio=3.62x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.908, Ratio=3.72x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.917, Ratio=3.76x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.927, Ratio=3.82x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.916, Ratio=3.79x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.904, Ratio=3.61x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.892, Ratio=3.67x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.930, Ratio=3.92x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.923, Ratio=3.73x, Gap=-4.220
Batch 375/537: Loss=0.9584 (C:0.9584, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.923, Ratio=3.77x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.900, Ratio=3.57x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.902, Ratio=3.67x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.905, Ratio=3.69x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.893, Ratio=3.66x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.912, Ratio=3.80x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.923, Ratio=3.75x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.893, Ratio=3.74x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.904, Ratio=3.77x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.888, Ratio=3.60x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.913, Ratio=3.77x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.896, Ratio=3.72x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.906, Ratio=3.74x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.922, Ratio=3.83x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.908, Ratio=3.70x, Gap=-3.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.922, Ratio=3.89x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.907, Ratio=3.59x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.871, Ratio=3.41x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.912, Ratio=3.75x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.915, Ratio=3.71x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.891, Ratio=3.68x, Gap=-4.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.887, Ratio=3.53x, Gap=-3.836
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.926, Ratio=3.91x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.934, Ratio=3.86x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.913, Ratio=3.75x, Gap=-3.806
Batch 400/537: Loss=0.9549 (C:0.9549, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.891, Ratio=3.65x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.921, Ratio=3.70x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.880, Ratio=3.55x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.908, Ratio=3.74x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.908, Ratio=3.69x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.884, Ratio=3.54x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.933, Ratio=4.02x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.882, Ratio=3.53x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.883, Ratio=3.55x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.884, Ratio=3.49x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.907, Ratio=3.77x, Gap=-3.898
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.874, Ratio=3.50x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.893, Ratio=3.63x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.903, Ratio=3.71x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.888, Ratio=3.63x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.921, Ratio=3.77x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.897, Ratio=3.62x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.899, Ratio=3.67x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.908, Ratio=3.77x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.909, Ratio=3.70x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.893, Ratio=3.58x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.891, Ratio=3.51x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.902, Ratio=3.78x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.894, Ratio=3.59x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.886, Ratio=3.51x, Gap=-4.526
Batch 425/537: Loss=0.9987 (C:0.9987, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.918, Ratio=3.79x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.893, Ratio=3.56x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.904, Ratio=3.63x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.917, Ratio=3.77x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.912, Ratio=3.84x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.898, Ratio=3.58x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.915, Ratio=3.83x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.899, Ratio=3.69x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.911, Ratio=3.59x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.909, Ratio=3.87x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.902, Ratio=3.80x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.903, Ratio=3.64x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.911, Ratio=3.65x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.911, Ratio=3.67x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.887, Ratio=3.66x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.898, Ratio=3.62x, Gap=-3.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.928, Ratio=3.84x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.914, Ratio=3.70x, Gap=-4.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.917, Ratio=3.70x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.885, Ratio=3.50x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.917, Ratio=3.75x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.934, Ratio=3.74x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.900, Ratio=3.59x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.915, Ratio=3.75x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.890, Ratio=3.57x, Gap=-4.094
Batch 450/537: Loss=0.9882 (C:0.9882, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.894, Ratio=3.62x, Gap=-4.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.898, Ratio=3.55x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.901, Ratio=3.77x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.907, Ratio=3.77x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.925, Ratio=3.92x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.908, Ratio=4.00x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.917, Ratio=3.79x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.890, Ratio=3.75x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.929, Ratio=3.81x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.928, Ratio=3.84x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.904, Ratio=3.77x, Gap=-3.970
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.903, Ratio=3.73x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.933, Ratio=3.80x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.878, Ratio=3.46x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.905, Ratio=3.75x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.925, Ratio=3.87x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.892, Ratio=3.68x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.890, Ratio=3.66x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.908, Ratio=3.77x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.879, Ratio=3.54x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.924, Ratio=3.68x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.903, Ratio=3.71x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.908, Ratio=3.70x, Gap=-4.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.894, Ratio=3.56x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.893, Ratio=3.67x, Gap=-4.270
Batch 475/537: Loss=0.9725 (C:0.9725, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.922, Ratio=3.69x, Gap=-4.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.911, Ratio=3.64x, Gap=-4.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.865, Ratio=3.41x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.890, Ratio=3.67x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.910, Ratio=3.73x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.882, Ratio=3.49x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.891, Ratio=3.67x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.890, Ratio=3.67x, Gap=-4.017
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.903, Ratio=3.69x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.914, Ratio=3.79x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.906, Ratio=3.78x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.887, Ratio=3.55x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.929, Ratio=3.79x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.928, Ratio=3.85x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.550, Neg=1.895, Ratio=3.45x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.900, Ratio=3.54x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.918, Ratio=3.83x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.912, Ratio=3.80x, Gap=-4.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.879, Ratio=3.59x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.910, Ratio=3.73x, Gap=-3.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.907, Ratio=3.72x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.914, Ratio=3.65x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.930, Ratio=3.77x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.899, Ratio=3.61x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.897, Ratio=3.64x, Gap=-4.401
Batch 500/537: Loss=0.9739 (C:0.9739, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.892, Ratio=3.59x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.551, Neg=1.880, Ratio=3.41x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.897, Ratio=3.70x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.910, Ratio=3.78x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.885, Ratio=3.69x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.909, Ratio=3.62x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.915, Ratio=3.75x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.894, Ratio=3.70x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.912, Ratio=3.74x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.887, Ratio=3.72x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.915, Ratio=3.79x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.920, Ratio=3.68x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.920, Ratio=3.77x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.910, Ratio=3.83x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.912, Ratio=3.85x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.913, Ratio=3.79x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.927, Ratio=3.96x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.901, Ratio=3.86x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.934, Ratio=4.01x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.910, Ratio=3.71x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.882, Ratio=3.54x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.890, Ratio=3.60x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.884, Ratio=3.62x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.906, Ratio=3.73x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.893, Ratio=3.57x, Gap=-4.276
Batch 525/537: Loss=0.9877 (C:0.9877, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.920, Ratio=3.70x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.903, Ratio=3.65x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.893, Ratio=3.67x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.899, Ratio=3.69x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.913, Ratio=3.67x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.907, Ratio=3.61x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.904, Ratio=3.54x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.901, Ratio=3.69x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.921, Ratio=3.67x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.905, Ratio=3.72x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.908, Ratio=3.75x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.948, Ratio=4.25x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.928, Ratio=4.05x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.911, Ratio=3.98x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.933, Ratio=4.09x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.908, Ratio=3.92x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.919, Ratio=4.03x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.944, Ratio=4.32x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.939, Ratio=4.13x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.924, Ratio=4.14x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.933, Ratio=4.13x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.923, Ratio=3.98x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.924, Ratio=3.88x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.935, Ratio=4.14x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.940, Ratio=4.23x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.925, Ratio=4.00x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.937, Ratio=4.29x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.938, Ratio=4.17x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.922, Ratio=3.96x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.943, Ratio=4.00x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.925, Ratio=4.21x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.939, Ratio=4.14x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.930, Ratio=4.05x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.922, Ratio=4.01x, Gap=-3.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.913, Ratio=4.03x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.929, Ratio=4.03x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.933, Ratio=4.14x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.921, Ratio=4.01x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.933, Ratio=4.20x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.945, Ratio=4.24x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.940, Ratio=4.28x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.941, Ratio=4.03x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.901, Ratio=3.87x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.919, Ratio=3.88x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.932, Ratio=4.18x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.903, Ratio=3.89x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.936, Ratio=4.19x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.924, Ratio=4.13x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.924, Ratio=4.22x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.926, Ratio=4.02x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.910, Ratio=3.85x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.937, Ratio=4.24x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.938, Ratio=4.02x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.953, Ratio=4.33x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.920, Ratio=3.97x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.943, Ratio=4.19x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.911, Ratio=3.97x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.917, Ratio=4.05x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.928, Ratio=3.99x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.920, Ratio=4.09x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.927, Ratio=3.97x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.921, Ratio=4.10x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.925, Ratio=4.05x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.937, Ratio=4.07x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.933, Ratio=4.13x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.957, Ratio=4.31x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.934, Ratio=4.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.938, Ratio=4.07x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.920, Ratio=4.03x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.925, Ratio=4.03x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.935, Ratio=4.24x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.906, Ratio=3.91x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.918, Ratio=4.11x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.921, Ratio=3.98x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.927, Ratio=4.04x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.912, Ratio=4.11x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.936, Ratio=4.10x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.931, Ratio=4.13x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.914, Ratio=4.05x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.917, Ratio=4.05x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.923, Ratio=4.02x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.14x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.933, Ratio=4.03x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.926, Ratio=4.23x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.15x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.916, Ratio=3.87x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.914, Ratio=4.06x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.924, Ratio=4.10x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.935, Ratio=4.18x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.945, Ratio=4.21x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.890, Ratio=3.86x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.926, Ratio=4.11x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.932, Ratio=4.20x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.941, Ratio=4.06x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.916, Ratio=4.08x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.927, Ratio=4.11x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.09x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.920, Ratio=4.07x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.956, Ratio=4.38x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.932, Ratio=4.12x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.922, Ratio=4.07x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.929, Ratio=4.12x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.907, Ratio=3.95x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.929, Ratio=4.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.934, Ratio=4.02x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.921, Ratio=4.00x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.912, Ratio=3.96x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.917, Ratio=4.05x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.944, Ratio=4.28x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.923, Ratio=4.14x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.937, Ratio=4.12x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.920, Ratio=3.89x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.937, Ratio=4.05x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.915, Ratio=3.91x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.932, Ratio=4.10x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.935, Ratio=4.15x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.08x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.917, Ratio=3.90x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.936, Ratio=4.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.942, Ratio=4.17x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.953, Ratio=4.20x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.931, Ratio=4.14x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.928, Ratio=4.26x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.959, Ratio=4.29x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.934, Ratio=4.19x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.943, Ratio=4.36x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.937, Ratio=4.20x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.926, Ratio=4.02x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.919, Ratio=3.83x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.919, Ratio=3.93x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.940, Ratio=4.20x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.938, Ratio=4.31x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.943, Ratio=4.17x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.936, Ratio=4.26x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.893, Ratio=3.70x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.922, Ratio=4.03x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.924, Ratio=4.13x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.921, Ratio=4.09x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.924, Ratio=4.13x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.947, Ratio=4.16x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.906, Ratio=3.94x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.937, Ratio=3.98x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.918, Ratio=3.96x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.911, Ratio=3.96x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.923, Ratio=4.14x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.940, Ratio=4.20x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.913, Ratio=3.89x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.955, Ratio=4.32x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.926, Ratio=4.16x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.920, Ratio=3.93x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.938, Ratio=4.03x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.943, Ratio=4.34x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.925, Ratio=4.02x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.915, Ratio=4.00x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.939, Ratio=4.23x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.895, Ratio=3.94x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.923, Ratio=3.99x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.930, Ratio=4.06x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.932, Ratio=4.07x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.905, Ratio=3.98x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.905, Ratio=3.98x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.932, Ratio=4.09x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.937, Ratio=4.22x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.932, Ratio=4.16x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.933, Ratio=3.95x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.899, Ratio=3.74x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.929, Ratio=4.11x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.933, Ratio=4.18x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.910, Ratio=3.81x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.938, Ratio=4.01x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.904, Ratio=3.91x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.946, Ratio=4.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.944, Ratio=4.34x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.921, Ratio=4.05x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.917, Ratio=4.05x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.949, Ratio=4.24x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.917, Ratio=3.91x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.913, Ratio=3.97x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.925, Ratio=4.07x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.929, Ratio=3.89x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.902, Ratio=3.80x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.950, Ratio=4.35x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.933, Ratio=4.09x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.925, Ratio=4.01x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.910, Ratio=3.76x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.944, Ratio=4.22x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.922, Ratio=4.03x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.925, Ratio=3.92x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.922, Ratio=4.03x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.912, Ratio=3.91x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.924, Ratio=3.96x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.927, Ratio=4.00x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.953, Ratio=4.25x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.906, Ratio=3.98x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.924, Ratio=3.99x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.916, Ratio=3.98x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.913, Ratio=3.93x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.927, Ratio=4.18x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.934, Ratio=4.11x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.931, Ratio=4.15x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.17x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.924, Ratio=4.06x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.913, Ratio=3.95x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.950, Ratio=4.31x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.920, Ratio=3.97x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.940, Ratio=4.30x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.940, Ratio=4.24x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.931, Ratio=4.26x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.945, Ratio=4.26x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.938, Ratio=4.09x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.939, Ratio=4.16x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.914, Ratio=3.99x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.922, Ratio=3.95x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.913, Ratio=4.04x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.903, Ratio=3.78x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.930, Ratio=4.12x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.940, Ratio=4.16x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.925, Ratio=4.17x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.932, Ratio=4.15x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.932, Ratio=4.23x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.916, Ratio=3.95x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.938, Ratio=4.08x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.926, Ratio=4.18x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.925, Ratio=3.99x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.916, Ratio=4.09x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.942, Ratio=4.25x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.927, Ratio=3.94x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.921, Ratio=4.10x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.928, Ratio=4.08x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.937, Ratio=4.13x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.912, Ratio=4.06x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.938, Ratio=4.15x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.907, Ratio=3.92x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.942, Ratio=4.26x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.955, Ratio=4.42x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.938, Ratio=4.27x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.946, Ratio=4.10x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.917, Ratio=4.15x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.913, Ratio=3.77x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.925, Ratio=4.11x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.934, Ratio=4.14x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.936, Ratio=4.11x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.922, Ratio=4.06x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.910, Ratio=3.96x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.919, Ratio=3.90x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.930, Ratio=4.12x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.927, Ratio=3.92x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.937, Ratio=4.18x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.911, Ratio=3.94x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.910, Ratio=3.93x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.901, Ratio=3.73x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.955, Ratio=4.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.915, Ratio=3.94x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.928, Ratio=4.17x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.905, Ratio=4.00x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.925, Ratio=4.20x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.934, Ratio=4.13x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.917, Ratio=4.02x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.933, Ratio=4.14x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.955, Ratio=4.40x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.920, Ratio=4.07x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.937, Ratio=4.22x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.913, Ratio=4.05x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.924, Ratio=4.05x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.944, Ratio=4.20x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.927, Ratio=4.14x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.920, Ratio=3.89x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.931, Ratio=4.04x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.929, Ratio=4.11x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.934, Ratio=4.02x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.926, Ratio=4.00x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.931, Ratio=4.06x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.921, Ratio=3.97x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.945, Ratio=4.19x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.938, Ratio=4.17x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.934, Ratio=4.11x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.910, Ratio=4.10x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.933, Ratio=4.02x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.904, Ratio=4.03x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.947, Ratio=4.21x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.937, Ratio=4.19x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.930, Ratio=3.98x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.935, Ratio=4.08x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.911, Ratio=3.94x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.937, Ratio=4.19x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.933, Ratio=4.09x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.939, Ratio=4.22x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.920, Ratio=3.85x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.939, Ratio=4.25x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.949, Ratio=4.34x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.931, Ratio=4.02x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.917, Ratio=4.05x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.947, Ratio=4.30x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.915, Ratio=3.86x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.956, Ratio=4.30x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.945, Ratio=4.29x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.917, Ratio=4.19x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.920, Ratio=3.97x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.942, Ratio=4.23x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.921, Ratio=3.99x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.934, Ratio=4.04x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.953, Ratio=4.27x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.936, Ratio=4.08x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.949, Ratio=4.35x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.936, Ratio=3.98x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.928, Ratio=4.07x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.919, Ratio=3.93x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.896, Ratio=3.87x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.945, Ratio=4.22x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.934, Ratio=4.02x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.929, Ratio=4.11x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.921, Ratio=4.13x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.950, Ratio=4.24x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.16x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.930, Ratio=4.10x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.940, Ratio=4.21x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.946, Ratio=4.26x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.938, Ratio=4.24x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.912, Ratio=3.91x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.923, Ratio=4.17x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.910, Ratio=3.88x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.926, Ratio=4.18x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.915, Ratio=3.97x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.920, Ratio=4.00x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.913, Ratio=3.96x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.928, Ratio=4.06x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.929, Ratio=4.10x, Gap=-3.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.910, Ratio=3.89x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.927, Ratio=3.96x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.903, Ratio=3.91x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.899, Ratio=3.79x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.919, Ratio=3.99x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.914, Ratio=3.94x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.928, Ratio=4.22x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.933, Ratio=4.13x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.917, Ratio=4.01x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.951, Ratio=4.32x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.934, Ratio=4.01x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.924, Ratio=4.02x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.931, Ratio=4.03x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.943, Ratio=4.29x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.926, Ratio=4.11x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.933, Ratio=4.21x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.923, Ratio=4.13x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.912, Ratio=4.10x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.924, Ratio=3.97x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.941, Ratio=4.09x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.939, Ratio=4.00x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.948, Ratio=4.19x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.948, Ratio=4.34x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.937, Ratio=4.05x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.919, Ratio=3.99x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.922, Ratio=3.97x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.919, Ratio=3.97x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.932, Ratio=4.13x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.924, Ratio=4.07x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.948, Ratio=4.32x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.920, Ratio=4.01x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.928, Ratio=4.01x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.942, Ratio=4.22x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.940, Ratio=4.21x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.941, Ratio=4.06x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.957, Ratio=4.34x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.911, Ratio=4.03x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.931, Ratio=4.09x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.925, Ratio=4.09x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.919, Ratio=4.10x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.927, Ratio=4.18x, Gap=-3.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.940, Ratio=4.33x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.919, Ratio=4.06x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.924, Ratio=3.96x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.938, Ratio=4.22x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.937, Ratio=4.04x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.923, Ratio=4.06x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.904, Ratio=3.83x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.948, Ratio=4.17x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.940, Ratio=4.21x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.932, Ratio=4.14x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.925, Ratio=4.08x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.928, Ratio=4.00x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.926, Ratio=4.12x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.928, Ratio=4.08x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.924, Ratio=4.13x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.935, Ratio=4.03x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.938, Ratio=4.16x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.911, Ratio=3.80x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.927, Ratio=4.13x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.921, Ratio=4.06x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.933, Ratio=4.32x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.921, Ratio=3.99x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.929, Ratio=4.29x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.926, Ratio=4.20x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.922, Ratio=4.02x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.939, Ratio=4.22x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.947, Ratio=4.28x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.952, Ratio=4.27x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.926, Ratio=4.13x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.948, Ratio=4.33x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.931, Ratio=4.10x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.903, Ratio=3.94x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.945, Ratio=4.23x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.918, Ratio=4.14x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.935, Ratio=4.11x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.904, Ratio=3.97x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.920, Ratio=4.07x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.916, Ratio=4.17x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.919, Ratio=4.03x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.940, Ratio=4.21x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.960, Ratio=4.37x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.919, Ratio=3.94x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.950, Ratio=4.21x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.925, Ratio=4.02x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.924, Ratio=3.91x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.919, Ratio=4.11x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.925, Ratio=3.97x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.942, Ratio=4.14x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.927, Ratio=3.96x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.931, Ratio=4.17x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.941, Ratio=4.05x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.936, Ratio=4.23x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.919, Ratio=4.00x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.902, Ratio=3.98x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.922, Ratio=4.15x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.925, Ratio=4.04x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.935, Ratio=4.05x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.919, Ratio=3.96x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.929, Ratio=4.10x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.916, Ratio=4.00x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.916, Ratio=3.94x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.914, Ratio=3.92x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.935, Ratio=4.13x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.947, Ratio=4.23x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.948, Ratio=4.28x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.942, Ratio=4.18x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.937, Ratio=4.10x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.915, Ratio=3.99x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.924, Ratio=4.10x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.929, Ratio=4.11x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.944, Ratio=4.15x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.919, Ratio=3.95x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.947, Ratio=4.18x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.955, Ratio=4.19x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.902, Ratio=3.78x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.924, Ratio=4.06x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.905, Ratio=3.97x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.938, Ratio=4.13x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.915, Ratio=3.81x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.903, Ratio=3.87x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.906, Ratio=3.85x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.942, Ratio=4.24x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.947, Ratio=4.15x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.935, Ratio=4.17x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.903, Ratio=3.86x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.934, Ratio=4.12x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.941, Ratio=4.27x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.918, Ratio=3.95x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.919, Ratio=3.89x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.917, Ratio=3.93x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.915, Ratio=4.04x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.916, Ratio=3.98x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.954, Ratio=4.22x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.931, Ratio=4.04x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.928, Ratio=3.96x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.936, Ratio=4.26x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.899, Ratio=3.92x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.906, Ratio=3.96x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.941, Ratio=4.25x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.923, Ratio=4.03x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.942, Ratio=4.14x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.940, Ratio=4.14x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.956, Ratio=4.25x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.912, Ratio=4.02x, Gap=-3.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.927, Ratio=4.16x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.919, Ratio=4.08x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.879, Ratio=3.73x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.934, Ratio=4.19x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.925, Ratio=4.10x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.943, Ratio=4.08x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.894, Ratio=3.76x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.936, Ratio=4.31x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.927, Ratio=4.11x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.935, Ratio=4.14x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.943, Ratio=4.14x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.929, Ratio=4.21x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.916, Ratio=4.03x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.904, Ratio=3.78x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.929, Ratio=4.02x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.907, Ratio=3.86x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.917, Ratio=4.13x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.916, Ratio=3.86x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.915, Ratio=3.93x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.927, Ratio=4.13x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.946, Ratio=4.20x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.927, Ratio=4.09x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.926, Ratio=4.01x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.926, Ratio=4.08x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.893, Ratio=3.87x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.925, Ratio=4.07x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.930, Ratio=4.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.932, Ratio=4.10x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.935, Ratio=4.04x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.968, Ratio=4.41x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.902, Ratio=3.84x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.909, Ratio=3.99x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.947, Ratio=4.23x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.931, Ratio=3.97x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.910, Ratio=4.08x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.916, Ratio=3.91x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.908, Ratio=3.97x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.931, Ratio=4.09x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.911, Ratio=3.86x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.935, Ratio=4.10x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.926, Ratio=4.07x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.927, Ratio=4.17x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.946, Ratio=4.28x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.950, Ratio=4.28x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.937, Ratio=4.13x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.921, Ratio=3.95x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.918, Ratio=4.04x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.919, Ratio=4.14x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.923, Ratio=4.01x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.907, Ratio=3.89x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.932, Ratio=4.14x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.952, Ratio=4.24x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.897, Ratio=3.86x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.917, Ratio=4.00x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.916, Ratio=4.04x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.935, Ratio=4.25x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.941, Ratio=4.33x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.917, Ratio=3.98x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.910, Ratio=4.11x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.917, Ratio=4.04x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.948, Ratio=4.27x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.935, Ratio=4.21x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.17x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.928, Ratio=4.07x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.892, Ratio=3.89x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.941, Ratio=4.17x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.915, Ratio=3.88x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.932, Ratio=4.15x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.925, Ratio=4.17x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.931, Ratio=4.14x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.896, Ratio=4.02x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.939, Ratio=4.21x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.934, Ratio=4.06x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.937, Ratio=4.14x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.907, Ratio=3.89x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.905, Ratio=3.95x, Gap=-3.661

============================================================
Epoch 13/20 completed in 37.6s
Train: Loss=0.9630 (C:0.9630, R:0.0105) Ratio=3.34x
Val:   Loss=0.9076 (C:0.9076, R:0.0105) Ratio=4.19x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.9076)
============================================================

Epoch 14 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.916, Ratio=3.76x, Gap=-4.139
Batch   0/537: Loss=0.9571 (C:0.9571, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.893, Ratio=3.67x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.924, Ratio=3.89x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.900, Ratio=3.67x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.911, Ratio=3.72x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.929, Ratio=3.94x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.940, Ratio=4.04x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.915, Ratio=3.85x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.920, Ratio=3.92x, Gap=-3.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.923, Ratio=3.95x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.924, Ratio=3.71x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.906, Ratio=3.79x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.938, Ratio=3.84x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.916, Ratio=3.85x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.908, Ratio=3.84x, Gap=-3.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.925, Ratio=3.78x, Gap=-5.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.929, Ratio=3.98x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.891, Ratio=3.66x, Gap=-4.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.935, Ratio=3.97x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.938, Ratio=3.87x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.924, Ratio=3.89x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.921, Ratio=3.79x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.919, Ratio=3.72x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.914, Ratio=3.64x, Gap=-4.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.919, Ratio=3.78x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.911, Ratio=3.78x, Gap=-4.070
Batch  25/537: Loss=0.9520 (C:0.9520, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.910, Ratio=4.02x, Gap=-4.118
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.885, Ratio=3.46x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.897, Ratio=3.90x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.897, Ratio=3.66x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.898, Ratio=3.68x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.900, Ratio=3.79x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.930, Ratio=3.92x, Gap=-3.878
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.917, Ratio=3.75x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.902, Ratio=3.74x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.903, Ratio=3.77x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.944, Ratio=4.12x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.929, Ratio=3.78x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.912, Ratio=3.83x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.938, Ratio=3.88x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.900, Ratio=3.54x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.912, Ratio=3.82x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.927, Ratio=3.90x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.922, Ratio=3.77x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.925, Ratio=3.96x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.922, Ratio=3.74x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.904, Ratio=3.75x, Gap=-4.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.911, Ratio=3.68x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.917, Ratio=3.81x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.904, Ratio=3.67x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.923, Ratio=3.90x, Gap=-3.989
Batch  50/537: Loss=0.9322 (C:0.9322, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.906, Ratio=3.56x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.926, Ratio=3.98x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.897, Ratio=3.82x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.905, Ratio=3.80x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.929, Ratio=3.80x, Gap=-4.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.898, Ratio=3.79x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.916, Ratio=3.91x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.933, Ratio=3.89x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.930, Ratio=3.92x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.914, Ratio=3.81x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.917, Ratio=3.86x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.905, Ratio=3.60x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.921, Ratio=3.76x, Gap=-4.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.902, Ratio=3.63x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.882, Ratio=3.58x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.917, Ratio=3.91x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.920, Ratio=3.68x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.910, Ratio=3.75x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.544, Neg=1.896, Ratio=3.48x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.923, Ratio=3.71x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.896, Ratio=3.62x, Gap=-3.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.898, Ratio=3.82x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.924, Ratio=3.81x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.913, Ratio=3.70x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.929, Ratio=3.99x, Gap=-4.342
Batch  75/537: Loss=0.9185 (C:0.9185, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.889, Ratio=3.74x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.898, Ratio=3.65x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.893, Ratio=3.80x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.896, Ratio=3.67x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.917, Ratio=3.76x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.884, Ratio=3.43x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.910, Ratio=3.75x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.898, Ratio=3.80x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.932, Ratio=3.85x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.960, Ratio=3.99x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.913, Ratio=3.69x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.885, Ratio=3.62x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.895, Ratio=3.87x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.927, Ratio=3.96x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.906, Ratio=3.69x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.917, Ratio=3.91x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.910, Ratio=3.85x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.918, Ratio=3.73x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.924, Ratio=3.77x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.902, Ratio=3.74x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.913, Ratio=3.80x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.916, Ratio=3.80x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.928, Ratio=3.92x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.923, Ratio=3.63x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.952, Ratio=3.80x, Gap=-4.196
Batch 100/537: Loss=0.9454 (C:0.9454, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.929, Ratio=3.80x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.923, Ratio=3.78x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.893, Ratio=3.74x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.903, Ratio=3.80x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.905, Ratio=3.76x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.912, Ratio=3.80x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.913, Ratio=3.72x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.916, Ratio=3.77x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.901, Ratio=3.85x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.895, Ratio=3.69x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.916, Ratio=3.85x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.934, Ratio=3.85x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.933, Ratio=3.89x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.912, Ratio=3.75x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.918, Ratio=3.85x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.934, Ratio=3.95x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.892, Ratio=3.56x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.895, Ratio=3.67x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.916, Ratio=3.84x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.908, Ratio=3.69x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.913, Ratio=3.89x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.891, Ratio=3.51x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.910, Ratio=3.79x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.897, Ratio=3.65x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.900, Ratio=3.84x, Gap=-4.380
Batch 125/537: Loss=0.9414 (C:0.9414, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.937, Ratio=3.90x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.905, Ratio=3.66x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.914, Ratio=3.66x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.895, Ratio=3.70x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.888, Ratio=3.71x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.895, Ratio=3.68x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.907, Ratio=3.82x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.908, Ratio=3.82x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.926, Ratio=3.87x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.913, Ratio=3.80x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.913, Ratio=3.74x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.925, Ratio=3.86x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.927, Ratio=3.84x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.914, Ratio=3.72x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.921, Ratio=3.74x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.924, Ratio=3.90x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.943, Ratio=3.88x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.950, Ratio=4.07x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.930, Ratio=3.90x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.922, Ratio=3.93x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.909, Ratio=3.85x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.907, Ratio=3.82x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.895, Ratio=3.73x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.915, Ratio=3.84x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.905, Ratio=3.75x, Gap=-4.164
Batch 150/537: Loss=0.9570 (C:0.9570, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.913, Ratio=3.81x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.894, Ratio=3.54x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.908, Ratio=3.85x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.888, Ratio=3.67x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.873, Ratio=3.55x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.900, Ratio=3.76x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.900, Ratio=3.80x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.914, Ratio=3.78x, Gap=-4.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.924, Ratio=3.90x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.931, Ratio=3.95x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.915, Ratio=3.88x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.880, Ratio=3.44x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.913, Ratio=3.66x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.899, Ratio=3.57x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.926, Ratio=3.69x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.902, Ratio=3.65x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.894, Ratio=3.50x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.937, Ratio=3.90x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.920, Ratio=3.81x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.925, Ratio=3.76x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.895, Ratio=3.65x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.886, Ratio=3.73x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.910, Ratio=3.76x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.912, Ratio=3.69x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.916, Ratio=3.82x, Gap=-4.306
Batch 175/537: Loss=0.9434 (C:0.9434, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.914, Ratio=3.74x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.904, Ratio=3.70x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.889, Ratio=3.74x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.905, Ratio=3.67x, Gap=-4.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.885, Ratio=3.57x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.912, Ratio=3.78x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.914, Ratio=3.76x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.902, Ratio=3.90x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.931, Ratio=3.75x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.546, Neg=1.907, Ratio=3.49x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.904, Ratio=3.61x, Gap=-4.137
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.890, Ratio=3.68x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.917, Ratio=3.80x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.918, Ratio=3.88x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.897, Ratio=3.66x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.910, Ratio=3.91x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.910, Ratio=3.72x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.925, Ratio=3.92x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.935, Ratio=3.93x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.918, Ratio=3.75x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.942, Ratio=3.95x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.920, Ratio=3.71x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.936, Ratio=3.92x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.900, Ratio=3.66x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.933, Ratio=3.83x, Gap=-3.967
Batch 200/537: Loss=0.9429 (C:0.9429, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.905, Ratio=3.56x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.909, Ratio=3.65x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.908, Ratio=3.81x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.901, Ratio=3.71x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.877, Ratio=3.58x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.934, Ratio=3.93x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.931, Ratio=3.97x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.906, Ratio=3.67x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.918, Ratio=3.82x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.905, Ratio=3.74x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.898, Ratio=3.58x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.915, Ratio=3.82x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.938, Ratio=3.99x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.908, Ratio=3.82x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.890, Ratio=3.55x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.885, Ratio=3.64x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.899, Ratio=3.69x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.887, Ratio=3.66x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.905, Ratio=3.71x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.890, Ratio=3.78x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.882, Ratio=3.68x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.895, Ratio=3.63x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.905, Ratio=3.92x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.919, Ratio=3.81x, Gap=-4.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.915, Ratio=3.79x, Gap=-3.794
Batch 225/537: Loss=0.9493 (C:0.9493, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.911, Ratio=3.66x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.918, Ratio=3.80x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.923, Ratio=3.85x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.901, Ratio=3.60x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.933, Ratio=3.94x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.927, Ratio=3.67x, Gap=-3.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.909, Ratio=3.74x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.921, Ratio=3.89x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.917, Ratio=3.79x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.899, Ratio=3.74x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.866, Ratio=3.61x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.916, Ratio=3.80x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.918, Ratio=3.79x, Gap=-4.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.866, Ratio=3.58x, Gap=-3.830
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.893, Ratio=3.84x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.893, Ratio=3.70x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.889, Ratio=3.64x, Gap=-3.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.932, Ratio=3.87x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.900, Ratio=3.66x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.925, Ratio=3.75x, Gap=-3.873
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.927, Ratio=3.90x, Gap=-4.074
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.931, Ratio=3.85x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.920, Ratio=3.90x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.892, Ratio=3.60x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.892, Ratio=3.66x, Gap=-4.064
Batch 250/537: Loss=0.9711 (C:0.9711, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.898, Ratio=3.73x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.935, Ratio=3.90x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.910, Ratio=3.85x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.910, Ratio=3.78x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.902, Ratio=3.69x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.905, Ratio=3.53x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.937, Ratio=3.92x, Gap=-4.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.914, Ratio=3.74x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.913, Ratio=3.77x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.855, Ratio=3.46x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.897, Ratio=3.76x, Gap=-4.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.913, Ratio=3.79x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.917, Ratio=3.70x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.876, Ratio=3.61x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.905, Ratio=3.64x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.890, Ratio=3.78x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.916, Ratio=3.79x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.905, Ratio=3.72x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.897, Ratio=3.55x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.895, Ratio=3.73x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.904, Ratio=3.77x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.928, Ratio=3.87x, Gap=-4.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.905, Ratio=3.73x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.922, Ratio=3.79x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.901, Ratio=3.86x, Gap=-4.064
Batch 275/537: Loss=0.9386 (C:0.9386, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.877, Ratio=3.56x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.917, Ratio=3.85x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.905, Ratio=3.70x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.895, Ratio=3.69x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.908, Ratio=3.70x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.915, Ratio=3.73x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.937, Ratio=3.80x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.900, Ratio=3.65x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.907, Ratio=3.73x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.919, Ratio=3.78x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.883, Ratio=3.60x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.920, Ratio=3.78x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.916, Ratio=3.80x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.897, Ratio=3.59x, Gap=-3.949
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.896, Ratio=3.71x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.918, Ratio=3.98x, Gap=-3.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.920, Ratio=3.93x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.891, Ratio=3.66x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.911, Ratio=3.78x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.909, Ratio=3.81x, Gap=-4.824
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.896, Ratio=3.69x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.908, Ratio=3.82x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.900, Ratio=3.71x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.913, Ratio=3.70x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.923, Ratio=3.77x, Gap=-3.893
Batch 300/537: Loss=0.9550 (C:0.9550, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.900, Ratio=3.53x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.928, Ratio=3.82x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.926, Ratio=3.91x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.888, Ratio=3.57x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.920, Ratio=3.77x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.905, Ratio=3.69x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.922, Ratio=3.80x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.893, Ratio=3.68x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.912, Ratio=3.85x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.909, Ratio=3.77x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.898, Ratio=3.62x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.922, Ratio=3.74x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.935, Ratio=3.97x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.916, Ratio=3.73x, Gap=-4.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.905, Ratio=3.67x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.901, Ratio=3.64x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.910, Ratio=3.81x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.917, Ratio=3.83x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.882, Ratio=3.56x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.909, Ratio=3.69x, Gap=-4.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.899, Ratio=3.73x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.925, Ratio=3.79x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.910, Ratio=3.75x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.933, Ratio=3.93x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.925, Ratio=3.91x, Gap=-4.059
Batch 325/537: Loss=0.9316 (C:0.9316, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.916, Ratio=3.67x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.925, Ratio=3.88x, Gap=-4.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.885, Ratio=3.46x, Gap=-4.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.882, Ratio=3.68x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.917, Ratio=3.73x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.912, Ratio=3.89x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.906, Ratio=3.74x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.918, Ratio=3.74x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.911, Ratio=3.83x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.905, Ratio=3.91x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.925, Ratio=3.77x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.916, Ratio=3.82x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.902, Ratio=3.82x, Gap=-3.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.892, Ratio=3.68x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.901, Ratio=3.72x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.909, Ratio=3.67x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.915, Ratio=3.70x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.927, Ratio=3.70x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.918, Ratio=3.86x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.915, Ratio=3.68x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.922, Ratio=3.74x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.935, Ratio=3.88x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.901, Ratio=3.74x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.934, Ratio=4.02x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.906, Ratio=3.69x, Gap=-3.980
Batch 350/537: Loss=0.9630 (C:0.9630, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.919, Ratio=3.72x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.925, Ratio=3.88x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.910, Ratio=3.68x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.906, Ratio=3.58x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.894, Ratio=3.64x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.927, Ratio=3.82x, Gap=-3.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.934, Ratio=3.86x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.926, Ratio=3.84x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.903, Ratio=3.85x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.892, Ratio=3.55x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.899, Ratio=3.75x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.891, Ratio=3.63x, Gap=-4.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.897, Ratio=3.70x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.909, Ratio=3.70x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.920, Ratio=3.81x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.922, Ratio=3.86x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.916, Ratio=3.71x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.937, Ratio=3.91x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.909, Ratio=3.70x, Gap=-4.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.894, Ratio=3.70x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.906, Ratio=3.68x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.908, Ratio=3.68x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.874, Ratio=3.57x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.927, Ratio=3.85x, Gap=-4.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.883, Ratio=3.45x, Gap=-4.122
Batch 375/537: Loss=1.0092 (C:1.0092, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.540, Neg=1.891, Ratio=3.50x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.907, Ratio=3.68x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.914, Ratio=3.77x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.922, Ratio=3.86x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.905, Ratio=3.65x, Gap=-3.986
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.921, Ratio=3.80x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.927, Ratio=3.74x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.907, Ratio=3.62x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.936, Ratio=3.95x, Gap=-4.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.907, Ratio=3.66x, Gap=-4.366
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.911, Ratio=3.65x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.903, Ratio=3.73x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.905, Ratio=3.64x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.937, Ratio=3.85x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.921, Ratio=3.86x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.921, Ratio=3.77x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.923, Ratio=3.85x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.877, Ratio=3.53x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.887, Ratio=3.70x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.928, Ratio=3.93x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.907, Ratio=3.81x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.914, Ratio=3.78x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.918, Ratio=3.82x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.902, Ratio=3.71x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.908, Ratio=3.62x, Gap=-4.141
Batch 400/537: Loss=0.9735 (C:0.9735, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.909, Ratio=3.62x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.927, Ratio=3.87x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.911, Ratio=3.77x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.882, Ratio=3.59x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.940, Ratio=3.75x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.922, Ratio=3.74x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.898, Ratio=3.66x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.897, Ratio=3.63x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.542, Neg=1.904, Ratio=3.51x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.936, Ratio=3.82x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.908, Ratio=3.75x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.896, Ratio=3.66x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.913, Ratio=3.86x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.891, Ratio=3.68x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.880, Ratio=3.58x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.923, Ratio=3.90x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.890, Ratio=3.76x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.934, Ratio=3.91x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.911, Ratio=3.77x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.910, Ratio=3.61x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.926, Ratio=3.80x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.915, Ratio=3.73x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.907, Ratio=3.57x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.908, Ratio=3.80x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.884, Ratio=3.57x, Gap=-4.039
Batch 425/537: Loss=0.9878 (C:0.9878, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.899, Ratio=3.76x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.873, Ratio=3.58x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.881, Ratio=3.58x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.914, Ratio=3.77x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.924, Ratio=3.77x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.923, Ratio=3.79x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.934, Ratio=3.88x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.923, Ratio=3.69x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.910, Ratio=3.94x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.911, Ratio=3.68x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.911, Ratio=3.79x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.913, Ratio=3.71x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.917, Ratio=3.66x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.921, Ratio=3.82x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.907, Ratio=3.65x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.896, Ratio=3.62x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.915, Ratio=3.77x, Gap=-4.038
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.898, Ratio=3.86x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.914, Ratio=3.64x, Gap=-5.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.911, Ratio=3.77x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.896, Ratio=3.90x, Gap=-3.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.892, Ratio=3.56x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.910, Ratio=3.84x, Gap=-4.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.896, Ratio=3.66x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.955, Ratio=4.12x, Gap=-3.957
Batch 450/537: Loss=0.9006 (C:0.9006, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.901, Ratio=3.64x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.928, Ratio=3.79x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.545, Neg=1.884, Ratio=3.46x, Gap=-4.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.898, Ratio=3.56x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.929, Ratio=3.78x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.930, Ratio=3.84x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.909, Ratio=3.58x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.892, Ratio=3.65x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.909, Ratio=3.80x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.907, Ratio=3.68x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.901, Ratio=3.83x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.881, Ratio=3.58x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.881, Ratio=3.53x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.897, Ratio=3.85x, Gap=-3.807
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.894, Ratio=3.64x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.884, Ratio=3.59x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.896, Ratio=3.62x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.919, Ratio=3.72x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.907, Ratio=3.70x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.891, Ratio=3.66x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.910, Ratio=3.57x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.904, Ratio=3.65x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.908, Ratio=3.60x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.909, Ratio=3.61x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.891, Ratio=3.65x, Gap=-4.207
Batch 475/537: Loss=0.9762 (C:0.9762, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.909, Ratio=3.83x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.917, Ratio=3.81x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.920, Ratio=3.78x, Gap=-4.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.913, Ratio=3.74x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.898, Ratio=3.64x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.912, Ratio=3.68x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.909, Ratio=3.80x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.923, Ratio=3.87x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.900, Ratio=3.79x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.891, Ratio=3.73x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.926, Ratio=3.86x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.891, Ratio=3.58x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.918, Ratio=3.86x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.921, Ratio=3.96x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.921, Ratio=3.67x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.907, Ratio=3.65x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.899, Ratio=3.64x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.901, Ratio=3.69x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.922, Ratio=3.75x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.892, Ratio=3.51x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.925, Ratio=3.79x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.909, Ratio=3.68x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.944, Ratio=4.08x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.899, Ratio=3.68x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.893, Ratio=3.65x, Gap=-4.149
Batch 500/537: Loss=0.9723 (C:0.9723, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.915, Ratio=3.78x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.915, Ratio=3.72x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.921, Ratio=3.89x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.903, Ratio=3.74x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.914, Ratio=3.88x, Gap=-4.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.912, Ratio=3.70x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.940, Ratio=3.91x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.883, Ratio=3.62x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.556, Neg=1.869, Ratio=3.36x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.959, Ratio=3.92x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.932, Ratio=3.88x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.919, Ratio=3.78x, Gap=-3.913
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.909, Ratio=3.81x, Gap=-3.850
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.928, Ratio=3.77x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.904, Ratio=3.70x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.910, Ratio=3.76x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.547, Neg=1.869, Ratio=3.42x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.899, Ratio=3.66x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.930, Ratio=3.93x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.896, Ratio=3.72x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.914, Ratio=3.81x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.869, Ratio=3.41x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.929, Ratio=3.81x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.926, Ratio=3.91x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.906, Ratio=3.75x, Gap=-3.995
Batch 525/537: Loss=0.9542 (C:0.9542, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.914, Ratio=3.68x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.535, Neg=1.889, Ratio=3.53x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.910, Ratio=3.69x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.889, Ratio=3.54x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.900, Ratio=3.79x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.884, Ratio=3.61x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.893, Ratio=3.65x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.908, Ratio=3.63x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.915, Ratio=3.65x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.926, Ratio=3.76x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.912, Ratio=3.81x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.935, Ratio=4.16x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.921, Ratio=4.05x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.923, Ratio=4.05x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.925, Ratio=4.14x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.923, Ratio=4.20x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.928, Ratio=4.18x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.951, Ratio=4.28x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.941, Ratio=4.25x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.935, Ratio=4.08x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.926, Ratio=4.08x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.936, Ratio=4.21x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.917, Ratio=4.06x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.926, Ratio=4.06x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.930, Ratio=4.17x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.935, Ratio=4.08x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.922, Ratio=4.06x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.908, Ratio=3.97x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.930, Ratio=4.26x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.923, Ratio=4.09x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.931, Ratio=4.20x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.976, Ratio=4.47x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.939, Ratio=4.35x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.919, Ratio=4.13x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.931, Ratio=4.05x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.926, Ratio=4.13x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.901, Ratio=3.97x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.914, Ratio=4.20x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.943, Ratio=4.36x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.922, Ratio=4.02x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.930, Ratio=4.09x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.926, Ratio=4.29x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.933, Ratio=4.21x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.929, Ratio=4.29x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.912, Ratio=3.95x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.974, Ratio=4.55x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.928, Ratio=4.19x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.940, Ratio=4.18x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.922, Ratio=4.00x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.937, Ratio=4.22x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.930, Ratio=4.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.930, Ratio=4.13x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.917, Ratio=4.04x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.947, Ratio=4.38x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.936, Ratio=4.25x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.937, Ratio=4.16x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.930, Ratio=4.24x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.925, Ratio=4.14x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.896, Ratio=3.85x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.928, Ratio=4.20x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.922, Ratio=4.13x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.915, Ratio=3.99x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.908, Ratio=3.86x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.929, Ratio=4.16x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.928, Ratio=4.20x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.918, Ratio=4.01x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.916, Ratio=3.96x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.950, Ratio=4.19x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.952, Ratio=4.35x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.917, Ratio=3.97x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.911, Ratio=4.09x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.933, Ratio=4.14x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.935, Ratio=4.03x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.896, Ratio=3.87x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.938, Ratio=4.22x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.935, Ratio=4.26x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.926, Ratio=4.04x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.921, Ratio=4.20x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.909, Ratio=3.89x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.942, Ratio=4.20x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.920, Ratio=4.06x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.911, Ratio=3.97x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.934, Ratio=4.13x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.950, Ratio=4.32x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.931, Ratio=4.17x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.926, Ratio=4.18x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.937, Ratio=4.21x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.958, Ratio=4.33x, Gap=-3.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.916, Ratio=4.11x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.940, Ratio=4.14x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.914, Ratio=4.05x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.930, Ratio=4.33x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.914, Ratio=4.01x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.914, Ratio=4.06x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.907, Ratio=4.00x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.933, Ratio=4.07x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.936, Ratio=4.16x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.922, Ratio=4.07x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.909, Ratio=3.99x, Gap=-3.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.924, Ratio=4.11x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.924, Ratio=4.19x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.918, Ratio=3.94x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.929, Ratio=4.25x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.935, Ratio=4.15x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.932, Ratio=4.20x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.946, Ratio=4.32x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.918, Ratio=4.14x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.946, Ratio=4.02x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.909, Ratio=4.07x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.13x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.940, Ratio=4.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.929, Ratio=4.18x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.901, Ratio=3.90x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.904, Ratio=3.90x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.922, Ratio=4.03x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.918, Ratio=4.00x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.941, Ratio=4.31x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.926, Ratio=4.17x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.920, Ratio=3.98x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.935, Ratio=4.19x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.908, Ratio=3.80x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.932, Ratio=4.02x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.912, Ratio=4.01x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.938, Ratio=4.13x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.939, Ratio=4.16x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.933, Ratio=4.08x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.933, Ratio=4.18x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.921, Ratio=4.07x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.924, Ratio=4.08x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.938, Ratio=4.19x, Gap=-3.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.932, Ratio=4.20x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.938, Ratio=4.33x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.931, Ratio=4.03x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.921, Ratio=3.98x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.926, Ratio=4.07x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.923, Ratio=4.12x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.950, Ratio=4.33x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.935, Ratio=4.28x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.927, Ratio=4.09x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.921, Ratio=4.09x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.919, Ratio=4.05x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.932, Ratio=4.29x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.921, Ratio=4.08x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.903, Ratio=3.89x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.925, Ratio=4.25x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.926, Ratio=4.21x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.944, Ratio=4.22x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.925, Ratio=4.12x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.925, Ratio=4.01x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.935, Ratio=4.31x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.923, Ratio=4.10x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.933, Ratio=4.25x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.913, Ratio=4.05x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.924, Ratio=4.12x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.16x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.931, Ratio=4.23x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.934, Ratio=3.95x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.909, Ratio=3.97x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.924, Ratio=4.17x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.937, Ratio=4.14x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.929, Ratio=4.14x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.945, Ratio=4.34x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.917, Ratio=4.07x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.920, Ratio=4.14x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.943, Ratio=4.12x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.922, Ratio=4.09x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.933, Ratio=4.08x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.943, Ratio=4.18x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.910, Ratio=4.01x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.913, Ratio=4.07x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.909, Ratio=4.05x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.912, Ratio=3.88x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.937, Ratio=4.09x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.934, Ratio=4.15x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.929, Ratio=4.19x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.927, Ratio=3.96x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.931, Ratio=4.08x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.930, Ratio=4.08x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.938, Ratio=4.26x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.943, Ratio=4.32x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.935, Ratio=4.28x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.918, Ratio=4.14x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.942, Ratio=4.06x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.934, Ratio=4.19x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.932, Ratio=4.17x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.921, Ratio=4.00x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.955, Ratio=4.34x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.937, Ratio=4.27x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.948, Ratio=4.31x, Gap=-3.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.915, Ratio=4.06x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.924, Ratio=4.10x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.931, Ratio=4.20x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.930, Ratio=4.10x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.960, Ratio=4.48x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.933, Ratio=3.95x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.939, Ratio=4.19x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.943, Ratio=4.25x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.942, Ratio=4.05x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.922, Ratio=4.06x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.948, Ratio=4.31x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.921, Ratio=3.99x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.942, Ratio=4.24x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.941, Ratio=4.23x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.943, Ratio=4.22x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.924, Ratio=4.12x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.922, Ratio=4.05x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.900, Ratio=3.91x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.926, Ratio=4.05x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.927, Ratio=4.16x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.911, Ratio=4.00x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.929, Ratio=4.19x, Gap=-3.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.916, Ratio=4.04x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.943, Ratio=4.30x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.937, Ratio=4.10x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.941, Ratio=4.23x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.924, Ratio=4.13x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.922, Ratio=4.06x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.941, Ratio=4.32x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.945, Ratio=4.21x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.917, Ratio=4.17x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.927, Ratio=4.22x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.914, Ratio=4.08x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.945, Ratio=4.37x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.941, Ratio=4.25x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.956, Ratio=4.37x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.927, Ratio=4.09x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.915, Ratio=3.96x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.923, Ratio=4.08x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.15x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.901, Ratio=3.97x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.918, Ratio=4.18x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.937, Ratio=4.04x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.923, Ratio=4.14x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.928, Ratio=4.04x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.906, Ratio=3.88x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.930, Ratio=4.16x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.894, Ratio=3.86x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.926, Ratio=4.23x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.934, Ratio=4.10x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.927, Ratio=4.17x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.951, Ratio=4.22x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.919, Ratio=4.07x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.944, Ratio=4.18x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.939, Ratio=4.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.934, Ratio=4.21x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.919, Ratio=4.01x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.889, Ratio=3.87x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.909, Ratio=3.92x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.929, Ratio=4.12x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.904, Ratio=3.86x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.941, Ratio=4.28x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.922, Ratio=4.00x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.938, Ratio=4.19x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.949, Ratio=4.36x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.939, Ratio=4.24x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.936, Ratio=4.09x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.950, Ratio=4.32x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.912, Ratio=4.03x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.931, Ratio=4.12x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.919, Ratio=4.11x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.907, Ratio=4.09x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.919, Ratio=4.11x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.913, Ratio=4.01x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.917, Ratio=4.06x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.950, Ratio=4.31x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.913, Ratio=4.03x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.943, Ratio=4.09x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.934, Ratio=4.08x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.926, Ratio=3.87x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.929, Ratio=4.34x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.916, Ratio=4.08x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.930, Ratio=4.09x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.897, Ratio=3.92x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.922, Ratio=4.01x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.905, Ratio=3.82x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.938, Ratio=4.14x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.922, Ratio=4.07x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.923, Ratio=4.00x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.918, Ratio=4.02x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.931, Ratio=4.15x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.916, Ratio=4.08x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.952, Ratio=4.15x, Gap=-3.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.918, Ratio=4.15x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.938, Ratio=4.16x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.910, Ratio=3.99x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.915, Ratio=4.06x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.946, Ratio=4.22x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.922, Ratio=3.97x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.937, Ratio=4.17x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.924, Ratio=4.02x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.915, Ratio=3.98x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.912, Ratio=4.01x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.943, Ratio=4.21x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.943, Ratio=4.17x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.913, Ratio=3.97x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.932, Ratio=3.98x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.915, Ratio=4.04x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.932, Ratio=4.08x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.929, Ratio=4.10x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.902, Ratio=3.98x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.933, Ratio=4.23x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.920, Ratio=4.14x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.925, Ratio=3.89x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.943, Ratio=4.39x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.938, Ratio=4.28x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.912, Ratio=4.02x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.928, Ratio=4.11x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.907, Ratio=3.99x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.942, Ratio=4.28x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.907, Ratio=4.03x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.932, Ratio=3.98x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.944, Ratio=4.26x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.926, Ratio=4.10x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.920, Ratio=4.05x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.911, Ratio=3.95x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.939, Ratio=4.21x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.955, Ratio=4.40x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.938, Ratio=4.18x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.932, Ratio=4.07x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.957, Ratio=4.34x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.933, Ratio=4.12x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.904, Ratio=3.90x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.940, Ratio=4.15x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.942, Ratio=4.35x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.912, Ratio=3.99x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.923, Ratio=3.97x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.934, Ratio=4.26x, Gap=-3.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.924, Ratio=4.21x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.938, Ratio=4.30x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.938, Ratio=4.23x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.948, Ratio=4.31x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.938, Ratio=4.21x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.924, Ratio=4.08x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.928, Ratio=4.07x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.892, Ratio=3.96x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.936, Ratio=4.08x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.922, Ratio=4.05x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.913, Ratio=3.97x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.919, Ratio=3.96x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.945, Ratio=4.27x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.943, Ratio=4.31x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.932, Ratio=4.20x, Gap=-3.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.949, Ratio=4.29x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.932, Ratio=3.98x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.917, Ratio=4.08x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.945, Ratio=4.18x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.929, Ratio=4.22x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.930, Ratio=4.10x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.921, Ratio=4.08x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.919, Ratio=4.12x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.910, Ratio=4.15x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.945, Ratio=4.35x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.932, Ratio=4.24x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.944, Ratio=4.16x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.922, Ratio=4.09x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.925, Ratio=4.06x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.947, Ratio=4.35x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.937, Ratio=4.12x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.914, Ratio=3.93x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.924, Ratio=4.09x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.915, Ratio=4.08x, Gap=-3.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.925, Ratio=4.06x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.938, Ratio=4.23x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.943, Ratio=4.00x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.941, Ratio=4.28x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.929, Ratio=4.24x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.917, Ratio=4.05x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.937, Ratio=4.20x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.934, Ratio=4.26x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.928, Ratio=4.04x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.936, Ratio=4.18x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.925, Ratio=4.13x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.925, Ratio=4.03x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.911, Ratio=3.97x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.925, Ratio=4.16x, Gap=-3.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.940, Ratio=4.36x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.928, Ratio=4.21x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.897, Ratio=3.85x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.937, Ratio=4.23x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.937, Ratio=4.11x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.949, Ratio=4.19x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.928, Ratio=4.08x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.938, Ratio=4.27x, Gap=-3.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.923, Ratio=4.01x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.941, Ratio=4.41x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.923, Ratio=4.13x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.925, Ratio=4.16x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.901, Ratio=3.92x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.922, Ratio=4.03x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.914, Ratio=3.96x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.936, Ratio=4.21x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.935, Ratio=4.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.931, Ratio=4.13x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.940, Ratio=4.10x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.918, Ratio=4.13x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.920, Ratio=4.03x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.947, Ratio=4.09x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.938, Ratio=4.22x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.937, Ratio=4.35x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.935, Ratio=4.23x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.942, Ratio=4.24x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.919, Ratio=4.08x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.917, Ratio=4.16x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.901, Ratio=3.87x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.941, Ratio=4.18x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.931, Ratio=4.49x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.918, Ratio=3.90x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.921, Ratio=4.01x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.934, Ratio=4.15x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.919, Ratio=3.94x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.905, Ratio=3.91x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.917, Ratio=4.06x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.936, Ratio=4.14x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.921, Ratio=4.09x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.935, Ratio=3.99x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.17x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.915, Ratio=3.96x, Gap=-3.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.927, Ratio=4.11x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.923, Ratio=4.06x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.908, Ratio=4.01x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.912, Ratio=4.06x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.925, Ratio=4.26x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.916, Ratio=3.87x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.940, Ratio=4.24x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.938, Ratio=4.34x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.902, Ratio=3.91x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.13x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.933, Ratio=4.10x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.924, Ratio=4.16x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.934, Ratio=4.09x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.928, Ratio=4.26x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.935, Ratio=4.27x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.966, Ratio=4.52x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.940, Ratio=4.32x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.915, Ratio=4.02x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.931, Ratio=4.03x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.936, Ratio=4.27x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.938, Ratio=4.08x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.909, Ratio=3.85x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.934, Ratio=4.16x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.946, Ratio=4.23x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.915, Ratio=4.10x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.948, Ratio=4.23x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.927, Ratio=4.10x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.914, Ratio=4.14x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.924, Ratio=3.97x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.939, Ratio=4.16x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.938, Ratio=4.19x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.942, Ratio=4.18x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.936, Ratio=4.18x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.939, Ratio=4.36x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.916, Ratio=4.01x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.933, Ratio=4.09x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.915, Ratio=4.09x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.949, Ratio=4.30x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.925, Ratio=4.08x, Gap=-3.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.944, Ratio=4.27x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.921, Ratio=3.93x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.13x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.903, Ratio=3.92x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.923, Ratio=4.11x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.922, Ratio=4.04x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.930, Ratio=4.05x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.924, Ratio=4.08x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.915, Ratio=4.16x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.916, Ratio=4.21x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.931, Ratio=4.12x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.933, Ratio=4.03x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.934, Ratio=4.29x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.919, Ratio=4.09x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.910, Ratio=4.07x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.949, Ratio=4.46x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.926, Ratio=4.03x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.930, Ratio=4.20x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.915, Ratio=3.88x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.927, Ratio=4.17x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.940, Ratio=4.25x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.908, Ratio=3.95x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.919, Ratio=3.88x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.934, Ratio=4.19x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.926, Ratio=4.22x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.923, Ratio=3.98x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.917, Ratio=4.11x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.924, Ratio=4.11x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.899, Ratio=3.92x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.940, Ratio=4.33x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.912, Ratio=3.95x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.930, Ratio=4.12x, Gap=-3.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.934, Ratio=4.03x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.908, Ratio=4.02x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.961, Ratio=4.39x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.920, Ratio=4.06x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.926, Ratio=3.99x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.943, Ratio=4.11x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.926, Ratio=3.98x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.915, Ratio=4.03x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.929, Ratio=4.05x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.929, Ratio=4.19x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.912, Ratio=4.09x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.899, Ratio=3.86x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.917, Ratio=4.07x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.918, Ratio=3.93x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.911, Ratio=3.95x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.923, Ratio=4.09x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.934, Ratio=4.08x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.928, Ratio=4.24x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.947, Ratio=4.24x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.929, Ratio=4.03x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.08x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.958, Ratio=4.34x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.910, Ratio=4.02x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.948, Ratio=4.20x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.915, Ratio=4.18x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.926, Ratio=3.93x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.946, Ratio=4.24x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.922, Ratio=4.05x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.927, Ratio=4.23x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.910, Ratio=3.95x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.939, Ratio=4.15x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.932, Ratio=4.19x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.904, Ratio=4.00x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.946, Ratio=4.42x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.931, Ratio=4.08x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.906, Ratio=4.04x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.913, Ratio=3.86x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.900, Ratio=4.00x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.930, Ratio=4.12x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.924, Ratio=4.14x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.915, Ratio=4.14x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.937, Ratio=4.15x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.921, Ratio=4.06x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.913, Ratio=4.05x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.925, Ratio=4.11x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.930, Ratio=4.03x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.932, Ratio=4.25x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.918, Ratio=3.96x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.937, Ratio=4.26x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.935, Ratio=4.17x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.899, Ratio=3.91x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.915, Ratio=3.98x, Gap=-3.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.944, Ratio=4.18x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.914, Ratio=3.96x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.929, Ratio=4.08x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.923, Ratio=4.02x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.924, Ratio=4.06x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.937, Ratio=4.14x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.927, Ratio=4.06x, Gap=-3.585

============================================================
Epoch 14/20 completed in 31.9s
Train: Loss=0.9571 (C:0.9571, R:0.0105) Ratio=3.48x
Val:   Loss=0.9017 (C:0.9017, R:0.0105) Ratio=4.28x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.9017)
============================================================

Epoch 15 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.923, Ratio=3.91x, Gap=-4.104
Batch   0/537: Loss=0.9271 (C:0.9271, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.908, Ratio=3.71x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.928, Ratio=3.85x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.917, Ratio=3.85x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.906, Ratio=3.82x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.915, Ratio=4.03x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.882, Ratio=3.55x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.893, Ratio=3.70x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.921, Ratio=3.82x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.897, Ratio=3.78x, Gap=-3.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.883, Ratio=3.67x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.933, Ratio=3.91x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.896, Ratio=3.57x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.917, Ratio=3.64x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.922, Ratio=3.65x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.930, Ratio=3.86x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.919, Ratio=3.95x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.944, Ratio=4.03x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.925, Ratio=3.75x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.925, Ratio=3.81x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.917, Ratio=4.07x, Gap=-3.887
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.940, Ratio=3.80x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.931, Ratio=3.86x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.917, Ratio=3.77x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.938, Ratio=3.94x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.915, Ratio=3.83x, Gap=-4.134
Batch  25/537: Loss=0.9438 (C:0.9438, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.904, Ratio=3.85x, Gap=-4.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.896, Ratio=3.85x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.927, Ratio=3.91x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.913, Ratio=3.96x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.925, Ratio=3.79x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.922, Ratio=3.73x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.932, Ratio=3.92x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.894, Ratio=3.68x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.919, Ratio=3.76x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.927, Ratio=3.99x, Gap=-4.364
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.924, Ratio=3.82x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.912, Ratio=3.72x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.916, Ratio=3.91x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.942, Ratio=3.94x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.927, Ratio=3.77x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.923, Ratio=3.89x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.922, Ratio=3.95x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.907, Ratio=3.79x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.907, Ratio=3.74x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.934, Ratio=4.02x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.901, Ratio=3.69x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.886, Ratio=3.59x, Gap=-3.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.920, Ratio=3.88x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.913, Ratio=3.79x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.921, Ratio=3.70x, Gap=-3.854
Batch  50/537: Loss=0.9692 (C:0.9692, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.926, Ratio=3.89x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.910, Ratio=3.94x, Gap=-3.900
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.908, Ratio=3.81x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.902, Ratio=3.80x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.876, Ratio=3.54x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.899, Ratio=3.69x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.914, Ratio=3.57x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.939, Ratio=3.94x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.929, Ratio=3.89x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.926, Ratio=3.84x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.933, Ratio=4.05x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.901, Ratio=3.71x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.901, Ratio=3.64x, Gap=-4.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.898, Ratio=3.76x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.918, Ratio=3.86x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.910, Ratio=3.64x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.916, Ratio=3.73x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.941, Ratio=4.08x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.931, Ratio=4.03x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.909, Ratio=3.79x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.906, Ratio=3.69x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.938, Ratio=3.89x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.888, Ratio=3.72x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.907, Ratio=3.80x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.876, Ratio=3.55x, Gap=-4.037
Batch  75/537: Loss=0.9948 (C:0.9948, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.897, Ratio=3.73x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.899, Ratio=3.75x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.916, Ratio=3.81x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.923, Ratio=3.97x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.891, Ratio=3.63x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.926, Ratio=3.99x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.893, Ratio=3.80x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.913, Ratio=3.84x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.929, Ratio=3.79x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.913, Ratio=3.81x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.911, Ratio=3.76x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.949, Ratio=4.01x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.937, Ratio=3.86x, Gap=-4.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.935, Ratio=3.75x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.889, Ratio=3.70x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.919, Ratio=3.76x, Gap=-4.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.930, Ratio=3.90x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.917, Ratio=3.66x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.925, Ratio=3.92x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.907, Ratio=3.83x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.928, Ratio=3.87x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.926, Ratio=3.89x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.902, Ratio=3.77x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.907, Ratio=3.81x, Gap=-4.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.864, Ratio=3.50x, Gap=-4.259
Batch 100/537: Loss=0.9990 (C:0.9990, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.902, Ratio=3.78x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.932, Ratio=3.89x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.897, Ratio=3.69x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.937, Ratio=3.96x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.899, Ratio=3.58x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.915, Ratio=3.64x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.937, Ratio=3.89x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.923, Ratio=3.93x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.912, Ratio=3.69x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.905, Ratio=3.70x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.926, Ratio=3.91x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.938, Ratio=3.96x, Gap=-4.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.913, Ratio=3.93x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.892, Ratio=3.65x, Gap=-3.948
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.897, Ratio=3.56x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.936, Ratio=3.84x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.938, Ratio=3.98x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.908, Ratio=3.71x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.928, Ratio=3.83x, Gap=-5.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.896, Ratio=3.77x, Gap=-3.890
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.936, Ratio=3.94x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.906, Ratio=3.79x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.907, Ratio=3.76x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.930, Ratio=3.90x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.931, Ratio=3.78x, Gap=-4.400
Batch 125/537: Loss=0.9501 (C:0.9501, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.916, Ratio=3.75x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.885, Ratio=3.68x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.915, Ratio=3.93x, Gap=-3.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.905, Ratio=3.71x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.906, Ratio=3.80x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.926, Ratio=3.95x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.908, Ratio=3.62x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.925, Ratio=3.75x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.910, Ratio=3.63x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.935, Ratio=3.87x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.940, Ratio=3.88x, Gap=-3.895
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.935, Ratio=3.77x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.926, Ratio=3.86x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.905, Ratio=3.65x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.935, Ratio=3.90x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.932, Ratio=3.95x, Gap=-4.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.929, Ratio=3.92x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.914, Ratio=3.89x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.898, Ratio=3.63x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.922, Ratio=3.83x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.887, Ratio=3.82x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.942, Ratio=4.02x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.904, Ratio=3.91x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.923, Ratio=3.78x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.897, Ratio=3.74x, Gap=-4.327
Batch 150/537: Loss=0.9606 (C:0.9606, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.907, Ratio=3.62x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.929, Ratio=3.79x, Gap=-4.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.925, Ratio=3.84x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.917, Ratio=3.77x, Gap=-4.053
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.925, Ratio=3.81x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.919, Ratio=3.86x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.918, Ratio=3.86x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.917, Ratio=3.78x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.931, Ratio=3.82x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.912, Ratio=3.80x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.923, Ratio=3.96x, Gap=-4.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.890, Ratio=3.57x, Gap=-3.864
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.925, Ratio=4.02x, Gap=-4.254
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.893, Ratio=3.67x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.923, Ratio=3.85x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.921, Ratio=4.03x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.924, Ratio=4.11x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.897, Ratio=3.81x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.897, Ratio=3.77x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.925, Ratio=3.75x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.943, Ratio=3.90x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.922, Ratio=3.77x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.909, Ratio=3.61x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.921, Ratio=3.81x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.910, Ratio=3.83x, Gap=-3.848
Batch 175/537: Loss=0.9410 (C:0.9410, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.943, Ratio=3.91x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.926, Ratio=3.86x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.936, Ratio=3.99x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.926, Ratio=3.76x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.954, Ratio=4.00x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.919, Ratio=3.73x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.918, Ratio=3.79x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.918, Ratio=3.65x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.934, Ratio=3.96x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.907, Ratio=3.93x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.920, Ratio=3.94x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.919, Ratio=3.71x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.918, Ratio=3.87x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.892, Ratio=3.70x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.916, Ratio=4.01x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.921, Ratio=3.82x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.919, Ratio=3.85x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.920, Ratio=3.91x, Gap=-3.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.914, Ratio=3.81x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.922, Ratio=3.83x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.919, Ratio=3.76x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.917, Ratio=3.63x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.916, Ratio=3.78x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.921, Ratio=3.91x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.909, Ratio=3.68x, Gap=-3.898
Batch 200/537: Loss=0.9646 (C:0.9646, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.925, Ratio=3.86x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.907, Ratio=3.77x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.917, Ratio=3.92x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.935, Ratio=3.86x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.907, Ratio=3.70x, Gap=-3.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.920, Ratio=3.77x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.909, Ratio=3.71x, Gap=-4.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.920, Ratio=3.87x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.927, Ratio=3.89x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.918, Ratio=3.81x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.911, Ratio=3.64x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.908, Ratio=3.74x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.906, Ratio=3.79x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.903, Ratio=3.81x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.876, Ratio=3.55x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.938, Ratio=4.05x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.912, Ratio=3.73x, Gap=-3.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.922, Ratio=3.97x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.914, Ratio=4.03x, Gap=-4.021
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.903, Ratio=3.62x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.907, Ratio=3.73x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.901, Ratio=3.73x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.909, Ratio=3.74x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.915, Ratio=3.81x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.882, Ratio=3.55x, Gap=-3.954
Batch 225/537: Loss=0.9936 (C:0.9936, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.926, Ratio=4.09x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.896, Ratio=3.71x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.902, Ratio=3.62x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.912, Ratio=3.80x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.922, Ratio=3.89x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.911, Ratio=3.67x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.915, Ratio=3.71x, Gap=-4.261
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.918, Ratio=3.94x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.900, Ratio=3.82x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.923, Ratio=3.83x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.924, Ratio=3.92x, Gap=-3.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.895, Ratio=3.71x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.925, Ratio=3.82x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.932, Ratio=3.84x, Gap=-3.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.941, Ratio=4.09x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.953, Ratio=3.91x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.941, Ratio=3.84x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.932, Ratio=3.86x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.918, Ratio=3.68x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.917, Ratio=3.67x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.910, Ratio=3.79x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.912, Ratio=3.64x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.930, Ratio=3.75x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.905, Ratio=3.75x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.919, Ratio=3.92x, Gap=-3.946
Batch 250/537: Loss=0.9310 (C:0.9310, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.933, Ratio=4.01x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.899, Ratio=3.78x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.917, Ratio=3.85x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.915, Ratio=3.81x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.919, Ratio=3.85x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.931, Ratio=3.99x, Gap=-3.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.925, Ratio=3.85x, Gap=-4.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.924, Ratio=3.89x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.931, Ratio=3.75x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.923, Ratio=3.80x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.940, Ratio=4.00x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.906, Ratio=3.79x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.887, Ratio=3.69x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.903, Ratio=3.64x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.885, Ratio=3.75x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.926, Ratio=3.89x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.913, Ratio=3.82x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.914, Ratio=3.68x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.919, Ratio=3.75x, Gap=-3.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.930, Ratio=3.78x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.930, Ratio=3.86x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.905, Ratio=3.73x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.925, Ratio=3.84x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.913, Ratio=3.95x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.909, Ratio=3.87x, Gap=-3.847
Batch 275/537: Loss=0.9376 (C:0.9376, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.933, Ratio=3.90x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.903, Ratio=3.68x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.924, Ratio=4.00x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.910, Ratio=3.76x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.904, Ratio=3.76x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.913, Ratio=3.79x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.910, Ratio=3.59x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.913, Ratio=3.72x, Gap=-4.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.906, Ratio=3.66x, Gap=-3.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.907, Ratio=3.74x, Gap=-4.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.914, Ratio=3.69x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.901, Ratio=3.76x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.898, Ratio=3.68x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.927, Ratio=3.78x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.923, Ratio=3.93x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.927, Ratio=3.92x, Gap=-3.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.924, Ratio=3.89x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.940, Ratio=3.90x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.886, Ratio=3.69x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.923, Ratio=3.79x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.912, Ratio=3.68x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.921, Ratio=3.81x, Gap=-4.026
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.934, Ratio=3.98x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.924, Ratio=3.90x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.919, Ratio=3.91x, Gap=-4.126
Batch 300/537: Loss=0.9300 (C:0.9300, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.904, Ratio=3.65x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.908, Ratio=3.87x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.904, Ratio=3.68x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.919, Ratio=3.70x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.907, Ratio=3.67x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.905, Ratio=3.89x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.920, Ratio=3.91x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.884, Ratio=3.58x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.890, Ratio=3.66x, Gap=-5.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.933, Ratio=3.78x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.928, Ratio=3.92x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.912, Ratio=3.65x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.921, Ratio=3.93x, Gap=-3.953
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.934, Ratio=3.80x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.874, Ratio=3.58x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.921, Ratio=3.83x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.938, Ratio=3.91x, Gap=-5.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.908, Ratio=3.71x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.924, Ratio=3.78x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.912, Ratio=3.86x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.884, Ratio=3.58x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.918, Ratio=3.83x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.910, Ratio=3.74x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.927, Ratio=3.93x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.924, Ratio=4.04x, Gap=-3.878
Batch 325/537: Loss=0.9122 (C:0.9122, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.908, Ratio=3.72x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.897, Ratio=3.68x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.920, Ratio=3.82x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.941, Ratio=4.10x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.914, Ratio=3.87x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.906, Ratio=3.67x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.908, Ratio=3.66x, Gap=-4.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.933, Ratio=3.80x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.902, Ratio=3.78x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.917, Ratio=3.75x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.914, Ratio=3.89x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.911, Ratio=3.76x, Gap=-4.043
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.920, Ratio=3.86x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.923, Ratio=3.70x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.920, Ratio=3.78x, Gap=-4.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.913, Ratio=3.71x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.920, Ratio=3.82x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.901, Ratio=3.62x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.927, Ratio=3.84x, Gap=-3.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.911, Ratio=3.76x, Gap=-3.893
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.901, Ratio=3.62x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.882, Ratio=3.63x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.889, Ratio=3.64x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.905, Ratio=3.73x, Gap=-4.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.902, Ratio=3.65x, Gap=-4.694
Batch 350/537: Loss=0.9730 (C:0.9730, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.913, Ratio=3.56x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.920, Ratio=3.71x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.929, Ratio=3.85x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.935, Ratio=3.88x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.934, Ratio=3.93x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.936, Ratio=3.84x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.933, Ratio=3.94x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.925, Ratio=3.88x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.918, Ratio=3.79x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.904, Ratio=3.75x, Gap=-4.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.922, Ratio=3.96x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.902, Ratio=3.64x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.916, Ratio=3.75x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.893, Ratio=3.78x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.929, Ratio=3.89x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.908, Ratio=3.91x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.904, Ratio=3.80x, Gap=-3.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.921, Ratio=3.85x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.916, Ratio=3.79x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.906, Ratio=3.67x, Gap=-3.971
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.903, Ratio=3.77x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.939, Ratio=3.90x, Gap=-3.962
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.899, Ratio=3.59x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.891, Ratio=3.54x, Gap=-3.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.921, Ratio=3.85x, Gap=-3.939
Batch 375/537: Loss=0.9388 (C:0.9388, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.915, Ratio=3.88x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.918, Ratio=3.79x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.919, Ratio=3.78x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.880, Ratio=3.60x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.930, Ratio=3.77x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.905, Ratio=3.79x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.926, Ratio=3.85x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.895, Ratio=3.69x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.931, Ratio=3.81x, Gap=-4.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.910, Ratio=3.68x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.938, Ratio=3.94x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.913, Ratio=3.89x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.889, Ratio=3.62x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.886, Ratio=3.63x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.893, Ratio=3.70x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.918, Ratio=3.84x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.918, Ratio=4.02x, Gap=-3.976
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.917, Ratio=3.83x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.924, Ratio=3.83x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.925, Ratio=4.00x, Gap=-3.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.929, Ratio=3.83x, Gap=-3.945
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.920, Ratio=3.71x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.937, Ratio=3.99x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.534, Neg=1.922, Ratio=3.60x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.913, Ratio=3.69x, Gap=-3.989
Batch 400/537: Loss=0.9669 (C:0.9669, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.900, Ratio=3.64x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.918, Ratio=3.69x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.904, Ratio=3.60x, Gap=-4.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.885, Ratio=3.56x, Gap=-3.921
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.907, Ratio=3.72x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.910, Ratio=3.68x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.911, Ratio=3.73x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.883, Ratio=3.61x, Gap=-3.863
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.912, Ratio=3.76x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.907, Ratio=3.80x, Gap=-3.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.909, Ratio=3.75x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.890, Ratio=3.63x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.935, Ratio=3.99x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.916, Ratio=3.82x, Gap=-3.903
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.909, Ratio=3.79x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.899, Ratio=3.78x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.917, Ratio=3.71x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.917, Ratio=3.89x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.909, Ratio=3.75x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.917, Ratio=3.79x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.903, Ratio=3.65x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.899, Ratio=3.74x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.906, Ratio=3.66x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.881, Ratio=3.62x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.928, Ratio=3.68x, Gap=-4.095
Batch 425/537: Loss=0.9680 (C:0.9680, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.914, Ratio=3.68x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.903, Ratio=3.68x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.921, Ratio=3.69x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.906, Ratio=3.79x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.919, Ratio=3.82x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.943, Ratio=3.82x, Gap=-3.897
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.906, Ratio=3.78x, Gap=-3.931
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.903, Ratio=3.81x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.931, Ratio=3.85x, Gap=-4.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.904, Ratio=3.80x, Gap=-3.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.900, Ratio=3.67x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.917, Ratio=3.75x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.940, Ratio=4.08x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.898, Ratio=3.60x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.909, Ratio=3.83x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.890, Ratio=3.53x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.932, Ratio=3.83x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.935, Ratio=3.80x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.915, Ratio=3.67x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.949, Ratio=4.03x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.920, Ratio=3.83x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.929, Ratio=3.79x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.912, Ratio=3.78x, Gap=-3.940
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.902, Ratio=3.69x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.912, Ratio=3.79x, Gap=-4.059
Batch 450/537: Loss=0.9516 (C:0.9516, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.896, Ratio=3.66x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.912, Ratio=3.67x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.892, Ratio=3.64x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.919, Ratio=3.84x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.905, Ratio=3.84x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.910, Ratio=3.81x, Gap=-4.231
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.907, Ratio=3.74x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.911, Ratio=3.74x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.913, Ratio=3.66x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.921, Ratio=3.86x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.926, Ratio=3.74x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.920, Ratio=3.66x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.911, Ratio=3.81x, Gap=-3.990
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.933, Ratio=4.03x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.887, Ratio=3.50x, Gap=-4.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.925, Ratio=3.93x, Gap=-3.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.878, Ratio=3.50x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.921, Ratio=3.81x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.918, Ratio=3.77x, Gap=-3.911
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.888, Ratio=3.73x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.943, Ratio=4.03x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.896, Ratio=3.81x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.931, Ratio=3.87x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.922, Ratio=3.98x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.929, Ratio=3.91x, Gap=-4.415
Batch 475/537: Loss=0.9282 (C:0.9282, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.911, Ratio=3.75x, Gap=-4.037
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.923, Ratio=4.00x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.913, Ratio=3.76x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.921, Ratio=3.75x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.917, Ratio=3.77x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.933, Ratio=3.89x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.903, Ratio=3.81x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.946, Ratio=3.89x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.916, Ratio=3.83x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.931, Ratio=3.86x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.914, Ratio=3.77x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.903, Ratio=3.65x, Gap=-4.131
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.921, Ratio=3.73x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.907, Ratio=3.64x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.920, Ratio=3.74x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.902, Ratio=3.75x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.928, Ratio=3.86x, Gap=-4.004
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.926, Ratio=3.85x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.913, Ratio=3.78x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.911, Ratio=3.67x, Gap=-4.879
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.905, Ratio=3.58x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.899, Ratio=3.76x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.900, Ratio=3.65x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.917, Ratio=3.74x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.936, Ratio=3.86x, Gap=-4.096
Batch 500/537: Loss=0.9369 (C:0.9369, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.890, Ratio=3.67x, Gap=-4.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.922, Ratio=3.84x, Gap=-4.128
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.900, Ratio=3.62x, Gap=-4.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.914, Ratio=3.73x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.930, Ratio=3.80x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.938, Ratio=3.94x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.907, Ratio=3.86x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.906, Ratio=3.81x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.901, Ratio=3.74x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.901, Ratio=3.72x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.916, Ratio=3.83x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.920, Ratio=3.78x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.919, Ratio=3.69x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.925, Ratio=3.84x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.902, Ratio=3.70x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.541, Neg=1.903, Ratio=3.52x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.902, Ratio=3.79x, Gap=-3.886
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.543, Neg=1.899, Ratio=3.50x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.926, Ratio=3.93x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.914, Ratio=3.72x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.913, Ratio=3.77x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.909, Ratio=3.63x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.539, Neg=1.870, Ratio=3.47x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.907, Ratio=3.80x, Gap=-4.024
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.927, Ratio=3.66x, Gap=-4.256
Batch 525/537: Loss=0.9704 (C:0.9704, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.887, Ratio=3.67x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.902, Ratio=3.64x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.903, Ratio=3.70x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.929, Ratio=3.93x, Gap=-3.998
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.924, Ratio=3.79x, Gap=-4.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.927, Ratio=3.88x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.934, Ratio=3.91x, Gap=-4.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.910, Ratio=3.71x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.917, Ratio=3.77x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.909, Ratio=3.66x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.907, Ratio=3.68x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.925, Ratio=4.13x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.947, Ratio=4.34x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.909, Ratio=4.16x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.942, Ratio=4.29x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.933, Ratio=4.32x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.935, Ratio=4.23x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.942, Ratio=4.19x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.921, Ratio=4.26x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.910, Ratio=4.12x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.16x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.941, Ratio=4.21x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.933, Ratio=4.36x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.932, Ratio=4.24x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.942, Ratio=4.28x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.915, Ratio=4.07x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.926, Ratio=4.11x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.16x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.902, Ratio=4.10x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.942, Ratio=4.34x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.918, Ratio=4.08x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.932, Ratio=4.17x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.931, Ratio=4.26x, Gap=-3.446
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.913, Ratio=4.22x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.925, Ratio=4.19x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.905, Ratio=3.93x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.922, Ratio=3.96x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.940, Ratio=4.19x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.949, Ratio=4.38x, Gap=-3.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.910, Ratio=4.06x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.927, Ratio=4.05x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.906, Ratio=4.06x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.932, Ratio=4.28x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.935, Ratio=4.29x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.915, Ratio=4.06x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.917, Ratio=3.95x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.944, Ratio=4.17x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.926, Ratio=4.14x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.916, Ratio=3.97x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.951, Ratio=4.30x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.920, Ratio=4.17x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.910, Ratio=4.09x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.940, Ratio=4.36x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.928, Ratio=4.17x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.926, Ratio=4.19x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.925, Ratio=4.25x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.921, Ratio=4.11x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.931, Ratio=4.19x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.931, Ratio=4.22x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.911, Ratio=3.97x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.941, Ratio=4.32x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.926, Ratio=4.23x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.928, Ratio=4.19x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.905, Ratio=3.87x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.922, Ratio=3.93x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.916, Ratio=4.18x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.899, Ratio=3.88x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.938, Ratio=4.33x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.941, Ratio=4.15x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.916, Ratio=3.98x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.931, Ratio=4.23x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.934, Ratio=4.11x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.899, Ratio=3.96x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.922, Ratio=4.19x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.950, Ratio=4.46x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.908, Ratio=4.14x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.939, Ratio=4.36x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.931, Ratio=4.16x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.904, Ratio=4.04x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.946, Ratio=4.36x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.933, Ratio=4.14x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.935, Ratio=4.08x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.924, Ratio=4.05x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.905, Ratio=3.85x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.908, Ratio=4.09x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.912, Ratio=3.94x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.933, Ratio=4.28x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.916, Ratio=4.10x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.928, Ratio=4.11x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.934, Ratio=4.15x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.945, Ratio=4.25x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.921, Ratio=4.00x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.949, Ratio=4.30x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.910, Ratio=4.00x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.941, Ratio=4.27x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.922, Ratio=4.13x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.925, Ratio=4.23x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.908, Ratio=3.83x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.929, Ratio=4.28x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.938, Ratio=4.18x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.909, Ratio=4.04x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.933, Ratio=4.26x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.925, Ratio=4.20x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.910, Ratio=4.05x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.925, Ratio=4.04x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.942, Ratio=4.27x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.947, Ratio=4.28x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.930, Ratio=4.26x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.954, Ratio=4.49x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.943, Ratio=4.21x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.941, Ratio=4.21x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.921, Ratio=4.18x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.932, Ratio=4.24x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.937, Ratio=4.20x, Gap=-3.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.935, Ratio=4.37x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.932, Ratio=4.43x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.926, Ratio=4.24x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.913, Ratio=4.09x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.921, Ratio=4.08x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.917, Ratio=4.12x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.937, Ratio=4.23x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.935, Ratio=4.22x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.941, Ratio=4.21x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.935, Ratio=4.25x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.943, Ratio=4.24x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.908, Ratio=4.02x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.930, Ratio=4.17x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.934, Ratio=4.09x, Gap=-3.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.910, Ratio=4.06x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.903, Ratio=3.93x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.926, Ratio=4.10x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.922, Ratio=3.99x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.901, Ratio=3.98x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.932, Ratio=4.35x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.919, Ratio=4.26x, Gap=-3.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.928, Ratio=4.24x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.906, Ratio=3.97x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.954, Ratio=4.25x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.919, Ratio=3.98x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=1.950, Ratio=4.57x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.932, Ratio=4.04x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.932, Ratio=4.29x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.910, Ratio=4.00x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.951, Ratio=4.29x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.933, Ratio=4.28x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.924, Ratio=4.16x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.921, Ratio=3.95x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.922, Ratio=4.17x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.949, Ratio=4.38x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.922, Ratio=4.19x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.928, Ratio=4.09x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.923, Ratio=4.01x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.923, Ratio=4.01x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.913, Ratio=4.07x, Gap=-3.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.923, Ratio=4.13x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.947, Ratio=4.34x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.894, Ratio=3.91x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.946, Ratio=4.30x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.938, Ratio=4.07x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.933, Ratio=4.20x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.911, Ratio=3.97x, Gap=-3.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.931, Ratio=4.19x, Gap=-3.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.927, Ratio=4.18x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.913, Ratio=4.04x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.936, Ratio=4.28x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.901, Ratio=3.90x, Gap=-3.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.917, Ratio=4.00x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.915, Ratio=3.97x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.934, Ratio=4.23x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.929, Ratio=4.04x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.932, Ratio=4.19x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.928, Ratio=4.17x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.935, Ratio=4.15x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.947, Ratio=4.44x, Gap=-3.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.933, Ratio=4.23x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.929, Ratio=4.02x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.932, Ratio=4.20x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.920, Ratio=4.11x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.923, Ratio=4.24x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.917, Ratio=4.10x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.922, Ratio=4.03x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.925, Ratio=4.23x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.905, Ratio=3.91x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.925, Ratio=3.99x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.934, Ratio=4.12x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.949, Ratio=4.22x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.918, Ratio=4.12x, Gap=-3.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.941, Ratio=4.39x, Gap=-3.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.932, Ratio=4.22x, Gap=-3.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.930, Ratio=4.13x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.930, Ratio=4.18x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.941, Ratio=4.31x, Gap=-3.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=1.961, Ratio=4.58x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.924, Ratio=4.27x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.918, Ratio=4.06x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.937, Ratio=4.26x, Gap=-3.411
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.926, Ratio=4.13x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.908, Ratio=4.09x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.900, Ratio=4.00x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.08x, Gap=-3.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.913, Ratio=4.08x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.927, Ratio=4.17x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.941, Ratio=4.16x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.912, Ratio=3.96x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.904, Ratio=3.98x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.917, Ratio=4.09x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.938, Ratio=4.11x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.915, Ratio=3.98x, Gap=-3.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.936, Ratio=4.19x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.959, Ratio=4.40x, Gap=-3.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.935, Ratio=4.20x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.930, Ratio=4.19x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.931, Ratio=4.13x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.953, Ratio=4.33x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.939, Ratio=4.23x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.939, Ratio=4.44x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.08x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.941, Ratio=4.42x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.926, Ratio=4.29x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.939, Ratio=4.42x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.928, Ratio=4.16x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.901, Ratio=4.02x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.929, Ratio=4.29x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.920, Ratio=4.04x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.920, Ratio=4.01x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.932, Ratio=4.24x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.921, Ratio=4.02x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.929, Ratio=4.32x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.919, Ratio=4.11x, Gap=-3.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.915, Ratio=4.09x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.937, Ratio=4.25x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.924, Ratio=4.05x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.930, Ratio=4.19x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.906, Ratio=4.04x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.920, Ratio=4.06x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.939, Ratio=4.18x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.926, Ratio=4.15x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.923, Ratio=4.10x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.940, Ratio=4.20x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.902, Ratio=3.89x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.949, Ratio=4.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.921, Ratio=4.12x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.15x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.931, Ratio=4.25x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.933, Ratio=4.26x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.928, Ratio=4.27x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.929, Ratio=4.12x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.944, Ratio=4.38x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.936, Ratio=4.15x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.935, Ratio=4.19x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.927, Ratio=4.08x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.927, Ratio=4.10x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.934, Ratio=4.38x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.930, Ratio=4.13x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.915, Ratio=4.05x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.946, Ratio=4.27x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.925, Ratio=4.22x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.915, Ratio=4.11x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.921, Ratio=4.30x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.897, Ratio=3.89x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.910, Ratio=3.96x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.920, Ratio=3.97x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.904, Ratio=3.99x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.920, Ratio=4.21x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.942, Ratio=4.29x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.933, Ratio=4.16x, Gap=-3.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.930, Ratio=4.16x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.914, Ratio=4.11x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.919, Ratio=4.00x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.932, Ratio=4.09x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.918, Ratio=4.10x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.941, Ratio=4.32x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.925, Ratio=4.17x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.917, Ratio=4.15x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.923, Ratio=4.29x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.927, Ratio=4.12x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.935, Ratio=4.28x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.914, Ratio=3.98x, Gap=-3.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.915, Ratio=4.02x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.926, Ratio=4.09x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.908, Ratio=4.00x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.915, Ratio=4.15x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.924, Ratio=4.13x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.923, Ratio=4.13x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.910, Ratio=4.06x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.925, Ratio=4.10x, Gap=-3.443
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.920, Ratio=4.23x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=1.945, Ratio=4.47x, Gap=-3.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.946, Ratio=4.29x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.921, Ratio=4.00x, Gap=-3.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.930, Ratio=4.18x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.920, Ratio=4.16x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.927, Ratio=4.19x, Gap=-3.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.923, Ratio=4.09x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.935, Ratio=4.20x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.918, Ratio=4.01x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.922, Ratio=4.10x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.944, Ratio=4.23x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.936, Ratio=4.21x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.930, Ratio=4.09x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.923, Ratio=4.26x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.912, Ratio=4.12x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.916, Ratio=4.13x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.934, Ratio=4.23x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.921, Ratio=4.01x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.911, Ratio=4.03x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.918, Ratio=4.22x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.929, Ratio=4.21x, Gap=-3.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.897, Ratio=4.11x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.911, Ratio=3.98x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.941, Ratio=4.22x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.949, Ratio=4.19x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.905, Ratio=4.04x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.946, Ratio=4.26x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.946, Ratio=4.50x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.937, Ratio=4.33x, Gap=-3.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.946, Ratio=4.18x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.922, Ratio=4.13x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.919, Ratio=4.13x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.933, Ratio=4.09x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.913, Ratio=4.05x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.906, Ratio=4.05x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.926, Ratio=4.17x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.936, Ratio=4.28x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.922, Ratio=4.07x, Gap=-3.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.902, Ratio=3.93x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.933, Ratio=4.20x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.929, Ratio=4.18x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.941, Ratio=4.31x, Gap=-3.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.932, Ratio=4.41x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.917, Ratio=4.18x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.920, Ratio=4.06x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.931, Ratio=4.21x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.920, Ratio=4.25x, Gap=-3.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.934, Ratio=4.09x, Gap=-3.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.935, Ratio=4.00x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.903, Ratio=3.87x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.917, Ratio=4.03x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.921, Ratio=4.18x, Gap=-3.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.908, Ratio=3.94x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.930, Ratio=4.04x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.925, Ratio=4.05x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.935, Ratio=4.09x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.932, Ratio=4.11x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.945, Ratio=4.22x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.929, Ratio=4.21x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.929, Ratio=4.21x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.942, Ratio=4.26x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.935, Ratio=4.31x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.900, Ratio=3.97x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.918, Ratio=4.07x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.918, Ratio=4.14x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.925, Ratio=3.99x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.920, Ratio=4.05x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.915, Ratio=4.26x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.923, Ratio=4.07x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.929, Ratio=4.13x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.923, Ratio=4.00x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.958, Ratio=4.48x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.929, Ratio=4.37x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.924, Ratio=4.13x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.939, Ratio=4.38x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.917, Ratio=4.10x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.916, Ratio=4.09x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.934, Ratio=4.14x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.930, Ratio=4.25x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.929, Ratio=4.20x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.917, Ratio=4.02x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.936, Ratio=4.12x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.926, Ratio=4.20x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.928, Ratio=4.19x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.926, Ratio=4.17x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.915, Ratio=3.99x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.908, Ratio=3.97x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.920, Ratio=4.05x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.914, Ratio=4.10x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.910, Ratio=3.92x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.904, Ratio=3.99x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.916, Ratio=4.10x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.920, Ratio=4.04x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.948, Ratio=4.39x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.917, Ratio=4.12x, Gap=-3.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.899, Ratio=3.88x, Gap=-3.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.925, Ratio=3.99x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.932, Ratio=4.25x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.901, Ratio=4.12x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.912, Ratio=4.15x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.940, Ratio=4.29x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.925, Ratio=4.12x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.918, Ratio=4.19x, Gap=-3.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.932, Ratio=4.21x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.933, Ratio=4.29x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.906, Ratio=4.09x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.906, Ratio=3.98x, Gap=-3.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.923, Ratio=4.05x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.920, Ratio=4.07x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.929, Ratio=4.26x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.925, Ratio=4.24x, Gap=-3.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.920, Ratio=4.13x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.916, Ratio=3.99x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.936, Ratio=4.17x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.14x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.924, Ratio=4.15x, Gap=-3.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.932, Ratio=4.26x, Gap=-3.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.938, Ratio=4.17x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.939, Ratio=4.35x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.935, Ratio=4.21x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.908, Ratio=3.87x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.917, Ratio=4.23x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.923, Ratio=4.13x, Gap=-3.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.925, Ratio=4.15x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.926, Ratio=4.14x, Gap=-3.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.938, Ratio=4.26x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.931, Ratio=4.03x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.916, Ratio=4.05x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.935, Ratio=4.29x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.940, Ratio=4.32x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.909, Ratio=4.09x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.921, Ratio=4.09x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.929, Ratio=4.28x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.938, Ratio=4.34x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.924, Ratio=3.98x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.925, Ratio=4.22x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.938, Ratio=4.22x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.914, Ratio=4.05x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.937, Ratio=4.16x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.928, Ratio=4.14x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.917, Ratio=4.11x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.932, Ratio=4.27x, Gap=-3.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.950, Ratio=4.35x, Gap=-3.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.907, Ratio=3.99x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.926, Ratio=4.06x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.924, Ratio=4.11x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.911, Ratio=4.03x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.907, Ratio=4.16x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.936, Ratio=4.24x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.914, Ratio=4.11x, Gap=-3.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.918, Ratio=4.24x, Gap=-3.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.913, Ratio=4.14x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.929, Ratio=4.27x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.924, Ratio=4.14x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.952, Ratio=4.42x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.926, Ratio=4.20x, Gap=-3.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.915, Ratio=4.19x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.910, Ratio=4.11x, Gap=-3.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.913, Ratio=4.15x, Gap=-3.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.916, Ratio=4.18x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.914, Ratio=4.09x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.907, Ratio=4.12x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.942, Ratio=4.20x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.946, Ratio=4.21x, Gap=-3.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.949, Ratio=4.42x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.936, Ratio=4.14x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.933, Ratio=4.17x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.913, Ratio=4.00x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.931, Ratio=4.19x, Gap=-3.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.936, Ratio=4.19x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.940, Ratio=4.25x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.898, Ratio=4.07x, Gap=-3.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.926, Ratio=4.17x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.914, Ratio=3.98x, Gap=-3.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.912, Ratio=4.03x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.927, Ratio=4.16x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.924, Ratio=4.07x, Gap=-3.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.910, Ratio=4.07x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.936, Ratio=4.16x, Gap=-3.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.943, Ratio=4.36x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.913, Ratio=4.02x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.916, Ratio=3.99x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.914, Ratio=4.01x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.923, Ratio=4.09x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.933, Ratio=4.44x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.952, Ratio=4.37x, Gap=-3.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.926, Ratio=4.19x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.939, Ratio=4.31x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.928, Ratio=4.14x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.929, Ratio=4.17x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.918, Ratio=4.04x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.931, Ratio=4.15x, Gap=-3.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.926, Ratio=4.28x, Gap=-3.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.926, Ratio=4.09x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.937, Ratio=4.23x, Gap=-3.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.938, Ratio=4.25x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.920, Ratio=4.01x, Gap=-3.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.900, Ratio=3.99x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.916, Ratio=3.98x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.936, Ratio=4.25x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.928, Ratio=4.28x, Gap=-3.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.922, Ratio=4.17x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.922, Ratio=4.17x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.919, Ratio=4.08x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.940, Ratio=4.18x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.927, Ratio=4.20x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.939, Ratio=4.14x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.930, Ratio=4.17x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.923, Ratio=4.18x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.925, Ratio=3.97x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.904, Ratio=3.87x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.926, Ratio=4.12x, Gap=-3.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.941, Ratio=4.18x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.921, Ratio=4.08x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.925, Ratio=4.09x, Gap=-3.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.929, Ratio=4.32x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.927, Ratio=4.06x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.942, Ratio=4.24x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.924, Ratio=4.24x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.916, Ratio=4.05x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.915, Ratio=4.15x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.928, Ratio=4.15x, Gap=-3.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.936, Ratio=4.16x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.913, Ratio=4.05x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.936, Ratio=4.24x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.931, Ratio=4.09x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.922, Ratio=4.18x, Gap=-3.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.933, Ratio=4.17x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.945, Ratio=4.24x, Gap=-3.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.922, Ratio=4.16x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.924, Ratio=4.15x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.937, Ratio=4.39x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.952, Ratio=4.40x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.934, Ratio=4.21x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.914, Ratio=3.89x, Gap=-3.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.913, Ratio=4.06x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.919, Ratio=4.15x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.941, Ratio=4.12x, Gap=-3.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.932, Ratio=4.24x, Gap=-3.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.921, Ratio=4.17x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.923, Ratio=4.12x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.933, Ratio=4.19x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.925, Ratio=4.13x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.925, Ratio=4.27x, Gap=-3.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.935, Ratio=4.27x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.928, Ratio=4.15x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.916, Ratio=4.01x, Gap=-3.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.921, Ratio=4.07x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.938, Ratio=4.27x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.921, Ratio=4.12x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.912, Ratio=4.05x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.924, Ratio=4.13x, Gap=-3.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.932, Ratio=4.13x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.930, Ratio=4.41x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.950, Ratio=4.24x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.935, Ratio=4.16x, Gap=-3.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.944, Ratio=4.18x, Gap=-3.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.923, Ratio=4.07x, Gap=-3.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.930, Ratio=4.08x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.947, Ratio=4.32x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.928, Ratio=4.08x, Gap=-3.471

============================================================
Epoch 15/20 completed in 33.4s
Train: Loss=0.9499 (C:0.9499, R:0.0105) Ratio=3.47x
Val:   Loss=0.8968 (C:0.8968, R:0.0105) Ratio=4.40x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.8968)
Checkpoint saved at epoch 15
============================================================

🌍 Updating global dataset at epoch 16
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.451 ± 0.559
    Neg distances: 1.967 ± 0.929
    Separation ratio: 4.37x
    Gap: -3.563
    ✅ Excellent global separation!

Epoch 16 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.965, Ratio=4.27x, Gap=-4.044
Batch   0/537: Loss=0.8697 (C:0.8697, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.964, Ratio=4.21x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.963, Ratio=4.00x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.970, Ratio=4.11x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.995, Ratio=4.29x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.006, Ratio=4.19x, Gap=-4.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.975, Ratio=3.95x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.990, Ratio=4.06x, Gap=-4.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.980, Ratio=3.97x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.009, Ratio=4.17x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.999, Ratio=3.99x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.002, Ratio=4.08x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.009, Ratio=4.14x, Gap=-4.818
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.999, Ratio=3.85x, Gap=-4.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.004, Ratio=3.95x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.987, Ratio=3.84x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.986, Ratio=4.15x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.006, Ratio=4.08x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.979, Ratio=4.02x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.970, Ratio=3.85x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.985, Ratio=4.11x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.976, Ratio=4.02x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.974, Ratio=3.88x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.976, Ratio=4.01x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.985, Ratio=4.07x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.980, Ratio=3.99x, Gap=-4.349
Batch  25/537: Loss=0.9059 (C:0.9059, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.987, Ratio=4.03x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.974, Ratio=4.03x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.984, Ratio=4.03x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.022, Ratio=4.25x, Gap=-3.987
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.000, Ratio=4.04x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.986, Ratio=4.20x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.005, Ratio=4.21x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.965, Ratio=3.84x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.001, Ratio=4.09x, Gap=-4.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.980, Ratio=3.90x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.984, Ratio=4.11x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.993, Ratio=3.88x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.982, Ratio=3.92x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.980, Ratio=4.15x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.982, Ratio=3.87x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.982, Ratio=4.16x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.978, Ratio=4.07x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.955, Ratio=3.93x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.969, Ratio=4.04x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.980, Ratio=4.09x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.952, Ratio=3.83x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.982, Ratio=3.89x, Gap=-4.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.988, Ratio=4.02x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.015, Ratio=4.14x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.971, Ratio=3.90x, Gap=-4.414
Batch  50/537: Loss=0.9206 (C:0.9206, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.983, Ratio=4.20x, Gap=-4.008
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.978, Ratio=3.78x, Gap=-4.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.966, Ratio=3.91x, Gap=-3.884
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.001, Ratio=4.17x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.963, Ratio=3.76x, Gap=-4.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.004, Ratio=3.93x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.977, Ratio=3.94x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.995, Ratio=4.01x, Gap=-5.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.979, Ratio=3.86x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.978, Ratio=3.91x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.977, Ratio=3.96x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.979, Ratio=3.90x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.974, Ratio=3.94x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.980, Ratio=3.97x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.981, Ratio=3.96x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.987, Ratio=4.05x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.995, Ratio=3.97x, Gap=-4.130
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.981, Ratio=3.98x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.968, Ratio=4.04x, Gap=-4.086
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.950, Ratio=3.71x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.958, Ratio=3.95x, Gap=-4.345
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.990, Ratio=3.97x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.000, Ratio=4.22x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.986, Ratio=4.13x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.986, Ratio=3.87x, Gap=-4.598
Batch  75/537: Loss=0.9255 (C:0.9255, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.984, Ratio=3.96x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.994, Ratio=3.85x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.981, Ratio=4.04x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.976, Ratio=4.03x, Gap=-3.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.999, Ratio=3.97x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.961, Ratio=3.86x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.991, Ratio=3.80x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.975, Ratio=3.85x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.978, Ratio=3.94x, Gap=-4.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.959, Ratio=3.92x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.973, Ratio=3.98x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.999, Ratio=3.97x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.972, Ratio=3.94x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.991, Ratio=4.13x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.001, Ratio=4.11x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.980, Ratio=3.98x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.998, Ratio=3.95x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.965, Ratio=3.91x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.971, Ratio=4.02x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.986, Ratio=4.03x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.970, Ratio=3.95x, Gap=-3.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.989, Ratio=3.99x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.962, Ratio=3.87x, Gap=-3.861
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.995, Ratio=4.13x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.940, Ratio=3.79x, Gap=-4.144
Batch 100/537: Loss=0.9392 (C:0.9392, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.984, Ratio=4.00x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.987, Ratio=3.83x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.972, Ratio=3.95x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.982, Ratio=3.85x, Gap=-4.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.960, Ratio=3.81x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.960, Ratio=3.74x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.998, Ratio=4.06x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.988, Ratio=3.99x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.970, Ratio=3.77x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.025, Ratio=4.21x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.985, Ratio=3.94x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.992, Ratio=4.05x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.994, Ratio=3.95x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.976, Ratio=3.91x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.960, Ratio=3.84x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.987, Ratio=4.11x, Gap=-4.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.989, Ratio=4.06x, Gap=-4.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.967, Ratio=4.03x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.990, Ratio=3.90x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.005, Ratio=4.34x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.979, Ratio=3.92x, Gap=-3.981
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.972, Ratio=4.00x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.985, Ratio=3.96x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.979, Ratio=3.86x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.997, Ratio=4.06x, Gap=-4.184
Batch 125/537: Loss=0.8961 (C:0.8961, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.994, Ratio=3.99x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.010, Ratio=4.11x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.977, Ratio=4.08x, Gap=-4.007
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.997, Ratio=4.18x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.979, Ratio=3.99x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.989, Ratio=3.96x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.981, Ratio=3.91x, Gap=-4.119
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.983, Ratio=4.03x, Gap=-4.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.993, Ratio=4.09x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.978, Ratio=4.03x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.984, Ratio=4.07x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.985, Ratio=3.91x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.013, Ratio=4.27x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.981, Ratio=4.06x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.973, Ratio=3.88x, Gap=-4.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.979, Ratio=4.02x, Gap=-3.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.006, Ratio=4.10x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.977, Ratio=3.98x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.000, Ratio=4.04x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.969, Ratio=3.94x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.990, Ratio=3.85x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.009, Ratio=4.19x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.963, Ratio=3.91x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.966, Ratio=4.15x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.971, Ratio=3.87x, Gap=-4.173
Batch 150/537: Loss=0.9257 (C:0.9257, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.980, Ratio=3.91x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.988, Ratio=4.21x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.991, Ratio=3.97x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.980, Ratio=4.00x, Gap=-4.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.977, Ratio=3.88x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.986, Ratio=3.95x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.993, Ratio=4.00x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.984, Ratio=3.94x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.988, Ratio=4.04x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.992, Ratio=4.02x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.983, Ratio=4.06x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.969, Ratio=3.93x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.977, Ratio=4.04x, Gap=-3.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.992, Ratio=4.07x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.995, Ratio=4.19x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.967, Ratio=3.95x, Gap=-4.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.991, Ratio=3.93x, Gap=-4.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.010, Ratio=4.30x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.991, Ratio=3.98x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.970, Ratio=3.91x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.993, Ratio=3.99x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.977, Ratio=3.94x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.984, Ratio=3.94x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.977, Ratio=3.92x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.969, Ratio=3.82x, Gap=-4.784
Batch 175/537: Loss=0.9351 (C:0.9351, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.001, Ratio=4.19x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.985, Ratio=3.90x, Gap=-4.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.007, Ratio=3.94x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.003, Ratio=4.05x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.981, Ratio=3.96x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.011, Ratio=4.10x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.988, Ratio=3.96x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.995, Ratio=4.01x, Gap=-3.952
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.987, Ratio=3.99x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.943, Ratio=3.84x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.965, Ratio=3.94x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.977, Ratio=3.92x, Gap=-5.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.999, Ratio=4.06x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.977, Ratio=3.91x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.969, Ratio=3.92x, Gap=-4.079
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.992, Ratio=4.00x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.968, Ratio=3.91x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.970, Ratio=3.98x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.991, Ratio=3.99x, Gap=-4.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.984, Ratio=4.06x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.983, Ratio=3.96x, Gap=-4.404
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.986, Ratio=3.93x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.996, Ratio=4.06x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.973, Ratio=3.79x, Gap=-4.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.987, Ratio=3.94x, Gap=-4.485
Batch 200/537: Loss=0.9122 (C:0.9122, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.969, Ratio=3.84x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.992, Ratio=4.02x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.969, Ratio=3.77x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.987, Ratio=4.02x, Gap=-4.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.958, Ratio=3.92x, Gap=-3.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.973, Ratio=3.83x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.990, Ratio=4.08x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.964, Ratio=3.82x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.970, Ratio=3.91x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.962, Ratio=3.74x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.005, Ratio=4.14x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.972, Ratio=4.01x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.959, Ratio=3.74x, Gap=-4.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.993, Ratio=3.83x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.984, Ratio=3.86x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.982, Ratio=3.97x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.007, Ratio=4.13x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.985, Ratio=4.22x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.994, Ratio=4.05x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.989, Ratio=3.96x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.000, Ratio=4.11x, Gap=-4.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.990, Ratio=4.13x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.974, Ratio=3.98x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.964, Ratio=3.87x, Gap=-3.880
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.967, Ratio=3.70x, Gap=-4.450
Batch 225/537: Loss=0.9518 (C:0.9518, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.004, Ratio=3.96x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.997, Ratio=3.96x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.966, Ratio=3.92x, Gap=-4.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.979, Ratio=3.88x, Gap=-3.854
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.974, Ratio=3.84x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.982, Ratio=3.97x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.961, Ratio=3.75x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.964, Ratio=3.84x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.988, Ratio=3.92x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.976, Ratio=3.96x, Gap=-4.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.980, Ratio=4.10x, Gap=-4.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.979, Ratio=3.92x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.989, Ratio=4.03x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.970, Ratio=4.03x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.971, Ratio=3.85x, Gap=-4.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.964, Ratio=3.98x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.978, Ratio=3.93x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.991, Ratio=4.07x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.970, Ratio=3.97x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.982, Ratio=3.84x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.970, Ratio=3.86x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=2.007, Ratio=3.92x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.972, Ratio=3.76x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.971, Ratio=3.90x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.984, Ratio=4.04x, Gap=-4.077
Batch 250/537: Loss=0.8988 (C:0.8988, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.961, Ratio=3.70x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.985, Ratio=3.89x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.979, Ratio=4.05x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.974, Ratio=3.90x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.002, Ratio=4.09x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.001, Ratio=4.05x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.991, Ratio=4.07x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.971, Ratio=3.96x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.958, Ratio=3.87x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.984, Ratio=4.11x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.975, Ratio=3.93x, Gap=-4.156
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.983, Ratio=4.09x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.961, Ratio=3.76x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.976, Ratio=3.91x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.974, Ratio=3.95x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.972, Ratio=3.87x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.980, Ratio=3.98x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.963, Ratio=3.97x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.998, Ratio=4.21x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.981, Ratio=3.98x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.989, Ratio=3.98x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.953, Ratio=3.83x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.981, Ratio=3.94x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.982, Ratio=3.95x, Gap=-4.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.980, Ratio=3.91x, Gap=-4.570
Batch 275/537: Loss=0.9180 (C:0.9180, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.000, Ratio=3.99x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.999, Ratio=4.06x, Gap=-4.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.998, Ratio=3.90x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.978, Ratio=3.90x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.983, Ratio=3.85x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.988, Ratio=3.89x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.983, Ratio=3.79x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.972, Ratio=4.02x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.999, Ratio=4.10x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.996, Ratio=4.20x, Gap=-3.988
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.955, Ratio=3.72x, Gap=-4.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.971, Ratio=3.97x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.984, Ratio=3.98x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.989, Ratio=4.05x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.972, Ratio=3.97x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.980, Ratio=3.93x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.957, Ratio=3.82x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.978, Ratio=3.98x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.974, Ratio=3.90x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.993, Ratio=4.09x, Gap=-4.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.975, Ratio=3.79x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.964, Ratio=3.90x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.971, Ratio=3.91x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.975, Ratio=3.85x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.977, Ratio=3.95x, Gap=-4.174
Batch 300/537: Loss=0.9108 (C:0.9108, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.965, Ratio=3.81x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.980, Ratio=3.99x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.979, Ratio=3.81x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.000, Ratio=4.12x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.976, Ratio=3.87x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.998, Ratio=4.21x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.992, Ratio=3.91x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.983, Ratio=3.96x, Gap=-4.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.016, Ratio=4.26x, Gap=-3.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.973, Ratio=3.94x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.985, Ratio=3.92x, Gap=-4.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.969, Ratio=3.89x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.000, Ratio=4.05x, Gap=-4.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.969, Ratio=3.90x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.984, Ratio=3.97x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.988, Ratio=4.00x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.951, Ratio=3.71x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.959, Ratio=3.79x, Gap=-4.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.984, Ratio=3.89x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.977, Ratio=4.06x, Gap=-4.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.981, Ratio=4.04x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.965, Ratio=3.82x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.989, Ratio=3.99x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.972, Ratio=4.01x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.981, Ratio=3.78x, Gap=-4.093
Batch 325/537: Loss=0.9409 (C:0.9409, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.979, Ratio=3.88x, Gap=-3.859
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.971, Ratio=3.84x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.008, Ratio=4.00x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.983, Ratio=3.97x, Gap=-4.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.009, Ratio=4.11x, Gap=-4.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.980, Ratio=3.74x, Gap=-4.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.007, Ratio=4.21x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.991, Ratio=3.92x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.000, Ratio=4.18x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.991, Ratio=4.04x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.001, Ratio=3.91x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.002, Ratio=4.12x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.974, Ratio=3.85x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.985, Ratio=4.17x, Gap=-4.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.002, Ratio=4.17x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.954, Ratio=3.89x, Gap=-4.108
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.967, Ratio=4.05x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.958, Ratio=3.96x, Gap=-4.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.967, Ratio=4.01x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.980, Ratio=3.86x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.998, Ratio=4.11x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.969, Ratio=3.84x, Gap=-4.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.977, Ratio=3.73x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.990, Ratio=3.95x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.997, Ratio=4.11x, Gap=-4.422
Batch 350/537: Loss=0.8896 (C:0.8896, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.001, Ratio=3.99x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.964, Ratio=3.72x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.979, Ratio=3.98x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.991, Ratio=3.97x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.977, Ratio=4.10x, Gap=-4.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.963, Ratio=3.89x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.973, Ratio=3.95x, Gap=-4.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.957, Ratio=3.83x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.984, Ratio=4.03x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.993, Ratio=4.00x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.953, Ratio=3.80x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.971, Ratio=3.82x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.989, Ratio=4.07x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.994, Ratio=3.81x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.986, Ratio=4.00x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.972, Ratio=3.84x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.986, Ratio=4.02x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.980, Ratio=4.15x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.987, Ratio=3.93x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.971, Ratio=3.78x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.998, Ratio=4.11x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.998, Ratio=4.17x, Gap=-4.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.981, Ratio=3.86x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.976, Ratio=4.09x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.983, Ratio=3.99x, Gap=-4.290
Batch 375/537: Loss=0.9068 (C:0.9068, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.968, Ratio=3.87x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.993, Ratio=3.99x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.984, Ratio=3.93x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.996, Ratio=4.03x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.988, Ratio=4.09x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.971, Ratio=3.85x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.984, Ratio=3.92x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.959, Ratio=3.69x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.977, Ratio=3.94x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.998, Ratio=4.02x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.953, Ratio=3.71x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.959, Ratio=3.76x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.981, Ratio=4.06x, Gap=-4.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.979, Ratio=4.02x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.956, Ratio=3.91x, Gap=-3.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.991, Ratio=4.10x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.984, Ratio=3.92x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.977, Ratio=3.76x, Gap=-4.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.980, Ratio=3.87x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.987, Ratio=4.18x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.001, Ratio=3.99x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.985, Ratio=4.02x, Gap=-4.163
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.997, Ratio=4.01x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.989, Ratio=3.95x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.966, Ratio=3.86x, Gap=-4.175
Batch 400/537: Loss=0.9279 (C:0.9279, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.970, Ratio=3.95x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.987, Ratio=4.06x, Gap=-4.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.997, Ratio=4.07x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.969, Ratio=3.79x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.966, Ratio=3.80x, Gap=-4.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.987, Ratio=4.01x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.977, Ratio=3.85x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.978, Ratio=3.87x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.991, Ratio=3.99x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.987, Ratio=3.96x, Gap=-4.077
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.983, Ratio=4.01x, Gap=-5.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.980, Ratio=3.83x, Gap=-4.225
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.973, Ratio=3.88x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.949, Ratio=3.77x, Gap=-4.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.959, Ratio=3.75x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.973, Ratio=4.01x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.978, Ratio=3.96x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.960, Ratio=3.81x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.975, Ratio=3.96x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.958, Ratio=3.86x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.972, Ratio=3.83x, Gap=-4.942
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.966, Ratio=3.87x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.978, Ratio=3.93x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.980, Ratio=3.88x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.005, Ratio=3.99x, Gap=-4.024
Batch 425/537: Loss=0.9077 (C:0.9077, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.008, Ratio=4.09x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.000, Ratio=3.90x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.022, Ratio=4.14x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.975, Ratio=4.06x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.993, Ratio=3.92x, Gap=-4.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.970, Ratio=3.96x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.974, Ratio=3.94x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.000, Ratio=4.12x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.995, Ratio=4.03x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.974, Ratio=3.94x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.992, Ratio=3.94x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.971, Ratio=3.93x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.975, Ratio=4.08x, Gap=-3.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.988, Ratio=3.80x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.987, Ratio=3.93x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.994, Ratio=4.04x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.989, Ratio=4.21x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.977, Ratio=3.82x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.981, Ratio=3.96x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.967, Ratio=3.98x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.985, Ratio=4.07x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.998, Ratio=3.96x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.968, Ratio=3.73x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.969, Ratio=3.83x, Gap=-4.009
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.996, Ratio=4.08x, Gap=-4.468
Batch 450/537: Loss=0.8920 (C:0.8920, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.964, Ratio=3.74x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.966, Ratio=3.87x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.986, Ratio=3.86x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.001, Ratio=3.98x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.980, Ratio=3.93x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.976, Ratio=4.06x, Gap=-3.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.977, Ratio=3.81x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.961, Ratio=3.88x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.014, Ratio=4.15x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.991, Ratio=4.15x, Gap=-4.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.980, Ratio=3.92x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.975, Ratio=3.95x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.976, Ratio=3.90x, Gap=-4.277
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.984, Ratio=3.86x, Gap=-5.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.962, Ratio=3.79x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.988, Ratio=3.93x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.967, Ratio=3.84x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.983, Ratio=3.97x, Gap=-4.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.975, Ratio=3.89x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.970, Ratio=3.82x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.987, Ratio=3.98x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.962, Ratio=3.89x, Gap=-4.876
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.984, Ratio=3.99x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.990, Ratio=4.05x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.973, Ratio=3.91x, Gap=-4.193
Batch 475/537: Loss=0.9181 (C:0.9181, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.997, Ratio=4.12x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.995, Ratio=3.90x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.961, Ratio=3.85x, Gap=-4.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.987, Ratio=4.16x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.975, Ratio=3.98x, Gap=-4.127
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.958, Ratio=3.69x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.986, Ratio=3.88x, Gap=-4.961
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.962, Ratio=3.87x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.000, Ratio=4.04x, Gap=-4.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.974, Ratio=3.98x, Gap=-4.014
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.978, Ratio=3.96x, Gap=-4.023
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.965, Ratio=3.91x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.984, Ratio=4.07x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.014, Ratio=4.24x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.973, Ratio=4.01x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.982, Ratio=3.98x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.990, Ratio=3.96x, Gap=-3.809
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.990, Ratio=3.98x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.983, Ratio=4.02x, Gap=-4.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.995, Ratio=3.98x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.980, Ratio=3.97x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.988, Ratio=4.01x, Gap=-4.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.978, Ratio=3.88x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.982, Ratio=3.96x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.986, Ratio=4.03x, Gap=-4.585
Batch 500/537: Loss=0.8995 (C:0.8995, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.954, Ratio=3.77x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.976, Ratio=4.11x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.965, Ratio=3.86x, Gap=-4.138
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.977, Ratio=3.94x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.988, Ratio=4.12x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.958, Ratio=3.73x, Gap=-4.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.944, Ratio=3.75x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.988, Ratio=4.09x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.995, Ratio=4.00x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.977, Ratio=3.85x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.988, Ratio=3.86x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.996, Ratio=4.01x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.529, Neg=1.968, Ratio=3.72x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.998, Ratio=4.11x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.988, Ratio=4.03x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.973, Ratio=3.90x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.977, Ratio=4.01x, Gap=-4.090
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.964, Ratio=3.93x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.975, Ratio=3.93x, Gap=-4.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.961, Ratio=3.85x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.986, Ratio=3.97x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.994, Ratio=3.93x, Gap=-4.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.987, Ratio=4.17x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.967, Ratio=3.94x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.952, Ratio=3.77x, Gap=-4.091
Batch 525/537: Loss=0.9422 (C:0.9422, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.956, Ratio=3.82x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.975, Ratio=3.92x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.978, Ratio=3.82x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.962, Ratio=3.78x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.973, Ratio=3.84x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.987, Ratio=3.82x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.991, Ratio=3.99x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.979, Ratio=3.94x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.968, Ratio=3.84x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.012, Ratio=3.94x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.963, Ratio=3.85x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.004, Ratio=4.42x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.995, Ratio=4.41x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.997, Ratio=4.27x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.011, Ratio=4.59x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.009, Ratio=4.36x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.012, Ratio=4.34x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.981, Ratio=4.22x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.006, Ratio=4.50x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.996, Ratio=4.33x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.995, Ratio=4.39x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.014, Ratio=4.44x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.995, Ratio=4.28x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.989, Ratio=4.43x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.963, Ratio=4.23x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.975, Ratio=4.21x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.990, Ratio=4.21x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.007, Ratio=4.45x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.011, Ratio=4.52x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.996, Ratio=4.39x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.006, Ratio=4.50x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.987, Ratio=4.28x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.990, Ratio=4.43x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.012, Ratio=4.39x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.016, Ratio=4.48x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.001, Ratio=4.48x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.009, Ratio=4.56x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.996, Ratio=4.34x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.995, Ratio=4.29x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.999, Ratio=4.43x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.002, Ratio=4.62x, Gap=-3.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.028, Ratio=4.42x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.005, Ratio=4.49x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.993, Ratio=4.15x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.999, Ratio=4.39x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.999, Ratio=4.43x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.000, Ratio=4.25x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.000, Ratio=4.34x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.976, Ratio=4.31x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.005, Ratio=4.40x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.984, Ratio=4.19x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.994, Ratio=4.39x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.006, Ratio=4.28x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.008, Ratio=4.46x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.008, Ratio=4.40x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.995, Ratio=4.15x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.023, Ratio=4.60x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.994, Ratio=4.34x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.996, Ratio=4.28x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.992, Ratio=4.27x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.006, Ratio=4.43x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.010, Ratio=4.47x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.005, Ratio=4.26x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.004, Ratio=4.43x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.997, Ratio=4.44x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.000, Ratio=4.40x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.008, Ratio=4.30x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.988, Ratio=4.32x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.004, Ratio=4.56x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.991, Ratio=4.24x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.992, Ratio=4.38x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.002, Ratio=4.42x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.010, Ratio=4.56x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.997, Ratio=4.54x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.982, Ratio=4.08x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.000, Ratio=4.35x, Gap=-3.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=1.993, Ratio=4.56x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.997, Ratio=4.36x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.989, Ratio=4.21x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.973, Ratio=4.09x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.033, Ratio=4.75x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.014, Ratio=4.48x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.978, Ratio=4.29x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.019, Ratio=4.48x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.010, Ratio=4.64x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.009, Ratio=4.42x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.008, Ratio=4.37x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.986, Ratio=4.32x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.998, Ratio=4.28x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.995, Ratio=4.25x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.012, Ratio=4.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.999, Ratio=4.33x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.27x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.006, Ratio=4.58x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.993, Ratio=4.24x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.005, Ratio=4.36x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.010, Ratio=4.58x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.004, Ratio=4.45x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.986, Ratio=4.03x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.010, Ratio=4.53x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.982, Ratio=4.20x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.010, Ratio=4.53x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.000, Ratio=4.50x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.011, Ratio=4.47x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.014, Ratio=4.47x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.997, Ratio=4.20x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.028, Ratio=4.65x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.976, Ratio=4.17x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.007, Ratio=4.41x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.000, Ratio=4.33x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.013, Ratio=4.39x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.007, Ratio=4.56x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.025, Ratio=4.66x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.006, Ratio=4.37x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.007, Ratio=4.34x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.019, Ratio=4.66x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.994, Ratio=4.40x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.993, Ratio=4.49x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.016, Ratio=4.42x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.997, Ratio=4.38x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.004, Ratio=4.36x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.007, Ratio=4.45x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.994, Ratio=4.22x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.003, Ratio=4.35x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.998, Ratio=4.34x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.003, Ratio=4.38x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.995, Ratio=4.20x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.017, Ratio=4.49x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.995, Ratio=4.40x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.998, Ratio=4.27x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.002, Ratio=4.49x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.982, Ratio=4.29x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.008, Ratio=4.61x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.013, Ratio=4.44x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.013, Ratio=4.37x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.996, Ratio=4.53x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.005, Ratio=4.29x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.002, Ratio=4.37x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.992, Ratio=4.29x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.994, Ratio=4.21x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.988, Ratio=4.33x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.016, Ratio=4.64x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.000, Ratio=4.30x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.986, Ratio=4.28x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.992, Ratio=4.30x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.012, Ratio=4.51x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.998, Ratio=4.34x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.996, Ratio=4.34x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.975, Ratio=4.17x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.984, Ratio=4.33x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.992, Ratio=4.30x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.997, Ratio=4.44x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.984, Ratio=4.30x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.011, Ratio=4.47x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.008, Ratio=4.58x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.997, Ratio=4.26x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.006, Ratio=4.55x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.006, Ratio=4.48x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.980, Ratio=4.28x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.991, Ratio=4.31x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.011, Ratio=4.46x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.986, Ratio=4.31x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.970, Ratio=4.24x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.999, Ratio=4.38x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.963, Ratio=4.07x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.013, Ratio=4.42x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.001, Ratio=4.48x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.001, Ratio=4.46x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.001, Ratio=4.41x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.985, Ratio=4.29x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.008, Ratio=4.49x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.017, Ratio=4.46x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.009, Ratio=4.50x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.988, Ratio=4.40x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.001, Ratio=4.32x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.996, Ratio=4.27x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.995, Ratio=4.23x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.999, Ratio=4.36x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.991, Ratio=4.36x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.998, Ratio=4.39x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.990, Ratio=4.42x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.006, Ratio=4.41x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.987, Ratio=4.31x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.007, Ratio=4.43x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.995, Ratio=4.21x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.002, Ratio=4.28x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.994, Ratio=4.46x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.998, Ratio=4.21x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.005, Ratio=4.38x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.003, Ratio=4.34x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.003, Ratio=4.33x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.996, Ratio=4.44x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.012, Ratio=4.61x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.994, Ratio=4.26x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.019, Ratio=4.44x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.001, Ratio=4.44x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.995, Ratio=4.41x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.985, Ratio=4.24x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.999, Ratio=4.34x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.000, Ratio=4.23x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.014, Ratio=4.30x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.008, Ratio=4.45x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.006, Ratio=4.43x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.011, Ratio=4.40x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.983, Ratio=4.22x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.974, Ratio=4.16x, Gap=-3.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.003, Ratio=4.26x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.984, Ratio=4.18x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.031, Ratio=4.67x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.016, Ratio=4.56x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.001, Ratio=4.46x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.978, Ratio=4.23x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.005, Ratio=4.44x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.995, Ratio=4.31x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.987, Ratio=4.27x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.003, Ratio=4.18x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.996, Ratio=4.35x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.003, Ratio=4.47x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.009, Ratio=4.54x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.002, Ratio=4.37x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.992, Ratio=4.39x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.000, Ratio=4.41x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.010, Ratio=4.41x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.031, Ratio=4.75x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.002, Ratio=4.50x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.015, Ratio=4.55x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.957, Ratio=4.00x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.999, Ratio=4.41x, Gap=-3.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.986, Ratio=4.33x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.014, Ratio=4.53x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.996, Ratio=4.41x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.987, Ratio=4.32x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.002, Ratio=4.46x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.020, Ratio=4.70x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.012, Ratio=4.37x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.986, Ratio=4.46x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.019, Ratio=4.46x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.019, Ratio=4.62x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.980, Ratio=4.20x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.002, Ratio=4.44x, Gap=-3.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.999, Ratio=4.47x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.994, Ratio=4.21x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.998, Ratio=4.30x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.004, Ratio=4.57x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.985, Ratio=4.42x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.978, Ratio=4.28x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.004, Ratio=4.61x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.000, Ratio=4.16x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.985, Ratio=4.28x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.991, Ratio=4.13x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.011, Ratio=4.53x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.996, Ratio=4.35x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.011, Ratio=4.50x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.017, Ratio=4.48x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.003, Ratio=4.28x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.984, Ratio=4.41x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.002, Ratio=4.64x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.974, Ratio=4.25x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.002, Ratio=4.29x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.999, Ratio=4.51x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.27x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.010, Ratio=4.45x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.006, Ratio=4.46x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.994, Ratio=4.45x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.971, Ratio=4.17x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.006, Ratio=4.42x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.005, Ratio=4.45x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.001, Ratio=4.45x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.025, Ratio=4.64x, Gap=-3.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.997, Ratio=4.31x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.995, Ratio=4.36x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.987, Ratio=4.28x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.995, Ratio=4.39x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.987, Ratio=4.37x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.010, Ratio=4.49x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.997, Ratio=4.27x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.004, Ratio=4.42x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.026, Ratio=4.56x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.013, Ratio=4.51x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.984, Ratio=4.08x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.978, Ratio=4.34x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.987, Ratio=4.15x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.997, Ratio=4.41x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.983, Ratio=4.25x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.985, Ratio=4.25x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.990, Ratio=4.46x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.027, Ratio=4.63x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.985, Ratio=4.36x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.015, Ratio=4.41x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.010, Ratio=4.42x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.983, Ratio=4.28x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.002, Ratio=4.29x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.986, Ratio=4.28x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.993, Ratio=4.23x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.007, Ratio=4.50x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.009, Ratio=4.55x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.004, Ratio=4.39x, Gap=-3.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.019, Ratio=4.44x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.001, Ratio=4.55x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.990, Ratio=4.34x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.993, Ratio=4.27x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.011, Ratio=4.48x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.013, Ratio=4.40x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.002, Ratio=4.40x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.994, Ratio=4.20x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.011, Ratio=4.55x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.017, Ratio=4.55x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.004, Ratio=4.41x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.998, Ratio=4.30x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.013, Ratio=4.48x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.024, Ratio=4.57x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.024, Ratio=4.47x, Gap=-3.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.003, Ratio=4.46x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.998, Ratio=4.40x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.016, Ratio=4.50x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.012, Ratio=4.63x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.987, Ratio=4.16x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.988, Ratio=4.27x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.003, Ratio=4.38x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.991, Ratio=4.32x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.992, Ratio=4.21x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.011, Ratio=4.35x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.019, Ratio=4.48x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.994, Ratio=4.37x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.988, Ratio=4.29x, Gap=-3.847
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.991, Ratio=4.28x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.000, Ratio=4.36x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.994, Ratio=4.29x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.985, Ratio=4.09x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.007, Ratio=4.38x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.008, Ratio=4.44x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.007, Ratio=4.45x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.001, Ratio=4.48x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.011, Ratio=4.42x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.996, Ratio=4.38x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.983, Ratio=4.19x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.979, Ratio=4.21x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.990, Ratio=4.23x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.003, Ratio=4.44x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.997, Ratio=4.31x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.002, Ratio=4.39x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.982, Ratio=4.17x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.003, Ratio=4.43x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.004, Ratio=4.42x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.010, Ratio=4.47x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.998, Ratio=4.29x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.007, Ratio=4.29x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.015, Ratio=4.48x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.990, Ratio=4.30x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.021, Ratio=4.40x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.020, Ratio=4.53x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.998, Ratio=4.34x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.009, Ratio=4.51x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.984, Ratio=4.28x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.001, Ratio=4.27x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.980, Ratio=4.25x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.003, Ratio=4.34x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.021, Ratio=4.63x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.002, Ratio=4.44x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.022, Ratio=4.48x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.974, Ratio=4.26x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.994, Ratio=4.31x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.998, Ratio=4.44x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.009, Ratio=4.49x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.003, Ratio=4.31x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.017, Ratio=4.48x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.024, Ratio=4.62x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.006, Ratio=4.40x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.994, Ratio=4.19x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.991, Ratio=4.16x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.992, Ratio=4.19x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.995, Ratio=4.31x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.987, Ratio=4.18x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.007, Ratio=4.41x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.006, Ratio=4.43x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.007, Ratio=4.42x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.023, Ratio=4.72x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.007, Ratio=4.47x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.015, Ratio=4.35x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.023, Ratio=4.64x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.002, Ratio=4.40x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.016, Ratio=4.46x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.006, Ratio=4.40x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.997, Ratio=4.30x, Gap=-3.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.999, Ratio=4.39x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.988, Ratio=4.40x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.010, Ratio=4.61x, Gap=-3.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.998, Ratio=4.49x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.001, Ratio=4.47x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.016, Ratio=4.53x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.978, Ratio=4.20x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.985, Ratio=4.28x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.022, Ratio=4.49x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.001, Ratio=4.41x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.013, Ratio=4.40x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.998, Ratio=4.22x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.999, Ratio=4.30x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.001, Ratio=4.37x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.005, Ratio=4.25x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.006, Ratio=4.54x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.991, Ratio=4.28x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.014, Ratio=4.52x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.007, Ratio=4.37x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.004, Ratio=4.22x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.996, Ratio=4.21x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.019, Ratio=4.59x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.981, Ratio=4.16x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.005, Ratio=4.62x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.008, Ratio=4.46x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.006, Ratio=4.53x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.000, Ratio=4.29x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.014, Ratio=4.56x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.005, Ratio=4.49x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.011, Ratio=4.32x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.995, Ratio=4.40x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.013, Ratio=4.57x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.010, Ratio=4.50x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.005, Ratio=4.34x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.020, Ratio=4.60x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.979, Ratio=4.08x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.010, Ratio=4.38x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.989, Ratio=4.13x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.989, Ratio=4.50x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.986, Ratio=4.23x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.984, Ratio=4.32x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.987, Ratio=4.26x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.009, Ratio=4.33x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.996, Ratio=4.30x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.994, Ratio=4.29x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.011, Ratio=4.40x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.999, Ratio=4.33x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.998, Ratio=4.49x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.022, Ratio=4.60x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.009, Ratio=4.44x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.007, Ratio=4.46x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.985, Ratio=4.36x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.003, Ratio=4.35x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.971, Ratio=4.16x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.017, Ratio=4.40x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.984, Ratio=4.23x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.994, Ratio=4.29x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.020, Ratio=4.43x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.989, Ratio=4.32x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.998, Ratio=4.30x, Gap=-3.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.010, Ratio=4.61x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.991, Ratio=4.23x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.023, Ratio=4.50x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.974, Ratio=4.21x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.995, Ratio=4.46x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.992, Ratio=4.34x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.002, Ratio=4.23x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.989, Ratio=4.28x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.999, Ratio=4.46x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.983, Ratio=4.17x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.004, Ratio=4.50x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.002, Ratio=4.39x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.998, Ratio=4.37x, Gap=-3.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.985, Ratio=4.20x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.987, Ratio=4.32x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.001, Ratio=4.49x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.002, Ratio=4.52x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.010, Ratio=4.50x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.993, Ratio=4.34x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.004, Ratio=4.50x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.981, Ratio=4.20x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.005, Ratio=4.63x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.977, Ratio=4.13x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.000, Ratio=4.25x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.989, Ratio=4.15x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.991, Ratio=4.20x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.991, Ratio=4.28x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.001, Ratio=4.44x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.017, Ratio=4.76x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.017, Ratio=4.47x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.006, Ratio=4.51x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.980, Ratio=4.16x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.998, Ratio=4.48x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.004, Ratio=4.39x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.022, Ratio=4.80x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.999, Ratio=4.31x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.994, Ratio=4.15x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.006, Ratio=4.48x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.978, Ratio=4.12x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.009, Ratio=4.38x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.998, Ratio=4.42x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.004, Ratio=4.55x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.005, Ratio=4.45x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.998, Ratio=4.35x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.016, Ratio=4.60x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.004, Ratio=4.46x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.997, Ratio=4.33x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.987, Ratio=4.32x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.999, Ratio=4.37x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.006, Ratio=4.54x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.984, Ratio=4.24x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.009, Ratio=4.39x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.981, Ratio=4.02x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.984, Ratio=4.12x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.992, Ratio=4.33x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.995, Ratio=4.24x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.016, Ratio=4.55x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.003, Ratio=4.51x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.990, Ratio=4.40x, Gap=-3.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.970, Ratio=4.23x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.987, Ratio=4.16x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.987, Ratio=4.35x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.980, Ratio=4.17x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.997, Ratio=4.42x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.013, Ratio=4.43x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.022, Ratio=4.51x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.012, Ratio=4.66x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.004, Ratio=4.42x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.015, Ratio=4.39x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.011, Ratio=4.51x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.997, Ratio=4.29x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.005, Ratio=4.49x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.991, Ratio=4.41x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.977, Ratio=4.18x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.012, Ratio=4.52x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.965, Ratio=4.07x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.002, Ratio=4.37x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.007, Ratio=4.37x, Gap=-3.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.996, Ratio=4.35x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.983, Ratio=4.24x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.999, Ratio=4.18x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.993, Ratio=4.39x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.993, Ratio=4.34x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.000, Ratio=4.39x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.995, Ratio=4.29x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.034, Ratio=4.70x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.973, Ratio=4.35x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.994, Ratio=4.45x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.991, Ratio=4.12x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.004, Ratio=4.39x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.042, Ratio=4.91x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.001, Ratio=4.16x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.009, Ratio=4.52x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.988, Ratio=4.30x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.006, Ratio=4.60x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.979, Ratio=4.23x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.981, Ratio=4.34x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.991, Ratio=4.17x, Gap=-3.653

============================================================
Epoch 16/20 completed in 39.5s
Train: Loss=0.9112 (C:0.9112, R:0.0105) Ratio=3.49x
Val:   Loss=0.8529 (C:0.8529, R:0.0105) Ratio=4.48x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.8529)
============================================================

Epoch 17 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.011, Ratio=4.16x, Gap=-4.318
Batch   0/537: Loss=0.8806 (C:0.8806, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.009, Ratio=3.98x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.998, Ratio=4.14x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.979, Ratio=4.01x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.976, Ratio=3.97x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.978, Ratio=3.84x, Gap=-3.983
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.985, Ratio=4.10x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.015, Ratio=4.13x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.997, Ratio=4.10x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.990, Ratio=4.06x, Gap=-4.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.984, Ratio=4.05x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.990, Ratio=4.05x, Gap=-4.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.975, Ratio=3.95x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.989, Ratio=4.04x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.992, Ratio=4.15x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.989, Ratio=4.04x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.987, Ratio=4.00x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.010, Ratio=4.24x, Gap=-3.957
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.017, Ratio=4.17x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.970, Ratio=3.79x, Gap=-5.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.982, Ratio=3.98x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.985, Ratio=4.10x, Gap=-4.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.971, Ratio=3.96x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.985, Ratio=4.23x, Gap=-4.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.996, Ratio=3.97x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.009, Ratio=4.30x, Gap=-4.080
Batch  25/537: Loss=0.8625 (C:0.8625, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.990, Ratio=4.04x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.980, Ratio=3.87x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.985, Ratio=4.09x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.004, Ratio=4.24x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.008, Ratio=4.13x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.994, Ratio=4.02x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.991, Ratio=4.00x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.002, Ratio=4.15x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.986, Ratio=4.08x, Gap=-4.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.972, Ratio=3.99x, Gap=-4.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.981, Ratio=3.95x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.993, Ratio=3.95x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.004, Ratio=4.07x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.973, Ratio=3.92x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.993, Ratio=4.07x, Gap=-4.862
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.985, Ratio=4.08x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.995, Ratio=3.91x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.007, Ratio=4.17x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.999, Ratio=4.12x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.987, Ratio=3.87x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.989, Ratio=4.30x, Gap=-3.925
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.974, Ratio=3.95x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.979, Ratio=4.05x, Gap=-4.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.983, Ratio=4.17x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.967, Ratio=4.05x, Gap=-4.068
Batch  50/537: Loss=0.8958 (C:0.8958, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.977, Ratio=3.99x, Gap=-4.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.969, Ratio=3.87x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.996, Ratio=4.08x, Gap=-4.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.965, Ratio=3.80x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.997, Ratio=4.08x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.989, Ratio=4.01x, Gap=-4.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.008, Ratio=4.17x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.981, Ratio=4.19x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.968, Ratio=3.90x, Gap=-5.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.994, Ratio=4.06x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.978, Ratio=4.18x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.986, Ratio=4.06x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.000, Ratio=4.21x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.999, Ratio=4.06x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.002, Ratio=4.21x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.980, Ratio=3.92x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.986, Ratio=3.95x, Gap=-4.055
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.988, Ratio=4.04x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.988, Ratio=4.04x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.977, Ratio=3.84x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.011, Ratio=4.21x, Gap=-4.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.004, Ratio=4.10x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.988, Ratio=4.04x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.984, Ratio=4.06x, Gap=-4.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.994, Ratio=4.09x, Gap=-4.599
Batch  75/537: Loss=0.8901 (C:0.8901, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.993, Ratio=4.05x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.982, Ratio=3.96x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.991, Ratio=4.07x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.971, Ratio=3.93x, Gap=-4.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.964, Ratio=3.83x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.970, Ratio=3.93x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.980, Ratio=3.93x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.995, Ratio=3.94x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.991, Ratio=4.06x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.971, Ratio=3.79x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.990, Ratio=4.04x, Gap=-4.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.996, Ratio=4.06x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.995, Ratio=4.10x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.966, Ratio=3.86x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.986, Ratio=4.00x, Gap=-4.363
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.003, Ratio=4.10x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.963, Ratio=3.88x, Gap=-4.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.982, Ratio=3.99x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.000, Ratio=4.06x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.003, Ratio=4.01x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.966, Ratio=4.01x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.007, Ratio=4.15x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.002, Ratio=4.17x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.016, Ratio=4.18x, Gap=-4.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.999, Ratio=4.10x, Gap=-4.163
Batch 100/537: Loss=0.8861 (C:0.8861, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.003, Ratio=4.05x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.009, Ratio=4.24x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.983, Ratio=4.08x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.970, Ratio=3.99x, Gap=-4.242
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.991, Ratio=3.99x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.976, Ratio=3.90x, Gap=-4.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.996, Ratio=3.91x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.962, Ratio=3.88x, Gap=-4.448
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.998, Ratio=4.24x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.979, Ratio=3.97x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.985, Ratio=3.92x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.010, Ratio=4.12x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.987, Ratio=3.99x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.014, Ratio=4.19x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.985, Ratio=4.09x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.965, Ratio=3.98x, Gap=-4.464
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.983, Ratio=3.97x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.986, Ratio=4.14x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.003, Ratio=4.07x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.981, Ratio=3.99x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.998, Ratio=4.07x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.017, Ratio=4.16x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.005, Ratio=4.14x, Gap=-4.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.985, Ratio=4.07x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.972, Ratio=3.95x, Gap=-4.291
Batch 125/537: Loss=0.9110 (C:0.9110, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.002, Ratio=4.31x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.989, Ratio=4.02x, Gap=-4.545
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.988, Ratio=4.13x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.968, Ratio=4.08x, Gap=-4.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.989, Ratio=4.02x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.977, Ratio=3.97x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.968, Ratio=3.87x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.973, Ratio=3.99x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.000, Ratio=3.94x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.999, Ratio=4.04x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.980, Ratio=3.95x, Gap=-4.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.983, Ratio=3.97x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.994, Ratio=3.90x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.980, Ratio=3.89x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.985, Ratio=3.89x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.990, Ratio=4.02x, Gap=-4.935
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.987, Ratio=4.12x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.974, Ratio=3.92x, Gap=-4.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.992, Ratio=4.09x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.006, Ratio=4.06x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.986, Ratio=4.03x, Gap=-3.967
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.973, Ratio=4.04x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.994, Ratio=4.05x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.999, Ratio=4.15x, Gap=-4.997
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.998, Ratio=4.08x, Gap=-4.361
Batch 150/537: Loss=0.8946 (C:0.8946, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.993, Ratio=4.05x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.990, Ratio=4.01x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.974, Ratio=3.82x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.993, Ratio=3.94x, Gap=-5.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.960, Ratio=3.86x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.998, Ratio=3.99x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.983, Ratio=3.82x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.969, Ratio=3.91x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.979, Ratio=3.84x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.977, Ratio=4.00x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.985, Ratio=4.02x, Gap=-4.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.978, Ratio=4.00x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.977, Ratio=3.97x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.975, Ratio=4.08x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.966, Ratio=3.84x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.994, Ratio=3.98x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.998, Ratio=4.18x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.971, Ratio=3.91x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.989, Ratio=3.97x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.004, Ratio=4.11x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.990, Ratio=3.90x, Gap=-4.327
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.978, Ratio=3.98x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.979, Ratio=3.81x, Gap=-4.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.998, Ratio=4.02x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.995, Ratio=4.07x, Gap=-4.066
Batch 175/537: Loss=0.8933 (C:0.8933, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.986, Ratio=3.89x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.997, Ratio=3.95x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.976, Ratio=3.86x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.983, Ratio=4.10x, Gap=-4.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.985, Ratio=4.08x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.994, Ratio=4.23x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.979, Ratio=3.96x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.993, Ratio=4.14x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.970, Ratio=3.96x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.958, Ratio=3.86x, Gap=-3.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.977, Ratio=3.94x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.976, Ratio=4.01x, Gap=-4.020
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.978, Ratio=4.00x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.988, Ratio=4.00x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.999, Ratio=3.89x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.980, Ratio=3.88x, Gap=-4.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.009, Ratio=4.13x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.969, Ratio=3.82x, Gap=-4.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.003, Ratio=4.11x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.977, Ratio=3.97x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.990, Ratio=4.04x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.987, Ratio=4.03x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.973, Ratio=3.98x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.984, Ratio=3.98x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.969, Ratio=3.96x, Gap=-4.080
Batch 200/537: Loss=0.9124 (C:0.9124, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.967, Ratio=3.83x, Gap=-4.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.990, Ratio=4.07x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.990, Ratio=4.19x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.991, Ratio=4.06x, Gap=-4.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.005, Ratio=4.04x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.993, Ratio=4.06x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.987, Ratio=4.07x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.994, Ratio=4.04x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.016, Ratio=4.09x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.992, Ratio=4.13x, Gap=-3.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.983, Ratio=4.13x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.986, Ratio=3.97x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.993, Ratio=4.04x, Gap=-4.484
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.965, Ratio=3.98x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.967, Ratio=4.02x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.996, Ratio=4.17x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.999, Ratio=4.03x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.978, Ratio=3.88x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.022, Ratio=4.19x, Gap=-4.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.002, Ratio=4.10x, Gap=-4.135
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.011, Ratio=4.10x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.982, Ratio=3.91x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.992, Ratio=3.98x, Gap=-4.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.000, Ratio=4.10x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.998, Ratio=3.94x, Gap=-4.977
Batch 225/537: Loss=0.9138 (C:0.9138, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.983, Ratio=3.99x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.978, Ratio=3.91x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.993, Ratio=4.03x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.002, Ratio=4.08x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.961, Ratio=3.88x, Gap=-4.103
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.990, Ratio=4.07x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.969, Ratio=3.91x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.971, Ratio=3.93x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.988, Ratio=3.92x, Gap=-3.975
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.003, Ratio=4.09x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.988, Ratio=4.11x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.990, Ratio=4.23x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.005, Ratio=4.15x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.985, Ratio=3.99x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.008, Ratio=4.09x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.007, Ratio=4.10x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.012, Ratio=4.24x, Gap=-4.047
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.016, Ratio=4.26x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.984, Ratio=4.01x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.004, Ratio=4.17x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.986, Ratio=3.94x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.988, Ratio=4.09x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.996, Ratio=4.01x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.989, Ratio=3.96x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.959, Ratio=3.71x, Gap=-4.471
Batch 250/537: Loss=0.9519 (C:0.9519, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.981, Ratio=3.81x, Gap=-4.218
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.010, Ratio=4.28x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.959, Ratio=3.89x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.974, Ratio=3.98x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.970, Ratio=3.89x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.978, Ratio=3.97x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.981, Ratio=4.01x, Gap=-4.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.002, Ratio=4.22x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.987, Ratio=4.03x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.996, Ratio=4.07x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.007, Ratio=4.16x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.996, Ratio=4.03x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.983, Ratio=4.13x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.990, Ratio=3.97x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.976, Ratio=3.97x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.979, Ratio=4.05x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.997, Ratio=4.15x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.990, Ratio=3.98x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.995, Ratio=4.12x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.947, Ratio=3.79x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.001, Ratio=4.05x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.995, Ratio=3.98x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.976, Ratio=3.90x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.972, Ratio=4.00x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.976, Ratio=3.84x, Gap=-4.193
Batch 275/537: Loss=0.9314 (C:0.9314, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.999, Ratio=4.02x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.004, Ratio=4.19x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.970, Ratio=3.97x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.994, Ratio=3.87x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.005, Ratio=4.03x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.999, Ratio=3.98x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.997, Ratio=3.94x, Gap=-4.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.012, Ratio=4.14x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.997, Ratio=3.99x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.992, Ratio=3.98x, Gap=-4.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.995, Ratio=4.01x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.990, Ratio=3.99x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.964, Ratio=3.87x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.992, Ratio=3.96x, Gap=-5.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.979, Ratio=4.03x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.989, Ratio=4.18x, Gap=-4.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.991, Ratio=4.12x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.988, Ratio=4.05x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.964, Ratio=3.76x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.993, Ratio=4.03x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.019, Ratio=4.24x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.001, Ratio=4.23x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.983, Ratio=4.02x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.986, Ratio=3.96x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.994, Ratio=4.07x, Gap=-4.094
Batch 300/537: Loss=0.8938 (C:0.8938, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.025, Ratio=4.07x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.992, Ratio=3.92x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.992, Ratio=4.06x, Gap=-4.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.981, Ratio=3.82x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.976, Ratio=3.81x, Gap=-4.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.011, Ratio=4.20x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.991, Ratio=4.13x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.966, Ratio=3.92x, Gap=-4.149
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.538, Neg=1.934, Ratio=3.59x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.987, Ratio=4.09x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.999, Ratio=4.03x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.994, Ratio=3.99x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.979, Ratio=4.03x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.975, Ratio=3.78x, Gap=-4.432
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.001, Ratio=4.07x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.989, Ratio=3.99x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.998, Ratio=4.01x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.995, Ratio=4.05x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.994, Ratio=3.94x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.977, Ratio=3.99x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.993, Ratio=4.13x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.994, Ratio=4.21x, Gap=-4.092
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.986, Ratio=4.13x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.972, Ratio=3.91x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.966, Ratio=3.85x, Gap=-4.689
Batch 325/537: Loss=0.9315 (C:0.9315, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.941, Ratio=3.69x, Gap=-4.204
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.985, Ratio=3.95x, Gap=-4.107
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.003, Ratio=4.12x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.968, Ratio=3.97x, Gap=-4.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.021, Ratio=4.15x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.978, Ratio=3.89x, Gap=-4.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.982, Ratio=3.95x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.984, Ratio=4.03x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.978, Ratio=3.88x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.983, Ratio=4.00x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.990, Ratio=3.95x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.985, Ratio=4.02x, Gap=-3.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.958, Ratio=3.78x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.998, Ratio=4.27x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.979, Ratio=3.95x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.993, Ratio=3.96x, Gap=-3.994
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.000, Ratio=4.22x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.010, Ratio=3.93x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.987, Ratio=3.93x, Gap=-4.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.988, Ratio=3.98x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.987, Ratio=3.95x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.958, Ratio=3.80x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.015, Ratio=4.18x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.993, Ratio=4.03x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.974, Ratio=3.86x, Gap=-4.598
Batch 350/537: Loss=0.9279 (C:0.9279, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.982, Ratio=4.03x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.974, Ratio=3.96x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.961, Ratio=3.89x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.996, Ratio=4.11x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.000, Ratio=4.14x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.968, Ratio=3.95x, Gap=-4.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.987, Ratio=3.95x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.006, Ratio=4.30x, Gap=-4.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.988, Ratio=3.95x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.977, Ratio=3.99x, Gap=-4.389
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.987, Ratio=4.05x, Gap=-3.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.009, Ratio=4.07x, Gap=-4.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.992, Ratio=3.89x, Gap=-4.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=1.985, Ratio=3.78x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.969, Ratio=3.86x, Gap=-4.139
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.994, Ratio=4.00x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.985, Ratio=4.07x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.998, Ratio=3.92x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.974, Ratio=3.90x, Gap=-4.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.985, Ratio=4.05x, Gap=-4.153
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.971, Ratio=4.02x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.987, Ratio=3.88x, Gap=-5.031
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.980, Ratio=3.96x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.981, Ratio=4.04x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.986, Ratio=3.92x, Gap=-4.332
Batch 375/537: Loss=0.9157 (C:0.9157, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.985, Ratio=4.04x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.994, Ratio=3.93x, Gap=-4.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.993, Ratio=4.09x, Gap=-3.811
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.986, Ratio=4.04x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.982, Ratio=3.98x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.997, Ratio=4.16x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.964, Ratio=3.90x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.987, Ratio=3.91x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.997, Ratio=4.07x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.965, Ratio=3.79x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.000, Ratio=3.98x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.989, Ratio=3.95x, Gap=-4.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.988, Ratio=4.16x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.989, Ratio=3.88x, Gap=-4.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.968, Ratio=3.88x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.985, Ratio=4.02x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.992, Ratio=3.93x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.979, Ratio=3.93x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.977, Ratio=3.85x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.968, Ratio=4.03x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.982, Ratio=3.91x, Gap=-4.087
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.987, Ratio=3.88x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.997, Ratio=4.14x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.975, Ratio=3.89x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.001, Ratio=4.09x, Gap=-5.096
Batch 400/537: Loss=0.8900 (C:0.8900, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.992, Ratio=4.02x, Gap=-4.866
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.976, Ratio=4.01x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.971, Ratio=3.90x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.008, Ratio=4.10x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.980, Ratio=3.97x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.994, Ratio=4.02x, Gap=-4.473
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.980, Ratio=3.99x, Gap=-4.078
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.989, Ratio=3.89x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.969, Ratio=3.83x, Gap=-4.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.995, Ratio=4.05x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.974, Ratio=4.06x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.023, Ratio=4.07x, Gap=-3.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=1.964, Ratio=3.72x, Gap=-4.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.987, Ratio=3.86x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.999, Ratio=4.01x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.000, Ratio=3.95x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.994, Ratio=4.12x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.991, Ratio=3.92x, Gap=-4.431
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.976, Ratio=3.98x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.947, Ratio=3.80x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.974, Ratio=3.93x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.975, Ratio=4.07x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.987, Ratio=4.02x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.954, Ratio=3.85x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.971, Ratio=3.96x, Gap=-3.857
Batch 425/537: Loss=0.9159 (C:0.9159, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.979, Ratio=3.92x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.999, Ratio=4.01x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.984, Ratio=3.94x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.002, Ratio=4.17x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.001, Ratio=3.98x, Gap=-4.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.984, Ratio=3.85x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.980, Ratio=3.81x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.985, Ratio=4.05x, Gap=-4.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.004, Ratio=4.18x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.983, Ratio=4.03x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.973, Ratio=3.93x, Gap=-4.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.001, Ratio=4.00x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.000, Ratio=3.99x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.995, Ratio=4.09x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.983, Ratio=3.88x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.998, Ratio=4.04x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.983, Ratio=3.92x, Gap=-4.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.023, Ratio=4.16x, Gap=-4.245
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.963, Ratio=3.93x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.970, Ratio=3.82x, Gap=-4.888
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.982, Ratio=3.85x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.984, Ratio=4.14x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.982, Ratio=4.00x, Gap=-4.172
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.982, Ratio=3.94x, Gap=-4.121
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.965, Ratio=3.86x, Gap=-4.434
Batch 450/537: Loss=0.9259 (C:0.9259, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.987, Ratio=3.99x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.965, Ratio=3.99x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.970, Ratio=3.90x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.527, Neg=1.973, Ratio=3.75x, Gap=-4.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.966, Ratio=3.84x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.964, Ratio=3.86x, Gap=-5.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.982, Ratio=3.91x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.018, Ratio=4.07x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.971, Ratio=3.92x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.549, Neg=1.957, Ratio=3.57x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.971, Ratio=3.90x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.995, Ratio=3.92x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.009, Ratio=4.14x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.972, Ratio=3.89x, Gap=-4.219
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.979, Ratio=3.89x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.996, Ratio=3.92x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.976, Ratio=3.84x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.990, Ratio=4.14x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.999, Ratio=4.05x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.967, Ratio=3.85x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.954, Ratio=3.77x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.966, Ratio=3.84x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.962, Ratio=3.91x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.007, Ratio=4.17x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.968, Ratio=3.92x, Gap=-4.024
Batch 475/537: Loss=0.9179 (C:0.9179, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.006, Ratio=4.16x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=1.958, Ratio=3.72x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.974, Ratio=3.97x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.979, Ratio=4.03x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.964, Ratio=3.96x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.972, Ratio=3.80x, Gap=-4.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.985, Ratio=3.88x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.016, Ratio=4.10x, Gap=-4.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.987, Ratio=3.87x, Gap=-4.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.993, Ratio=3.84x, Gap=-4.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.996, Ratio=4.02x, Gap=-4.082
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.994, Ratio=3.95x, Gap=-4.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.968, Ratio=3.90x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.956, Ratio=3.85x, Gap=-4.028
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.965, Ratio=3.85x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.977, Ratio=3.97x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.969, Ratio=3.86x, Gap=-4.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.967, Ratio=3.89x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.980, Ratio=3.87x, Gap=-3.989
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.983, Ratio=3.83x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.974, Ratio=3.97x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.967, Ratio=3.71x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.952, Ratio=3.64x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.986, Ratio=3.91x, Gap=-4.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.973, Ratio=3.96x, Gap=-4.162
Batch 500/537: Loss=0.9095 (C:0.9095, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.987, Ratio=4.16x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.954, Ratio=3.77x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.984, Ratio=3.95x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.960, Ratio=3.98x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.959, Ratio=3.75x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.973, Ratio=4.09x, Gap=-3.965
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.970, Ratio=3.88x, Gap=-4.358
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.992, Ratio=4.04x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.982, Ratio=4.04x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.973, Ratio=3.92x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.968, Ratio=3.88x, Gap=-4.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.994, Ratio=4.02x, Gap=-3.958
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.990, Ratio=3.92x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.996, Ratio=4.02x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.011, Ratio=4.03x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.983, Ratio=4.05x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.981, Ratio=3.89x, Gap=-5.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.986, Ratio=4.06x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.523, Neg=1.972, Ratio=3.77x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.965, Ratio=3.87x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.004, Ratio=4.09x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.995, Ratio=4.20x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.969, Ratio=3.79x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.531, Neg=1.944, Ratio=3.66x, Gap=-4.972
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.975, Ratio=4.09x, Gap=-4.037
Batch 525/537: Loss=0.8956 (C:0.8956, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.959, Ratio=3.86x, Gap=-4.223
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.969, Ratio=3.79x, Gap=-4.964
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.977, Ratio=4.07x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.976, Ratio=4.07x, Gap=-4.126
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.979, Ratio=3.98x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.000, Ratio=3.93x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.995, Ratio=4.28x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.000, Ratio=3.96x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.980, Ratio=3.98x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.992, Ratio=4.12x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.994, Ratio=4.04x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.014, Ratio=4.58x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.008, Ratio=4.57x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.990, Ratio=4.22x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.995, Ratio=4.22x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.007, Ratio=4.55x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.985, Ratio=4.07x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.003, Ratio=4.42x, Gap=-3.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.025, Ratio=4.62x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.007, Ratio=4.40x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.016, Ratio=4.60x, Gap=-3.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.002, Ratio=4.41x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.021, Ratio=4.46x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.988, Ratio=4.31x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.015, Ratio=4.72x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.995, Ratio=4.39x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.984, Ratio=4.16x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.978, Ratio=4.13x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.019, Ratio=4.57x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.008, Ratio=4.59x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.999, Ratio=4.44x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.998, Ratio=4.29x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.992, Ratio=4.35x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.996, Ratio=4.37x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.000, Ratio=4.38x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.991, Ratio=4.34x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.017, Ratio=4.45x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.041, Ratio=4.86x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.985, Ratio=4.33x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.993, Ratio=4.24x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.010, Ratio=4.67x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.022, Ratio=4.63x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.014, Ratio=4.62x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.971, Ratio=4.11x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.015, Ratio=4.60x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.014, Ratio=4.45x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.985, Ratio=4.12x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.011, Ratio=4.48x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.988, Ratio=4.32x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.993, Ratio=4.39x, Gap=-3.551
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.004, Ratio=4.34x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.014, Ratio=4.45x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.986, Ratio=4.24x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.009, Ratio=4.36x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.010, Ratio=4.63x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.002, Ratio=4.50x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.996, Ratio=4.27x, Gap=-3.533
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.003, Ratio=4.41x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.995, Ratio=4.45x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.30x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.987, Ratio=4.26x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.021, Ratio=4.66x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.972, Ratio=4.16x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.995, Ratio=4.36x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.028, Ratio=4.70x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.998, Ratio=4.33x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.978, Ratio=4.21x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.990, Ratio=4.36x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.003, Ratio=4.39x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.987, Ratio=4.30x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.028, Ratio=4.54x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.003, Ratio=4.35x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.983, Ratio=4.38x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.004, Ratio=4.39x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.002, Ratio=4.33x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.001, Ratio=4.34x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.997, Ratio=4.30x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.998, Ratio=4.30x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.006, Ratio=4.44x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.986, Ratio=4.22x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.994, Ratio=4.43x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.014, Ratio=4.50x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.987, Ratio=4.41x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.013, Ratio=4.38x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.024, Ratio=4.64x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.992, Ratio=4.24x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.019, Ratio=4.59x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.008, Ratio=4.58x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.978, Ratio=4.11x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.979, Ratio=4.23x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.992, Ratio=4.32x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.995, Ratio=4.25x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.013, Ratio=4.71x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.996, Ratio=4.32x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.006, Ratio=4.52x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.987, Ratio=4.22x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.970, Ratio=4.24x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.011, Ratio=4.40x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.010, Ratio=4.46x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.994, Ratio=4.43x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.014, Ratio=4.47x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.008, Ratio=4.34x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.026, Ratio=4.83x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.982, Ratio=4.32x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.984, Ratio=4.17x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.005, Ratio=4.35x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.029, Ratio=4.67x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.993, Ratio=4.32x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.012, Ratio=4.59x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.991, Ratio=4.16x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.008, Ratio=4.51x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.011, Ratio=4.48x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.991, Ratio=4.28x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.010, Ratio=4.49x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.000, Ratio=4.55x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.013, Ratio=4.50x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.986, Ratio=4.30x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.967, Ratio=4.24x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.022, Ratio=4.76x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.993, Ratio=4.29x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.991, Ratio=4.37x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.984, Ratio=4.26x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.990, Ratio=4.56x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.992, Ratio=4.27x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.001, Ratio=4.39x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.032, Ratio=4.54x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.996, Ratio=4.29x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.019, Ratio=4.63x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.011, Ratio=4.55x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.006, Ratio=4.53x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.005, Ratio=4.47x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.993, Ratio=4.53x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.010, Ratio=4.35x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.013, Ratio=4.74x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.991, Ratio=4.41x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.998, Ratio=4.34x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.000, Ratio=4.22x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.015, Ratio=4.52x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.008, Ratio=4.51x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.997, Ratio=4.26x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.985, Ratio=4.31x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.004, Ratio=4.24x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.015, Ratio=4.67x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.005, Ratio=4.31x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.999, Ratio=4.42x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.000, Ratio=4.48x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.017, Ratio=4.70x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.984, Ratio=4.11x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.005, Ratio=4.55x, Gap=-3.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.014, Ratio=4.62x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.995, Ratio=4.32x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.988, Ratio=4.28x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.031, Ratio=4.80x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.021, Ratio=4.63x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.007, Ratio=4.59x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.008, Ratio=4.42x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.995, Ratio=4.21x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.017, Ratio=4.46x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.003, Ratio=4.45x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.001, Ratio=4.35x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.982, Ratio=4.25x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.001, Ratio=4.56x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.005, Ratio=4.58x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.013, Ratio=4.53x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.995, Ratio=4.35x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.018, Ratio=4.62x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.008, Ratio=4.28x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.006, Ratio=4.45x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.008, Ratio=4.34x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.021, Ratio=4.64x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.977, Ratio=4.35x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.984, Ratio=4.30x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.979, Ratio=4.31x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.004, Ratio=4.49x, Gap=-3.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.973, Ratio=4.12x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.022, Ratio=4.57x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.007, Ratio=4.49x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.985, Ratio=4.30x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.982, Ratio=4.31x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.001, Ratio=4.50x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.981, Ratio=4.30x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.995, Ratio=4.34x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.989, Ratio=4.27x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.004, Ratio=4.57x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.011, Ratio=4.58x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.003, Ratio=4.56x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.000, Ratio=4.51x, Gap=-3.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.002, Ratio=4.48x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.011, Ratio=4.58x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.997, Ratio=4.21x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.962, Ratio=4.08x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.998, Ratio=4.29x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.002, Ratio=4.47x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.984, Ratio=4.25x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.001, Ratio=4.32x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.27x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.000, Ratio=4.60x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.995, Ratio=4.29x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.009, Ratio=4.61x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.990, Ratio=4.30x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.998, Ratio=4.52x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.016, Ratio=4.61x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.994, Ratio=4.44x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.003, Ratio=4.35x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.012, Ratio=4.32x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.997, Ratio=4.38x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.993, Ratio=4.28x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.006, Ratio=4.40x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.000, Ratio=4.42x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.010, Ratio=4.59x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.988, Ratio=4.23x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.003, Ratio=4.53x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.034, Ratio=4.77x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.026, Ratio=4.70x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.999, Ratio=4.40x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.004, Ratio=4.52x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.013, Ratio=4.53x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.991, Ratio=4.21x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.994, Ratio=4.42x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.023, Ratio=4.62x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.001, Ratio=4.44x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.019, Ratio=4.48x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.978, Ratio=4.19x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.998, Ratio=4.46x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.999, Ratio=4.36x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.008, Ratio=4.43x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.977, Ratio=4.12x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.990, Ratio=4.39x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.032, Ratio=4.56x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.004, Ratio=4.34x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.006, Ratio=4.27x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.007, Ratio=4.41x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.000, Ratio=4.50x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.000, Ratio=4.39x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.993, Ratio=4.44x, Gap=-3.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.010, Ratio=4.53x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.984, Ratio=4.21x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.978, Ratio=4.27x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.004, Ratio=4.29x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.001, Ratio=4.34x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.996, Ratio=4.38x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.005, Ratio=4.41x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.985, Ratio=4.29x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.982, Ratio=4.25x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.014, Ratio=4.40x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.994, Ratio=4.38x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.996, Ratio=4.49x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.008, Ratio=4.48x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.014, Ratio=4.61x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.001, Ratio=4.49x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.988, Ratio=4.27x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.028, Ratio=4.75x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.998, Ratio=4.48x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.968, Ratio=3.98x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.021, Ratio=4.63x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.019, Ratio=4.55x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.986, Ratio=4.37x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.004, Ratio=4.64x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.023, Ratio=4.49x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.004, Ratio=4.47x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.027, Ratio=4.64x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.989, Ratio=4.37x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.978, Ratio=4.28x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.005, Ratio=4.42x, Gap=-3.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.014, Ratio=4.63x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.997, Ratio=4.21x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.003, Ratio=4.40x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.987, Ratio=4.44x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.003, Ratio=4.49x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.994, Ratio=4.33x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.019, Ratio=4.66x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.035, Ratio=4.66x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.019, Ratio=4.74x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.991, Ratio=4.47x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.012, Ratio=4.55x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.994, Ratio=4.48x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.009, Ratio=4.38x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.019, Ratio=4.62x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.010, Ratio=4.41x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.013, Ratio=4.59x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.996, Ratio=4.34x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.004, Ratio=4.55x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.998, Ratio=4.49x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.992, Ratio=4.27x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.011, Ratio=4.49x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.000, Ratio=4.56x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.004, Ratio=4.39x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.013, Ratio=4.29x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.008, Ratio=4.45x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.016, Ratio=4.70x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.012, Ratio=4.57x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.015, Ratio=4.60x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.47x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.013, Ratio=4.46x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.992, Ratio=4.41x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.009, Ratio=4.70x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.992, Ratio=4.54x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.005, Ratio=4.38x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.017, Ratio=4.31x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.989, Ratio=4.39x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.980, Ratio=4.31x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.010, Ratio=4.36x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.998, Ratio=4.39x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.983, Ratio=4.25x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.996, Ratio=4.33x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.016, Ratio=4.30x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.991, Ratio=4.31x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.951, Ratio=4.05x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.981, Ratio=4.20x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.988, Ratio=4.34x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.006, Ratio=4.56x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.992, Ratio=4.34x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.994, Ratio=4.17x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.990, Ratio=4.33x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.983, Ratio=4.41x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.984, Ratio=4.32x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.008, Ratio=4.33x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.019, Ratio=4.71x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.998, Ratio=4.32x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.023, Ratio=4.57x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.000, Ratio=4.50x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.987, Ratio=4.25x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.987, Ratio=4.31x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.989, Ratio=4.40x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.010, Ratio=4.48x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.971, Ratio=4.22x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.959, Ratio=3.96x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.994, Ratio=4.27x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.981, Ratio=4.32x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.011, Ratio=4.60x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.986, Ratio=4.18x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.012, Ratio=4.45x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.015, Ratio=4.52x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.999, Ratio=4.32x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.999, Ratio=4.38x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.999, Ratio=4.37x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.007, Ratio=4.39x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.019, Ratio=4.47x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.008, Ratio=4.65x, Gap=-3.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.997, Ratio=4.39x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.019, Ratio=4.45x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.998, Ratio=4.20x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.993, Ratio=4.42x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.000, Ratio=4.44x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.999, Ratio=4.37x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.991, Ratio=4.30x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.001, Ratio=4.46x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.985, Ratio=4.45x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.997, Ratio=4.41x, Gap=-3.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.007, Ratio=4.55x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.971, Ratio=4.23x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.008, Ratio=4.31x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.981, Ratio=4.44x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.034, Ratio=4.72x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.001, Ratio=4.51x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.021, Ratio=4.55x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.983, Ratio=4.26x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.027, Ratio=4.71x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.995, Ratio=4.39x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.990, Ratio=4.19x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.976, Ratio=4.10x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.990, Ratio=4.34x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.984, Ratio=4.29x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.978, Ratio=4.32x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.996, Ratio=4.54x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.007, Ratio=4.48x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.004, Ratio=4.45x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.996, Ratio=4.23x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.030, Ratio=4.75x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.011, Ratio=4.44x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.001, Ratio=4.43x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.992, Ratio=4.39x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.005, Ratio=4.40x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.011, Ratio=4.37x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.995, Ratio=4.37x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.023, Ratio=4.65x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.986, Ratio=4.28x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.007, Ratio=4.46x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.999, Ratio=4.31x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.009, Ratio=4.46x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.990, Ratio=4.37x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.981, Ratio=4.20x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.002, Ratio=4.48x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.006, Ratio=4.60x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.997, Ratio=4.29x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.992, Ratio=4.41x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.013, Ratio=4.50x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.006, Ratio=4.42x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.014, Ratio=4.57x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.001, Ratio=4.54x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.016, Ratio=4.46x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.009, Ratio=4.50x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.027, Ratio=4.66x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.021, Ratio=4.57x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.993, Ratio=4.42x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.029, Ratio=4.58x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.005, Ratio=4.40x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.000, Ratio=4.50x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.015, Ratio=4.53x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.025, Ratio=4.60x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.012, Ratio=4.59x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.990, Ratio=4.37x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.991, Ratio=4.34x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.995, Ratio=4.33x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.000, Ratio=4.42x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.991, Ratio=4.34x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.991, Ratio=4.36x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.003, Ratio=4.36x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.008, Ratio=4.56x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.013, Ratio=4.47x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.014, Ratio=4.43x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.997, Ratio=4.26x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.005, Ratio=4.44x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.000, Ratio=4.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.974, Ratio=4.34x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.973, Ratio=4.21x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.984, Ratio=4.36x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.993, Ratio=4.39x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.002, Ratio=4.46x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.018, Ratio=4.49x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.991, Ratio=4.46x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.993, Ratio=4.29x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.028, Ratio=4.64x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.020, Ratio=4.76x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.006, Ratio=4.44x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.003, Ratio=4.41x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.002, Ratio=4.42x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.016, Ratio=4.63x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.986, Ratio=4.31x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.994, Ratio=4.50x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.975, Ratio=4.22x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.014, Ratio=4.45x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.017, Ratio=4.46x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.008, Ratio=4.69x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.999, Ratio=4.27x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.991, Ratio=4.37x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.011, Ratio=4.54x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.021, Ratio=4.66x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.028, Ratio=4.55x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.008, Ratio=4.55x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.981, Ratio=4.18x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.011, Ratio=4.45x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.012, Ratio=4.44x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.980, Ratio=4.25x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.022, Ratio=4.62x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.001, Ratio=4.49x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.988, Ratio=4.27x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.990, Ratio=4.28x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.028, Ratio=4.69x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.004, Ratio=4.34x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.011, Ratio=4.48x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.016, Ratio=4.47x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.979, Ratio=4.35x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.996, Ratio=4.25x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.002, Ratio=4.31x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.010, Ratio=4.41x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.966, Ratio=4.01x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.998, Ratio=4.62x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.997, Ratio=4.49x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.000, Ratio=4.44x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.013, Ratio=4.44x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.011, Ratio=4.64x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.003, Ratio=4.38x, Gap=-3.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.975, Ratio=4.12x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.014, Ratio=4.50x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.004, Ratio=4.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.995, Ratio=4.31x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.996, Ratio=4.43x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.000, Ratio=4.52x, Gap=-3.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.999, Ratio=4.26x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.012, Ratio=4.45x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.013, Ratio=4.65x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.013, Ratio=4.49x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.999, Ratio=4.37x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.990, Ratio=4.52x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.991, Ratio=4.49x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.002, Ratio=4.30x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.006, Ratio=4.53x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.000, Ratio=4.33x, Gap=-3.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.989, Ratio=4.25x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.996, Ratio=4.48x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.999, Ratio=4.53x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.993, Ratio=4.31x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.004, Ratio=4.37x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.017, Ratio=4.78x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.978, Ratio=4.12x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.002, Ratio=4.53x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.992, Ratio=4.22x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.981, Ratio=4.25x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.988, Ratio=4.43x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.994, Ratio=4.33x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.015, Ratio=4.57x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.000, Ratio=4.58x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.999, Ratio=4.41x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.995, Ratio=4.47x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.993, Ratio=4.36x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.049, Ratio=4.82x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.992, Ratio=4.32x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.997, Ratio=4.29x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.008, Ratio=4.41x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.976, Ratio=4.22x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.981, Ratio=4.23x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.48x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.015, Ratio=4.69x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.019, Ratio=4.50x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.001, Ratio=4.61x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.998, Ratio=4.49x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.008, Ratio=4.52x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.987, Ratio=4.29x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.987, Ratio=4.32x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.989, Ratio=4.23x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.015, Ratio=4.37x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.998, Ratio=4.42x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.014, Ratio=4.57x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.002, Ratio=4.52x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.987, Ratio=4.32x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.988, Ratio=4.41x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.037, Ratio=4.72x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.989, Ratio=4.30x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.963, Ratio=4.20x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.006, Ratio=4.40x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.996, Ratio=4.55x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.995, Ratio=4.33x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.011, Ratio=4.26x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.008, Ratio=4.56x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.993, Ratio=4.48x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.998, Ratio=4.24x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.000, Ratio=4.35x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.007, Ratio=4.44x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.014, Ratio=4.64x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.000, Ratio=4.57x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.021, Ratio=4.42x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.985, Ratio=4.14x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.019, Ratio=4.65x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.012, Ratio=4.61x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.987, Ratio=4.40x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.013, Ratio=4.54x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.005, Ratio=4.45x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.973, Ratio=4.27x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.999, Ratio=4.45x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.009, Ratio=4.36x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.994, Ratio=4.43x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.975, Ratio=4.27x, Gap=-3.684

============================================================
Epoch 17/20 completed in 33.2s
Train: Loss=0.9054 (C:0.9054, R:0.0105) Ratio=3.63x
Val:   Loss=0.8471 (C:0.8471, R:0.0105) Ratio=4.59x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.8471)
============================================================

Epoch 18 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.976, Ratio=4.02x, Gap=-4.573
Batch   0/537: Loss=0.8998 (C:0.8998, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.971, Ratio=4.00x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.019, Ratio=4.28x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.003, Ratio=4.14x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.004, Ratio=4.16x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.004, Ratio=4.16x, Gap=-4.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.971, Ratio=3.91x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.017, Ratio=4.24x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.974, Ratio=3.94x, Gap=-4.463
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.966, Ratio=3.82x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.014, Ratio=4.30x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.001, Ratio=4.19x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.991, Ratio=4.11x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.983, Ratio=3.98x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.985, Ratio=4.11x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.030, Ratio=4.30x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.017, Ratio=4.22x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.992, Ratio=4.00x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.987, Ratio=4.05x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.991, Ratio=4.01x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.027, Ratio=4.34x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.968, Ratio=3.86x, Gap=-4.286
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.002, Ratio=4.08x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.983, Ratio=3.94x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.996, Ratio=4.05x, Gap=-4.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.983, Ratio=4.08x, Gap=-4.531
Batch  25/537: Loss=0.8922 (C:0.8922, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.971, Ratio=3.91x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.979, Ratio=3.95x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.980, Ratio=4.07x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.004, Ratio=4.17x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.982, Ratio=3.96x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.010, Ratio=4.31x, Gap=-3.963
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.985, Ratio=4.03x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.985, Ratio=4.18x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.992, Ratio=3.95x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.992, Ratio=4.16x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.968, Ratio=3.88x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.004, Ratio=4.02x, Gap=-4.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.008, Ratio=4.22x, Gap=-4.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.010, Ratio=4.18x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.999, Ratio=4.07x, Gap=-3.974
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.990, Ratio=4.01x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.957, Ratio=3.85x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.991, Ratio=4.21x, Gap=-4.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.991, Ratio=4.02x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.985, Ratio=4.23x, Gap=-4.063
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.008, Ratio=3.95x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.980, Ratio=3.95x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.992, Ratio=4.20x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.000, Ratio=4.09x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.976, Ratio=4.03x, Gap=-4.159
Batch  50/537: Loss=0.8991 (C:0.8991, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.989, Ratio=4.02x, Gap=-4.379
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.980, Ratio=3.79x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.030, Ratio=4.45x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.998, Ratio=3.98x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.009, Ratio=4.27x, Gap=-4.483
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.980, Ratio=4.04x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.986, Ratio=4.14x, Gap=-4.100
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.979, Ratio=3.85x, Gap=-4.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.999, Ratio=4.05x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.004, Ratio=4.08x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.984, Ratio=3.98x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.993, Ratio=3.95x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.978, Ratio=3.99x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.982, Ratio=4.13x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.985, Ratio=4.01x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.006, Ratio=4.33x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.971, Ratio=3.82x, Gap=-4.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.997, Ratio=4.23x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.972, Ratio=3.79x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.009, Ratio=4.21x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.984, Ratio=3.87x, Gap=-4.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.977, Ratio=3.90x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.990, Ratio=3.86x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.970, Ratio=3.85x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.996, Ratio=4.07x, Gap=-4.244
Batch  75/537: Loss=0.8944 (C:0.8944, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.996, Ratio=4.12x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.999, Ratio=4.20x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.000, Ratio=4.06x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.017, Ratio=4.30x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.972, Ratio=4.20x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.992, Ratio=4.14x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.986, Ratio=4.11x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.989, Ratio=4.06x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.984, Ratio=4.06x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.968, Ratio=4.04x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.980, Ratio=4.08x, Gap=-3.924
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.986, Ratio=3.93x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.018, Ratio=4.21x, Gap=-4.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.996, Ratio=4.00x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.971, Ratio=3.88x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.013, Ratio=4.01x, Gap=-4.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.000, Ratio=4.01x, Gap=-4.052
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.006, Ratio=4.05x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.003, Ratio=4.13x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.999, Ratio=4.18x, Gap=-4.413
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.981, Ratio=4.00x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.006, Ratio=4.22x, Gap=-4.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.013, Ratio=4.24x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.976, Ratio=4.09x, Gap=-4.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.993, Ratio=4.17x, Gap=-3.812
Batch 100/537: Loss=0.8813 (C:0.8813, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.994, Ratio=4.18x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.975, Ratio=3.90x, Gap=-4.182
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.987, Ratio=4.03x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.967, Ratio=3.79x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.958, Ratio=4.00x, Gap=-4.016
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.974, Ratio=3.92x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.979, Ratio=4.06x, Gap=-4.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.003, Ratio=4.23x, Gap=-4.376
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.995, Ratio=4.07x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.996, Ratio=3.93x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.993, Ratio=4.03x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.005, Ratio=4.16x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.986, Ratio=4.04x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.018, Ratio=4.26x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.522, Neg=1.951, Ratio=3.73x, Gap=-4.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.955, Ratio=3.78x, Gap=-4.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.006, Ratio=4.23x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.004, Ratio=4.17x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.973, Ratio=3.92x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.996, Ratio=3.99x, Gap=-5.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.994, Ratio=3.98x, Gap=-4.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.006, Ratio=4.10x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.993, Ratio=3.99x, Gap=-4.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.008, Ratio=4.08x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.996, Ratio=4.13x, Gap=-4.110
Batch 125/537: Loss=0.8821 (C:0.8821, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.002, Ratio=4.03x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.010, Ratio=4.12x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.996, Ratio=4.09x, Gap=-4.455
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.984, Ratio=3.91x, Gap=-3.885
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.975, Ratio=3.97x, Gap=-4.018
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.994, Ratio=4.05x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.002, Ratio=4.15x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.972, Ratio=3.87x, Gap=-3.843
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.976, Ratio=3.89x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.009, Ratio=4.13x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.001, Ratio=4.08x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.964, Ratio=3.98x, Gap=-4.088
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.986, Ratio=4.10x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.001, Ratio=4.12x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.986, Ratio=3.97x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.958, Ratio=3.68x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.016, Ratio=4.23x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.005, Ratio=4.16x, Gap=-4.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.001, Ratio=3.96x, Gap=-4.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.007, Ratio=4.09x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.994, Ratio=4.05x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.982, Ratio=4.04x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.989, Ratio=4.08x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.983, Ratio=4.00x, Gap=-4.353
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.993, Ratio=4.15x, Gap=-4.032
Batch 150/537: Loss=0.8811 (C:0.8811, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.972, Ratio=4.00x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.991, Ratio=3.94x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.980, Ratio=4.07x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.004, Ratio=4.28x, Gap=-4.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.991, Ratio=4.03x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.008, Ratio=4.19x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.971, Ratio=3.93x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.991, Ratio=4.13x, Gap=-4.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.984, Ratio=3.90x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.984, Ratio=3.88x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.979, Ratio=3.96x, Gap=-4.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.981, Ratio=3.85x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.013, Ratio=4.22x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.015, Ratio=4.27x, Gap=-4.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.989, Ratio=4.04x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.971, Ratio=3.84x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.985, Ratio=4.06x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.997, Ratio=4.06x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.987, Ratio=3.92x, Gap=-4.155
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.003, Ratio=4.10x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.998, Ratio=4.07x, Gap=-4.896
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.003, Ratio=4.03x, Gap=-3.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.992, Ratio=4.05x, Gap=-3.920
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.996, Ratio=4.07x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.999, Ratio=4.16x, Gap=-4.075
Batch 175/537: Loss=0.8826 (C:0.8826, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.003, Ratio=4.02x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.536, Neg=1.961, Ratio=3.66x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.011, Ratio=4.19x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.987, Ratio=4.10x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.955, Ratio=3.86x, Gap=-4.877
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.005, Ratio=4.15x, Gap=-4.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.987, Ratio=4.11x, Gap=-3.917
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.984, Ratio=4.09x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.006, Ratio=4.06x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.974, Ratio=3.91x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.000, Ratio=4.05x, Gap=-4.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.970, Ratio=3.87x, Gap=-4.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.995, Ratio=4.00x, Gap=-4.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.989, Ratio=4.01x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.991, Ratio=4.07x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.973, Ratio=3.83x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.002, Ratio=4.07x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.000, Ratio=4.04x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.978, Ratio=3.88x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.986, Ratio=4.10x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.989, Ratio=3.95x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.985, Ratio=3.94x, Gap=-4.447
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.992, Ratio=3.99x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.008, Ratio=4.24x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.985, Ratio=4.02x, Gap=-4.047
Batch 200/537: Loss=0.9030 (C:0.9030, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.010, Ratio=4.09x, Gap=-4.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.996, Ratio=4.01x, Gap=-4.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.984, Ratio=4.02x, Gap=-4.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.997, Ratio=4.08x, Gap=-4.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.000, Ratio=4.06x, Gap=-4.148
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.992, Ratio=3.99x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.972, Ratio=3.90x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.987, Ratio=4.08x, Gap=-4.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.960, Ratio=3.95x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.964, Ratio=3.95x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.989, Ratio=4.17x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.979, Ratio=3.95x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.977, Ratio=4.07x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.973, Ratio=3.86x, Gap=-4.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.001, Ratio=4.01x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.988, Ratio=4.02x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.987, Ratio=3.99x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.981, Ratio=3.94x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.979, Ratio=3.96x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.990, Ratio=3.97x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.005, Ratio=4.21x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.990, Ratio=4.04x, Gap=-4.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.983, Ratio=3.90x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.976, Ratio=4.00x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.977, Ratio=3.97x, Gap=-4.412
Batch 225/537: Loss=0.9079 (C:0.9079, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.016, Ratio=4.29x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.973, Ratio=3.95x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.966, Ratio=3.97x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=1.996, Ratio=4.23x, Gap=-4.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.971, Ratio=3.86x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.986, Ratio=3.83x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.987, Ratio=3.90x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.997, Ratio=3.99x, Gap=-4.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.999, Ratio=3.96x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.994, Ratio=4.06x, Gap=-4.568
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.996, Ratio=3.92x, Gap=-4.105
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.986, Ratio=3.94x, Gap=-4.838
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.996, Ratio=4.19x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.978, Ratio=3.89x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.985, Ratio=4.10x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.992, Ratio=4.00x, Gap=-4.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.008, Ratio=4.03x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.969, Ratio=3.86x, Gap=-4.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.007, Ratio=4.16x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.971, Ratio=3.99x, Gap=-4.147
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.964, Ratio=3.96x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.976, Ratio=4.08x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.976, Ratio=3.98x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.013, Ratio=4.15x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=1.999, Ratio=4.20x, Gap=-4.125
Batch 250/537: Loss=0.8759 (C:0.8759, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.999, Ratio=4.11x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.002, Ratio=4.06x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.009, Ratio=4.10x, Gap=-3.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.962, Ratio=3.86x, Gap=-4.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.976, Ratio=4.01x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.994, Ratio=4.11x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.953, Ratio=3.77x, Gap=-4.298
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.986, Ratio=3.97x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.005, Ratio=4.13x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.974, Ratio=3.86x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.983, Ratio=4.02x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.983, Ratio=3.86x, Gap=-4.238
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.982, Ratio=3.96x, Gap=-4.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.008, Ratio=4.23x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.993, Ratio=4.12x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.984, Ratio=3.88x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.986, Ratio=3.96x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.018, Ratio=4.28x, Gap=-4.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.981, Ratio=3.85x, Gap=-4.814
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.005, Ratio=4.16x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.995, Ratio=4.18x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.995, Ratio=4.07x, Gap=-4.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.014, Ratio=4.26x, Gap=-4.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.990, Ratio=4.02x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.985, Ratio=3.98x, Gap=-4.449
Batch 275/537: Loss=0.9046 (C:0.9046, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.959, Ratio=3.83x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.991, Ratio=4.03x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.993, Ratio=4.08x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.004, Ratio=4.06x, Gap=-4.217
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.009, Ratio=4.01x, Gap=-5.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.981, Ratio=3.90x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.977, Ratio=3.99x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.988, Ratio=3.96x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.989, Ratio=3.96x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.969, Ratio=3.70x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.002, Ratio=4.17x, Gap=-4.266
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.963, Ratio=3.94x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.975, Ratio=4.06x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.995, Ratio=4.07x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.955, Ratio=3.83x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.983, Ratio=3.99x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.016, Ratio=4.14x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.996, Ratio=4.14x, Gap=-4.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.993, Ratio=4.14x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.982, Ratio=3.98x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.986, Ratio=4.01x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.003, Ratio=4.19x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.005, Ratio=4.17x, Gap=-3.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.998, Ratio=3.92x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.992, Ratio=4.02x, Gap=-4.084
Batch 300/537: Loss=0.8998 (C:0.8998, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.004, Ratio=4.05x, Gap=-4.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.983, Ratio=4.04x, Gap=-3.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.982, Ratio=3.97x, Gap=-4.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.016, Ratio=4.13x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.983, Ratio=4.12x, Gap=-4.391
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.983, Ratio=4.12x, Gap=-3.906
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.990, Ratio=3.97x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.955, Ratio=3.82x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.957, Ratio=3.86x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.012, Ratio=4.23x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.005, Ratio=4.18x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.980, Ratio=4.01x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.982, Ratio=3.92x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.988, Ratio=3.95x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.005, Ratio=4.05x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.976, Ratio=3.90x, Gap=-4.310
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.012, Ratio=4.08x, Gap=-3.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.007, Ratio=4.11x, Gap=-4.387
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.010, Ratio=3.94x, Gap=-4.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.004, Ratio=4.26x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.968, Ratio=3.91x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.982, Ratio=3.98x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.979, Ratio=4.06x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.000, Ratio=4.04x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.005, Ratio=4.05x, Gap=-4.306
Batch 325/537: Loss=0.8984 (C:0.8984, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.979, Ratio=3.93x, Gap=-4.324
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.989, Ratio=4.15x, Gap=-4.894
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.977, Ratio=4.07x, Gap=-4.192
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.967, Ratio=3.84x, Gap=-4.253
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.978, Ratio=4.04x, Gap=-4.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.965, Ratio=3.90x, Gap=-4.422
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.977, Ratio=4.13x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.963, Ratio=3.90x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.989, Ratio=4.10x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.981, Ratio=3.89x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.966, Ratio=3.94x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.977, Ratio=3.89x, Gap=-5.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.012, Ratio=4.19x, Gap=-4.309
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.006, Ratio=3.95x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.011, Ratio=4.20x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.022, Ratio=4.02x, Gap=-4.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.979, Ratio=3.97x, Gap=-4.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.007, Ratio=4.12x, Gap=-4.071
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.016, Ratio=4.19x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.003, Ratio=4.12x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.975, Ratio=3.94x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.985, Ratio=3.88x, Gap=-5.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.986, Ratio=3.99x, Gap=-4.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.969, Ratio=3.78x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.997, Ratio=4.06x, Gap=-4.388
Batch 350/537: Loss=0.8964 (C:0.8964, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.520, Neg=1.960, Ratio=3.77x, Gap=-4.291
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.992, Ratio=3.95x, Gap=-4.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.009, Ratio=4.30x, Gap=-4.210
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.974, Ratio=3.93x, Gap=-4.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.975, Ratio=3.95x, Gap=-4.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.987, Ratio=4.16x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.006, Ratio=4.08x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.988, Ratio=4.02x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.004, Ratio=3.98x, Gap=-4.189
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.003, Ratio=3.97x, Gap=-4.369
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.998, Ratio=4.23x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.984, Ratio=3.85x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.016, Ratio=4.11x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.990, Ratio=4.00x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.979, Ratio=3.87x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.999, Ratio=4.01x, Gap=-5.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.995, Ratio=4.00x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.980, Ratio=3.90x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.986, Ratio=3.99x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.959, Ratio=3.85x, Gap=-4.058
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.974, Ratio=4.04x, Gap=-4.073
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.970, Ratio=4.03x, Gap=-4.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.990, Ratio=4.10x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.987, Ratio=3.95x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.986, Ratio=4.14x, Gap=-4.320
Batch 375/537: Loss=0.8851 (C:0.8851, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.988, Ratio=4.12x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.533, Neg=1.948, Ratio=3.66x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.982, Ratio=3.89x, Gap=-4.834
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.010, Ratio=4.08x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.009, Ratio=4.00x, Gap=-4.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.010, Ratio=4.22x, Gap=-3.951
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.008, Ratio=4.14x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.972, Ratio=3.94x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.999, Ratio=3.87x, Gap=-4.334
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.977, Ratio=3.90x, Gap=-4.091
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.979, Ratio=4.02x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.950, Ratio=3.76x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.981, Ratio=3.93x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.004, Ratio=4.04x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.970, Ratio=3.81x, Gap=-4.187
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.921, Ratio=3.76x, Gap=-3.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.990, Ratio=4.07x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.997, Ratio=4.04x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.991, Ratio=4.06x, Gap=-4.068
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.961, Ratio=3.88x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.970, Ratio=3.94x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.998, Ratio=4.01x, Gap=-4.025
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.993, Ratio=3.98x, Gap=-4.259
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.998, Ratio=4.10x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.530, Neg=1.987, Ratio=3.75x, Gap=-4.439
Batch 400/537: Loss=0.9428 (C:0.9428, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.014, Ratio=4.30x, Gap=-4.393
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.988, Ratio=4.05x, Gap=-4.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.008, Ratio=4.17x, Gap=-3.874
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.002, Ratio=3.98x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=1.984, Ratio=4.09x, Gap=-4.041
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=1.993, Ratio=4.17x, Gap=-4.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.993, Ratio=4.07x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.000, Ratio=4.09x, Gap=-4.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.992, Ratio=4.06x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.001, Ratio=4.00x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=1.973, Ratio=3.90x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.001, Ratio=4.11x, Gap=-5.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.998, Ratio=3.97x, Gap=-3.982
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=1.974, Ratio=3.85x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.992, Ratio=4.08x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.993, Ratio=4.10x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.001, Ratio=4.06x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=1.981, Ratio=3.98x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.977, Ratio=3.89x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.537, Neg=1.963, Ratio=3.65x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.998, Ratio=4.32x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.991, Ratio=4.12x, Gap=-4.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.989, Ratio=4.07x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.947, Ratio=3.83x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=1.973, Ratio=4.08x, Gap=-4.545
Batch 425/537: Loss=0.8931 (C:0.8931, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.988, Ratio=3.97x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=1.980, Ratio=3.81x, Gap=-4.377
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.987, Ratio=3.96x, Gap=-4.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.973, Ratio=3.95x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.980, Ratio=3.96x, Gap=-3.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.001, Ratio=4.04x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.978, Ratio=3.90x, Gap=-4.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.984, Ratio=3.88x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.980, Ratio=3.96x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.979, Ratio=3.99x, Gap=-5.033
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.980, Ratio=4.03x, Gap=-3.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=1.975, Ratio=3.98x, Gap=-4.442
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.984, Ratio=3.98x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.979, Ratio=3.93x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.974, Ratio=3.96x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=1.970, Ratio=3.82x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.005, Ratio=4.06x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.989, Ratio=4.08x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.000, Ratio=4.02x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=1.973, Ratio=3.85x, Gap=-4.815
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.988, Ratio=4.04x, Gap=-4.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.993, Ratio=3.90x, Gap=-4.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.972, Ratio=3.87x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.953, Ratio=3.80x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.004, Ratio=4.19x, Gap=-4.402
Batch 450/537: Loss=0.8788 (C:0.8788, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.998, Ratio=3.98x, Gap=-4.042
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.981, Ratio=4.02x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.008, Ratio=4.16x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.977, Ratio=3.99x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.972, Ratio=3.93x, Gap=-4.190
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.001, Ratio=4.24x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.971, Ratio=3.87x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.002, Ratio=4.30x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.986, Ratio=3.98x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.984, Ratio=3.88x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.011, Ratio=4.14x, Gap=-4.075
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=1.991, Ratio=3.98x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.976, Ratio=4.12x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.004, Ratio=4.05x, Gap=-4.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.960, Ratio=3.98x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.967, Ratio=3.92x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.995, Ratio=4.15x, Gap=-4.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.002, Ratio=3.95x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.988, Ratio=3.89x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.009, Ratio=4.02x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.975, Ratio=4.00x, Gap=-4.168
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.989, Ratio=3.96x, Gap=-4.274
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.994, Ratio=3.93x, Gap=-4.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.974, Ratio=3.93x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.521, Neg=1.960, Ratio=3.76x, Gap=-4.294
Batch 475/537: Loss=0.9407 (C:0.9407, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.959, Ratio=3.74x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.992, Ratio=4.03x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=1.968, Ratio=3.93x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=1.982, Ratio=3.89x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.009, Ratio=4.27x, Gap=-3.944
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.987, Ratio=4.05x, Gap=-3.999
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.983, Ratio=3.90x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.994, Ratio=3.97x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.975, Ratio=3.90x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.998, Ratio=4.05x, Gap=-4.124
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=1.980, Ratio=4.04x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.007, Ratio=4.13x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.003, Ratio=3.92x, Gap=-4.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=1.962, Ratio=3.95x, Gap=-3.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.987, Ratio=3.98x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.994, Ratio=3.96x, Gap=-4.335
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.983, Ratio=4.07x, Gap=-4.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=1.988, Ratio=3.87x, Gap=-4.013
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.003, Ratio=4.07x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=1.997, Ratio=4.10x, Gap=-4.095
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.998, Ratio=4.13x, Gap=-4.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.984, Ratio=4.14x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=1.993, Ratio=3.96x, Gap=-4.435
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.008, Ratio=4.09x, Gap=-4.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.012, Ratio=4.11x, Gap=-4.525
Batch 500/537: Loss=0.8873 (C:0.8873, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.007, Ratio=4.02x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.993, Ratio=4.04x, Gap=-4.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=1.990, Ratio=4.02x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=1.999, Ratio=4.07x, Gap=-4.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.000, Ratio=4.09x, Gap=-4.899
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.983, Ratio=3.91x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.975, Ratio=3.96x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=1.996, Ratio=3.95x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=1.987, Ratio=3.98x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=1.970, Ratio=3.92x, Gap=-3.960
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=1.962, Ratio=3.87x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.981, Ratio=4.02x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.971, Ratio=3.93x, Gap=-4.194
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.997, Ratio=4.08x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.995, Ratio=4.14x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.999, Ratio=4.16x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.979, Ratio=4.02x, Gap=-4.133
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.992, Ratio=4.08x, Gap=-4.946
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=1.982, Ratio=3.85x, Gap=-4.199
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=1.983, Ratio=3.83x, Gap=-4.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=1.972, Ratio=3.81x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=1.985, Ratio=3.96x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.524, Neg=1.991, Ratio=3.80x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=1.993, Ratio=4.08x, Gap=-4.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.532, Neg=1.946, Ratio=3.66x, Gap=-4.402
Batch 525/537: Loss=0.9661 (C:0.9661, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.988, Ratio=4.09x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=1.990, Ratio=3.92x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.996, Ratio=4.22x, Gap=-4.076
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.972, Ratio=3.87x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=1.992, Ratio=4.05x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=1.993, Ratio=3.90x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.005, Ratio=4.00x, Gap=-4.193
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=1.983, Ratio=3.90x, Gap=-4.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=1.992, Ratio=4.02x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=1.983, Ratio=4.03x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.993, Ratio=4.07x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.995, Ratio=4.31x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.010, Ratio=4.55x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.005, Ratio=4.55x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.009, Ratio=4.48x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.016, Ratio=4.55x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.015, Ratio=4.59x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.022, Ratio=4.58x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.025, Ratio=4.62x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.001, Ratio=4.46x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.014, Ratio=4.49x, Gap=-3.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.997, Ratio=4.50x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.023, Ratio=4.79x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.010, Ratio=4.64x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.979, Ratio=4.25x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.997, Ratio=4.42x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.012, Ratio=4.50x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.998, Ratio=4.43x, Gap=-3.790
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.011, Ratio=4.46x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.030, Ratio=4.82x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.979, Ratio=4.42x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.999, Ratio=4.26x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.019, Ratio=4.57x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.015, Ratio=4.50x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.022, Ratio=4.60x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.008, Ratio=4.41x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.006, Ratio=4.59x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.018, Ratio=4.61x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.011, Ratio=4.60x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.014, Ratio=4.61x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.023, Ratio=4.57x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.993, Ratio=4.49x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.031, Ratio=4.65x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.984, Ratio=4.52x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.014, Ratio=4.61x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.022, Ratio=4.48x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.021, Ratio=4.61x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.989, Ratio=4.35x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.003, Ratio=4.47x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.009, Ratio=4.53x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.011, Ratio=4.51x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.005, Ratio=4.42x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.018, Ratio=4.49x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.013, Ratio=4.59x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.993, Ratio=4.37x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.990, Ratio=4.31x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.992, Ratio=4.40x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.040, Ratio=4.79x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.016, Ratio=4.53x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.986, Ratio=4.27x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.988, Ratio=4.43x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.005, Ratio=4.62x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.992, Ratio=4.44x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.994, Ratio=4.26x, Gap=-3.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.017, Ratio=4.63x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.015, Ratio=4.89x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.993, Ratio=4.58x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.004, Ratio=4.49x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.997, Ratio=4.50x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.998, Ratio=4.32x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=1.997, Ratio=4.62x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.003, Ratio=4.45x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.003, Ratio=4.44x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.996, Ratio=4.61x, Gap=-3.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.021, Ratio=4.59x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.979, Ratio=4.34x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.990, Ratio=4.40x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.987, Ratio=4.25x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.984, Ratio=4.26x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.986, Ratio=4.24x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.997, Ratio=4.52x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.000, Ratio=4.39x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.009, Ratio=4.53x, Gap=-3.881
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.018, Ratio=4.61x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.995, Ratio=4.21x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.011, Ratio=4.49x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.967, Ratio=4.27x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.009, Ratio=4.64x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.987, Ratio=4.43x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.017, Ratio=4.63x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.007, Ratio=4.37x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.010, Ratio=4.41x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.011, Ratio=4.62x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.005, Ratio=4.49x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.013, Ratio=4.53x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.011, Ratio=4.38x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.017, Ratio=4.53x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.005, Ratio=4.64x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.026, Ratio=4.62x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.018, Ratio=4.61x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.027, Ratio=4.67x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.022, Ratio=4.62x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.024, Ratio=4.49x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.011, Ratio=4.46x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.024, Ratio=4.58x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.999, Ratio=4.39x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.016, Ratio=4.74x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.010, Ratio=4.57x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.020, Ratio=4.61x, Gap=-3.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.004, Ratio=4.48x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.985, Ratio=4.31x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.999, Ratio=4.45x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.000, Ratio=4.40x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.022, Ratio=4.50x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.996, Ratio=4.49x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.016, Ratio=4.36x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.028, Ratio=4.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.028, Ratio=4.84x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.997, Ratio=4.44x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.026, Ratio=4.68x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.995, Ratio=4.37x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=1.994, Ratio=4.61x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.002, Ratio=4.55x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.007, Ratio=4.52x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.992, Ratio=4.36x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.018, Ratio=4.68x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.982, Ratio=4.12x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.018, Ratio=4.65x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.992, Ratio=4.29x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.983, Ratio=4.40x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.006, Ratio=4.52x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.027, Ratio=4.80x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.023, Ratio=4.58x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=1.996, Ratio=4.57x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.004, Ratio=4.35x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.971, Ratio=4.23x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.017, Ratio=4.54x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=1.997, Ratio=4.51x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.024, Ratio=4.43x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.997, Ratio=4.43x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.037, Ratio=4.67x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.017, Ratio=4.63x, Gap=-3.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.997, Ratio=4.31x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.014, Ratio=4.73x, Gap=-3.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.005, Ratio=4.69x, Gap=-3.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.013, Ratio=4.65x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.992, Ratio=4.46x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.024, Ratio=4.66x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.014, Ratio=4.62x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.023, Ratio=4.79x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.013, Ratio=4.53x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.995, Ratio=4.20x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.980, Ratio=4.43x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.022, Ratio=4.54x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.006, Ratio=4.51x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.009, Ratio=4.59x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.013, Ratio=4.57x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.002, Ratio=4.34x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.002, Ratio=4.47x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=1.987, Ratio=4.20x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.016, Ratio=4.51x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=1.990, Ratio=4.34x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.999, Ratio=4.46x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.989, Ratio=4.22x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.000, Ratio=4.40x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.003, Ratio=4.49x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.018, Ratio=4.68x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.998, Ratio=4.38x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.015, Ratio=4.69x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.995, Ratio=4.34x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.992, Ratio=4.38x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.978, Ratio=4.38x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.982, Ratio=4.43x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.010, Ratio=4.57x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.015, Ratio=4.61x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.033, Ratio=4.74x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.999, Ratio=4.33x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.013, Ratio=4.39x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.003, Ratio=4.35x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.014, Ratio=4.71x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.009, Ratio=4.66x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.026, Ratio=4.63x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.023, Ratio=4.66x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.971, Ratio=4.27x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.48x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.007, Ratio=4.54x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.017, Ratio=4.45x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.013, Ratio=4.44x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.002, Ratio=4.26x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.005, Ratio=4.45x, Gap=-3.510
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.988, Ratio=4.28x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.994, Ratio=4.43x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.999, Ratio=4.40x, Gap=-3.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.000, Ratio=4.51x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.000, Ratio=4.61x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.024, Ratio=4.81x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.004, Ratio=4.44x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.006, Ratio=4.33x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.982, Ratio=4.35x, Gap=-3.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.995, Ratio=4.40x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=1.991, Ratio=4.63x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.983, Ratio=4.27x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.018, Ratio=4.48x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.998, Ratio=4.47x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.988, Ratio=4.19x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.004, Ratio=4.58x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.012, Ratio=4.43x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.037, Ratio=4.61x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.997, Ratio=4.31x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.018, Ratio=4.63x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.033, Ratio=4.94x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.012, Ratio=4.56x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.009, Ratio=4.57x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.013, Ratio=4.57x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.000, Ratio=4.44x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.012, Ratio=4.64x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.000, Ratio=4.44x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.007, Ratio=4.45x, Gap=-3.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.000, Ratio=4.48x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.012, Ratio=4.72x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.985, Ratio=4.54x, Gap=-3.526
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.987, Ratio=4.25x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.028, Ratio=4.70x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.011, Ratio=4.69x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=1.990, Ratio=4.15x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.021, Ratio=4.63x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.001, Ratio=4.54x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.024, Ratio=4.54x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.004, Ratio=4.52x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.019, Ratio=4.52x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.017, Ratio=4.75x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.980, Ratio=4.22x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.012, Ratio=4.66x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.995, Ratio=4.47x, Gap=-3.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.003, Ratio=4.63x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.986, Ratio=4.43x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.022, Ratio=4.56x, Gap=-3.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.006, Ratio=4.31x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.999, Ratio=4.51x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.013, Ratio=4.73x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.988, Ratio=4.33x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=1.998, Ratio=4.18x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.992, Ratio=4.32x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.033, Ratio=4.82x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.009, Ratio=4.55x, Gap=-3.546
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.002, Ratio=4.41x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.007, Ratio=4.52x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.006, Ratio=4.52x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.027, Ratio=4.68x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.021, Ratio=4.57x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.997, Ratio=4.29x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.000, Ratio=4.50x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.001, Ratio=4.42x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=1.996, Ratio=4.55x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.024, Ratio=4.72x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.003, Ratio=4.37x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.991, Ratio=4.42x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.016, Ratio=4.63x, Gap=-3.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.017, Ratio=4.51x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=1.973, Ratio=4.08x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.006, Ratio=4.35x, Gap=-3.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.022, Ratio=4.64x, Gap=-3.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.036, Ratio=4.83x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=1.995, Ratio=4.53x, Gap=-3.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.008, Ratio=4.59x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.005, Ratio=4.44x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=1.983, Ratio=4.05x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.023, Ratio=4.47x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.008, Ratio=4.55x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.999, Ratio=4.46x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.016, Ratio=4.59x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.997, Ratio=4.64x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.041, Ratio=4.79x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.003, Ratio=4.43x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.996, Ratio=4.43x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.011, Ratio=4.62x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.992, Ratio=4.36x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.004, Ratio=4.52x, Gap=-3.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.035, Ratio=4.97x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.007, Ratio=4.41x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.005, Ratio=4.53x, Gap=-3.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.004, Ratio=4.46x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.012, Ratio=4.61x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.017, Ratio=4.81x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.027, Ratio=4.63x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=1.991, Ratio=4.36x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.011, Ratio=4.58x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.991, Ratio=4.26x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.019, Ratio=4.45x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.030, Ratio=4.62x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.997, Ratio=4.41x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.019, Ratio=4.57x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.997, Ratio=4.45x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.037, Ratio=4.93x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.012, Ratio=4.48x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.011, Ratio=4.61x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.985, Ratio=4.37x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.006, Ratio=4.46x, Gap=-3.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.016, Ratio=4.57x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.023, Ratio=4.66x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.010, Ratio=4.56x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.30x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.020, Ratio=4.65x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.008, Ratio=4.63x, Gap=-3.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.007, Ratio=4.56x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.002, Ratio=4.28x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.992, Ratio=4.40x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.996, Ratio=4.41x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.022, Ratio=4.59x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.993, Ratio=4.24x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.011, Ratio=4.56x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.044, Ratio=4.68x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.985, Ratio=4.40x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.990, Ratio=4.33x, Gap=-3.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.003, Ratio=4.44x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.022, Ratio=4.61x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.012, Ratio=4.52x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.025, Ratio=4.71x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.998, Ratio=4.48x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.987, Ratio=4.47x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.031, Ratio=4.65x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.003, Ratio=4.49x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.016, Ratio=4.57x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.020, Ratio=4.59x, Gap=-3.465
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.001, Ratio=4.60x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.026, Ratio=4.67x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=1.989, Ratio=4.23x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.003, Ratio=4.44x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.021, Ratio=4.69x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.014, Ratio=4.60x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.024, Ratio=4.78x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.002, Ratio=4.42x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.005, Ratio=4.49x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.017, Ratio=4.47x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=1.998, Ratio=4.63x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=1.981, Ratio=4.18x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.983, Ratio=4.37x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=1.998, Ratio=4.41x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=1.977, Ratio=4.07x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.976, Ratio=4.34x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.012, Ratio=4.60x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.019, Ratio=4.54x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.992, Ratio=4.46x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=1.985, Ratio=4.35x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.030, Ratio=4.93x, Gap=-3.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.031, Ratio=4.61x, Gap=-3.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.005, Ratio=4.43x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.013, Ratio=4.55x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.999, Ratio=4.29x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.983, Ratio=4.31x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.013, Ratio=4.63x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.003, Ratio=4.42x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.008, Ratio=4.31x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.009, Ratio=4.52x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.990, Ratio=4.38x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.000, Ratio=4.46x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.003, Ratio=4.61x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.991, Ratio=4.29x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.027, Ratio=4.74x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.021, Ratio=4.83x, Gap=-3.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.027, Ratio=4.56x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.000, Ratio=4.46x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.007, Ratio=4.39x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.968, Ratio=4.17x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.988, Ratio=4.25x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.008, Ratio=4.72x, Gap=-3.565
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.48x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.017, Ratio=4.57x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.036, Ratio=4.89x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.012, Ratio=4.55x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.001, Ratio=4.66x, Gap=-3.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.022, Ratio=4.48x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.015, Ratio=4.48x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.006, Ratio=4.44x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.994, Ratio=4.44x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.025, Ratio=4.62x, Gap=-3.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.013, Ratio=4.45x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.004, Ratio=4.51x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.998, Ratio=4.39x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.988, Ratio=4.38x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=1.998, Ratio=4.50x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.019, Ratio=4.62x, Gap=-3.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.981, Ratio=4.24x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.997, Ratio=4.34x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.006, Ratio=4.51x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.022, Ratio=4.61x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=1.997, Ratio=4.47x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.006, Ratio=4.43x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.018, Ratio=4.52x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.974, Ratio=4.22x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.999, Ratio=4.43x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.006, Ratio=4.51x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.008, Ratio=4.59x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.017, Ratio=4.48x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.007, Ratio=4.35x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.016, Ratio=4.55x, Gap=-3.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.002, Ratio=4.50x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.001, Ratio=4.51x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.017, Ratio=4.62x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=1.988, Ratio=4.44x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.012, Ratio=4.31x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.012, Ratio=4.51x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.008, Ratio=4.53x, Gap=-3.513
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.030, Ratio=4.67x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.002, Ratio=4.61x, Gap=-3.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.024, Ratio=4.46x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.001, Ratio=4.34x, Gap=-3.566
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.014, Ratio=4.47x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.998, Ratio=4.40x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.016, Ratio=4.38x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.989, Ratio=4.22x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.989, Ratio=4.43x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.007, Ratio=4.13x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.975, Ratio=4.10x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.020, Ratio=4.49x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=1.982, Ratio=4.40x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=1.992, Ratio=4.44x, Gap=-3.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.002, Ratio=4.53x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.010, Ratio=4.48x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.010, Ratio=4.44x, Gap=-3.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.007, Ratio=4.51x, Gap=-3.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.017, Ratio=4.55x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.004, Ratio=4.46x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.990, Ratio=4.37x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.014, Ratio=4.66x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.012, Ratio=4.46x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.008, Ratio=4.28x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.020, Ratio=4.61x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.992, Ratio=4.40x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=1.996, Ratio=4.52x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.010, Ratio=4.52x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.006, Ratio=4.75x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.014, Ratio=4.52x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.012, Ratio=4.54x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.018, Ratio=4.57x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.019, Ratio=4.45x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.019, Ratio=4.60x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.993, Ratio=4.26x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.983, Ratio=4.30x, Gap=-3.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.017, Ratio=4.59x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=1.998, Ratio=4.49x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.007, Ratio=4.48x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=1.980, Ratio=4.27x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.984, Ratio=4.31x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.009, Ratio=4.55x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.994, Ratio=4.25x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.025, Ratio=4.70x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.015, Ratio=4.51x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.998, Ratio=4.42x, Gap=-3.514
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.994, Ratio=4.34x, Gap=-3.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.995, Ratio=4.33x, Gap=-3.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.993, Ratio=4.31x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.008, Ratio=4.72x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.006, Ratio=4.52x, Gap=-3.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.034, Ratio=4.56x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.020, Ratio=4.61x, Gap=-3.576
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.000, Ratio=4.43x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.988, Ratio=4.22x, Gap=-3.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.983, Ratio=4.40x, Gap=-3.842
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=1.992, Ratio=4.28x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.034, Ratio=4.76x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.007, Ratio=4.45x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.003, Ratio=4.43x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.030, Ratio=4.81x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.977, Ratio=4.29x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.981, Ratio=4.35x, Gap=-3.542
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.009, Ratio=4.54x, Gap=-3.534
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.009, Ratio=4.66x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.005, Ratio=4.62x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.009, Ratio=4.53x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=1.987, Ratio=4.25x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.010, Ratio=4.49x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.010, Ratio=4.47x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.014, Ratio=4.52x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.015, Ratio=4.56x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=1.998, Ratio=4.44x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.023, Ratio=4.80x, Gap=-3.515
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.988, Ratio=4.38x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.000, Ratio=4.61x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=1.976, Ratio=4.23x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.015, Ratio=4.53x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.001, Ratio=4.43x, Gap=-3.577
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.008, Ratio=4.50x, Gap=-3.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.005, Ratio=4.46x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.004, Ratio=4.37x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.006, Ratio=4.42x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.982, Ratio=4.31x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.986, Ratio=4.31x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.012, Ratio=4.57x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.021, Ratio=4.72x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=1.985, Ratio=4.12x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.009, Ratio=4.63x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.993, Ratio=4.32x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=1.989, Ratio=4.22x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.989, Ratio=4.32x, Gap=-3.549
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.004, Ratio=4.64x, Gap=-3.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.014, Ratio=4.62x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=1.970, Ratio=4.10x, Gap=-3.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.006, Ratio=4.42x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.009, Ratio=4.38x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=1.977, Ratio=4.22x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.975, Ratio=4.42x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.001, Ratio=4.52x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.021, Ratio=4.70x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.004, Ratio=4.49x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=1.987, Ratio=4.33x, Gap=-3.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.013, Ratio=4.55x, Gap=-3.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.013, Ratio=4.56x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.001, Ratio=4.47x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.015, Ratio=4.56x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=1.975, Ratio=4.27x, Gap=-3.759
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.011, Ratio=4.51x, Gap=-3.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=1.988, Ratio=4.18x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.008, Ratio=4.57x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.009, Ratio=4.50x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.023, Ratio=4.70x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.981, Ratio=4.13x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=1.993, Ratio=4.46x, Gap=-3.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.028, Ratio=4.64x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.002, Ratio=4.46x, Gap=-3.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.000, Ratio=4.49x, Gap=-3.544
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.010, Ratio=4.59x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=1.986, Ratio=4.32x, Gap=-3.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=1.989, Ratio=4.27x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.004, Ratio=4.38x, Gap=-3.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=1.981, Ratio=4.37x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.016, Ratio=4.57x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=1.989, Ratio=4.31x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.017, Ratio=4.58x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.014, Ratio=4.55x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.028, Ratio=4.69x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.002, Ratio=4.34x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.003, Ratio=4.43x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=1.981, Ratio=4.35x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=1.999, Ratio=4.57x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.012, Ratio=4.52x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.010, Ratio=4.47x, Gap=-3.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.006, Ratio=4.36x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=1.977, Ratio=4.37x, Gap=-3.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.003, Ratio=4.60x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.016, Ratio=4.50x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=1.982, Ratio=4.13x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.002, Ratio=4.64x, Gap=-3.548
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=1.994, Ratio=4.52x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.004, Ratio=4.65x, Gap=-3.556
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.015, Ratio=4.44x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=1.988, Ratio=4.31x, Gap=-3.621

============================================================
Epoch 18/20 completed in 32.9s
Train: Loss=0.9015 (C:0.9015, R:0.0105) Ratio=3.69x
Val:   Loss=0.8391 (C:0.8391, R:0.0105) Ratio=4.75x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.8391)
============================================================

🌍 Updating global dataset at epoch 19
🌍 Extracting features for entire dataset...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
  Subsampled to 5000 samples
  Global dataset updated: 5000 samples
  Analyzing global separation...
  GLOBAL ANALYSIS:
    Pos distances: 0.426 ± 0.552
    Neg distances: 2.053 ± 0.945
    Separation ratio: 4.82x
    Gap: -3.637
    ✅ Excellent global separation!

Epoch 19 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.032, Ratio=4.43x, Gap=-4.367
Batch   0/537: Loss=0.8370 (C:0.8370, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.054, Ratio=4.35x, Gap=-4.342
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.050, Ratio=4.29x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.028, Ratio=4.10x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.063, Ratio=4.51x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.052, Ratio=4.23x, Gap=-4.011
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.048, Ratio=4.23x, Gap=-4.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.073, Ratio=4.40x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.072, Ratio=4.15x, Gap=-4.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.111, Ratio=4.55x, Gap=-4.262
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.078, Ratio=4.22x, Gap=-4.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.082, Ratio=4.33x, Gap=-4.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.070, Ratio=4.18x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.085, Ratio=4.46x, Gap=-4.313
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.084, Ratio=4.28x, Gap=-4.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.081, Ratio=4.36x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.078, Ratio=4.31x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.069, Ratio=4.22x, Gap=-4.977
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.054, Ratio=4.21x, Gap=-4.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.094, Ratio=4.41x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.072, Ratio=4.46x, Gap=-3.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.047, Ratio=4.19x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.089, Ratio=4.54x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.056, Ratio=4.21x, Gap=-4.228
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.062, Ratio=4.30x, Gap=-4.338
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.049, Ratio=4.26x, Gap=-4.803
Batch  25/537: Loss=0.8544 (C:0.8544, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.061, Ratio=4.25x, Gap=-4.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.066, Ratio=4.42x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.083, Ratio=4.26x, Gap=-4.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.074, Ratio=4.43x, Gap=-4.559
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.078, Ratio=4.47x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.059, Ratio=4.36x, Gap=-4.469
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.062, Ratio=4.28x, Gap=-4.499
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.045, Ratio=4.21x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.046, Ratio=4.25x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.066, Ratio=4.29x, Gap=-4.528
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.063, Ratio=4.37x, Gap=-4.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.085, Ratio=4.50x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.064, Ratio=4.24x, Gap=-4.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.083, Ratio=4.32x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.069, Ratio=4.22x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.097, Ratio=4.68x, Gap=-4.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.078, Ratio=4.37x, Gap=-4.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.081, Ratio=4.41x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.060, Ratio=4.09x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.069, Ratio=4.41x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.076, Ratio=4.41x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.067, Ratio=4.38x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.086, Ratio=4.41x, Gap=-4.993
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.063, Ratio=4.33x, Gap=-4.402
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.036, Ratio=4.00x, Gap=-4.732
Batch  50/537: Loss=0.8956 (C:0.8956, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.059, Ratio=4.26x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.104, Ratio=4.61x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.048, Ratio=4.13x, Gap=-3.933
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.073, Ratio=4.22x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.052, Ratio=4.17x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.085, Ratio=4.57x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.047, Ratio=4.15x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.075, Ratio=4.38x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.056, Ratio=4.12x, Gap=-4.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.069, Ratio=4.19x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.069, Ratio=4.24x, Gap=-4.146
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.069, Ratio=4.31x, Gap=-4.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.074, Ratio=4.23x, Gap=-5.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.069, Ratio=4.30x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.067, Ratio=4.33x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.069, Ratio=4.32x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.077, Ratio=4.26x, Gap=-4.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.061, Ratio=4.31x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.081, Ratio=4.44x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.071, Ratio=4.51x, Gap=-4.502
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.036, Ratio=4.06x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.079, Ratio=4.49x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.082, Ratio=4.30x, Gap=-4.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.089, Ratio=4.37x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.074, Ratio=4.35x, Gap=-4.280
Batch  75/537: Loss=0.8447 (C:0.8447, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.072, Ratio=4.42x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.080, Ratio=4.62x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.063, Ratio=4.19x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.064, Ratio=4.35x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.062, Ratio=4.12x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.092, Ratio=4.46x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.063, Ratio=4.27x, Gap=-4.438
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.062, Ratio=4.21x, Gap=-4.314
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.052, Ratio=4.21x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.082, Ratio=4.38x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.065, Ratio=4.32x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.049, Ratio=4.25x, Gap=-4.039
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.062, Ratio=4.26x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.037, Ratio=4.09x, Gap=-4.337
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.039, Ratio=4.18x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.071, Ratio=4.38x, Gap=-4.152
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.066, Ratio=4.19x, Gap=-4.375
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.072, Ratio=4.28x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.063, Ratio=4.27x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.084, Ratio=4.51x, Gap=-4.471
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.094, Ratio=4.62x, Gap=-4.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.070, Ratio=4.41x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.070, Ratio=4.34x, Gap=-4.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.056, Ratio=4.23x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.074, Ratio=4.29x, Gap=-4.161
Batch 100/537: Loss=0.8485 (C:0.8485, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.067, Ratio=4.38x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.069, Ratio=4.54x, Gap=-4.167
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.049, Ratio=4.13x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.071, Ratio=4.44x, Gap=-4.145
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.052, Ratio=4.12x, Gap=-4.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.088, Ratio=4.47x, Gap=-4.520
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.041, Ratio=4.03x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.063, Ratio=4.31x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.074, Ratio=4.32x, Gap=-4.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.073, Ratio=4.38x, Gap=-4.032
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.085, Ratio=4.37x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.046, Ratio=4.15x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.049, Ratio=4.21x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.024, Ratio=4.07x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.074, Ratio=4.25x, Gap=-5.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.065, Ratio=4.44x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.065, Ratio=4.32x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.088, Ratio=4.37x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.055, Ratio=4.29x, Gap=-4.351
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.051, Ratio=4.17x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.067, Ratio=4.24x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.050, Ratio=4.14x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.073, Ratio=4.33x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.064, Ratio=4.31x, Gap=-4.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.063, Ratio=4.21x, Gap=-4.159
Batch 125/537: Loss=0.8616 (C:0.8616, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.040, Ratio=4.03x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.049, Ratio=4.06x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.078, Ratio=4.35x, Gap=-4.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.035, Ratio=4.05x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.067, Ratio=4.14x, Gap=-3.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.066, Ratio=4.36x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.087, Ratio=4.48x, Gap=-4.248
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.071, Ratio=4.35x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.042, Ratio=4.22x, Gap=-4.258
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.045, Ratio=4.07x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.045, Ratio=4.16x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.047, Ratio=4.25x, Gap=-5.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.056, Ratio=4.29x, Gap=-4.006
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.062, Ratio=4.24x, Gap=-4.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.080, Ratio=4.42x, Gap=-4.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.042, Ratio=4.22x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.088, Ratio=4.48x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.091, Ratio=4.46x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.084, Ratio=4.43x, Gap=-3.995
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.044, Ratio=4.16x, Gap=-3.955
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=2.054, Ratio=3.97x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.067, Ratio=4.27x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=2.035, Ratio=3.96x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.062, Ratio=4.34x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.084, Ratio=4.36x, Gap=-4.267
Batch 150/537: Loss=0.8419 (C:0.8419, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.063, Ratio=4.25x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.077, Ratio=4.12x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.057, Ratio=4.14x, Gap=-4.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.052, Ratio=4.26x, Gap=-4.174
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.053, Ratio=4.16x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.055, Ratio=4.18x, Gap=-4.505
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.062, Ratio=4.08x, Gap=-4.575
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.052, Ratio=4.08x, Gap=-4.453
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.052, Ratio=4.10x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.060, Ratio=4.20x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.054, Ratio=4.17x, Gap=-4.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.046, Ratio=4.13x, Gap=-5.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.050, Ratio=4.25x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.043, Ratio=4.06x, Gap=-4.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.045, Ratio=4.17x, Gap=-4.003
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.071, Ratio=4.27x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.063, Ratio=4.13x, Gap=-4.249
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.090, Ratio=4.41x, Gap=-4.904
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.055, Ratio=4.04x, Gap=-4.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.082, Ratio=4.27x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.064, Ratio=4.13x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.060, Ratio=4.13x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.060, Ratio=4.10x, Gap=-4.872
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.052, Ratio=4.09x, Gap=-4.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.045, Ratio=4.20x, Gap=-4.252
Batch 175/537: Loss=0.8668 (C:0.8668, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=2.045, Ratio=3.94x, Gap=-4.206
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.059, Ratio=4.32x, Gap=-4.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.526, Neg=2.025, Ratio=3.85x, Gap=-4.521
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.052, Ratio=4.21x, Gap=-4.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.081, Ratio=4.35x, Gap=-4.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.049, Ratio=4.07x, Gap=-4.839
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.033, Ratio=3.99x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.081, Ratio=4.29x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.034, Ratio=4.09x, Gap=-4.479
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.050, Ratio=4.11x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.084, Ratio=4.54x, Gap=-4.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.055, Ratio=4.27x, Gap=-4.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.080, Ratio=4.25x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.067, Ratio=4.11x, Gap=-4.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.074, Ratio=4.27x, Gap=-4.817
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.062, Ratio=4.17x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.066, Ratio=4.06x, Gap=-4.415
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.094, Ratio=4.45x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.045, Ratio=4.17x, Gap=-4.069
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.069, Ratio=4.29x, Gap=-3.852
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.073, Ratio=4.41x, Gap=-4.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.072, Ratio=4.40x, Gap=-4.260
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.063, Ratio=4.26x, Gap=-4.908
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.043, Ratio=4.21x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.078, Ratio=4.33x, Gap=-4.216
Batch 200/537: Loss=0.8480 (C:0.8480, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.072, Ratio=4.36x, Gap=-4.064
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.053, Ratio=4.21x, Gap=-4.536
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.124, Ratio=4.52x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.068, Ratio=4.40x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.064, Ratio=4.34x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.065, Ratio=4.49x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.067, Ratio=4.22x, Gap=-4.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.045, Ratio=4.16x, Gap=-4.294
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.080, Ratio=4.29x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.073, Ratio=4.15x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.044, Ratio=4.14x, Gap=-5.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.044, Ratio=4.00x, Gap=-4.460
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.081, Ratio=4.46x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.076, Ratio=4.39x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.075, Ratio=4.25x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.058, Ratio=4.12x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.040, Ratio=4.09x, Gap=-4.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.073, Ratio=4.37x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.092, Ratio=4.39x, Gap=-4.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.069, Ratio=4.26x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.050, Ratio=4.11x, Gap=-3.954
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.033, Ratio=4.02x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.069, Ratio=4.34x, Gap=-3.936
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.030, Ratio=3.99x, Gap=-4.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.064, Ratio=4.27x, Gap=-4.592
Batch 225/537: Loss=0.8561 (C:0.8561, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.068, Ratio=4.30x, Gap=-4.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.060, Ratio=4.20x, Gap=-4.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.066, Ratio=4.20x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.043, Ratio=4.10x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.073, Ratio=4.36x, Gap=-4.401
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.048, Ratio=4.19x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.040, Ratio=4.02x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.045, Ratio=4.19x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.072, Ratio=4.22x, Gap=-4.046
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.054, Ratio=4.14x, Gap=-4.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.044, Ratio=4.15x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.066, Ratio=4.25x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.064, Ratio=4.26x, Gap=-4.034
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.052, Ratio=4.04x, Gap=-4.323
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.086, Ratio=4.29x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.068, Ratio=4.15x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.087, Ratio=4.16x, Gap=-4.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.040, Ratio=4.12x, Gap=-3.956
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.089, Ratio=4.35x, Gap=-4.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.064, Ratio=4.23x, Gap=-4.084
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.053, Ratio=4.21x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.061, Ratio=4.19x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.047, Ratio=4.29x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.086, Ratio=4.49x, Gap=-4.321
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.065, Ratio=4.25x, Gap=-4.329
Batch 250/537: Loss=0.8596 (C:0.8596, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.033, Ratio=4.11x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.049, Ratio=4.23x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.038, Ratio=4.06x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.075, Ratio=4.42x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.058, Ratio=4.32x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.031, Ratio=3.96x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.094, Ratio=4.52x, Gap=-4.844
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.087, Ratio=4.39x, Gap=-4.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=2.055, Ratio=4.00x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=2.052, Ratio=3.98x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.083, Ratio=4.28x, Gap=-4.436
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.061, Ratio=4.12x, Gap=-4.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.065, Ratio=4.12x, Gap=-4.869
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.060, Ratio=4.27x, Gap=-4.140
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.049, Ratio=4.18x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.038, Ratio=4.11x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.059, Ratio=4.37x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.050, Ratio=4.10x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.016, Ratio=3.99x, Gap=-4.445
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.076, Ratio=4.38x, Gap=-4.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.080, Ratio=4.43x, Gap=-4.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.038, Ratio=4.02x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.074, Ratio=4.35x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.074, Ratio=4.35x, Gap=-4.224
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.091, Ratio=4.42x, Gap=-4.293
Batch 275/537: Loss=0.8346 (C:0.8346, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.071, Ratio=4.42x, Gap=-5.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.050, Ratio=4.26x, Gap=-4.482
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.056, Ratio=4.22x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.082, Ratio=4.36x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.058, Ratio=4.21x, Gap=-4.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.043, Ratio=4.17x, Gap=-4.157
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.034, Ratio=4.11x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.076, Ratio=4.34x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.078, Ratio=4.39x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.086, Ratio=4.37x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.066, Ratio=4.26x, Gap=-4.177
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.073, Ratio=4.27x, Gap=-4.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.068, Ratio=4.18x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.054, Ratio=4.14x, Gap=-4.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.067, Ratio=4.24x, Gap=-5.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.055, Ratio=4.43x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.069, Ratio=4.21x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.058, Ratio=4.12x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.092, Ratio=4.53x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.081, Ratio=4.21x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.065, Ratio=4.11x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.061, Ratio=4.49x, Gap=-3.928
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.058, Ratio=4.04x, Gap=-4.160
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.058, Ratio=4.20x, Gap=-5.030
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.525, Neg=2.003, Ratio=3.82x, Gap=-4.484
Batch 300/537: Loss=0.9279 (C:0.9279, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.049, Ratio=4.17x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.061, Ratio=4.31x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.045, Ratio=4.17x, Gap=-4.593
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.072, Ratio=4.34x, Gap=-4.230
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.074, Ratio=4.22x, Gap=-4.022
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.091, Ratio=4.39x, Gap=-4.282
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.075, Ratio=4.32x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.069, Ratio=4.20x, Gap=-3.996
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.075, Ratio=4.11x, Gap=-4.339
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.050, Ratio=4.17x, Gap=-3.985
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.086, Ratio=4.33x, Gap=-4.332
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.080, Ratio=4.41x, Gap=-4.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.062, Ratio=4.32x, Gap=-4.487
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.065, Ratio=4.24x, Gap=-4.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.044, Ratio=4.30x, Gap=-3.916
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.041, Ratio=4.18x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.054, Ratio=4.12x, Gap=-4.500
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.065, Ratio=4.30x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.067, Ratio=4.47x, Gap=-4.123
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.062, Ratio=4.23x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.088, Ratio=4.30x, Gap=-4.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.067, Ratio=4.46x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.057, Ratio=4.27x, Gap=-5.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.070, Ratio=4.39x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.047, Ratio=4.27x, Gap=-4.728
Batch 325/537: Loss=0.8513 (C:0.8513, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=2.050, Ratio=3.98x, Gap=-4.361
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.041, Ratio=4.02x, Gap=-4.299
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.077, Ratio=4.40x, Gap=-4.459
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.082, Ratio=4.27x, Gap=-4.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.080, Ratio=4.50x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.077, Ratio=4.33x, Gap=-4.169
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.045, Ratio=4.08x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.055, Ratio=4.11x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.046, Ratio=4.02x, Gap=-4.539
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.075, Ratio=4.47x, Gap=-4.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.076, Ratio=4.34x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.098, Ratio=4.35x, Gap=-4.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.071, Ratio=4.33x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.055, Ratio=4.17x, Gap=-4.307
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.078, Ratio=4.22x, Gap=-4.166
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.054, Ratio=4.23x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.063, Ratio=4.36x, Gap=-4.501
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.055, Ratio=4.15x, Gap=-4.787
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.049, Ratio=4.07x, Gap=-4.394
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.071, Ratio=4.50x, Gap=-3.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.058, Ratio=4.33x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.080, Ratio=4.43x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.051, Ratio=4.07x, Gap=-4.325
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.034, Ratio=4.13x, Gap=-4.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.047, Ratio=4.08x, Gap=-4.439
Batch 350/537: Loss=0.8834 (C:0.8834, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.069, Ratio=4.31x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.073, Ratio=4.44x, Gap=-4.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.085, Ratio=4.41x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.062, Ratio=4.36x, Gap=-4.554
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.085, Ratio=4.35x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.072, Ratio=4.30x, Gap=-4.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.056, Ratio=4.12x, Gap=-4.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=2.073, Ratio=4.05x, Gap=-4.354
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.049, Ratio=4.06x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=2.055, Ratio=4.01x, Gap=-4.525
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.090, Ratio=4.46x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.087, Ratio=4.49x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.062, Ratio=4.27x, Gap=-4.495
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.019, Ratio=3.99x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.053, Ratio=4.40x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.081, Ratio=4.32x, Gap=-5.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.061, Ratio=4.28x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.070, Ratio=4.46x, Gap=-4.109
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.071, Ratio=4.45x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.054, Ratio=4.29x, Gap=-4.265
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.070, Ratio=4.31x, Gap=-4.848
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.056, Ratio=4.22x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.070, Ratio=4.52x, Gap=-4.329
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.077, Ratio=4.19x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.060, Ratio=4.16x, Gap=-4.381
Batch 375/537: Loss=0.8714 (C:0.8714, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.084, Ratio=4.46x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.106, Ratio=4.50x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.088, Ratio=4.39x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.052, Ratio=4.11x, Gap=-4.316
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.071, Ratio=4.29x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.062, Ratio=4.09x, Gap=-4.010
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.077, Ratio=4.30x, Gap=-5.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.081, Ratio=4.28x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.082, Ratio=4.35x, Gap=-4.938
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.045, Ratio=4.17x, Gap=-4.081
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.080, Ratio=4.23x, Gap=-4.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.055, Ratio=4.24x, Gap=-4.423
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.062, Ratio=4.22x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.056, Ratio=4.37x, Gap=-4.344
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.010, Ratio=3.93x, Gap=-4.330
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.060, Ratio=4.20x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.047, Ratio=4.02x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.032, Ratio=4.09x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.086, Ratio=4.33x, Gap=-4.226
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.059, Ratio=4.08x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.063, Ratio=4.27x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.079, Ratio=4.34x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.067, Ratio=4.16x, Gap=-4.398
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.027, Ratio=3.95x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.077, Ratio=4.23x, Gap=-4.881
Batch 400/537: Loss=0.8595 (C:0.8595, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.068, Ratio=4.25x, Gap=-4.923
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.075, Ratio=4.12x, Gap=-4.882
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=2.043, Ratio=3.96x, Gap=-4.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.094, Ratio=4.46x, Gap=-4.040
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.076, Ratio=4.32x, Gap=-4.492
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.056, Ratio=4.25x, Gap=-4.311
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.511, Neg=2.049, Ratio=4.01x, Gap=-4.207
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.066, Ratio=4.27x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.061, Ratio=4.07x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.077, Ratio=4.32x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.051, Ratio=4.06x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.045, Ratio=4.13x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.041, Ratio=4.05x, Gap=-4.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.055, Ratio=4.13x, Gap=-4.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.060, Ratio=4.17x, Gap=-4.889
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.063, Ratio=4.34x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.022, Ratio=4.06x, Gap=-4.441
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.061, Ratio=4.15x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.073, Ratio=4.25x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.078, Ratio=4.43x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.047, Ratio=4.29x, Gap=-4.476
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=2.046, Ratio=3.99x, Gap=-4.246
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.514, Neg=2.066, Ratio=4.02x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.057, Ratio=4.08x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.062, Ratio=4.22x, Gap=-4.315
Batch 425/537: Loss=0.8600 (C:0.8600, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.055, Ratio=4.24x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.059, Ratio=4.24x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.030, Ratio=4.05x, Gap=-4.317
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.065, Ratio=4.34x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.065, Ratio=4.38x, Gap=-4.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.077, Ratio=4.38x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.068, Ratio=4.36x, Gap=-4.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.091, Ratio=4.31x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.066, Ratio=4.16x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.044, Ratio=4.07x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.067, Ratio=4.23x, Gap=-3.939
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.067, Ratio=4.39x, Gap=-4.524
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.065, Ratio=4.38x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.067, Ratio=4.24x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.070, Ratio=4.08x, Gap=-4.350
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.060, Ratio=4.19x, Gap=-4.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.071, Ratio=4.23x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.086, Ratio=4.47x, Gap=-4.212
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.051, Ratio=4.19x, Gap=-4.408
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.070, Ratio=4.36x, Gap=-4.239
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.044, Ratio=3.99x, Gap=-4.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.076, Ratio=4.40x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.073, Ratio=4.22x, Gap=-4.831
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.055, Ratio=4.18x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.068, Ratio=4.37x, Gap=-4.377
Batch 450/537: Loss=0.8405 (C:0.8405, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.028, Ratio=3.98x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.104, Ratio=4.47x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.094, Ratio=4.55x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.058, Ratio=4.20x, Gap=-4.050
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.049, Ratio=4.19x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.080, Ratio=4.36x, Gap=-4.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.053, Ratio=4.04x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.058, Ratio=4.20x, Gap=-4.382
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.073, Ratio=4.39x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.075, Ratio=4.42x, Gap=-4.200
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.063, Ratio=4.27x, Gap=-4.154
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.057, Ratio=4.18x, Gap=-4.000
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.054, Ratio=4.22x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.092, Ratio=4.36x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.069, Ratio=4.17x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.084, Ratio=4.32x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.080, Ratio=4.13x, Gap=-4.421
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.066, Ratio=4.29x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.052, Ratio=4.16x, Gap=-4.858
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.071, Ratio=4.26x, Gap=-4.269
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.057, Ratio=4.14x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.084, Ratio=4.28x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.062, Ratio=4.32x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.044, Ratio=4.08x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.046, Ratio=4.15x, Gap=-5.171
Batch 475/537: Loss=0.8693 (C:0.8693, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.067, Ratio=4.20x, Gap=-4.247
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.072, Ratio=4.16x, Gap=-4.343
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.048, Ratio=4.13x, Gap=-4.529
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.080, Ratio=4.20x, Gap=-5.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.062, Ratio=4.14x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.064, Ratio=4.28x, Gap=-4.216
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.067, Ratio=4.15x, Gap=-4.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.043, Ratio=4.05x, Gap=-4.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.057, Ratio=4.30x, Gap=-4.263
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.061, Ratio=4.32x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.077, Ratio=4.27x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.071, Ratio=4.29x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.070, Ratio=4.35x, Gap=-4.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.052, Ratio=4.18x, Gap=-4.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.063, Ratio=4.26x, Gap=-4.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.060, Ratio=4.23x, Gap=-4.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.064, Ratio=4.32x, Gap=-4.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.054, Ratio=4.13x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.062, Ratio=4.29x, Gap=-4.112
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.096, Ratio=4.55x, Gap=-5.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.051, Ratio=4.17x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.056, Ratio=4.05x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.050, Ratio=4.18x, Gap=-4.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.095, Ratio=4.50x, Gap=-4.235
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.072, Ratio=4.28x, Gap=-4.214
Batch 500/537: Loss=0.8579 (C:0.8579, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.073, Ratio=4.25x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.066, Ratio=4.21x, Gap=-4.302
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.066, Ratio=4.35x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=2.064, Ratio=3.99x, Gap=-4.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.069, Ratio=4.10x, Gap=-4.860
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.061, Ratio=4.24x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.067, Ratio=4.27x, Gap=-4.419
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.078, Ratio=4.37x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.094, Ratio=4.36x, Gap=-4.915
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.066, Ratio=4.32x, Gap=-4.973
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.064, Ratio=4.14x, Gap=-5.195
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.061, Ratio=4.34x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.060, Ratio=4.19x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.052, Ratio=4.22x, Gap=-4.229
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.086, Ratio=4.33x, Gap=-4.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.040, Ratio=4.17x, Gap=-4.907
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.050, Ratio=4.08x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.083, Ratio=4.35x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.052, Ratio=4.29x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.044, Ratio=4.20x, Gap=-4.403
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.050, Ratio=4.06x, Gap=-4.486
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.048, Ratio=4.22x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.054, Ratio=4.19x, Gap=-4.480
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.060, Ratio=4.29x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.053, Ratio=4.11x, Gap=-4.199
Batch 525/537: Loss=0.8791 (C:0.8791, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.065, Ratio=4.13x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.057, Ratio=4.14x, Gap=-4.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.519, Neg=2.045, Ratio=3.94x, Gap=-4.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.072, Ratio=4.28x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.073, Ratio=4.21x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.049, Ratio=4.02x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.076, Ratio=4.22x, Gap=-4.287
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.513, Neg=2.041, Ratio=3.98x, Gap=-4.496
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.059, Ratio=4.15x, Gap=-4.512
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.070, Ratio=4.34x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.046, Ratio=4.11x, Gap=-4.509
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.074, Ratio=4.89x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.048, Ratio=4.56x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.056, Ratio=4.58x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.082, Ratio=4.73x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.065, Ratio=4.76x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.055, Ratio=4.58x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.079, Ratio=4.90x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.112, Ratio=5.40x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.057, Ratio=4.69x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.070, Ratio=4.77x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.079, Ratio=4.97x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.065, Ratio=4.49x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.070, Ratio=4.68x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.068, Ratio=4.83x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.076, Ratio=4.84x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.052, Ratio=4.59x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.093, Ratio=4.95x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.081, Ratio=4.99x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.062, Ratio=4.73x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.082, Ratio=4.90x, Gap=-3.826
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.070, Ratio=4.77x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.081, Ratio=4.81x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.082, Ratio=4.93x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.067, Ratio=4.66x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.070, Ratio=4.64x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.061, Ratio=4.61x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.093, Ratio=4.90x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.065, Ratio=4.90x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.073, Ratio=4.91x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.075, Ratio=4.72x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.063, Ratio=4.58x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.069, Ratio=4.75x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.054, Ratio=4.72x, Gap=-3.785
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.079, Ratio=4.84x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.074, Ratio=4.84x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.071, Ratio=4.74x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.090, Ratio=4.99x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.065, Ratio=5.04x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.047, Ratio=4.50x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.101, Ratio=4.90x, Gap=-3.822
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.071, Ratio=4.94x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.051, Ratio=4.67x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.066, Ratio=4.68x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.082, Ratio=4.87x, Gap=-3.959
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.049, Ratio=4.56x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.069, Ratio=4.70x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.077, Ratio=4.83x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.081, Ratio=4.88x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.070, Ratio=4.70x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.072, Ratio=4.83x, Gap=-3.557
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.092, Ratio=4.93x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.083, Ratio=5.04x, Gap=-3.801
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.086, Ratio=4.92x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.065, Ratio=4.69x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.084, Ratio=4.95x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.066, Ratio=4.67x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.074, Ratio=4.75x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.063, Ratio=4.64x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.082, Ratio=4.89x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.078, Ratio=4.95x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.062, Ratio=4.74x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.057, Ratio=4.56x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.090, Ratio=4.92x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.099, Ratio=5.01x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.072, Ratio=4.68x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.058, Ratio=4.81x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.085, Ratio=4.93x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.059, Ratio=4.75x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.077, Ratio=4.80x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.096, Ratio=4.77x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.69x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.060, Ratio=4.57x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.076, Ratio=5.07x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.067, Ratio=4.60x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.091, Ratio=4.84x, Gap=-3.583
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.080, Ratio=4.80x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.084, Ratio=4.85x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.050, Ratio=4.47x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.061, Ratio=4.73x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.081, Ratio=4.73x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.093, Ratio=4.71x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.083, Ratio=4.73x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.111, Ratio=5.16x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.054, Ratio=4.58x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.052, Ratio=4.70x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.074, Ratio=4.76x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.087, Ratio=4.96x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.079, Ratio=4.73x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.079, Ratio=4.81x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.061, Ratio=4.52x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.100, Ratio=5.16x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.077, Ratio=4.98x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.083, Ratio=4.79x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.053, Ratio=4.78x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.066, Ratio=4.88x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.067, Ratio=4.86x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.072, Ratio=4.84x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.096, Ratio=5.23x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.061, Ratio=4.56x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.068, Ratio=4.83x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.077, Ratio=4.80x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.049, Ratio=4.55x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.091, Ratio=5.11x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.102, Ratio=5.10x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.086, Ratio=4.88x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.072, Ratio=4.64x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.087, Ratio=4.89x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.063, Ratio=4.82x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.070, Ratio=4.86x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.081, Ratio=4.97x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.071, Ratio=4.70x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.086, Ratio=4.85x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.060, Ratio=4.46x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.078, Ratio=4.76x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.047, Ratio=4.69x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.067, Ratio=4.77x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.080, Ratio=4.91x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.048, Ratio=4.70x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.062, Ratio=4.75x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.078, Ratio=5.05x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.068, Ratio=4.79x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.061, Ratio=4.63x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.058, Ratio=4.95x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.055, Ratio=4.69x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.058, Ratio=4.60x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.054, Ratio=4.71x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.078, Ratio=4.75x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.074, Ratio=4.57x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.079, Ratio=4.93x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.087, Ratio=5.03x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.076, Ratio=4.71x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.051, Ratio=4.58x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.083, Ratio=4.62x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.067, Ratio=4.76x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.083, Ratio=4.79x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.037, Ratio=4.57x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.075, Ratio=4.94x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.083, Ratio=4.85x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.050, Ratio=4.69x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.070, Ratio=4.82x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.051, Ratio=4.54x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.093, Ratio=4.99x, Gap=-3.774
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.404, Neg=2.101, Ratio=5.20x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.062, Ratio=4.76x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.104, Ratio=4.78x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.061, Ratio=4.77x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.073, Ratio=4.77x, Gap=-3.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.090, Ratio=5.00x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.085, Ratio=4.83x, Gap=-3.812
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.093, Ratio=4.88x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.056, Ratio=4.61x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.084, Ratio=4.84x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.089, Ratio=4.98x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.058, Ratio=4.61x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.069, Ratio=4.84x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.063, Ratio=4.71x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.087, Ratio=5.07x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.076, Ratio=4.62x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.065, Ratio=4.76x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.104, Ratio=5.17x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.056, Ratio=4.87x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.093, Ratio=4.90x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.070, Ratio=4.71x, Gap=-3.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.100, Ratio=4.92x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.068, Ratio=4.76x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.052, Ratio=4.60x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.064, Ratio=4.88x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.045, Ratio=4.55x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.075, Ratio=4.81x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.079, Ratio=4.98x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.079, Ratio=4.82x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.085, Ratio=4.87x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.088, Ratio=5.04x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.039, Ratio=4.58x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.080, Ratio=5.01x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.037, Ratio=4.60x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.063, Ratio=4.77x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.097, Ratio=5.11x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.050, Ratio=4.70x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.089, Ratio=4.84x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.044, Ratio=4.51x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.059, Ratio=4.82x, Gap=-3.579
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.089, Ratio=5.07x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.084, Ratio=4.91x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.074, Ratio=4.88x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.069, Ratio=4.74x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.057, Ratio=4.56x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.089, Ratio=4.77x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.054, Ratio=4.54x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.046, Ratio=4.42x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.061, Ratio=4.63x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.063, Ratio=4.61x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.084, Ratio=5.02x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.067, Ratio=4.88x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.061, Ratio=4.60x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.085, Ratio=4.91x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.070, Ratio=4.68x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.067, Ratio=4.94x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.067, Ratio=4.49x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.090, Ratio=4.80x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.69x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.061, Ratio=4.66x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.075, Ratio=4.90x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.074, Ratio=4.89x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.082, Ratio=5.02x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.071, Ratio=4.86x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.089, Ratio=4.83x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.080, Ratio=4.71x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.067, Ratio=4.72x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.093, Ratio=4.93x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.086, Ratio=5.05x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.063, Ratio=4.61x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.076, Ratio=4.78x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.089, Ratio=4.80x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.086, Ratio=4.81x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.071, Ratio=4.84x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.083, Ratio=4.85x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.091, Ratio=4.98x, Gap=-3.968
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.071, Ratio=4.63x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.083, Ratio=4.99x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.044, Ratio=4.62x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.058, Ratio=4.78x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.077, Ratio=4.94x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.068, Ratio=4.70x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.065, Ratio=4.69x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.060, Ratio=4.69x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.062, Ratio=4.35x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.088, Ratio=5.05x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.057, Ratio=4.49x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.095, Ratio=4.83x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.057, Ratio=4.76x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.058, Ratio=4.77x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.396, Neg=2.086, Ratio=5.27x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.076, Ratio=4.93x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.096, Ratio=5.03x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.090, Ratio=5.02x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.073, Ratio=4.73x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.071, Ratio=4.88x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.108, Ratio=5.05x, Gap=-3.585
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.094, Ratio=5.16x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.083, Ratio=4.74x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.043, Ratio=4.68x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.052, Ratio=4.52x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.079, Ratio=4.91x, Gap=-3.829
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.071, Ratio=4.78x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.078, Ratio=4.83x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.066, Ratio=4.57x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.084, Ratio=4.87x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.089, Ratio=4.94x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.065, Ratio=4.59x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.067, Ratio=4.68x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.058, Ratio=4.53x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.093, Ratio=5.05x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.081, Ratio=4.97x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.049, Ratio=4.47x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.057, Ratio=4.63x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.048, Ratio=4.59x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.071, Ratio=4.74x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.076, Ratio=4.86x, Gap=-3.595
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.076, Ratio=4.68x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.062, Ratio=4.70x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.070, Ratio=4.96x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.047, Ratio=4.53x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.094, Ratio=4.97x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.071, Ratio=4.77x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.085, Ratio=4.99x, Gap=-3.587
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.089, Ratio=5.11x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.093, Ratio=5.03x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.083, Ratio=4.85x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.059, Ratio=4.69x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.088, Ratio=4.97x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.065, Ratio=4.59x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.076, Ratio=4.96x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.054, Ratio=4.54x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.064, Ratio=4.61x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.093, Ratio=5.00x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.073, Ratio=4.71x, Gap=-3.786
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.075, Ratio=4.86x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.093, Ratio=5.22x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.064, Ratio=4.55x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.074, Ratio=4.59x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.095, Ratio=4.84x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.063, Ratio=4.65x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.080, Ratio=4.83x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.061, Ratio=4.63x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.061, Ratio=4.66x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.094, Ratio=5.07x, Gap=-3.770
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.075, Ratio=4.80x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.072, Ratio=4.93x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.073, Ratio=4.94x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.112, Ratio=5.00x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.088, Ratio=5.06x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.059, Ratio=4.64x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.048, Ratio=4.70x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.059, Ratio=4.75x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.050, Ratio=4.58x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.071, Ratio=4.82x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.067, Ratio=4.80x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.077, Ratio=4.95x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.078, Ratio=4.89x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.079, Ratio=4.78x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.085, Ratio=5.04x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.045, Ratio=4.56x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.071, Ratio=4.69x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.065, Ratio=5.08x, Gap=-3.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.095, Ratio=4.91x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.072, Ratio=4.80x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.078, Ratio=4.80x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.068, Ratio=4.88x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.080, Ratio=4.84x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.069, Ratio=4.83x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.083, Ratio=4.99x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.056, Ratio=4.67x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.051, Ratio=4.58x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.089, Ratio=4.96x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.093, Ratio=5.21x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.054, Ratio=4.78x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.070, Ratio=4.90x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.073, Ratio=4.75x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.081, Ratio=4.81x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.082, Ratio=4.90x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.055, Ratio=4.45x, Gap=-3.789
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.074, Ratio=4.80x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.082, Ratio=4.83x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.062, Ratio=4.67x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.067, Ratio=4.57x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.088, Ratio=4.83x, Gap=-3.767
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.079, Ratio=4.71x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.080, Ratio=4.93x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.078, Ratio=4.85x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.057, Ratio=4.57x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.084, Ratio=5.03x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.060, Ratio=4.67x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.083, Ratio=5.01x, Gap=-3.806
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.052, Ratio=4.73x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.070, Ratio=4.82x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.090, Ratio=4.99x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.051, Ratio=4.72x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.076, Ratio=4.94x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.073, Ratio=4.50x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.077, Ratio=4.81x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.044, Ratio=4.59x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.057, Ratio=4.71x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.076, Ratio=4.80x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.070, Ratio=4.89x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.072, Ratio=4.83x, Gap=-3.781
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.065, Ratio=4.67x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.090, Ratio=5.04x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.084, Ratio=4.95x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.066, Ratio=4.66x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.083, Ratio=4.89x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.080, Ratio=4.76x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.060, Ratio=4.70x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.063, Ratio=4.80x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.081, Ratio=4.84x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.099, Ratio=5.05x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.085, Ratio=4.96x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.75x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.075, Ratio=4.67x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.055, Ratio=4.67x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.073, Ratio=4.69x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.032, Ratio=4.41x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.041, Ratio=4.46x, Gap=-3.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.078, Ratio=4.94x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.070, Ratio=4.80x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.064, Ratio=4.77x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.089, Ratio=4.96x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.078, Ratio=5.04x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.059, Ratio=4.74x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.078, Ratio=5.00x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.095, Ratio=4.99x, Gap=-3.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.74x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.059, Ratio=4.75x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.070, Ratio=4.71x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.077, Ratio=4.82x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.063, Ratio=4.76x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.043, Ratio=4.42x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.114, Ratio=4.97x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.057, Ratio=4.67x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.057, Ratio=4.61x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.085, Ratio=5.00x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.089, Ratio=4.92x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.081, Ratio=4.75x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.093, Ratio=4.93x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.090, Ratio=5.07x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.056, Ratio=4.72x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.083, Ratio=4.99x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.035, Ratio=4.55x, Gap=-3.613
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.071, Ratio=5.00x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.076, Ratio=4.81x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.060, Ratio=4.68x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.097, Ratio=5.02x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.068, Ratio=4.64x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.049, Ratio=4.61x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.084, Ratio=4.97x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.047, Ratio=4.50x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.070, Ratio=4.68x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.055, Ratio=4.57x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.70x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.072, Ratio=4.87x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.102, Ratio=5.10x, Gap=-3.725
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.076, Ratio=4.80x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.075, Ratio=4.91x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.042, Ratio=4.55x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.068, Ratio=4.72x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.056, Ratio=4.73x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.095, Ratio=5.15x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.059, Ratio=4.75x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.063, Ratio=4.54x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.077, Ratio=4.73x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.096, Ratio=4.96x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.081, Ratio=4.96x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.055, Ratio=4.68x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.061, Ratio=4.58x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.063, Ratio=4.82x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.093, Ratio=4.99x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.070, Ratio=4.81x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.080, Ratio=4.94x, Gap=-3.541
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.74x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.094, Ratio=4.78x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.067, Ratio=4.69x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.078, Ratio=4.75x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.064, Ratio=4.78x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.087, Ratio=4.88x, Gap=-3.578
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.085, Ratio=4.70x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.063, Ratio=4.64x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.090, Ratio=5.01x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.079, Ratio=4.79x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.055, Ratio=4.50x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.093, Ratio=4.89x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.073, Ratio=4.75x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.049, Ratio=4.63x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.073, Ratio=4.75x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.052, Ratio=4.63x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.074, Ratio=4.79x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.080, Ratio=4.70x, Gap=-3.750
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.047, Ratio=4.60x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.071, Ratio=4.62x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.062, Ratio=4.53x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.066, Ratio=4.75x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.089, Ratio=5.00x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.060, Ratio=4.74x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.059, Ratio=4.83x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.067, Ratio=4.74x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.075, Ratio=4.82x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.074, Ratio=4.75x, Gap=-3.628
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.062, Ratio=4.67x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.067, Ratio=4.68x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.079, Ratio=4.77x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.092, Ratio=4.97x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.061, Ratio=4.52x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.043, Ratio=4.41x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.69x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.112, Ratio=5.19x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.070, Ratio=4.69x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.084, Ratio=5.01x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.081, Ratio=4.95x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.059, Ratio=4.49x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.050, Ratio=4.66x, Gap=-3.768
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.068, Ratio=4.91x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.082, Ratio=4.93x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.044, Ratio=4.44x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.083, Ratio=4.73x, Gap=-3.588
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.083, Ratio=5.01x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.087, Ratio=5.01x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.078, Ratio=4.87x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.067, Ratio=4.74x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.066, Ratio=4.87x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.067, Ratio=4.91x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.082, Ratio=4.84x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.055, Ratio=4.65x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.061, Ratio=4.56x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.084, Ratio=4.90x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.054, Ratio=4.51x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.084, Ratio=5.00x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.059, Ratio=4.60x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.056, Ratio=4.63x, Gap=-3.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.050, Ratio=4.59x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.064, Ratio=4.65x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.059, Ratio=4.59x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.091, Ratio=5.01x, Gap=-3.832
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.092, Ratio=4.99x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.067, Ratio=4.79x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.072, Ratio=4.74x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.075, Ratio=4.52x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.073, Ratio=4.77x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.065, Ratio=4.86x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.071, Ratio=4.72x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.085, Ratio=4.95x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.070, Ratio=4.73x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.054, Ratio=4.63x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.064, Ratio=4.89x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.066, Ratio=4.70x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.068, Ratio=4.63x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.064, Ratio=4.76x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.090, Ratio=5.07x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.093, Ratio=4.97x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.074, Ratio=4.63x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.090, Ratio=4.83x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.059, Ratio=4.50x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.075, Ratio=4.75x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.050, Ratio=4.56x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.057, Ratio=4.47x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.081, Ratio=4.75x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.080, Ratio=4.98x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.077, Ratio=4.66x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.058, Ratio=4.63x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.090, Ratio=5.03x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.027, Ratio=4.33x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.082, Ratio=4.93x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.106, Ratio=5.04x, Gap=-3.846
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.087, Ratio=4.94x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.078, Ratio=4.93x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.079, Ratio=4.66x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.060, Ratio=4.83x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.058, Ratio=4.74x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.056, Ratio=4.52x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.103, Ratio=4.73x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.081, Ratio=4.80x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.078, Ratio=4.83x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.062, Ratio=4.71x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.075, Ratio=4.81x, Gap=-3.845
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.068, Ratio=4.56x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.079, Ratio=4.75x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.072, Ratio=4.77x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.062, Ratio=4.71x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.065, Ratio=5.08x, Gap=-3.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.069, Ratio=4.51x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.069, Ratio=4.82x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.072, Ratio=4.78x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.074, Ratio=4.62x, Gap=-3.586
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.039, Ratio=4.45x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.087, Ratio=4.84x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.074, Ratio=4.73x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.046, Ratio=4.63x, Gap=-3.653
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.082, Ratio=4.84x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.087, Ratio=4.88x, Gap=-3.703

============================================================
Epoch 19/20 completed in 39.3s
Train: Loss=0.8584 (C:0.8584, R:0.0105) Ratio=3.70x
Val:   Loss=0.7920 (C:0.7920, R:0.0105) Ratio=4.78x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.7920)
============================================================

Epoch 20 Training
----------------------------------------
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.067, Ratio=4.37x, Gap=-4.914
Batch   0/537: Loss=0.8417 (C:0.8417, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.070, Ratio=4.36x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.069, Ratio=4.46x, Gap=-4.326
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.072, Ratio=4.42x, Gap=-4.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.079, Ratio=4.73x, Gap=-4.094
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.076, Ratio=4.39x, Gap=-4.002
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.082, Ratio=4.37x, Gap=-4.437
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.098, Ratio=4.65x, Gap=-4.061
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.112, Ratio=4.61x, Gap=-3.966
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.066, Ratio=4.43x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.078, Ratio=4.47x, Gap=-4.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.067, Ratio=4.23x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.087, Ratio=4.45x, Gap=-4.978
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.081, Ratio=4.33x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.089, Ratio=4.37x, Gap=-4.494
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.081, Ratio=4.30x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.065, Ratio=4.17x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.049, Ratio=4.15x, Gap=-4.209
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.095, Ratio=4.35x, Gap=-4.508
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.087, Ratio=4.27x, Gap=-4.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.077, Ratio=4.34x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.070, Ratio=4.48x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.064, Ratio=4.38x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.073, Ratio=4.55x, Gap=-4.211
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.070, Ratio=4.29x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.075, Ratio=4.41x, Gap=-4.482
Batch  25/537: Loss=0.8355 (C:0.8355, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.070, Ratio=4.35x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.071, Ratio=4.27x, Gap=-4.083
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.052, Ratio=4.11x, Gap=-4.352
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.066, Ratio=4.31x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.076, Ratio=4.32x, Gap=-4.828
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.110, Ratio=4.42x, Gap=-4.883
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.058, Ratio=4.17x, Gap=-4.892
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.061, Ratio=4.42x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.062, Ratio=4.28x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.072, Ratio=4.25x, Gap=-3.914
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.053, Ratio=4.34x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.055, Ratio=4.35x, Gap=-4.328
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.082, Ratio=4.56x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.066, Ratio=4.17x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.070, Ratio=4.37x, Gap=-4.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.059, Ratio=4.32x, Gap=-4.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.055, Ratio=4.28x, Gap=-4.813
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.069, Ratio=4.39x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.107, Ratio=4.41x, Gap=-4.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.074, Ratio=4.34x, Gap=-4.392
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.056, Ratio=4.22x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.060, Ratio=4.22x, Gap=-4.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.049, Ratio=4.26x, Gap=-4.355
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.092, Ratio=4.42x, Gap=-4.984
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.074, Ratio=4.34x, Gap=-4.274
Batch  50/537: Loss=0.8449 (C:0.8449, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.102, Ratio=4.72x, Gap=-4.319
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.075, Ratio=4.35x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.073, Ratio=4.47x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.071, Ratio=4.32x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.081, Ratio=4.45x, Gap=-4.236
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.050, Ratio=4.30x, Gap=-4.478
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.072, Ratio=4.36x, Gap=-4.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.070, Ratio=4.26x, Gap=-4.208
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.043, Ratio=4.18x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.077, Ratio=4.35x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.047, Ratio=4.22x, Gap=-5.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.099, Ratio=4.33x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.078, Ratio=4.42x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.101, Ratio=4.44x, Gap=-4.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.051, Ratio=4.08x, Gap=-4.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.067, Ratio=4.33x, Gap=-4.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.066, Ratio=4.37x, Gap=-4.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.080, Ratio=4.34x, Gap=-4.240
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.104, Ratio=4.69x, Gap=-4.045
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.060, Ratio=4.10x, Gap=-4.535
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.077, Ratio=4.55x, Gap=-4.202
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.052, Ratio=4.25x, Gap=-4.036
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.078, Ratio=4.40x, Gap=-4.272
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.062, Ratio=4.36x, Gap=-4.367
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.069, Ratio=4.35x, Gap=-4.784
Batch  75/537: Loss=0.8423 (C:0.8423, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.056, Ratio=4.28x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.064, Ratio=4.41x, Gap=-4.461
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.078, Ratio=4.30x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.080, Ratio=4.52x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.069, Ratio=4.20x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.067, Ratio=4.27x, Gap=-4.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.096, Ratio=4.44x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.114, Ratio=4.55x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.045, Ratio=4.30x, Gap=-4.178
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.090, Ratio=4.42x, Gap=-4.440
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.062, Ratio=4.29x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.066, Ratio=4.40x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.069, Ratio=4.28x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.070, Ratio=4.34x, Gap=-4.373
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.039, Ratio=4.01x, Gap=-4.856
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.053, Ratio=4.26x, Gap=-4.386
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.107, Ratio=4.57x, Gap=-4.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.054, Ratio=4.12x, Gap=-4.941
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.047, Ratio=4.05x, Gap=-4.417
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.060, Ratio=4.31x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.047, Ratio=4.14x, Gap=-4.450
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.062, Ratio=4.20x, Gap=-4.233
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.046, Ratio=4.18x, Gap=-4.368
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.069, Ratio=4.29x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.074, Ratio=4.29x, Gap=-4.437
Batch 100/537: Loss=0.8560 (C:0.8560, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.049, Ratio=4.16x, Gap=-4.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.067, Ratio=4.09x, Gap=-4.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.075, Ratio=4.27x, Gap=-4.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.058, Ratio=4.04x, Gap=-4.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.076, Ratio=4.50x, Gap=-4.833
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.054, Ratio=4.43x, Gap=-4.409
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.060, Ratio=4.33x, Gap=-4.301
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.070, Ratio=4.15x, Gap=-4.122
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.086, Ratio=4.57x, Gap=-4.271
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.070, Ratio=4.20x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.086, Ratio=4.33x, Gap=-5.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.076, Ratio=4.33x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.055, Ratio=4.13x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.063, Ratio=4.37x, Gap=-4.518
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.048, Ratio=4.19x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.048, Ratio=4.17x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.049, Ratio=4.17x, Gap=-4.567
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.064, Ratio=4.28x, Gap=-4.439
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.059, Ratio=4.21x, Gap=-4.425
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.066, Ratio=4.29x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.076, Ratio=4.38x, Gap=-4.760
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.065, Ratio=4.31x, Gap=-4.416
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.079, Ratio=4.42x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.104, Ratio=4.47x, Gap=-4.523
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.056, Ratio=4.21x, Gap=-4.353
Batch 125/537: Loss=0.8622 (C:0.8622, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.049, Ratio=4.19x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.076, Ratio=4.39x, Gap=-5.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.068, Ratio=4.29x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.048, Ratio=4.10x, Gap=-4.158
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.068, Ratio=4.23x, Gap=-4.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.054, Ratio=4.30x, Gap=-4.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.093, Ratio=4.49x, Gap=-4.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.069, Ratio=4.37x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.080, Ratio=4.43x, Gap=-4.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.056, Ratio=4.21x, Gap=-4.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.061, Ratio=4.30x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.064, Ratio=4.31x, Gap=-4.252
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.054, Ratio=4.19x, Gap=-4.213
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.078, Ratio=4.49x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.073, Ratio=4.44x, Gap=-4.093
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.072, Ratio=4.22x, Gap=-4.370
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.082, Ratio=4.45x, Gap=-4.054
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.069, Ratio=4.41x, Gap=-4.164
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.068, Ratio=4.26x, Gap=-4.406
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.094, Ratio=4.47x, Gap=-4.275
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.072, Ratio=4.19x, Gap=-3.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.072, Ratio=4.20x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.065, Ratio=4.23x, Gap=-3.950
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.086, Ratio=4.57x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.072, Ratio=4.38x, Gap=-4.474
Batch 150/537: Loss=0.8403 (C:0.8403, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.062, Ratio=4.30x, Gap=-4.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.057, Ratio=4.13x, Gap=-4.096
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.051, Ratio=4.13x, Gap=-4.378
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.045, Ratio=4.21x, Gap=-4.111
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.064, Ratio=4.22x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.074, Ratio=4.36x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.074, Ratio=4.33x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.062, Ratio=4.10x, Gap=-4.359
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.071, Ratio=4.25x, Gap=-4.799
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.042, Ratio=4.14x, Gap=-4.507
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.092, Ratio=4.31x, Gap=-4.097
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.086, Ratio=4.45x, Gap=-4.360
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.049, Ratio=4.23x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.094, Ratio=4.59x, Gap=-4.553
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.046, Ratio=4.15x, Gap=-5.019
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.043, Ratio=4.13x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.067, Ratio=4.30x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.070, Ratio=4.21x, Gap=-5.044
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.057, Ratio=4.28x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.512, Neg=2.045, Ratio=4.00x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.049, Ratio=4.28x, Gap=-4.395
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.095, Ratio=4.55x, Gap=-4.427
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.045, Ratio=4.19x, Gap=-4.538
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.064, Ratio=4.47x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.080, Ratio=4.43x, Gap=-4.098
Batch 175/537: Loss=0.8344 (C:0.8344, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.060, Ratio=4.39x, Gap=-4.407
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.075, Ratio=4.28x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.034, Ratio=4.16x, Gap=-4.296
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.059, Ratio=4.06x, Gap=-4.136
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.071, Ratio=4.40x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.082, Ratio=4.23x, Gap=-4.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.065, Ratio=4.23x, Gap=-4.115
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.050, Ratio=4.22x, Gap=-4.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.060, Ratio=4.20x, Gap=-4.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.094, Ratio=4.48x, Gap=-4.388
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.069, Ratio=4.46x, Gap=-4.543
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.065, Ratio=4.22x, Gap=-4.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.094, Ratio=4.28x, Gap=-4.504
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.064, Ratio=4.41x, Gap=-4.537
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.100, Ratio=4.33x, Gap=-4.129
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.065, Ratio=4.11x, Gap=-4.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.075, Ratio=4.21x, Gap=-4.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.113, Ratio=4.60x, Gap=-4.467
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.054, Ratio=4.13x, Gap=-4.947
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.077, Ratio=4.30x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.067, Ratio=4.35x, Gap=-4.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.088, Ratio=4.45x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.034, Ratio=4.13x, Gap=-5.027
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.083, Ratio=4.17x, Gap=-4.143
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.064, Ratio=4.16x, Gap=-4.407
Batch 200/537: Loss=0.8718 (C:0.8718, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.067, Ratio=4.37x, Gap=-4.049
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.069, Ratio=4.29x, Gap=-4.188
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.041, Ratio=4.18x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.068, Ratio=4.54x, Gap=-4.185
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.058, Ratio=4.26x, Gap=-3.930
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.054, Ratio=4.24x, Gap=-4.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.047, Ratio=4.18x, Gap=-4.308
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.082, Ratio=4.61x, Gap=-4.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.050, Ratio=4.17x, Gap=-4.288
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.053, Ratio=4.18x, Gap=-4.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.073, Ratio=4.23x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.106, Ratio=4.43x, Gap=-4.215
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.061, Ratio=4.11x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.087, Ratio=4.28x, Gap=-4.221
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.076, Ratio=4.32x, Gap=-4.315
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.114, Ratio=4.38x, Gap=-4.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.067, Ratio=4.24x, Gap=-4.433
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.063, Ratio=4.33x, Gap=-4.150
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.059, Ratio=4.19x, Gap=-4.048
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.076, Ratio=4.52x, Gap=-4.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.070, Ratio=4.44x, Gap=-4.072
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.071, Ratio=4.31x, Gap=-4.912
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.066, Ratio=4.37x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.064, Ratio=4.12x, Gap=-4.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.086, Ratio=4.33x, Gap=-4.991
Batch 225/537: Loss=0.8458 (C:0.8458, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.052, Ratio=4.24x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.077, Ratio=4.35x, Gap=-4.181
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.065, Ratio=4.25x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.084, Ratio=4.63x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.072, Ratio=4.30x, Gap=-4.264
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.021, Ratio=4.05x, Gap=-4.383
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.045, Ratio=4.18x, Gap=-4.472
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=2.044, Ratio=3.95x, Gap=-4.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.085, Ratio=4.46x, Gap=-4.278
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.064, Ratio=4.29x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.061, Ratio=4.20x, Gap=-4.591
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.074, Ratio=4.22x, Gap=-4.851
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.062, Ratio=4.18x, Gap=-4.381
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.063, Ratio=4.27x, Gap=-4.303
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.063, Ratio=4.24x, Gap=-4.336
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.064, Ratio=4.41x, Gap=-4.341
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.072, Ratio=4.35x, Gap=-4.550
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.079, Ratio=4.42x, Gap=-3.991
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.078, Ratio=4.31x, Gap=-4.902
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.097, Ratio=4.31x, Gap=-4.498
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.074, Ratio=4.28x, Gap=-4.488
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.082, Ratio=4.36x, Gap=-4.276
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.066, Ratio=4.29x, Gap=-4.114
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.085, Ratio=4.39x, Gap=-4.477
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.060, Ratio=4.31x, Gap=-4.249
Batch 250/537: Loss=0.8494 (C:0.8494, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.020, Ratio=4.01x, Gap=-4.371
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.060, Ratio=4.19x, Gap=-4.390
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.055, Ratio=4.12x, Gap=-4.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.057, Ratio=4.28x, Gap=-4.117
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.081, Ratio=4.41x, Gap=-3.909
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.054, Ratio=4.16x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.072, Ratio=4.28x, Gap=-4.503
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.087, Ratio=4.44x, Gap=-4.106
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.056, Ratio=4.25x, Gap=-4.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.059, Ratio=4.20x, Gap=-4.449
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.067, Ratio=4.09x, Gap=-4.085
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.076, Ratio=4.45x, Gap=-4.300
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.079, Ratio=4.43x, Gap=-4.191
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.048, Ratio=4.30x, Gap=-4.056
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.052, Ratio=4.12x, Gap=-4.564
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.056, Ratio=4.20x, Gap=-4.522
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.067, Ratio=4.34x, Gap=-4.104
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.071, Ratio=4.23x, Gap=-4.173
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.105, Ratio=4.50x, Gap=-4.871
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.077, Ratio=4.46x, Gap=-4.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.085, Ratio=4.39x, Gap=-4.289
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.063, Ratio=4.23x, Gap=-4.470
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.042, Ratio=4.22x, Gap=-4.293
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.087, Ratio=4.45x, Gap=-4.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.048, Ratio=4.15x, Gap=-4.374
Batch 275/537: Loss=0.8742 (C:0.8742, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.056, Ratio=4.32x, Gap=-4.400
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.091, Ratio=4.47x, Gap=-4.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.055, Ratio=4.35x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.073, Ratio=4.33x, Gap=-4.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.528, Neg=2.041, Ratio=3.87x, Gap=-4.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.063, Ratio=4.44x, Gap=-4.385
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.060, Ratio=4.12x, Gap=-4.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.058, Ratio=4.27x, Gap=-4.491
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.068, Ratio=4.10x, Gap=-5.015
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.509, Neg=2.066, Ratio=4.06x, Gap=-4.384
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.069, Ratio=4.36x, Gap=-4.057
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.072, Ratio=4.39x, Gap=-4.867
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.060, Ratio=4.22x, Gap=-4.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.065, Ratio=4.25x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.062, Ratio=4.31x, Gap=-4.424
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.064, Ratio=4.39x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.068, Ratio=4.26x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.085, Ratio=4.21x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.061, Ratio=4.22x, Gap=-4.865
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.055, Ratio=4.12x, Gap=-4.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.059, Ratio=4.19x, Gap=-4.927
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.068, Ratio=4.40x, Gap=-3.932
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.069, Ratio=4.31x, Gap=-4.196
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.076, Ratio=4.28x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.063, Ratio=4.37x, Gap=-4.536
Batch 300/537: Loss=0.8394 (C:0.8394, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.049, Ratio=4.13x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.073, Ratio=4.48x, Gap=-4.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.070, Ratio=4.48x, Gap=-4.255
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.064, Ratio=4.42x, Gap=-4.331
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.061, Ratio=4.15x, Gap=-4.475
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.072, Ratio=4.30x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.065, Ratio=4.22x, Gap=-5.280
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.054, Ratio=4.07x, Gap=-4.161
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.081, Ratio=4.39x, Gap=-4.198
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.084, Ratio=4.44x, Gap=-4.176
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.067, Ratio=4.28x, Gap=-4.295
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.094, Ratio=4.44x, Gap=-4.444
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.044, Ratio=4.20x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.090, Ratio=4.43x, Gap=-4.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.075, Ratio=4.52x, Gap=-4.290
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.055, Ratio=4.25x, Gap=-4.029
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.072, Ratio=4.47x, Gap=-4.430
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.092, Ratio=4.33x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.058, Ratio=4.16x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.048, Ratio=4.18x, Gap=-4.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.076, Ratio=4.44x, Gap=-5.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.069, Ratio=4.18x, Gap=-4.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.054, Ratio=4.24x, Gap=-4.414
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.098, Ratio=4.36x, Gap=-4.891
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.073, Ratio=4.33x, Gap=-4.444
Batch 325/537: Loss=0.8462 (C:0.8462, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.083, Ratio=4.37x, Gap=-4.035
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.062, Ratio=4.15x, Gap=-4.410
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.067, Ratio=4.36x, Gap=-4.256
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.072, Ratio=4.13x, Gap=-4.179
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.069, Ratio=4.33x, Gap=-4.840
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.040, Ratio=4.13x, Gap=-4.517
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.075, Ratio=4.23x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.070, Ratio=4.17x, Gap=-4.412
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.069, Ratio=4.24x, Gap=-5.099
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.052, Ratio=4.04x, Gap=-5.197
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.084, Ratio=4.51x, Gap=-4.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.085, Ratio=4.49x, Gap=-4.396
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.047, Ratio=4.36x, Gap=-4.113
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.068, Ratio=4.17x, Gap=-4.481
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.054, Ratio=4.27x, Gap=-4.001
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.033, Ratio=4.07x, Gap=-4.251
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.059, Ratio=4.39x, Gap=-4.232
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.064, Ratio=4.42x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.075, Ratio=4.22x, Gap=-3.919
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.060, Ratio=4.26x, Gap=-4.067
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.065, Ratio=4.27x, Gap=-4.116
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.081, Ratio=4.34x, Gap=-4.222
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.091, Ratio=4.39x, Gap=-4.511
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.066, Ratio=4.24x, Gap=-4.457
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.081, Ratio=4.35x, Gap=-4.870
Batch 350/537: Loss=0.8408 (C:0.8408, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.061, Ratio=4.26x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.056, Ratio=4.18x, Gap=-4.292
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.046, Ratio=4.09x, Gap=-4.281
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.064, Ratio=4.15x, Gap=-4.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.077, Ratio=4.49x, Gap=-4.051
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.056, Ratio=4.18x, Gap=-5.125
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.058, Ratio=4.33x, Gap=-4.062
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.076, Ratio=4.47x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.047, Ratio=4.10x, Gap=-4.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.046, Ratio=4.12x, Gap=-5.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.062, Ratio=4.34x, Gap=-4.340
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.060, Ratio=4.31x, Gap=-4.305
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.074, Ratio=4.29x, Gap=-4.101
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.074, Ratio=4.41x, Gap=-4.573
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.082, Ratio=4.22x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.078, Ratio=4.37x, Gap=-4.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.081, Ratio=4.18x, Gap=-4.374
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.081, Ratio=4.25x, Gap=-4.333
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.069, Ratio=4.40x, Gap=-4.089
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.086, Ratio=4.27x, Gap=-4.992
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.074, Ratio=4.29x, Gap=-4.349
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.080, Ratio=4.50x, Gap=-4.180
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.068, Ratio=4.13x, Gap=-4.468
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.083, Ratio=4.43x, Gap=-4.005
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.475, Neg=2.078, Ratio=4.38x, Gap=-4.426
Batch 375/537: Loss=0.8407 (C:0.8407, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.050, Ratio=4.16x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.045, Ratio=4.38x, Gap=-4.937
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.069, Ratio=4.31x, Gap=-4.186
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.030, Ratio=4.08x, Gap=-4.547
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.094, Ratio=4.45x, Gap=-4.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.037, Ratio=4.03x, Gap=-4.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.082, Ratio=4.45x, Gap=-4.110
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.061, Ratio=4.20x, Gap=-4.348
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.039, Ratio=4.05x, Gap=-4.506
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.051, Ratio=4.02x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.037, Ratio=4.17x, Gap=-4.059
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.060, Ratio=4.13x, Gap=-4.555
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.066, Ratio=4.28x, Gap=-4.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.057, Ratio=4.17x, Gap=-4.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.057, Ratio=4.06x, Gap=-4.203
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.045, Ratio=4.03x, Gap=-4.257
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.063, Ratio=4.24x, Gap=-4.979
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.051, Ratio=4.23x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.048, Ratio=4.18x, Gap=-4.497
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.055, Ratio=4.24x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.069, Ratio=4.22x, Gap=-4.347
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.058, Ratio=4.18x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.069, Ratio=4.18x, Gap=-4.279
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.079, Ratio=4.29x, Gap=-4.070
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.067, Ratio=4.17x, Gap=-4.324
Batch 400/537: Loss=0.8672 (C:0.8672, R:0.0106)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.079, Ratio=4.42x, Gap=-4.283
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.092, Ratio=4.35x, Gap=-4.273
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.505, Neg=2.047, Ratio=4.06x, Gap=-4.320
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.074, Ratio=4.37x, Gap=-4.485
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.087, Ratio=4.34x, Gap=-4.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.510, Neg=2.058, Ratio=4.03x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.068, Ratio=4.19x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.075, Ratio=4.19x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.059, Ratio=4.17x, Gap=-4.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.073, Ratio=4.35x, Gap=-4.454
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.518, Neg=2.054, Ratio=3.97x, Gap=-5.012
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.048, Ratio=4.12x, Gap=-5.170
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.465, Neg=2.068, Ratio=4.45x, Gap=-4.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.075, Ratio=4.23x, Gap=-4.552
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.054, Ratio=4.16x, Gap=-4.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.076, Ratio=4.41x, Gap=-4.060
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.073, Ratio=4.15x, Gap=-3.943
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.478, Neg=2.056, Ratio=4.30x, Gap=-4.322
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.033, Ratio=4.09x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.494, Neg=2.045, Ratio=4.14x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.056, Ratio=4.13x, Gap=-4.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.050, Ratio=4.08x, Gap=-4.356
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.065, Ratio=4.28x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.060, Ratio=4.15x, Gap=-4.570
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.079, Ratio=4.33x, Gap=-4.373
Batch 425/537: Loss=0.8428 (C:0.8428, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.098, Ratio=4.40x, Gap=-4.267
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.068, Ratio=4.47x, Gap=-4.183
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.070, Ratio=4.14x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.073, Ratio=4.24x, Gap=-4.426
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.059, Ratio=4.21x, Gap=-3.901
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.062, Ratio=4.23x, Gap=-4.474
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.057, Ratio=4.22x, Gap=-4.561
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.075, Ratio=4.21x, Gap=-4.346
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.466, Neg=2.055, Ratio=4.41x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.057, Ratio=4.18x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.064, Ratio=4.23x, Gap=-4.405
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.497, Neg=2.045, Ratio=4.12x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.055, Ratio=4.09x, Gap=-4.563
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.085, Ratio=4.61x, Gap=-4.214
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.066, Ratio=4.31x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.069, Ratio=4.35x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.060, Ratio=4.19x, Gap=-4.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.075, Ratio=4.27x, Gap=-4.270
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.047, Ratio=4.04x, Gap=-4.312
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.082, Ratio=4.33x, Gap=-4.434
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.067, Ratio=4.22x, Gap=-4.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.055, Ratio=4.24x, Gap=-4.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.051, Ratio=4.13x, Gap=-4.318
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.483, Neg=2.043, Ratio=4.23x, Gap=-4.531
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.484, Neg=2.067, Ratio=4.27x, Gap=-4.805
Batch 450/537: Loss=0.8552 (C:0.8552, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.062, Ratio=4.33x, Gap=-4.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.470, Neg=2.074, Ratio=4.41x, Gap=-4.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.091, Ratio=4.59x, Gap=-4.420
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.473, Neg=2.072, Ratio=4.38x, Gap=-5.159
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.489, Neg=2.093, Ratio=4.28x, Gap=-4.244
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.094, Ratio=4.23x, Gap=-4.451
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.506, Neg=2.057, Ratio=4.06x, Gap=-4.841
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.085, Ratio=4.47x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.084, Ratio=4.37x, Gap=-4.458
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.094, Ratio=4.43x, Gap=-4.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.477, Neg=2.061, Ratio=4.32x, Gap=-4.372
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.065, Ratio=4.23x, Gap=-4.142
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.061, Ratio=4.21x, Gap=-4.820
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.061, Ratio=4.28x, Gap=-4.120
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.073, Ratio=4.23x, Gap=-4.530
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.092, Ratio=4.48x, Gap=-4.489
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.467, Neg=2.062, Ratio=4.41x, Gap=-4.205
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.495, Neg=2.063, Ratio=4.17x, Gap=-4.519
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.069, Ratio=4.26x, Gap=-4.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.476, Neg=2.071, Ratio=4.36x, Gap=-4.779
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.086, Ratio=4.40x, Gap=-4.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.083, Ratio=4.53x, Gap=-4.132
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.486, Neg=2.085, Ratio=4.29x, Gap=-4.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.077, Ratio=4.19x, Gap=-4.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.504, Neg=2.046, Ratio=4.06x, Gap=-4.681
Batch 475/537: Loss=0.8843 (C:0.8843, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.059, Ratio=4.20x, Gap=-4.452
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.081, Ratio=4.20x, Gap=-4.571
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.068, Ratio=4.24x, Gap=-4.151
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.036, Ratio=4.20x, Gap=-4.527
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.057, Ratio=4.17x, Gap=-4.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.057, Ratio=4.13x, Gap=-4.080
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.068, Ratio=4.20x, Gap=-4.516
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.039, Ratio=4.16x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.061, Ratio=4.25x, Gap=-4.490
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.056, Ratio=4.12x, Gap=-4.428
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.063, Ratio=4.23x, Gap=-4.201
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.500, Neg=2.042, Ratio=4.08x, Gap=-4.462
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.068, Ratio=4.21x, Gap=-4.285
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.044, Ratio=4.17x, Gap=-4.456
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.043, Ratio=4.19x, Gap=-4.227
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.046, Ratio=4.11x, Gap=-4.134
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.088, Ratio=4.45x, Gap=-4.234
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.515, Neg=2.036, Ratio=3.96x, Gap=-4.250
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.069, Ratio=4.15x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.075, Ratio=4.23x, Gap=-4.175
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.492, Neg=2.080, Ratio=4.23x, Gap=-4.144
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.516, Neg=2.061, Ratio=3.99x, Gap=-4.532
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.065, Ratio=4.13x, Gap=-4.220
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.046, Ratio=4.18x, Gap=-4.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.490, Neg=2.040, Ratio=4.17x, Gap=-4.203
Batch 500/537: Loss=0.8711 (C:0.8711, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.046, Ratio=4.24x, Gap=-4.297
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.073, Ratio=4.31x, Gap=-4.397
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.073, Ratio=4.28x, Gap=-4.429
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.488, Neg=2.058, Ratio=4.22x, Gap=-4.569
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.060, Ratio=4.10x, Gap=-4.580
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.508, Neg=2.011, Ratio=3.96x, Gap=-4.162
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.040, Ratio=4.09x, Gap=-4.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.059, Ratio=4.29x, Gap=-4.237
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.501, Neg=2.052, Ratio=4.10x, Gap=-4.558
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.481, Neg=2.068, Ratio=4.30x, Gap=-4.870
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.043, Ratio=4.24x, Gap=-5.284
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.479, Neg=2.070, Ratio=4.32x, Gap=-4.362
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.075, Ratio=4.23x, Gap=-4.357
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.507, Neg=2.045, Ratio=4.03x, Gap=-4.171
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.502, Neg=2.036, Ratio=4.06x, Gap=-4.399
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.474, Neg=2.066, Ratio=4.35x, Gap=-4.098
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.503, Neg=2.061, Ratio=4.09x, Gap=-4.306
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.086, Ratio=4.50x, Gap=-4.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.082, Ratio=4.44x, Gap=-4.184
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.036, Ratio=4.15x, Gap=-4.380
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.491, Neg=2.044, Ratio=4.16x, Gap=-4.066
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.077, Ratio=4.32x, Gap=-4.268
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.499, Neg=2.052, Ratio=4.11x, Gap=-4.365
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.067, Ratio=4.46x, Gap=-4.304
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.051, Ratio=4.21x, Gap=-4.335
Batch 525/537: Loss=0.8603 (C:0.8603, R:0.0105)
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.498, Neg=2.051, Ratio=4.12x, Gap=-4.165
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.487, Neg=2.055, Ratio=4.22x, Gap=-4.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.485, Neg=2.061, Ratio=4.25x, Gap=-4.418
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.480, Neg=2.050, Ratio=4.27x, Gap=-4.102
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.472, Neg=2.074, Ratio=4.39x, Gap=-4.065
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.496, Neg=2.067, Ratio=4.16x, Gap=-4.141
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.482, Neg=2.068, Ratio=4.29x, Gap=-4.466
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.493, Neg=2.067, Ratio=4.19x, Gap=-4.241
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.468, Neg=2.071, Ratio=4.42x, Gap=-4.243
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.082, Ratio=4.51x, Gap=-4.493
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.517, Neg=2.048, Ratio=3.96x, Gap=-4.611
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.083, Ratio=4.83x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.080, Ratio=4.76x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.078, Ratio=4.86x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.061, Ratio=4.73x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.080, Ratio=4.89x, Gap=-3.625
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.078, Ratio=4.70x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.073, Ratio=4.73x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.088, Ratio=4.76x, Gap=-3.560
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.087, Ratio=4.86x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.066, Ratio=4.58x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.067, Ratio=4.66x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.092, Ratio=4.84x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.080, Ratio=4.71x, Gap=-3.794
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.104, Ratio=4.93x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.074, Ratio=4.73x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.081, Ratio=4.86x, Gap=-3.745
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.085, Ratio=4.85x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.083, Ratio=4.87x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.075, Ratio=4.65x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.079, Ratio=4.73x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.085, Ratio=4.80x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.085, Ratio=4.83x, Gap=-3.821
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.055, Ratio=4.60x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.078, Ratio=4.85x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.090, Ratio=4.91x, Gap=-3.574
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.085, Ratio=4.78x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.065, Ratio=4.64x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.073, Ratio=4.68x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.091, Ratio=4.89x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.085, Ratio=4.84x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.059, Ratio=4.74x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.089, Ratio=5.02x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.075, Ratio=4.68x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.079, Ratio=4.83x, Gap=-3.805
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.095, Ratio=4.90x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.070, Ratio=4.64x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.103, Ratio=5.23x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.463, Neg=2.069, Ratio=4.47x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.092, Ratio=4.87x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.070, Ratio=4.68x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.067, Ratio=4.63x, Gap=-3.602
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.103, Ratio=5.22x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.086, Ratio=4.92x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.400, Neg=2.096, Ratio=5.24x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.102, Ratio=4.89x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.067, Ratio=4.85x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.081, Ratio=4.77x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.059, Ratio=4.44x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.116, Ratio=5.08x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.097, Ratio=5.12x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.061, Ratio=4.76x, Gap=-3.808
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.084, Ratio=4.67x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.084, Ratio=4.85x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.067, Ratio=4.62x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.074, Ratio=4.68x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.050, Ratio=4.81x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.075, Ratio=4.58x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.049, Ratio=4.66x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.055, Ratio=4.68x, Gap=-3.827
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.067, Ratio=4.56x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.099, Ratio=5.13x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.086, Ratio=4.87x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.082, Ratio=5.03x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.078, Ratio=4.62x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.081, Ratio=4.94x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.088, Ratio=4.91x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.086, Ratio=4.72x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.079, Ratio=4.82x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.088, Ratio=4.92x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.065, Ratio=4.79x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.067, Ratio=4.62x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.099, Ratio=4.91x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.093, Ratio=4.96x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.060, Ratio=4.53x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.082, Ratio=4.85x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.086, Ratio=4.90x, Gap=-3.775
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.071, Ratio=4.57x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.112, Ratio=5.06x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.095, Ratio=4.93x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.082, Ratio=4.99x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.089, Ratio=5.07x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.085, Ratio=4.76x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.096, Ratio=4.75x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.090, Ratio=5.06x, Gap=-3.635
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.107, Ratio=5.09x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.087, Ratio=4.71x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.067, Ratio=4.70x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.061, Ratio=4.59x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.093, Ratio=4.94x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.069, Ratio=4.71x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.065, Ratio=4.59x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.096, Ratio=4.98x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.069, Ratio=4.83x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.080, Ratio=4.79x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.075, Ratio=4.60x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.072, Ratio=4.54x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.087, Ratio=4.86x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.093, Ratio=5.13x, Gap=-3.803
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.084, Ratio=4.78x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.091, Ratio=5.00x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.091, Ratio=4.95x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.089, Ratio=4.78x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.109, Ratio=5.13x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.093, Ratio=5.09x, Gap=-3.590
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.053, Ratio=4.66x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.053, Ratio=4.52x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.096, Ratio=4.89x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.104, Ratio=5.11x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.083, Ratio=4.67x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.085, Ratio=4.74x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.096, Ratio=4.88x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.098, Ratio=4.79x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.084, Ratio=4.84x, Gap=-3.795
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.091, Ratio=4.81x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.054, Ratio=4.63x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.078, Ratio=4.65x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.099, Ratio=5.14x, Gap=-3.589
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.090, Ratio=5.08x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.066, Ratio=4.67x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.058, Ratio=4.74x, Gap=-3.714
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.095, Ratio=5.17x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.100, Ratio=4.76x, Gap=-3.853
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.457, Neg=2.057, Ratio=4.50x, Gap=-3.929
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.084, Ratio=4.87x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.081, Ratio=4.94x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.065, Ratio=4.72x, Gap=-3.765
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.092, Ratio=4.95x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.090, Ratio=4.91x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.078, Ratio=4.92x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.088, Ratio=4.71x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.077, Ratio=4.92x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.079, Ratio=4.91x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.090, Ratio=4.80x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.090, Ratio=4.85x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.099, Ratio=5.13x, Gap=-3.753
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.089, Ratio=5.03x, Gap=-3.592
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.088, Ratio=4.89x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.089, Ratio=4.83x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.127, Ratio=5.22x, Gap=-3.739
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.066, Ratio=4.68x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.064, Ratio=4.62x, Gap=-3.695
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.075, Ratio=4.86x, Gap=-3.678
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.075, Ratio=4.67x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.060, Ratio=4.63x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.086, Ratio=4.81x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.083, Ratio=4.77x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.064, Ratio=4.74x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.076, Ratio=4.75x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.085, Ratio=4.76x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.089, Ratio=4.91x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.084, Ratio=4.72x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.094, Ratio=4.98x, Gap=-3.823
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.076, Ratio=4.86x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.094, Ratio=4.93x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.097, Ratio=4.72x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.459, Neg=2.076, Ratio=4.52x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.080, Ratio=4.80x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.093, Ratio=5.07x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.058, Ratio=4.58x, Gap=-3.645
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.093, Ratio=4.96x, Gap=-3.596
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.063, Ratio=4.72x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.087, Ratio=4.93x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.099, Ratio=5.13x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.088, Ratio=4.95x, Gap=-3.631
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.69x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.089, Ratio=4.81x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.072, Ratio=4.93x, Gap=-3.603
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.064, Ratio=4.62x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.097, Ratio=5.16x, Gap=-3.610
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.081, Ratio=4.96x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.087, Ratio=5.12x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.092, Ratio=5.03x, Gap=-3.614
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.085, Ratio=4.65x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.077, Ratio=4.54x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.063, Ratio=4.76x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.069, Ratio=4.78x, Gap=-3.629
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.092, Ratio=5.04x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.072, Ratio=4.82x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.067, Ratio=4.61x, Gap=-3.730
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.076, Ratio=4.73x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.066, Ratio=4.67x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.109, Ratio=5.03x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.079, Ratio=4.76x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.080, Ratio=4.86x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.073, Ratio=4.55x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.458, Neg=2.064, Ratio=4.50x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.072, Ratio=4.78x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.069, Ratio=4.86x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.082, Ratio=4.76x, Gap=-3.969
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.101, Ratio=5.02x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.070, Ratio=4.78x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.105, Ratio=5.00x, Gap=-3.607
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.076, Ratio=4.67x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.079, Ratio=4.86x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.047, Ratio=4.51x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.066, Ratio=4.74x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.078, Ratio=4.74x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.078, Ratio=4.84x, Gap=-3.728
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.076, Ratio=4.74x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.082, Ratio=4.79x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.084, Ratio=4.75x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.076, Ratio=4.83x, Gap=-3.572
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.062, Ratio=4.53x, Gap=-3.687
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.091, Ratio=4.98x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.079, Ratio=4.62x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.074, Ratio=4.68x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.053, Ratio=4.51x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.086, Ratio=4.91x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.079, Ratio=4.74x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.106, Ratio=5.09x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.090, Ratio=5.03x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.082, Ratio=4.94x, Gap=-3.776
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.079, Ratio=4.80x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.082, Ratio=4.78x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.060, Ratio=4.72x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.092, Ratio=4.91x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.053, Ratio=4.54x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.088, Ratio=4.95x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.092, Ratio=4.62x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.087, Ratio=4.88x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.073, Ratio=4.77x, Gap=-3.762
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.093, Ratio=4.94x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.081, Ratio=4.75x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.086, Ratio=4.84x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.104, Ratio=5.15x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.070, Ratio=5.00x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.077, Ratio=4.76x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.085, Ratio=4.88x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.086, Ratio=4.74x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.102, Ratio=5.06x, Gap=-3.849
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.077, Ratio=4.90x, Gap=-3.758
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.077, Ratio=4.86x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.065, Ratio=4.70x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.085, Ratio=4.84x, Gap=-3.868
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.108, Ratio=5.19x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.079, Ratio=4.69x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.072, Ratio=4.63x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.087, Ratio=4.94x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.066, Ratio=4.72x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.068, Ratio=4.67x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.067, Ratio=4.66x, Gap=-3.644
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.066, Ratio=4.80x, Gap=-3.619
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.092, Ratio=5.07x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.068, Ratio=4.69x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.078, Ratio=4.81x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.065, Ratio=4.56x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.071, Ratio=4.59x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.071, Ratio=4.81x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.092, Ratio=4.75x, Gap=-3.706
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.086, Ratio=4.92x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.087, Ratio=4.80x, Gap=-3.721
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.088, Ratio=4.81x, Gap=-3.663
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.090, Ratio=4.84x, Gap=-3.737
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.073, Ratio=4.72x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.078, Ratio=5.06x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.072, Ratio=4.71x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.090, Ratio=4.79x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.109, Ratio=5.16x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.091, Ratio=5.02x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.085, Ratio=4.88x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.096, Ratio=4.98x, Gap=-3.744
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.073, Ratio=4.71x, Gap=-3.671
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.071, Ratio=4.85x, Gap=-3.618
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.086, Ratio=4.85x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.088, Ratio=5.00x, Gap=-3.764
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.075, Ratio=4.76x, Gap=-3.594
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.087, Ratio=4.99x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.087, Ratio=4.83x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.076, Ratio=4.69x, Gap=-3.652
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.099, Ratio=4.82x, Gap=-3.640
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.098, Ratio=5.04x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.093, Ratio=4.88x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.108, Ratio=5.13x, Gap=-3.747
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.095, Ratio=5.09x, Gap=-3.738
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.058, Ratio=4.69x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.066, Ratio=4.71x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.080, Ratio=4.95x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.084, Ratio=4.84x, Gap=-3.648
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.077, Ratio=4.63x, Gap=-3.713
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.071, Ratio=4.86x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.069, Ratio=4.65x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.095, Ratio=4.98x, Gap=-3.634
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.469, Neg=2.056, Ratio=4.38x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.082, Ratio=4.77x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.081, Ratio=4.83x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.403, Neg=2.091, Ratio=5.18x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.092, Ratio=4.85x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.068, Ratio=4.63x, Gap=-3.716
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.080, Ratio=4.71x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.053, Ratio=4.67x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.093, Ratio=5.13x, Gap=-3.604
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.084, Ratio=4.78x, Gap=-3.763
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.089, Ratio=5.08x, Gap=-3.684
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.092, Ratio=4.86x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.092, Ratio=5.00x, Gap=-3.793
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.105, Ratio=4.90x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.068, Ratio=4.72x, Gap=-3.688
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.074, Ratio=4.58x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.079, Ratio=4.91x, Gap=-3.599
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.084, Ratio=4.67x, Gap=-3.709
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.067, Ratio=4.71x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.092, Ratio=5.15x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.104, Ratio=5.19x, Gap=-3.668
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.063, Ratio=4.74x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.078, Ratio=4.77x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.063, Ratio=4.72x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.071, Ratio=4.56x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.081, Ratio=4.81x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.088, Ratio=4.93x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.078, Ratio=4.76x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.084, Ratio=4.90x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.083, Ratio=4.73x, Gap=-3.657
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.074, Ratio=4.68x, Gap=-3.788
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.095, Ratio=4.95x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.058, Ratio=4.67x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.072, Ratio=4.78x, Gap=-3.693
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.053, Ratio=4.63x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.414, Neg=2.087, Ratio=5.04x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.059, Ratio=4.64x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.099, Ratio=4.82x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.086, Ratio=4.95x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.077, Ratio=4.63x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.100, Ratio=4.82x, Gap=-3.715
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.082, Ratio=4.83x, Gap=-3.702
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.068, Ratio=4.67x, Gap=-3.719
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.096, Ratio=4.92x, Gap=-3.729
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.075, Ratio=4.73x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.078, Ratio=4.73x, Gap=-3.620
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.079, Ratio=4.69x, Gap=-3.757
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.050, Ratio=4.57x, Gap=-3.674
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.070, Ratio=4.59x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.075, Ratio=4.78x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.070, Ratio=4.75x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.051, Ratio=4.63x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.417, Neg=2.106, Ratio=5.05x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.078, Ratio=4.97x, Gap=-3.660
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.086, Ratio=4.65x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.082, Ratio=4.90x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.074, Ratio=4.89x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.071, Ratio=4.72x, Gap=-3.771
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.093, Ratio=4.93x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.112, Ratio=5.03x, Gap=-3.655
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.082, Ratio=4.86x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.084, Ratio=4.67x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.087, Ratio=4.89x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.078, Ratio=4.69x, Gap=-3.682
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.073, Ratio=4.80x, Gap=-3.718
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.069, Ratio=4.63x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.083, Ratio=4.93x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.107, Ratio=4.79x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.064, Ratio=4.91x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.068, Ratio=4.78x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.100, Ratio=4.84x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.088, Ratio=4.78x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.090, Ratio=4.86x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.106, Ratio=5.03x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.071, Ratio=4.60x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.084, Ratio=4.90x, Gap=-3.654
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.049, Ratio=4.52x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.097, Ratio=4.96x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.057, Ratio=4.87x, Gap=-3.676
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.077, Ratio=4.60x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.086, Ratio=4.90x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.078, Ratio=4.93x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.080, Ratio=4.70x, Gap=-3.638
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.086, Ratio=4.85x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.462, Neg=2.055, Ratio=4.45x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.080, Ratio=4.78x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.065, Ratio=4.68x, Gap=-3.732
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.056, Ratio=4.64x, Gap=-3.727
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.082, Ratio=4.71x, Gap=-3.766
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.081, Ratio=4.72x, Gap=-3.633
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.067, Ratio=4.75x, Gap=-3.641
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.093, Ratio=4.92x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.097, Ratio=4.91x, Gap=-3.722
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.077, Ratio=4.63x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.088, Ratio=4.95x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.072, Ratio=4.86x, Gap=-3.621
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.073, Ratio=4.58x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.073, Ratio=4.57x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.391, Neg=2.119, Ratio=5.42x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.062, Ratio=4.66x, Gap=-3.617
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.077, Ratio=4.80x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.100, Ratio=4.98x, Gap=-3.651
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.079, Ratio=4.93x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.081, Ratio=4.80x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.113, Ratio=5.03x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.091, Ratio=4.93x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.087, Ratio=4.87x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.080, Ratio=4.81x, Gap=-3.664
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.061, Ratio=4.72x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.094, Ratio=4.96x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.073, Ratio=4.60x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.416, Neg=2.089, Ratio=5.02x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.070, Ratio=4.58x, Gap=-3.752
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.081, Ratio=4.77x, Gap=-3.685
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.084, Ratio=4.88x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.092, Ratio=4.86x, Gap=-3.784
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.080, Ratio=4.83x, Gap=-3.791
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.088, Ratio=4.88x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.412, Neg=2.101, Ratio=5.09x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.100, Ratio=4.79x, Gap=-3.626
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.066, Ratio=4.71x, Gap=-3.689
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.104, Ratio=5.13x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.401, Neg=2.107, Ratio=5.26x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.081, Ratio=4.87x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.091, Ratio=4.81x, Gap=-3.650
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.073, Ratio=4.77x, Gap=-3.669
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.100, Ratio=4.94x, Gap=-3.665
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.065, Ratio=4.67x, Gap=-3.630
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.071, Ratio=4.70x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.102, Ratio=4.94x, Gap=-3.772
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.077, Ratio=4.76x, Gap=-3.667
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.056, Ratio=4.69x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.079, Ratio=4.85x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.070, Ratio=4.87x, Gap=-3.761
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.086, Ratio=4.75x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.073, Ratio=4.80x, Gap=-3.627
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.104, Ratio=4.88x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.407, Neg=2.077, Ratio=5.10x, Gap=-3.540
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.073, Ratio=5.02x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.418, Neg=2.089, Ratio=4.99x, Gap=-3.637
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.442, Neg=2.091, Ratio=4.73x, Gap=-3.705
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.093, Ratio=4.88x, Gap=-3.624
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.426, Neg=2.083, Ratio=4.88x, Gap=-3.649
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.057, Ratio=4.77x, Gap=-3.656
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.087, Ratio=4.82x, Gap=-3.562
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.069, Ratio=4.56x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.057, Ratio=4.53x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.451, Neg=2.069, Ratio=4.59x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.074, Ratio=4.79x, Gap=-3.609
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.415, Neg=2.108, Ratio=5.07x, Gap=-3.608
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.055, Ratio=4.66x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.099, Ratio=4.91x, Gap=-3.581
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.067, Ratio=4.74x, Gap=-3.670
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.080, Ratio=4.73x, Gap=-3.780
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.079, Ratio=4.74x, Gap=-3.601
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.082, Ratio=4.83x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.081, Ratio=4.67x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.448, Neg=2.064, Ratio=4.61x, Gap=-3.735
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.074, Ratio=4.57x, Gap=-3.731
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.091, Ratio=4.84x, Gap=-3.717
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.087, Ratio=4.92x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.086, Ratio=4.75x, Gap=-3.754
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.419, Neg=2.076, Ratio=4.95x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.411, Neg=2.110, Ratio=5.13x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.096, Ratio=4.91x, Gap=-3.733
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.446, Neg=2.072, Ratio=4.64x, Gap=-3.679
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.091, Ratio=4.96x, Gap=-3.632
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.080, Ratio=4.71x, Gap=-3.658
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.454, Neg=2.070, Ratio=4.56x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.079, Ratio=4.84x, Gap=-3.798
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.094, Ratio=4.88x, Gap=-3.661
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.074, Ratio=4.62x, Gap=-3.736
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.081, Ratio=4.93x, Gap=-3.647
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.062, Ratio=4.61x, Gap=-3.756
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.437, Neg=2.081, Ratio=4.76x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.074, Ratio=4.81x, Gap=-3.643
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.074, Ratio=4.80x, Gap=-3.677
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.450, Neg=2.062, Ratio=4.58x, Gap=-3.696
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.096, Ratio=5.07x, Gap=-3.597
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.402, Neg=2.108, Ratio=5.24x, Gap=-3.598
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.453, Neg=2.063, Ratio=4.55x, Gap=-3.703
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.098, Ratio=4.99x, Gap=-3.673
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.425, Neg=2.061, Ratio=4.85x, Gap=-3.636
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.077, Ratio=4.80x, Gap=-3.606
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.081, Ratio=4.87x, Gap=-3.615
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.091, Ratio=4.94x, Gap=-3.642
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.460, Neg=2.048, Ratio=4.45x, Gap=-3.686
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.075, Ratio=4.78x, Gap=-3.582
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.068, Ratio=4.45x, Gap=-3.711
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.076, Ratio=4.68x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.435, Neg=2.072, Ratio=4.77x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.413, Neg=2.072, Ratio=5.02x, Gap=-3.680
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.084, Ratio=4.80x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.077, Ratio=4.75x, Gap=-3.749
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.088, Ratio=4.84x, Gap=-3.782
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.104, Ratio=4.96x, Gap=-3.662
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.077, Ratio=4.67x, Gap=-3.707
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.444, Neg=2.070, Ratio=4.66x, Gap=-3.748
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.427, Neg=2.103, Ratio=4.93x, Gap=-3.710
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.447, Neg=2.086, Ratio=4.67x, Gap=-3.755
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.112, Ratio=5.22x, Gap=-3.605
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.455, Neg=2.069, Ratio=4.54x, Gap=-3.692
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.091, Ratio=4.84x, Gap=-3.804
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.074, Ratio=4.91x, Gap=-3.646
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.086, Ratio=4.93x, Gap=-3.724
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.100, Ratio=4.98x, Gap=-3.701
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.073, Ratio=4.72x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.428, Neg=2.086, Ratio=4.87x, Gap=-3.743
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.431, Neg=2.080, Ratio=4.83x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.080, Ratio=4.75x, Gap=-3.751
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.456, Neg=2.089, Ratio=4.58x, Gap=-3.825
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.424, Neg=2.082, Ratio=4.91x, Gap=-3.691
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.061, Ratio=4.72x, Gap=-3.681
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.073, Ratio=4.70x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.077, Ratio=4.72x, Gap=-3.769
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.430, Neg=2.072, Ratio=4.82x, Gap=-3.740
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.076, Ratio=4.71x, Gap=-3.600
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.461, Neg=2.061, Ratio=4.47x, Gap=-3.773
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.445, Neg=2.071, Ratio=4.65x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.083, Ratio=4.74x, Gap=-3.792
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.076, Ratio=4.94x, Gap=-3.700
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.087, Ratio=4.82x, Gap=-3.683
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.085, Ratio=4.94x, Gap=-3.675
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.073, Ratio=4.68x, Gap=-3.584
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.449, Neg=2.084, Ratio=4.64x, Gap=-3.697
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.434, Neg=2.068, Ratio=4.77x, Gap=-3.694
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.422, Neg=2.087, Ratio=4.95x, Gap=-3.623
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.082, Ratio=4.94x, Gap=-3.796
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.439, Neg=2.084, Ratio=4.75x, Gap=-3.698
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.094, Ratio=4.80x, Gap=-3.741
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.438, Neg=2.072, Ratio=4.74x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.420, Neg=2.078, Ratio=4.95x, Gap=-3.690
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.408, Neg=2.101, Ratio=5.14x, Gap=-3.723
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.441, Neg=2.084, Ratio=4.73x, Gap=-3.835
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.046, Ratio=4.41x, Gap=-3.777
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.406, Neg=2.105, Ratio=5.19x, Gap=-3.639
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.436, Neg=2.077, Ratio=4.76x, Gap=-3.612
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.094, Ratio=4.88x, Gap=-3.616
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.433, Neg=2.074, Ratio=4.79x, Gap=-3.666
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.452, Neg=2.051, Ratio=4.53x, Gap=-3.726
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.092, Ratio=4.97x, Gap=-3.734
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.085, Ratio=4.83x, Gap=-3.742
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.100, Ratio=4.77x, Gap=-3.672
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.443, Neg=2.079, Ratio=4.69x, Gap=-3.704
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.432, Neg=2.080, Ratio=4.82x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.440, Neg=2.079, Ratio=4.73x, Gap=-3.810
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.429, Neg=2.077, Ratio=4.84x, Gap=-3.712
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.410, Neg=2.085, Ratio=5.08x, Gap=-3.910
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.471, Neg=2.056, Ratio=4.37x, Gap=-3.659
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.464, Neg=2.050, Ratio=4.41x, Gap=-3.708
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.405, Neg=2.119, Ratio=5.24x, Gap=-3.699
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.421, Neg=2.113, Ratio=5.02x, Gap=-3.720
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.423, Neg=2.076, Ratio=4.91x, Gap=-3.746
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.409, Neg=2.084, Ratio=5.10x, Gap=-3.622
  Enhanced batch: 1020 current + 1500 global = 2520 total
    Batch distances: Pos=0.395, Neg=2.105, Ratio=5.33x, Gap=-3.745

============================================================
Epoch 20/20 completed in 32.9s
Train: Loss=0.8534 (C:0.8534, R:0.0105) Ratio=3.75x
Val:   Loss=0.7874 (C:0.7874, R:0.0105) Ratio=4.88x
Reconstruction weight: 0.000
✅ New best model saved (Val Loss: 0.7874)
Checkpoint saved at epoch 20
============================================================

Global Dataset Training Completed!
Best epoch: 20
Best validation loss: 0.7874
Final separation ratios: Train=3.75x, Val=4.88x
Training completed!
Loading best model from experiments/global_concat_test_20250712_125603/checkpoints/best_model.pt
Starting model evaluation...
========================================
GlobalContrastiveEvaluator initialized on cuda
Starting comprehensive evaluation...
============================================================
Extracting latent representations...
  Processed 1/539 batches
  Processed 51/539 batches
  Processed 101/539 batches
  Processed 151/539 batches
  Processed 201/539 batches
  Processed 251/539 batches
  Processed 301/539 batches
  Processed 351/539 batches
  Processed 401/539 batches
  Processed 451/539 batches
  Processed 501/539 batches
Extracted representations: torch.Size([549367, 75])
Evaluating clustering performance...
Subsampled to 50000 points for clustering evaluation
Clustering Results:
  Silhouette Score: 0.6386
  Adjusted Rand Score: 0.7446
  Clustering Accuracy: 0.9067
Evaluating classification performance...
  Extracting training representations...
Extracting latent representations...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
Extracted representations: torch.Size([547740, 75])
  Extracting validation representations...
Extracting latent representations...
  Processed 1/537 batches
  Processed 51/537 batches
  Processed 101/537 batches
  Processed 151/537 batches
  Processed 201/537 batches
  Processed 251/537 batches
  Processed 301/537 batches
  Processed 351/537 batches
  Processed 401/537 batches
  Processed 451/537 batches
  Processed 501/537 batches
Extracted representations: torch.Size([547740, 75])
Subsampled training to 50000 samples
Subsampled validation to 10000 samples
  Training on 50000 samples, evaluating on 10000 samples
Classification Results:
  Accuracy: 0.9061
  Per-class F1: [0.0, 0.0, 0.0]
Evaluating reconstruction quality...
Reconstruction Results:
  Average MSE: 0.010513
Evaluating separation quality...

PIPELINE FAILED: [enforce fail at alloc_cpu.cpp:117] err == 0. DefaultCPUAllocator: can't allocate memory: you tried to allocate 1207216402756 bytes. Error code 12 (Cannot allocate memory)

Analysis completed with exit code: 0
Time: Sat 12 Jul 13:09:07 BST 2025

=== ANALYSIS SUCCESSFUL ===
Autoencoder pipeline successful!


Job finished.
